
const GB_base64_js = "InVzZSBzdHJpY3QiOwp2YXIgdG9CYXNlNjQgPSBbIkEiLCAiQiIsICJDIiwgIkQiLCAiRSIsICJGIiwgIkciLCAiSCIsICJJIiwgIkoiLCAiSyIsICJMIiwgIk0iLCAiTiIsICJPIiwgIlAiLCAiUSIsICJSIiwgIlMiLCAiVCIsICJVIiwgIlYiLCAiVyIsICJYIiwgIlkiLCAiWiIsCgkiYSIsICJiIiwgImMiLCAiZCIsICJlIiwgImYiLCAiZyIsICJoIiwgImkiLCAiaiIsICJrIiwgImwiLCAibSIsICJuIiwgIm8iLCAicCIsICJxIiwgInIiLCAicyIsICJ0IiwgInUiLCAidiIsICJ3IiwgIngiLCAieSIsICJ6IiwKCSIwIiwgIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiwgIjciLCAiOCIsICI5IiwgIisiICwgIi8iLCAiPSJdOwp2YXIgZnJvbUJhc2U2NCA9ICJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSI7CmZ1bmN0aW9uIGJhc2U2NChkYXRhKSB7Cgl0cnkgewoJCXZhciBiYXNlNjQgPSB3aW5kb3cuYnRvYShkYXRhKTsJLy9Vc2UgdGhpcyBuYXRpdmUgZnVuY3Rpb24gd2hlbiBpdCdzIGF2YWlsYWJsZSwgYXMgaXQncyBhIG1hZ25pdHVkZSBmYXN0ZXIgdGhhbiB0aGUgbm9uLW5hdGl2ZSBjb2RlIGJlbG93LgoJfQoJY2F0Y2ggKGVycm9yKSB7CgkJLy9EZWZhdWx0aW5nIHRvIG5vbi1uYXRpdmUgYmFzZTY0IGVuY29kaW5nLi4uCgkJdmFyIGJhc2U2NCA9ICIiOwoJCXZhciBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGg7CgkJaWYgKGRhdGFMZW5ndGggPiAwKSB7CgkJCXZhciBieXRlcyA9IFswLCAwLCAwXTsKCQkJdmFyIGluZGV4ID0gMDsKCQkJdmFyIHJlbWFpbmRlciA9IGRhdGFMZW5ndGggJSAzOwoJCQl3aGlsZSAoZGF0YS5sZW5ndGggJSAzID4gMCkgewoJCQkJLy9NYWtlIHN1cmUgd2UgZG9uJ3QgZG8gZnV6enkgbWF0aCBpbiB0aGUgbmV4dCBsb29wLi4uCgkJCQlkYXRhW2RhdGEubGVuZ3RoXSA9ICIgIjsKCQkJfQoJCQl3aGlsZSAoaW5kZXggPCBkYXRhTGVuZ3RoKSB7CgkJCQkvL0tlZXAgdGhpcyBsb29wIHNtYWxsIGZvciBzcGVlZC4KCQkJCWJ5dGVzID0gW2RhdGEuY2hhckNvZGVBdChpbmRleCsrKSAmIDB4RkYsIGRhdGEuY2hhckNvZGVBdChpbmRleCsrKSAmIDB4RkYsIGRhdGEuY2hhckNvZGVBdChpbmRleCsrKSAmIDB4RkZdOwoJCQkJYmFzZTY0ICs9IHRvQmFzZTY0W2J5dGVzWzBdID4+IDJdICsgdG9CYXNlNjRbKChieXRlc1swXSAmIDB4MykgPDwgNCkgfCAoYnl0ZXNbMV0gPj4gNCldICsgdG9CYXNlNjRbKChieXRlc1sxXSAmIDB4RikgPDwgMikgfCAoYnl0ZXNbMl0gPj4gNildICsgdG9CYXNlNjRbYnl0ZXNbMl0gJiAweDNGXTsKCQkJfQoJCQlpZiAocmVtYWluZGVyID4gMCkgewoJCQkJLy9GaWxsIGluIHRoZSBwYWRkaW5nIGFuZCByZWNhbHVsYXRlIHRoZSB0cmFpbGluZyBzaXgtYml0IGdyb3VwLi4uCgkJCQliYXNlNjRbYmFzZTY0Lmxlbmd0aCAtIDFdID0gIj0iOwoJCQkJaWYgKHJlbWFpbmRlciA9PSAyKSB7CgkJCQkJYmFzZTY0W2Jhc2U2NC5sZW5ndGggLSAyXSA9ICI9IjsKCQkJCQliYXNlNjRbYmFzZTY0Lmxlbmd0aCAtIDNdID0gdG9CYXNlNjRbKGJ5dGVzWzBdICYgMHgzKSA8PCA0XTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWJhc2U2NFtiYXNlNjQubGVuZ3RoIC0gMl0gPSB0b0Jhc2U2NFsoYnl0ZXNbMV0gJiAweEYpIDw8IDJdOwoJCQkJfQoJCQl9CgkJfQoJfQoJcmV0dXJuIGJhc2U2NDsKfQpmdW5jdGlvbiBiYXNlNjRfZGVjb2RlKGRhdGEpIHsKCXRyeSB7CgkJdmFyIGRlY29kZTY0ID0gd2luZG93LmF0b2IoZGF0YSk7CS8vVXNlIHRoaXMgbmF0aXZlIGZ1bmN0aW9uIHdoZW4gaXQncyBhdmFpbGFibGUsIGFzIGl0J3MgYSBtYWduaXR1ZGUgZmFzdGVyIHRoYW4gdGhlIG5vbi1uYXRpdmUgY29kZSBiZWxvdy4KCX0KCWNhdGNoIChlcnJvcikgewoJCS8vRGVmYXVsdGluZyB0byBub24tbmF0aXZlIGJhc2U2NCBkZWNvZGluZy4uLgoJCXZhciBkZWNvZGU2NCA9ICIiOwoJCXZhciBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGg7CgkJaWYgKGRhdGFMZW5ndGggPiAzICYmIGRhdGFMZW5ndGggJSA0ID09IDApIHsKCQkJdmFyIHNpeGJpdHMgPSBbMCwgMCwgMCwgMF07CS8vRGVjbGFyZSB0aGlzIG91dCBvZiB0aGUgbG9vcCwgdG8gc3BlZWQgdXAgdGhlIG9wcy4KCQkJdmFyIGluZGV4ID0gMDsKCQkJd2hpbGUgKGluZGV4IDwgZGF0YUxlbmd0aCkgewoJCQkJLy9LZWVwIHRoaXMgbG9vcCBzbWFsbCBmb3Igc3BlZWQuCgkJCQlzaXhiaXRzID0gW2Zyb21CYXNlNjQuaW5kZXhPZihkYXRhLmNoYXJBdChpbmRleCsrKSksIGZyb21CYXNlNjQuaW5kZXhPZihkYXRhLmNoYXJBdChpbmRleCsrKSksIGZyb21CYXNlNjQuaW5kZXhPZihkYXRhLmNoYXJBdChpbmRleCsrKSksIGZyb21CYXNlNjQuaW5kZXhPZihkYXRhLmNoYXJBdChpbmRleCsrKSldOwoJCQkJZGVjb2RlNjQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoc2l4Yml0c1swXSA8PCAyKSB8IChzaXhiaXRzWzFdID4+IDQpKSArIFN0cmluZy5mcm9tQ2hhckNvZGUoKChzaXhiaXRzWzFdICYgMHgwRikgPDwgNCkgfCAoc2l4Yml0c1syXSA+PiAyKSkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoc2l4Yml0c1syXSAmIDB4MDMpIDw8IDYpIHwgc2l4Yml0c1szXSk7CgkJCX0KCQkJLy9DaGVjayBmb3IgdGhlICc9JyBjaGFyYWN0ZXIgYWZ0ZXIgdGhlIGxvb3AsIHNvIHdlIGRvbid0IGhvc2UgaXQgdXAuCgkJCWlmIChzaXhiaXRzWzNdID49IDB4NDApIHsKCQkJCWRlY29kZTY0Lmxlbmd0aCAtPSAxOwoJCQkJaWYgKHNpeGJpdHNbMl0gPj0gMHg0MCkgewoJCQkJCWRlY29kZTY0Lmxlbmd0aCAtPSAxOwoJCQkJfQoJCQl9CgkJfQoJfQoJcmV0dXJuIGRlY29kZTY0Owp9CmZ1bmN0aW9uIHRvX2xpdHRsZV9lbmRpYW5fZHdvcmQoc3RyKSB7CglyZXR1cm4gdG9fbGl0dGxlX2VuZGlhbl93b3JkKHN0cikgKyB0b19saXR0bGVfZW5kaWFuX3dvcmQoc3RyID4+IDE2KTsKfQpmdW5jdGlvbiB0b19saXR0bGVfZW5kaWFuX3dvcmQoc3RyKSB7CglyZXR1cm4gdG9fYnl0ZShzdHIpICsgdG9fYnl0ZShzdHIgPj4gOCk7Cn0KZnVuY3Rpb24gdG9fYnl0ZShzdHIpIHsKCXJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHN0ciAmIDB4RkYpOwp9CmZ1bmN0aW9uIGFycmF5VG9CYXNlNjQoYXJyYXlJbikgewoJdmFyIGJpblN0cmluZyA9ICIiOwoJdmFyIGxlbmd0aCA9IGFycmF5SW4ubGVuZ3RoOwoJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgKytpbmRleCkgewoJCWlmICh0eXBlb2YgYXJyYXlJbltpbmRleF0gPT0gIm51bWJlciIpIHsKCQkJYmluU3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYXJyYXlJbltpbmRleF0pOwoJCX0KCX0KCXJldHVybiBiYXNlNjQoYmluU3RyaW5nKTsKfQpmdW5jdGlvbiBiYXNlNjRUb0FycmF5KGI2NFN0cmluZykgewoJdmFyIGJpblN0cmluZyA9IGJhc2U2NF9kZWNvZGUoYjY0U3RyaW5nKTsKCXZhciBvdXRBcnJheSA9IFtdOwoJdmFyIGxlbmd0aCA9IGJpblN0cmluZy5sZW5ndGg7Cglmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOykgewoJCW91dEFycmF5LnB1c2goYmluU3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgrKykgJiAweEZGKTsKCX0KCXJldHVybiBvdXRBcnJheTsKfQ==";
const GB_controls_js ="Y29uc3QgSlNfS0VZX0FMVCA9IDE4Owpjb25zdCBKU19LRVlfQ1RSTCA9IDE3OwoKY29uc3QgREVBRFpPTkUgPSAwLjE7Cgp2YXIgZGVmYXVsdEtleXMgPSB7CiAgdXA6IFsiQXJyb3dVcCIsICJ3IiwgIlciXSwKICBkb3duOiBbIkFycm93RG93biIsICJzIiwgIlMiXSwKICBsZWZ0OiBbIkFycm93TGVmdCIsICJhIiwgIkEiXSwKICByaWdodDogWyJBcnJvd1JpZ2h0IiwgImQiLCAiRCJdLAogIGE6IFsiQWx0IiwgInoiLCAiaiIsICJaIiwgIkoiXSwKICBiOiBbIkNvbnRyb2wiLCAiayIsICJ4IiwgIksiLCAiWCJdLAogIHN0YXJ0OiBbIkVudGVyIl0sCiAgc2VsZWN0OiBbIlNoaWZ0Il0KfTsKCi8vIEJ1aWxkIGtleWJpbmRpbmdzIG9iamVjdCB1c2luZwovLyB2YWx1ZSBmcm9tIGN1c3RvbUNvbnRyb2xzIGlmIGRlZmluZWQgb3IgZGVmYXVsdEtleXMgaWYgbm90CnZhciBrZXlCaW5kaW5ncyA9IHt9Owpmb3IgKHZhciBrZXkgaW4gZGVmYXVsdEtleXMpIHsKICB2YXIga2V5cyA9IGN1c3RvbUNvbnRyb2xzW2tleV0gPyBjdXN0b21Db250cm9sc1trZXldIDogZGVmYXVsdEtleXNba2V5XTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgIGtleUJpbmRpbmdzW2tleXNbaV1dID0ga2V5OwogICAga2V5QmluZGluZ3NbU3RyaW5nKGtleXNbaV0pLnRvTG93ZXJDYXNlKCldID0ga2V5OwogICAga2V5QmluZGluZ3NbU3RyaW5nKGtleXNbaV0pLnRvVXBwZXJDYXNlKCldID0ga2V5OwogIH0KfQoKdmFyIGlzVG91Y2hFbmFibGVkID0gIm9udG91Y2hzdGFydCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OwoKdmFyIGNvbnRyb2xsZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udHJvbGxlciIpOwp2YXIgYnRuQSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250cm9sbGVyX2EiKTsKdmFyIGJ0bkIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udHJvbGxlcl9iIik7CnZhciBidG5TdGFydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb250cm9sbGVyX3N0YXJ0Iik7CnZhciBidG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udHJvbGxlcl9zZWxlY3QiKTsKdmFyIGRwYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udHJvbGxlcl9kcGFkIik7CgoKLy8gSFRNTCBHYW1lcGFkIEFQSSBzdXBwb3J0Ci8vIFBvbGwgZm9yIGdhbWVwYWQgaW5wdXQgYWJvdXQgfjQgdGltZXMgcGVyIGdhbWVib3kgZnJhbWUgKH4yNDAgdGltZXMgc2Vjb25kKQpjb25zdCBHQU1FUEFEX1BPTExJTkdfSU5URVJWQUwgPSAxMDAwIC8gNjAgLyA0Owpjb25zdCBHQU1FUEFEX0tFWU1BUF9TVEFOREFSRF9TVFIgPSAic3RhbmRhcmQiCgovLyBXaGVuIGdhbWVwYWQubWFwcGluZyByZXBvcnRzICJzdGFuZGFyZCIKY29uc3QgR0FNRVBBRF9LRVlNQVBfU1RBTkRBUkQgPSBbCiAgICAgICAgICAgIHtnYl9rZXk6ICJiIiwgICAgICBncF9idXR0b246IDAsICB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJhIiwgICAgICBncF9idXR0b246IDEsICB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJzZWxlY3QiLCBncF9idXR0b246IDgsICB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJzdGFydCIsICBncF9idXR0b246IDksICB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJ1cCIsICAgICBncF9idXR0b246IDEyLCB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJkb3duIiwgICBncF9idXR0b246IDEzLCB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJsZWZ0IiwgICBncF9idXR0b246IDE0LCB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJyaWdodCIsICBncF9idXR0b246IDE1LCB0eXBlOiAiYnV0dG9uIn0KICAgICAgICAgICAgXTsKCmNvbnN0IEdBTUVQQURfS0VZTUFQX0RFRkFVTFQgPSBbCiAgICAgICAgICAgIHtnYl9rZXk6ICJhIiwgICAgICBncF9idXR0b246IDAsIHR5cGU6ICJidXR0b24ifSwKICAgICAgICAgICAge2diX2tleTogImIiLCAgICAgIGdwX2J1dHRvbjogMSwgdHlwZTogImJ1dHRvbiJ9LAogICAgICAgICAgICB7Z2Jfa2V5OiAic2VsZWN0IiwgZ3BfYnV0dG9uOiAyLCB0eXBlOiAiYnV0dG9uIn0sCiAgICAgICAgICAgIHtnYl9rZXk6ICJzdGFydCIsICBncF9idXR0b246IDMsIHR5cGU6ICJidXR0b24ifSwKICAgICAgICAgICAge2diX2tleTogInVwIiwgICAgIGdwX2J1dHRvbjogMiwgdHlwZTogImF4aXMifSwKICAgICAgICAgICAge2diX2tleTogImRvd24iLCAgIGdwX2J1dHRvbjogMywgdHlwZTogImF4aXMifSwKICAgICAgICAgICAge2diX2tleTogImxlZnQiLCAgIGdwX2J1dHRvbjogMCwgdHlwZTogImF4aXMifSwKICAgICAgICAgICAge2diX2tleTogInJpZ2h0IiwgIGdwX2J1dHRvbjogMSwgdHlwZTogImF4aXMifQogICAgICAgICAgICBdOwoKLy8gZ2FtZXBhZCByZWxhdGVkIHZhcnMKdmFyIGdwID0gewogICAgICAgIGFwaUlEOiB1bmRlZmluZWQsCiAgICAgICAgdGltZXJJRDogdW5kZWZpbmVkLAogICAgICAgIGtleWJpbmRzOiB1bmRlZmluZWQsCiAgICAgICAgYXhlczogewogICAgICAgICAgICBsYXN0OiB1bmRlZmluZWQsCiAgICAgICAgICAgIGN1cjogW10sCiAgICAgICAgICAgIGNoYW5nZWQ6IFtdIH0sCiAgICAgICAgYnV0dG9uczogewogICAgICAgICAgICBsYXN0OiB1bmRlZmluZWQsCiAgICAgICAgICAgIGN1cjogW10sCiAgICAgICAgICAgIGNoYW5nZWQ6IFtdIH0KICAgICAgICB9OwoKCmZ1bmN0aW9uIGJpbmRCdXR0b24oZWwsIGNvZGUpIHsKICBlbC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaHN0YXJ0IiwgZnVuY3Rpb24oZSkgewogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgIGUuY3VycmVudFRhcmdldC5jbGFzc05hbWUgPSBlLmN1cnJlbnRUYXJnZXQuY2xhc3NOYW1lICsgIiBidG5QcmVzc2VkIjsKICAgIEdhbWVCb3lLZXlEb3duKGNvZGUpOwogIH0pOwoKICBlbC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaGVuZCIsIGZ1bmN0aW9uKGUpIHsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICBpbml0U291bmQoKTsKICAgIGUuY3VycmVudFRhcmdldC5jbGFzc05hbWUgPSBlLmN1cnJlbnRUYXJnZXQuY2xhc3NOYW1lLnJlcGxhY2UoCiAgICAgIC8gYnRuUHJlc3NlZC8sCiAgICAgICIiCiAgICApOwogICAgR2FtZUJveUtleVVwKGNvZGUpOwogIH0pOwp9CgpmdW5jdGlvbiBiaW5kRHBhZChlbCkgewogIGVsLmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCBmdW5jdGlvbihlKSB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgdmFyIHJlY3QgPSBlLmN1cnJlbnRUYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICB2YXIgeCA9ICgyICogKGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRYIC0gcmVjdC5sZWZ0KSkgLyByZWN0LndpZHRoIC0gMTsKICAgIHZhciB5ID0gKDIgKiAoZS50YXJnZXRUb3VjaGVzWzBdLmNsaWVudFkgLSByZWN0LnRvcCkpIC8gcmVjdC5oZWlnaHQgLSAxOwogICAgbW92ZSh4LCB5KTsKICB9KTsKCiAgZWwuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIiwgZnVuY3Rpb24oZSkgewogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgIHZhciByZWN0ID0gZS5jdXJyZW50VGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgdmFyIHggPSAoMiAqIChlLnRhcmdldFRvdWNoZXNbMF0uY2xpZW50WCAtIHJlY3QubGVmdCkpIC8gcmVjdC53aWR0aCAtIDE7CiAgICB2YXIgeSA9ICgyICogKGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRZIC0gcmVjdC50b3ApKSAvIHJlY3QuaGVpZ2h0IC0gMTsKICAgIG1vdmUoeCwgeSk7CiAgfSk7CgogIGZ1bmN0aW9uIG1vdmUoeCwgeSkgewogICAgaWYgKHggPCAtREVBRFpPTkUgfHwgeCA+IERFQURaT05FKSB7CiAgICAgIGlmICh5ID4geCAmJiB5IDwgLXgpIHsKICAgICAgICBHYW1lQm95S2V5VXAoInJpZ2h0Iik7CiAgICAgICAgR2FtZUJveUtleURvd24oImxlZnQiKTsKICAgICAgfSBlbHNlIGlmICh5ID4gLXggJiYgeSA8IHgpIHsKICAgICAgICBHYW1lQm95S2V5VXAoImxlZnQiKTsKICAgICAgICBHYW1lQm95S2V5RG93bigicmlnaHQiKTsKICAgICAgfQoKICAgICAgaWYgKHkgPiAtREVBRFpPTkUgJiYgeSA8IERFQURaT05FKSB7CiAgICAgICAgR2FtZUJveUtleVVwKCJ1cCIpOwogICAgICAgIEdhbWVCb3lLZXlVcCgiZG93biIpOwogICAgICB9CiAgICB9CgogICAgaWYgKHkgPCAtREVBRFpPTkUgfHwgeSA+IERFQURaT05FKSB7CiAgICAgIGlmICh4ID4geSAmJiB4IDwgLXkpIHsKICAgICAgICBHYW1lQm95S2V5VXAoImRvd24iKTsKICAgICAgICBHYW1lQm95S2V5RG93bigidXAiKTsKICAgICAgfSBlbHNlIGlmICh4ID4gLXkgJiYgeCA8IHkpIHsKICAgICAgICBHYW1lQm95S2V5VXAoInVwIik7CiAgICAgICAgR2FtZUJveUtleURvd24oImRvd24iKTsKICAgICAgfQoKICAgICAgaWYgKHggPiAtREVBRFpPTkUgJiYgeCA8IERFQURaT05FKSB7CiAgICAgICAgR2FtZUJveUtleVVwKCJsZWZ0Iik7CiAgICAgICAgR2FtZUJveUtleVVwKCJyaWdodCIpOwogICAgICB9CiAgICB9CiAgfQoKICBlbC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaGVuZCIsIGZ1bmN0aW9uKGUpIHsKICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICBpbml0U291bmQoKTsKICAgIEdhbWVCb3lLZXlVcCgibGVmdCIpOwogICAgR2FtZUJveUtleVVwKCJyaWdodCIpOwogICAgR2FtZUJveUtleVVwKCJ1cCIpOwogICAgR2FtZUJveUtleVVwKCJkb3duIik7CiAgfSk7Cn0KCmZ1bmN0aW9uIGJpbmRUb3VjaFJlc3RvcmUoKSB7CiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCBmdW5jdGlvbihlKSB7CiAgICBjb250cm9sbGVyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgaXNUb3VjaEVuYWJsZWQgPSB0cnVlOwogIH0pCn0KCmZ1bmN0aW9uIGJpbmRLZXlib2FyZCgpIHsKICB3aW5kb3cub25rZXlkb3duID0gZnVuY3Rpb24oZSkgewogICAgaW5pdFNvdW5kKCk7CiAgICBpZiAoaXNUb3VjaEVuYWJsZWQpIHsKICAgICAgY29udHJvbGxlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBpc1RvdWNoRW5hYmxlZCA9IGZhbHNlOwogICAgfQogICAgaWYgKAogICAgICBlLmtleUNvZGUgIT09IEpTX0tFWV9DVFJMICYmCiAgICAgIGUua2V5Q29kZSAhPT0gSlNfS0VZX0FMVCAmJgogICAgICAoZS5hbHRLZXkgfHwgZS5jdHJsS2V5IHx8IGUubWV0YUtleSkKICAgICkgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoa2V5QmluZGluZ3NbZS5rZXldKSB7CiAgICAgIEdhbWVCb3lLZXlEb3duKGtleUJpbmRpbmdzW2Uua2V5XSk7CiAgICB9CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgfTsKCiAgd2luZG93Lm9ua2V5dXAgPSBmdW5jdGlvbihlKSB7CiAgICBpZiAoZS5rZXkgPT09ICJEZWFkIikgewogICAgICAvLyBJcGFkIGtleWJvYXJkIGZpeCA6LS8KICAgICAgLy8gRG9lc24ndCByZWdpc3RlciB3aGljaCBrZXkgd2FzIHJlbGVhc2VkLCBzbyByZWxlYXNlIGFsbCBvZiB0aGVtCiAgICAgIFsicmlnaHQiLCAibGVmdCIsICJ1cCIsICJkb3duIiwgImEiLCAiYiIsICJzZWxlY3QiLCAic3RhcnQiXS5mb3JFYWNoKAogICAgICAgIGtleSA9PiB7CiAgICAgICAgICBHYW1lQm95S2V5VXAoa2V5KTsKICAgICAgICB9CiAgICAgICk7CiAgICB9CiAgICBpZiAoa2V5QmluZGluZ3NbZS5rZXldKSB7CiAgICAgIEdhbWVCb3lLZXlVcChrZXlCaW5kaW5nc1tlLmtleV0pOwogICAgfQogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogIH07Cn0KCmZ1bmN0aW9uIGJpbmRDbGljaygpIHsKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbihlKSB7CiAgICBpbml0U291bmQoKTsKICB9KQp9CgppZiAoaXNUb3VjaEVuYWJsZWQpIHsKICBjb250cm9sbGVyLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogIGJpbmRCdXR0b24oYnRuQSwgImEiKTsKICBiaW5kQnV0dG9uKGJ0bkIsICJiIik7CiAgYmluZEJ1dHRvbihidG5TdGFydCwgInN0YXJ0Iik7CiAgYmluZEJ1dHRvbihidG5TZWxlY3QsICJzZWxlY3QiKTsKICBiaW5kRHBhZChkcGFkKTsKICBiaW5kVG91Y2hSZXN0b3JlKCk7Cn0gZWxzZSB7CiAgY29udHJvbGxlci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwp9CmJpbmRLZXlib2FyZCgpOwpiaW5kQ2xpY2soKTsKCmZ1bmN0aW9uIHJlc2V0S2V5cygpIHsKICBmb3IgKHZhciBrZXkgaW4gZGVmYXVsdEtleXMpIHsKICAgIEdhbWVCb3lLZXlVcChrZXkpOwogIH0KfQoKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImZvY3VzIiwgcmVzZXRLZXlzKTsKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImJsdXIiLCByZXNldEtleXMpOwoKLy8gSFRNTCBHYW1lcGFkIEFQSSBTdXBwb3J0CgovLyBMb2FkIGEga2V5IG1hcCBmb3IgZ2FtZXBhZC10by1nYW1lYm95IGJ1dHRvbnMKZnVuY3Rpb24gZ2FtZXBhZEJpbmRLZXlzKHN0ck1hcHBpbmcpIHsKCiAgICAvLyBUcnkgdG8gdXNlIHRoZSB3M2MgInN0YW5kYXJkIiBnYW1lcGFkIG1hcHBpbmcgaWYgYXZhaWxhYmxlCiAgICAvLyAoQ2hyb21lL1Y4IHNlZW1zIHRvIGRvIHRoYXQgYmV0dGVyIHRoYW4gRmlyZWZveCkKICAgIC8vCiAgICAvLyBPdGhlcndpc2UgdXNlIGEgZGVmYXVsdCBtYXBwaW5nIHRoYXQgYXNzaWducwogICAgLy8gQS9CL1NlbGVjdC9TdGFydCB0byB0aGUgZmlyc3QgZm91ciBidXR0b25zLAogICAgLy8gYW5kIFUvRC9ML1IgdG8gdGhlIGZpcnN0IHR3byBheGVzLgoKICAgIGlmIChzdHJNYXBwaW5nID09PSBHQU1FUEFEX0tFWU1BUF9TVEFOREFSRF9TVFIpCiAgICAgICAgZ3Aua2V5YmluZHMgPSBHQU1FUEFEX0tFWU1BUF9TVEFOREFSRDsKICAgIGVsc2UKICAgICAgICBncC5rZXliaW5kcyA9IEdBTUVQQURfS0VZTUFQX0RFRkFVTFQ7Cn0KCgpmdW5jdGlvbiBnYW1lcGFkQ2FjaGVWYWx1ZXMoZ2FtZXBhZCkgewoKICAgIC8vIFJlYWQgQnV0dG9ucwogICAgZm9yKGxldCBrPTA7IGs8Z2FtZXBhZC5idXR0b25zLmxlbmd0aDsgaysrKSB7CiAgICAgICAgLy8gLnZhbHVlIGlzIGZvciBhbmFsb2csIC5wcmVzc2VkIGlzIGZvciBib29sZWFuIGJ1dHRvbnMKICAgICAgICBncC5idXR0b25zLmN1cltrXSA9IChnYW1lcGFkLmJ1dHRvbnNba10udmFsdWUgPiAwIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZXBhZC5idXR0b25zW2tdLnByZXNzZWQgPT0gdHJ1ZSk7CgogICAgICAgIC8vIFVwZGF0ZSBzdGF0ZSBjaGFuZ2VkIGlmIG5vdCBvbiBmaXJzdCBpbnB1dCBwYXNzCiAgICAgICAgaWYgKGdwLmJ1dHRvbnMubGFzdCAhPT0gdW5kZWZpbmVkKQogICAgICAgICAgICBncC5idXR0b25zLmNoYW5nZWRba10gPSAoZ3AuYnV0dG9ucy5jdXJba10gIT0gZ3AuYnV0dG9ucy5sYXN0W2tdKTsKICAgIH0KCiAgICAvLyBSZWFkIEF4ZXMKICAgIGZvcihsZXQgaz0wOyBrPGdhbWVwYWQuYXhlcy5sZW5ndGg7IGsrKykgewogICAgICAgIC8vIERlY29kZSBlYWNoIGRwYWQgYXhpcyBpbnRvIHR3byBidXR0b25zLCBvbmUgZm9yIGVhY2ggZGlyZWN0aW9uCiAgICAgICAgZ3AuYXhlcy5jdXJbKGsqMikgIF0gPSAoZ2FtZXBhZC5heGVzW2tdIDwgMCk7CiAgICAgICAgZ3AuYXhlcy5jdXJbKGsqMikrMV0gPSAoZ2FtZXBhZC5heGVzW2tdID4gMCk7CgogICAgICAgIC8vIFVwZGF0ZSBzdGF0ZSBjaGFuZ2VkIGlmIG5vdCBvbiBmaXJzdCBpbnB1dCBwYXNzCiAgICAgICAgaWYgKGdwLmF4ZXMubGFzdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGdwLmF4ZXMuY2hhbmdlZFsoayoyKSAgXSA9IChncC5heGVzLmN1clsoayoyKSAgXSAhPSBncC5heGVzLmxhc3RbKGsqMikgIF0pOwogICAgICAgICAgICBncC5heGVzLmNoYW5nZWRbKGsqMikrMV0gPSAoZ3AuYXhlcy5jdXJbKGsqMikrMV0gIT0gZ3AuYXhlcy5sYXN0WyhrKjIpKzFdKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gU2F2ZSBjdXJyZW50IHN0YXRlIGZvciBjb21wYXJpc29uIG9uIG5leHQgaW5wdXQKICAgIGdwLmF4ZXMubGFzdCA9IGdwLmF4ZXMuY3VyLnNsaWNlKDApOwogICAgZ3AuYnV0dG9ucy5sYXN0ID0gZ3AuYnV0dG9ucy5jdXIuc2xpY2UoMCk7Cn0KCgpmdW5jdGlvbiBnYW1lcGFkSGFuZGxlQnV0dG9uKGtleUJpbmQpIHsKCiAgICB2YXIgYnV0dG9uQ2FjaGU7CgogICAgLy8gU2VsZWN0IGJ1dHRvbiAvIGF4aXMgY2FjaGUgYmFzZWQgb24ga2V5IGJpbmQgdHlwZQogICAgaWYgKGtleUJpbmQudHlwZSA9PT0gImJ1dHRvbiIpCiAgICAgICAgYnV0dG9uQ2FjaGUgPSBncC5idXR0b25zOwogICAgZWxzZSBpZiAoa2V5QmluZC50eXBlID09PSAiYXhpcyIpCiAgICAgICAgYnV0dG9uQ2FjaGUgPSBncC5heGVzOwoKICAgIC8vIE1ha2Ugc3VyZSB0aGUgYnV0dG9uIGV4aXN0cyBpbiB0aGUgY2FjaGUgYXJyYXkKICAgIGlmIChrZXlCaW5kLmdwX2J1dHRvbiA8IGJ1dHRvbkNhY2hlLmNoYW5nZWQubGVuZ3RoKSB7CgogICAgICAgIC8vIFNlbmQgdGhlIGJ1dHRvbiBzdGF0ZSBpZiBpdCdzIGNoYW5nZWQKICAgICAgICBpZiAoYnV0dG9uQ2FjaGUuY2hhbmdlZFtrZXlCaW5kLmdwX2J1dHRvbl0pCiAgICAgICAgICAgIGlmIChidXR0b25DYWNoZS5jdXJba2V5QmluZC5ncF9idXR0b25dKQogICAgICAgICAgICAgICAgR2FtZUJveUtleURvd24oa2V5QmluZC5nYl9rZXkpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBHYW1lQm95S2V5VXAoa2V5QmluZC5nYl9rZXkpOwogICAgfQp9CgoKZnVuY3Rpb24gZ2FtZXBhZEdldEN1cnJlbnQoKSB7CgogICAgLy8gQ2hyb21lIHJlcXVpcmVzIHJldHJpZXZpbmcgYSBuZXcgZ2FtZXBhZCBvYmplY3QKICAgIC8vIGV2ZXJ5IHRpbWUgYnV0dG9uIHN0YXRlIGlzIHF1ZXJpZWQgKHRoZSBleGlzdGluZyBvYmplY3QKICAgIC8vIHdpbGwgaGF2ZSBzdGFsZSBidXR0b24gc3RhdGUpLiBKdXN0IGRvIHRoYXQgZm9yIGFsbCBicm93c2VycwogICAgdmFyIGdhbWVwYWQgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKVtncC5hcGlJRF07CgogICAgaWYgKGdhbWVwYWQpCiAgICAgICAgaWYgKGdhbWVwYWQuY29ubmVjdGVkKQogICAgICAgICAgICByZXR1cm4gZ2FtZXBhZDsKCiAgICByZXR1cm4gdW5kZWZpbmVkOwp9CgoKZnVuY3Rpb24gZ2FtZXBhZFVwZGF0ZSgpIHsKCiAgICB2YXIgZ2FtZXBhZCA9IGdhbWVwYWRHZXRDdXJyZW50KCk7CgogICAgaWYgKGdhbWVwYWQgIT09IHVuZGVmaW5lZCkgewoKICAgICAgICAvLyBDYWNoZSBnYW1lcGFkIGlucHV0IHZhbHVlcwogICAgICAgIGdhbWVwYWRDYWNoZVZhbHVlcyhnYW1lcGFkKTsKCiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIGJ1dHRvbnMgYW5kIHNlbmQgY2hhbmdlcyBpZiBuZWVkZWQKICAgICAgICBmb3IgKGxldCBpPTA7IGk8Z3Aua2V5YmluZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGdhbWVwYWRIYW5kbGVCdXR0b24oZ3Aua2V5YmluZHNbaV0pOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgLy8gR2FtZXBhZCBpcyBubyBsb25nZXIgcHJlc2VudCwgZGlzY29ubmVjdAogICAgICAgIGdhbWVwYWRTdG9wKCk7CiAgICB9Cn0KCgpmdW5jdGlvbiBnYW1lcGFkU3RhcnQoZ2FtZXBhZCkgewoKICAgIC8vIE1ha2Ugc3VyZSBpdCBoYXMgZW5vdWdoIGJ1dHRvbnMgYW5kIGF4ZXMKICAgIGlmICgoZ2FtZXBhZC5tYXBwaW5nID09PSBHQU1FUEFEX0tFWU1BUF9TVEFOREFSRF9TVFIpIHx8CiAgICAgICAgKChnYW1lcGFkLmF4ZXMubGVuZ3RoID49IDIpICYmIChnYW1lcGFkLmJ1dHRvbnMubGVuZ3RoID49IDQpKSkgewoKICAgICAgICAvLyBTYXZlIEFQSSBpbmRleCBmb3IgcG9sbGluZyAocmVxdWlyZWQgYnkgQ2hyb21lL1Y4KQogICAgICAgIGdwLmFwaUlEICAgPSBnYW1lcGFkLmluZGV4OwoKICAgICAgICAvLyBBc3NpZ24gZ2FtZWJveSBrZXlzIHRvIHRoZSBnYW1lcGFkCiAgICAgICAgZ2FtZXBhZEJpbmRLZXlzKGdhbWVwYWQubWFwcGluZyk7CgogICAgICAgIC8vIFN0YXJ0IHBvbGxpbmcgdGhlIGdhbWVwYWQgZm9yIGlucHV0CiAgICAgICAgZ3AudGltZXJJRCA9IHNldEludGVydmFsKCAoKSA9PiBnYW1lcGFkVXBkYXRlKCksIEdBTUVQQURfUE9MTElOR19JTlRFUlZBTCk7CiAgICB9Cn0KCgpmdW5jdGlvbiBnYW1lcGFkU3RvcCgpIHsKCiAgICAvLyBTdG9wIHBvbGxpbmcgdGhlIGdhbWVwYWQgZm9yIGlucHV0CiAgICBpZiAoZ3AudGltZXJJRCAhPT0gdW5kZWZpbmVkKQogICAgICAgIGNsZWFySW50ZXJ2YWwoZ3AudGltZXJJRCk7CgogICAgLy8gQ2xlYXIgcHJldmlvdXMgYnV0dG9uIGhpc3RvcnkgYW5kIGNvbnRyb2xsZXIgaW5mbwogICAgZ3AuYXhlcy5sYXN0ID0gdW5kZWZpbmVkOwogICAgZ3AuYnV0dG9ucy5sYXN0ID0gdW5kZWZpbmVkOwogICAgZ3Aua2V5YmluZHMgPSB1bmRlZmluZWQ7CgogICAgZ3AuYXBpSUQgPSB1bmRlZmluZWQ7Cn0KCgpmdW5jdGlvbiBpbml0R2FtZVBhZCgpCnsKICAgIC8vIFdoZW4gYSBnYW1lcGFkIGNvbm5lY3RzLCBzdGFydCBwb2xsaW5nIGl0IGZvciBpbnB1dAogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImdhbWVwYWRjb25uZWN0ZWQiLCAoZXZlbnQpID0+IHsKICAgICAgICBpbml0U291bmQoKTsKICAgICAgICBnYW1lcGFkU3RhcnQoIG5hdmlnYXRvci5nZXRHYW1lcGFkcygpW2V2ZW50LmdhbWVwYWQuaW5kZXhdICk7CiAgICB9KTsKCiAgICAvLyBXaGVuIGEgZ2FtZXBhZCBkaXNjb25uZWN0cywgc2h1dCBkb3duIHBvbGxpbmcgZm9yIGlucHV0CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiZ2FtZXBhZGRpc2Nvbm5lY3RlZCIsIChldmVudCkgPT4gewogICAgICAgIGdhbWVwYWRTdG9wKCk7CiAgICB9KTsKfQoKCmluaXRHYW1lUGFkKCk7CgoKCgo=";
const GB_GameBoyCore_js = "InVzZSBzdHJpY3QiOwogLyoKICBKYXZhU2NyaXB0IEdhbWVCb3kgQ29sb3IgRW11bGF0b3IKICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxNiBHcmFudCBHYWxpdHoKCiAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6CgogIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgoKICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiovCmZ1bmN0aW9uIEdhbWVCb3lDb3JlKGNhbnZhcywgUk9NSW1hZ2UpIHsKCS8vUGFyYW1zLCBldGMuLi4KCXRoaXMuY2FudmFzID0gY2FudmFzOwkJCQkJCS8vQ2FudmFzIERPTSBvYmplY3QgZm9yIGRyYXdpbmcgb3V0IHRoZSBncmFwaGljcyB0by4KCXRoaXMuZHJhd0NvbnRleHQgPSBudWxsOwkJCQkJLy8gTENEIENvbnRleHQKCXRoaXMuUk9NSW1hZ2UgPSBST01JbWFnZTsJCQkJCS8vVGhlIGdhbWUncyBST00uCgkvL0NQVSBSZWdpc3RlcnMgYW5kIEZsYWdzOgoJdGhpcy5yZWdpc3RlckEgPSAweDAxOyAJCQkJCQkvL1JlZ2lzdGVyIEEgKEFjY3VtdWxhdG9yKQoJdGhpcy5GWmVybyA9IHRydWU7IAkJCQkJCQkvL1JlZ2lzdGVyIEYgIC0gUmVzdWx0IHdhcyB6ZXJvCgl0aGlzLkZTdWJ0cmFjdCA9IGZhbHNlOwkJCQkJCS8vUmVnaXN0ZXIgRiAgLSBTdWJ0cmFjdGlvbiB3YXMgZXhlY3V0ZWQKCXRoaXMuRkhhbGZDYXJyeSA9IHRydWU7CQkJCQkJLy9SZWdpc3RlciBGICAtIEhhbGYgY2Fycnkgb3IgaGFsZiBib3Jyb3cKCXRoaXMuRkNhcnJ5ID0gdHJ1ZTsJCQkJCQkJLy9SZWdpc3RlciBGICAtIENhcnJ5IG9yIGJvcnJvdwoJdGhpcy5yZWdpc3RlckIgPSAweDAwOwkJCQkJCS8vUmVnaXN0ZXIgQgoJdGhpcy5yZWdpc3RlckMgPSAweDEzOwkJCQkJCS8vUmVnaXN0ZXIgQwoJdGhpcy5yZWdpc3RlckQgPSAweDAwOwkJCQkJCS8vUmVnaXN0ZXIgRAoJdGhpcy5yZWdpc3RlckUgPSAweEQ4OwkJCQkJCS8vUmVnaXN0ZXIgRQoJdGhpcy5yZWdpc3RlcnNITCA9IDB4MDE0RDsJCQkJCS8vUmVnaXN0ZXJzIEggYW5kIEwgY29tYmluZWQKCXRoaXMuc3RhY2tQb2ludGVyID0gMHhGRkZFOwkJCQkJLy9TdGFjayBQb2ludGVyCgl0aGlzLnByb2dyYW1Db3VudGVyID0gMHgwMTAwOwkJCQkvL1Byb2dyYW0gQ291bnRlcgoJLy9Tb21lIENQVSBFbXVsYXRpb24gU3RhdGUgVmFyaWFibGVzOgoJdGhpcy5DUFVDeWNsZXNUb3RhbCA9IDA7CQkJCQkvL1JlbGF0aXZlIENQVSBjbG9ja2luZyB0byBzcGVlZCBzZXQsIHJvdW5kZWQgYXBwcm9wcmlhdGVseS4KCXRoaXMuQ1BVQ3ljbGVzVG90YWxCYXNlID0gMDsJCQkJLy9SZWxhdGl2ZSBDUFUgY2xvY2tpbmcgdG8gc3BlZWQgc2V0IGJhc2UuCgl0aGlzLkNQVUN5Y2xlc1RvdGFsQ3VycmVudCA9IDA7CQkJCS8vUmVsYXRpdmUgQ1BVIGNsb2NraW5nIHRvIHNwZWVkIHNldCwgdGhlIGRpcmVjdGx5IHVzZWQgdmFsdWUuCgl0aGlzLkNQVUN5Y2xlc1RvdGFsUm91bmRvZmYgPSAwOwkJCS8vQ2xvY2tpbmcgcGVyIGl0ZXJhdGlvbiByb3VuZGluZyBjYXRjaC4KCXRoaXMuYmFzZUNQVUN5Y2xlc1Blckl0ZXJhdGlvbgk9IDA7CQkvL0NQVSBjbG9ja3MgcGVyIGl0ZXJhdGlvbiBhdCAxeCBzcGVlZC4KCXRoaXMucmVtYWluaW5nQ2xvY2tzID0gMDsJCQkJCS8vSEFMVCBjbG9ja2luZyBvdmVycnVuIGNhcnJ5IG92ZXIuCgl0aGlzLmluQm9vdHN0cmFwID0gdHJ1ZTsJCQkJCS8vV2hldGhlciB3ZSdyZSBpbiB0aGUgR0JDIGJvb3QgUk9NLgoJdGhpcy51c2VkQm9vdFJPTSA9IGZhbHNlOwkJCQkJLy9VcGRhdGVkIHVwb24gUk9NIGxvYWRpbmcuLi4KCXRoaXMudXNlZEdCQ0Jvb3RST00gPSBmYWxzZTsJCQkJLy9EaWQgd2UgYm9vdCB0byB0aGUgR0JDIGJvb3QgUk9NPwoJdGhpcy5oYWx0ID0gZmFsc2U7CQkJCQkJCS8vSGFzIHRoZSBDUFUgYmVlbiBzdXNwZW5kZWQgdW50aWwgdGhlIG5leHQgaW50ZXJydXB0PwoJdGhpcy5za2lwUENJbmNyZW1lbnQgPSBmYWxzZTsJCQkJLy9EaWQgd2UgdHJpcCB0aGUgRE1HIEhhbHQgYnVnPwoJdGhpcy5zdG9wRW11bGF0b3IgPSAzOwkJCQkJCS8vSGFzIHRoZSBlbXVsYXRpb24gYmVlbiBwYXVzZWQgb3IgYSBmcmFtZSBoYXMgZW5kZWQ/Cgl0aGlzLklNRSA9IHRydWU7CQkJCQkJCS8vQXJlIGludGVycnVwdHMgZW5hYmxlZD8KCXRoaXMuSVJRTGluZU1hdGNoZWQgPSAwOwkJCQkJLy9DUFUgSVJRIGFzc2VydGlvbi4KCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCA9IDA7CQkJCS8vSUYgUmVnaXN0ZXIKCXRoaXMuaW50ZXJydXB0c0VuYWJsZWQgPSAwOwkJCQkJLy9JRSBSZWdpc3RlcgoJdGhpcy5oZG1hUnVubmluZyA9IGZhbHNlOwkJCQkJLy9IRE1BIFRyYW5zZmVyIEZsYWcgLSBHQkMgb25seQoJdGhpcy5DUFVUaWNrcyA9IDA7CQkJCQkJCS8vVGhlIG51bWJlciBvZiBjbG9jayBjeWNsZXMgZW11bGF0ZWQuCgl0aGlzLmRvdWJsZVNwZWVkU2hpZnRlciA9IDA7CQkJCS8vR0JDIGRvdWJsZSBzcGVlZCBjbG9ja2luZyBzaGlmdGVyLgoJdGhpcy5Kb3lQYWQgPSAweEZGOwkJCQkJCQkvL0pveXBhZCBTdGF0ZSAodHdvIGZvdXItYml0IHN0YXRlcyBhY3R1YWxseSkKCXRoaXMuQ1BVU3RvcHBlZCA9IGZhbHNlOwkJCQkJLy9DUFUgU1RPUCBzdGF0dXMuCgkvL01haW4gUkFNLCBNQkMgUkFNLCBHQkMgTWFpbiBSQU0sIFZSQU0sIGV0Yy4KCXRoaXMubWVtb3J5UmVhZGVyID0gW107CQkJCQkJLy9BcnJheSBvZiBmdW5jdGlvbnMgbWFwcGVkIHRvIHJlYWQgYmFjayBtZW1vcnkKCXRoaXMubWVtb3J5V3JpdGVyID0gW107CQkJCQkJLy9BcnJheSBvZiBmdW5jdGlvbnMgbWFwcGVkIHRvIHdyaXRlIHRvIG1lbW9yeQoJdGhpcy5tZW1vcnlIaWdoUmVhZGVyID0gW107CQkJCQkvL0FycmF5IG9mIGZ1bmN0aW9ucyBtYXBwZWQgdG8gcmVhZCBiYWNrIDB4RkZYWCBtZW1vcnkKCXRoaXMubWVtb3J5SGlnaFdyaXRlciA9IFtdOwkJCQkJLy9BcnJheSBvZiBmdW5jdGlvbnMgbWFwcGVkIHRvIHdyaXRlIHRvIDB4RkZYWCBtZW1vcnkKCXRoaXMuUk9NID0gW107CQkJCQkJCQkvL1RoZSBmdWxsIFJPTSBmaWxlIGR1bXBlZCB0byBhbiBhcnJheS4KCXRoaXMubWVtb3J5ID0gW107CQkJCQkJCS8vTWFpbiBDb3JlIE1lbW9yeQoJdGhpcy5NQkNSYW0gPSBbXTsJCQkJCQkJLy9Td2l0Y2hhYmxlIFJBTSAoVXNlZCBieSBnYW1lcyBmb3IgbW9yZSBSQU0pIGZvciB0aGUgbWFpbiBtZW1vcnkgcmFuZ2UgMHhBMDAwIC0gMHhDMDAwLgoJdGhpcy5WUkFNID0gW107CQkJCQkJCQkvL0V4dHJhIFZSQU0gYmFuayBmb3IgR0JDLgoJdGhpcy5HQkNNZW1vcnkgPSBbXTsJCQkJCQkvL0dCQyBtYWluIFJBTSBCYW5rcwoJdGhpcy5NQkMxTW9kZSA9IGZhbHNlOwkJCQkJCS8vTUJDMSBUeXBlICg0LzMyLCAxNi84KQoJdGhpcy5NQkNSQU1CYW5rc0VuYWJsZWQgPSBmYWxzZTsJCQkvL01CQyBSQU0gQWNjZXNzIENvbnRyb2wuCgl0aGlzLmN1cnJNQkNSQU1CYW5rID0gMDsJCQkJCS8vTUJDIEN1cnJlbnRseSBJbmRleGVkIFJBTSBCYW5rCgl0aGlzLmN1cnJNQkNSQU1CYW5rUG9zaXRpb24gPSAtMHhBMDAwOwkJLy9NQkMgUG9zaXRpb24gQWRkZXI7Cgl0aGlzLmNHQkMgPSBmYWxzZTsJCQkJCQkJLy9HYW1lQm95IENvbG9yIGRldGVjdGlvbi4KCXRoaXMuZ2JjUmFtQmFuayA9IDE7CQkJCQkJLy9DdXJyZW50bHkgU3dpdGNoZWQgR2FtZUJveSBDb2xvciByYW0gYmFuawoJdGhpcy5nYmNSYW1CYW5rUG9zaXRpb24gPSAtMHhEMDAwOwkJCS8vR0JDIFJBTSBvZmZzZXQgZnJvbSBhZGRyZXNzIHN0YXJ0LgoJdGhpcy5nYmNSYW1CYW5rUG9zaXRpb25FQ0hPID0gLTB4RjAwMDsJCS8vR0JDIFJBTSAoRUNITyBtaXJyb3JpbmcpIG9mZnNldCBmcm9tIGFkZHJlc3Mgc3RhcnQuCgl0aGlzLlJBTUJhbmtzID0gWzAsIDEsIDIsIDQsIDE2XTsJCQkvL1VzZWQgdG8gbWFwIHRoZSBSQU0gYmFua3MgdG8gbWF4aW11bSBzaXplIHRoZSBNQkMgdXNlZCBjYW4gZG8uCgl0aGlzLlJPTUJhbmsxb2ZmcyA9IDA7CQkJCQkJLy9PZmZzZXQgb2YgdGhlIFJPTSBiYW5rIHN3aXRjaGluZy4KCXRoaXMuY3VycmVudFJPTUJhbmsgPSAwOwkJCQkJLy9UaGUgcGFyc2VkIGN1cnJlbnQgUk9NIGJhbmsgc2VsZWN0aW9uLgoJdGhpcy5jYXJ0cmlkZ2VUeXBlID0gMDsJCQkJCQkvL0NhcnRyaWRnZSBUeXBlCgl0aGlzLm5hbWUgPSAiIjsJCQkJCQkJCS8vTmFtZSBvZiB0aGUgZ2FtZQoJdGhpcy5nYW1lQ29kZSA9ICIiOwkJCQkJCQkvL0dhbWUgY29kZSAoU3VmZml4IGZvciBvbGRlciBnYW1lcykKCXRoaXMuZnJvbVNhdmVTdGF0ZSA9IGZhbHNlOwkJCQkJLy9BIGJvb2xlYW4gdG8gc2VlIGlmIHRoaXMgd2FzIGxvYWRlZCBpbiBhcyBhIHNhdmUgc3RhdGUuCgl0aGlzLnNhdmVkU3RhdGVGaWxlTmFtZSA9ICIiOwkJCQkvL1doZW4gbG9hZGVkIGluIGFzIGEgc2F2ZSBzdGF0ZSwgdGhpcyB3aWxsIG5vdCBiZSBlbXB0eS4KCXRoaXMuU1RBVFRyYWNrZXIgPSAwOwkJCQkJCS8vVHJhY2tlciBmb3IgU1RBVCB0cmlnZ2VyaW5nLgoJdGhpcy5tb2RlU1RBVCA9IDA7CQkJCQkJCS8vVGhlIHNjYW4gbGluZSBtb2RlIChmb3IgbGluZXMgMS0xNDQgaXQncyAyLTMtMCwgZm9yIDE0NS0xNTQgaXQncyAxKQoJdGhpcy5zcHJpdGVDb3VudCA9IDI1MjsJCQkJCQkvL01vZGUgMyBleHRyYSBjbG9ja2luZyBjb3VudGVyIChEZXBlbmRzIG9uIGhvdyBtYW55IHNwcml0ZXMgYXJlIG9uIHRoZSBjdXJyZW50IGxpbmUuKS4KCXRoaXMuTFlDTWF0Y2hUcmlnZ2VyU1RBVCA9IGZhbHNlOwkJCS8vU2hvdWxkIHdlIHRyaWdnZXIgYW4gaW50ZXJydXB0IGlmIExZPT1MWUM/Cgl0aGlzLm1vZGUyVHJpZ2dlclNUQVQgPSBmYWxzZTsJCQkJLy9TaG91bGQgd2UgdHJpZ2dlciBhbiBpbnRlcnJ1cHQgaWYgaW4gbW9kZSAyPwoJdGhpcy5tb2RlMVRyaWdnZXJTVEFUID0gZmFsc2U7CQkJCS8vU2hvdWxkIHdlIHRyaWdnZXIgYW4gaW50ZXJydXB0IGlmIGluIG1vZGUgMT8KCXRoaXMubW9kZTBUcmlnZ2VyU1RBVCA9IGZhbHNlOwkJCQkvL1Nob3VsZCB3ZSB0cmlnZ2VyIGFuIGludGVycnVwdCBpZiBpbiBtb2RlIDA/Cgl0aGlzLkxDRGlzT24gPSBmYWxzZTsJCQkJCQkvL0lzIHRoZSBlbXVsYXRlZCBMQ0QgY29udHJvbGxlciBvbj8KCXRoaXMuTElORUNPTlRST0wgPSBbXTsJCQkJCQkvL0FycmF5IG9mIGZ1bmN0aW9ucyB0byBoYW5kbGUgZWFjaCBzY2FuIGxpbmUgd2UgZG8gKG9uc2NyZWVuICsgb2Zmc2NyZWVuKQoJdGhpcy5ESVNQTEFZT0ZGQ09OVFJPTCA9IFtmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9BcnJheSBvZiBsaW5lIDAgZnVuY3Rpb24gdG8gaGFuZGxlIHRoZSBMQ0QgY29udHJvbGxlciB3aGVuIGl0J3Mgb2ZmIChEbyBub3RoaW5nISkuCgl9XTsKCXRoaXMuTENEQ09OVFJPTCA9IG51bGw7CQkJCQkJLy9Qb2ludGVyIHRvIGVpdGhlciBMSU5FQ09OVFJPTCBvciBESVNQTEFZT0ZGQ09OVFJPTC4KCXRoaXMuaW5pdGlhbGl6ZUxDRENvbnRyb2xsZXIoKTsJCQkJLy9Db21waWxlIHRoZSBMQ0QgY29udHJvbGxlciBmdW5jdGlvbnMuCgkvL1JUQyAoUmVhbCBUaW1lIENsb2NrIGZvciBNQkMzKToKCXRoaXMuUlRDaXNMYXRjaGVkID0gZmFsc2U7Cgl0aGlzLmxhdGNoZWRTZWNvbmRzID0gMDsJCQkJCS8vUlRDIGxhdGNoZWQgc2Vjb25kcy4KCXRoaXMubGF0Y2hlZE1pbnV0ZXMgPSAwOwkJCQkJLy9SVEMgbGF0Y2hlZCBtaW51dGVzLgoJdGhpcy5sYXRjaGVkSG91cnMgPSAwOwkJCQkJCS8vUlRDIGxhdGNoZWQgaG91cnMuCgl0aGlzLmxhdGNoZWRMRGF5cyA9IDA7CQkJCQkJLy9SVEMgbGF0Y2hlZCBsb3dlciA4LWJpdHMgb2YgdGhlIGRheSBjb3VudGVyLgoJdGhpcy5sYXRjaGVkSERheXMgPSAwOwkJCQkJCS8vUlRDIGxhdGNoZWQgaGlnaC1iaXQgb2YgdGhlIGRheSBjb3VudGVyLgoJdGhpcy5SVENTZWNvbmRzID0gMDsJCQkJCQkvL1JUQyBzZWNvbmRzIGNvdW50ZXIuCgl0aGlzLlJUQ01pbnV0ZXMgPSAwOwkJCQkJCS8vUlRDIG1pbnV0ZXMgY291bnRlci4KCXRoaXMuUlRDSG91cnMgPSAwOwkJCQkJCQkvL1JUQyBob3VycyBjb3VudGVyLgoJdGhpcy5SVENEYXlzID0gMDsJCQkJCQkJLy9SVEMgZGF5cyBjb3VudGVyLgoJdGhpcy5SVENEYXlPdmVyRmxvdyA9IGZhbHNlOwkJCQkvL0RpZCB0aGUgUlRDIG92ZXJmbG93IGFuZCB3cmFwIHRoZSBkYXkgY291bnRlcj8KCXRoaXMuUlRDSEFMVCA9IGZhbHNlOwkJCQkJCS8vSXMgdGhlIFJUQyBhbGxvd2VkIHRvIGNsb2NrIHVwPwoJLy9HeXJvOgoJdGhpcy5oaWdoWCA9IDEyNzsKCXRoaXMubG93WCA9IDEyNzsKCXRoaXMuaGlnaFkgPSAxMjc7Cgl0aGlzLmxvd1kgPSAxMjc7CgkvL1NvdW5kIHZhcmlhYmxlczoKCXRoaXMuYXVkaW9IYW5kbGUgPSBudWxsOwkJCQkJCS8vWEF1ZGlvSlMgaGFuZGxlCgl0aGlzLm51bVNhbXBsZXNUb3RhbCA9IDA7CQkJCQkJLy9MZW5ndGggb2YgdGhlIHNvdW5kIGJ1ZmZlcnMuCgl0aGlzLmR1dHlMb29rdXAgPSBbCQkJCQkJCQkvL01hcCB0aGUgZHV0eSB2YWx1ZXMgZ2l2ZW4gdG8gb25lcyB3ZSBjYW4gd29yayB3aXRoLgoJCVtmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgdHJ1ZV0sCgkJW3RydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIHRydWVdLAoJCVt0cnVlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZV0sCgkJW2ZhbHNlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCBmYWxzZV0KCV07Cgl0aGlzLmJ1ZmZlckNvbnRhaW5BbW91bnQgPSAwOwkJCQkJLy9CdWZmZXIgbWFpbnRlbmFuY2UgbWV0cmljLgoJdGhpcy5MU0ZSMTVUYWJsZSA9IG51bGw7Cgl0aGlzLkxTRlI3VGFibGUgPSBudWxsOwoJdGhpcy5ub2lzZVNhbXBsZVRhYmxlID0gbnVsbDsKCXRoaXMuaW5pdGlhbGl6ZUF1ZGlvU3RhcnRTdGF0ZSgpOwoJdGhpcy5zb3VuZE1hc3RlckVuYWJsZWQgPSBmYWxzZTsJCQkvL0FzIGl0cyBuYW1lIGltcGxpZXMKCXRoaXMuY2hhbm5lbDNQQ00gPSBudWxsOwkJCQkJLy9DaGFubmVsIDMgYWRqdXN0ZWQgc2FtcGxlIGJ1ZmZlci4KCS8vVmluIFNoaXQ6Cgl0aGlzLlZpbkxlZnRDaGFubmVsTWFzdGVyVm9sdW1lID0gODsJCS8vQ29tcHV0ZWQgcG9zdC1taXhpbmcgdm9sdW1lLgoJdGhpcy5WaW5SaWdodENoYW5uZWxNYXN0ZXJWb2x1bWUgPSA4OwkJLy9Db21wdXRlZCBwb3N0LW1peGluZyB2b2x1bWUuCgkvL0NoYW5uZWwgcGF0aHMgZW5hYmxlZDoKCXRoaXMubGVmdENoYW5uZWwxID0gZmFsc2U7Cgl0aGlzLmxlZnRDaGFubmVsMiA9IGZhbHNlOwoJdGhpcy5sZWZ0Q2hhbm5lbDMgPSBmYWxzZTsKCXRoaXMubGVmdENoYW5uZWw0ID0gZmFsc2U7Cgl0aGlzLnJpZ2h0Q2hhbm5lbDEgPSBmYWxzZTsKCXRoaXMucmlnaHRDaGFubmVsMiA9IGZhbHNlOwoJdGhpcy5yaWdodENoYW5uZWwzID0gZmFsc2U7Cgl0aGlzLnJpZ2h0Q2hhbm5lbDQgPSBmYWxzZTsKCXRoaXMuYXVkaW9DbG9ja3NVbnRpbE5leHRFdmVudCA9IDE7Cgl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyID0gMTsKCS8vQ2hhbm5lbCBvdXRwdXQgbGV2ZWwgY2FjaGVzOgoJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0ID0gMDsKCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHQgPSAwOwoJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVMZWZ0ID0gMDsKCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHQgPSAwOwoJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVMZWZ0ID0gMDsKCXRoaXMuY2hhbm5lbDNjdXJyZW50U2FtcGxlUmlnaHQgPSAwOwoJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0ID0gMDsKCXRoaXMuY2hhbm5lbDRjdXJyZW50U2FtcGxlUmlnaHQgPSAwOwoJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gMDsKCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSAwOwoJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gMDsKCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSAwOwoJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gMDsKCXRoaXMuY2hhbm5lbDNjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSAwOwoJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gMDsKCXRoaXMuY2hhbm5lbDRjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSAwOwoJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0VHJpbWFyeSA9IDA7Cgl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0VHJpbWFyeSA9IDA7Cgl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnRUcmltYXJ5ID0gMDsKCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHRUcmltYXJ5ID0gMDsKCXRoaXMubWl4ZXJPdXRwdXRDYWNoZSA9IDA7CgkvL1ByZS1tdWx0aXBsaWVycyB0byBjYWNoZSBzb21lIGNhbGN1bGF0aW9uczoKCXRoaXMuZW11bGF0b3JTcGVlZCA9IDE7Cgl0aGlzLmluaXRpYWxpemVUaW1pbmcoKTsKCS8vQXVkaW8gZ2VuZXJhdGlvbiBjb3VudGVyczoKCXRoaXMuYXVkaW9UaWNrcyA9IDA7CQkJCS8vVXNlZCB0byBzYW1wbGUgdGhlIGF1ZGlvIHN5c3RlbSBldmVyeSB4IENQVSBpbnN0cnVjdGlvbnMuCgl0aGlzLmF1ZGlvSW5kZXggPSAwOwkJCQkvL1VzZWQgdG8ga2VlcCBhbGlnbm1lbnQgb24gYXVkaW8gZ2VuZXJhdGlvbi4KCXRoaXMuZG93bnNhbXBsZUlucHV0ID0gMDsKCXRoaXMuYXVkaW9EZXN0aW5hdGlvblBvc2l0aW9uID0gMDsJLy9Vc2VkIHRvIGtlZXAgYWxpZ25tZW50IG9uIGF1ZGlvIGdlbmVyYXRpb24uCgl0aGlzLnJvbGxvdmVyID0gMDsJCQkJCS8vVXNlZCB0byBrZWVwIGFsaWdubWVudCBvbiB0aGUgbnVtYmVyIG9mIHNhbXBsZXMgdG8gb3V0cHV0IChSZWFsaWduIGZyb20gY291bnRlciBhbGlhcykuCgkvL1RpbWluZyBWYXJpYWJsZXMKCXRoaXMuZW11bGF0b3JUaWNrcyA9IDA7CQkJCS8vVGltZXMgZm9yIGhvdyBtYW55IGluc3RydWN0aW9ucyB0byBleGVjdXRlIGJlZm9yZSBlbmRpbmcgdGhlIGxvb3AuCgl0aGlzLkRJVlRpY2tzID0gNTY7CQkJCQkvL0RJViBUaWNrcyBDb3VudGVyIChJbnZpc2libGUgbG93ZXIgOC1iaXQpCgl0aGlzLkxDRFRpY2tzID0gNjA7CQkJCQkvL0NvdW50ZXIgZm9yIGhvdyBtYW55IGluc3RydWN0aW9ucyBoYXZlIGJlZW4gZXhlY3V0ZWQgb24gYSBzY2FubGluZSBzbyBmYXIuCgl0aGlzLnRpbWVyVGlja3MgPSAwOwkJCQkvL0NvdW50ZXIgZm9yIHRoZSBUSU1BIHRpbWVyLgoJdGhpcy5USU1BRW5hYmxlZCA9IGZhbHNlOwkJCS8vSXMgVElNQSBlbmFibGVkPwoJdGhpcy5UQUNDbG9ja2VyID0gMTAyNDsJCQkJLy9UaW1lciBNYXggVGlja3MKCXRoaXMuc2VyaWFsVGltZXIgPSAwOwkJCQkvL1NlcmlhbCBJUlEgVGltZXIKCXRoaXMuc2VyaWFsU2hpZnRUaW1lciA9IDA7CQkJLy9TZXJpYWwgVHJhbnNmZXIgU2hpZnQgVGltZXIKCXRoaXMuc2VyaWFsU2hpZnRUaW1lckFsbG9jYXRlZCA9IDA7CS8vU2VyaWFsIFRyYW5zZmVyIFNoaWZ0IFRpbWVyIFJlZmlsbAoJdGhpcy5JUlFFbmFibGVEZWxheSA9IDA7CQkJLy9BcmUgdGhlIGludGVycnVwdHMgb24gcXVldWUgdG8gYmUgZW5hYmxlZD8KCXZhciBkYXRlVmFyID0gbmV3IERhdGUoKTsKCXRoaXMubGFzdEl0ZXJhdGlvbiA9IGRhdGVWYXIuZ2V0VGltZSgpOy8vVGhlIGxhc3QgdGltZSB3ZSBpdGVyYXRlZCB0aGUgbWFpbiBsb29wLgoJZGF0ZVZhciA9IG5ldyBEYXRlKCk7Cgl0aGlzLmZpcnN0SXRlcmF0aW9uID0gZGF0ZVZhci5nZXRUaW1lKCk7Cgl0aGlzLml0ZXJhdGlvbnMgPSAwOwoJdGhpcy5hY3R1YWxTY2FuTGluZSA9IDA7CQkJLy9BY3R1YWwgc2NhbiBsaW5lLi4uCgl0aGlzLmxhc3RVbnJlbmRlcmVkTGluZSA9IDA7CQkvL0xhc3QgcmVuZGVyZWQgc2NhbiBsaW5lLi4uCgl0aGlzLnF1ZXVlZFNjYW5MaW5lcyA9IDA7Cgl0aGlzLnRvdGFsTGluZXNQYXNzZWQgPSAwOwoJdGhpcy5oYWx0UG9zdENsb2NrcyA9IDA7CQkJLy9Qb3N0LUhhbHQgY2xvY2tpbmcuCgkvL1JPTSBDYXJ0cmlkZ2UgQ29tcG9uZW50czoKCXRoaXMuY01CQzEgPSBmYWxzZTsJCQkJCS8vRG9lcyB0aGUgY2FydHJpZGdlIHVzZSBNQkMxPwoJdGhpcy5jTUJDMiA9IGZhbHNlOwkJCQkJLy9Eb2VzIHRoZSBjYXJ0cmlkZ2UgdXNlIE1CQzI/Cgl0aGlzLmNNQkMzID0gZmFsc2U7CQkJCQkvL0RvZXMgdGhlIGNhcnRyaWRnZSB1c2UgTUJDMz8KCXRoaXMuY01CQzUgPSBmYWxzZTsJCQkJCS8vRG9lcyB0aGUgY2FydHJpZGdlIHVzZSBNQkM1PwoJdGhpcy5jTUJDNyA9IGZhbHNlOwkJCQkJLy9Eb2VzIHRoZSBjYXJ0cmlkZ2UgdXNlIE1CQzc/Cgl0aGlzLmNTUkFNID0gZmFsc2U7CQkJCQkvL0RvZXMgdGhlIGNhcnRyaWRnZSB1c2Ugc2F2ZSBSQU0/Cgl0aGlzLmNNTU1PMSA9IGZhbHNlOwkJCQkvLy4uLgoJdGhpcy5jUlVNQkxFID0gZmFsc2U7CQkJCS8vRG9lcyB0aGUgY2FydHJpZGdlIHVzZSB0aGUgUlVNQkxFIGFkZHJlc3NpbmcgKG1vZGlmaWVkIE1CQzUpPwoJdGhpcy5jQ2FtZXJhID0gZmFsc2U7CQkJCS8vSXMgdGhlIGNhcnRyaWRnZSBhY3R1YWxseSBhIEdhbWVCb3kgQ2FtZXJhPwoJdGhpcy5jVEFNQTUgPSBmYWxzZTsJCQkJLy9Eb2VzIHRoZSBjYXJ0cmlkZ2UgdXNlIFRBTUE1PyAoVGFtYWdvdGNoaSBDYXJ0cmlkZ2UpCgl0aGlzLmNIdUMzID0gZmFsc2U7CQkJCQkvL0RvZXMgdGhlIGNhcnRyaWRnZSB1c2UgSHVDMyAoSHVkc29uIFNvZnQgLyBtb2RpZmllZCBNQkMzKT8KCXRoaXMuY0h1QzEgPSBmYWxzZTsJCQkJCS8vRG9lcyB0aGUgY2FydHJpZGdlIHVzZSBIdUMxIChIdWRzb24gU29mdCAvIG1vZGlmaWVkIE1CQzEpPwoJdGhpcy5jVElNRVIgPSBmYWxzZTsJCQkJLy9Eb2VzIHRoZSBjYXJ0cmlkZ2UgaGF2ZSBhbiBSVEM/Cgl0aGlzLlJPTUJhbmtzID0gWwkJCQkJLy8gMSBCYW5rID0gMTYgS0J5dGVzID0gMjU2IEtiaXRzCgkJMiwgNCwgOCwgMTYsIDMyLCA2NCwgMTI4LCAyNTYsIDUxMgoJXTsKCXRoaXMuUk9NQmFua3NbMHg1Ml0gPSA3MjsKCXRoaXMuUk9NQmFua3NbMHg1M10gPSA4MDsKCXRoaXMuUk9NQmFua3NbMHg1NF0gPSA5NjsKCXRoaXMubnVtUkFNQmFua3MgPSAwOwkJCQkJLy9Ib3cgbWFueSBSQU0gYmFua3Mgd2VyZSBhY3R1YWxseSBhbGxvY2F0ZWQ/CgkvLy8vR3JhcGhpY3MgVmFyaWFibGVzCgl0aGlzLmN1cnJWUkFNQmFuayA9IDA7CQkJCQkvL0N1cnJlbnQgVlJBTSBiYW5rIGZvciBHQkMuCgl0aGlzLmJhY2tncm91bmRYID0gMDsJCQkJCS8vUmVnaXN0ZXIgU0NYIChYLVNjcm9sbCkKCXRoaXMuYmFja2dyb3VuZFkgPSAwOwkJCQkJLy9SZWdpc3RlciBTQ1kgKFktU2Nyb2xsKQoJdGhpcy5nZnhXaW5kb3dEaXNwbGF5ID0gZmFsc2U7CQkJLy9JcyB0aGUgd2luZG93cyBlbmFibGVkPwoJdGhpcy5nZnhTcHJpdGVTaG93ID0gZmFsc2U7CQkJCS8vQXJlIHNwcml0ZXMgZW5hYmxlZD8KCXRoaXMuZ2Z4U3ByaXRlTm9ybWFsSGVpZ2h0ID0gdHJ1ZTsJCS8vQXJlIHdlIGRvaW5nIDh4OCBvciA4eDE2IHNwcml0ZXM/Cgl0aGlzLmJnRW5hYmxlZCA9IHRydWU7CQkJCQkvL0lzIHRoZSBCRyBlbmFibGVkPwoJdGhpcy5CR1ByaW9yaXR5RW5hYmxlZCA9IHRydWU7CQkJLy9DYW4gd2UgZmxhZyB0aGUgQkcgZm9yIHByaW9yaXR5IG92ZXIgc3ByaXRlcz8KCXRoaXMuZ2Z4V2luZG93Q0hSQmFua1Bvc2l0aW9uID0gMDsJCS8vVGhlIGN1cnJlbnQgYmFuayBvZiB0aGUgY2hhcmFjdGVyIG1hcCB0aGUgd2luZG93IHVzZXMuCgl0aGlzLmdmeEJhY2tncm91bmRDSFJCYW5rUG9zaXRpb24gPSAwOwkvL1RoZSBjdXJyZW50IGJhbmsgb2YgdGhlIGNoYXJhY3RlciBtYXAgdGhlIEJHIHVzZXMuCgl0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0ID0gMHg4MDsJLy9GYXN0IG1hcHBpbmcgb2YgdGhlIHRpbGUgbnVtYmVyaW5nLwoJdGhpcy53aW5kb3dZID0gMDsJCQkJCQkvL0N1cnJlbnQgWSBvZmZzZXQgb2YgdGhlIHdpbmRvdy4KCXRoaXMud2luZG93WCA9IDA7CQkJCQkJLy9DdXJyZW50IFggb2Zmc2V0IG9mIHRoZSB3aW5kb3cuCgl0aGlzLmRyZXdCbGFuayA9IDA7CQkJCQkJLy9UbyBwcmV2ZW50IHRoZSByZXBlYXRpbmcgb2YgZHJhd2luZyBhIGJsYW5rIHNjcmVlbi4KCXRoaXMuZHJld0ZyYW1lID0gZmFsc2U7CQkJCQkvL1Rocm90dGxlIGhvdyBtYW55IGRyYXdzIHdlIGNhbiBkbyB0byBvbmNlIHBlciBpdGVyYXRpb24uCgl0aGlzLm1pZFNjYW5saW5lT2Zmc2V0ID0gLTE7CQkJLy9taWQtc2NhbmxpbmUgcmVuZGVyaW5nIG9mZnNldC4KCXRoaXMucGl4ZWxFbmQgPSAwOwkJCQkJCS8vdHJhY2sgdGhlIHgtY29vcmQgbGltaXQgZm9yIGxpbmUgcmVuZGVyaW5nIChtaWQtc2NhbmxpbmUgdXNhZ2UpLgoJdGhpcy5jdXJyZW50WCA9IDA7CQkJCQkJLy9UaGUgeC1jb29yZCB3ZSBsZWZ0IG9mZiBhdCBmb3IgbWlkLXNjYW5saW5lIHJlbmRlcmluZy4KCS8vQkcgVGlsZSBQb2ludGVyIENhY2hlczoKCXRoaXMuQkdDSFJCYW5rMSA9IG51bGw7Cgl0aGlzLkJHQ0hSQmFuazIgPSBudWxsOwoJdGhpcy5CR0NIUkN1cnJlbnRCYW5rID0gbnVsbDsKCS8vVGlsZSBEYXRhIENhY2hlOgoJdGhpcy50aWxlQ2FjaGUgPSBudWxsOwoJLy9QYWxldHRlczoKCXRoaXMuY29sb3JzID0gWzB4RUZGRkRFLCAweEFERDc5NCwgMHg1MjkyNzMsIDB4MTgzNDQyXTsJCQkvLyJDbGFzc2ljIiBHYW1lQm95IHBhbGV0dGUgY29sb3JzLgoJdGhpcy5PQkpQYWxldHRlID0gbnVsbDsKCXRoaXMuQkdQYWxldHRlID0gbnVsbDsKCXRoaXMuZ2JjT0JKUmF3UGFsZXR0ZSA9IG51bGw7Cgl0aGlzLmdiY0JHUmF3UGFsZXR0ZSA9IG51bGw7Cgl0aGlzLmdiT0JKUGFsZXR0ZSA9IG51bGw7Cgl0aGlzLmdiQkdQYWxldHRlID0gbnVsbDsKCXRoaXMuZ2JjT0JKUGFsZXR0ZSA9IG51bGw7Cgl0aGlzLmdiY0JHUGFsZXR0ZSA9IG51bGw7Cgl0aGlzLmdiQkdDb2xvcml6ZWRQYWxldHRlID0gbnVsbDsKCXRoaXMuZ2JPQkpDb2xvcml6ZWRQYWxldHRlID0gbnVsbDsKCXRoaXMuY2FjaGVkQkdQYWxldHRlQ29udmVyc2lvbiA9IG51bGw7Cgl0aGlzLmNhY2hlZE9CSlBhbGV0dGVDb252ZXJzaW9uID0gbnVsbDsKCXRoaXMudXBkYXRlR0JCR1BhbGV0dGUgPSB0aGlzLnVwZGF0ZUdCUmVndWxhckJHUGFsZXR0ZTsKCXRoaXMudXBkYXRlR0JPQkpQYWxldHRlID0gdGhpcy51cGRhdGVHQlJlZ3VsYXJPQkpQYWxldHRlOwoJdGhpcy5jb2xvcml6ZWRHQlBhbGV0dGVzID0gZmFsc2U7Cgl0aGlzLkJHTGF5ZXJSZW5kZXIgPSBudWxsOwkJCS8vUmVmZXJlbmNlIHRvIHRoZSBCRyByZW5kZXJpbmcgZnVuY3Rpb24uCgl0aGlzLldpbmRvd0xheWVyUmVuZGVyID0gbnVsbDsJCS8vUmVmZXJlbmNlIHRvIHRoZSB3aW5kb3cgcmVuZGVyaW5nIGZ1bmN0aW9uLgoJdGhpcy5TcHJpdGVMYXllclJlbmRlciA9IG51bGw7CQkvL1JlZmVyZW5jZSB0byB0aGUgT0FNIHJlbmRlcmluZyBmdW5jdGlvbi4KCXRoaXMuZnJhbWVCdWZmZXIgPSBbXTsJCQkJLy9UaGUgaW50ZXJuYWwgZnJhbWUtYnVmZmVyLgoJdGhpcy5zd2l6emxlZEZyYW1lID0gbnVsbDsJCQkvL1RoZSBzZWNvbmRhcnkgZ2Z4IGJ1ZmZlciB0aGF0IGhvbGRzIHRoZSBjb252ZXJ0ZWQgUkdCQSB2YWx1ZXMuCgl0aGlzLmNhbnZhc0J1ZmZlciA9IG51bGw7CQkJLy9pbWFnZURhdGEgaGFuZGxlCgl0aGlzLnBpeGVsU3RhcnQgPSAwOwkJCQkvL1RlbXAgdmFyaWFibGUgZm9yIGhvbGRpbmcgdGhlIGN1cnJlbnQgd29ya2luZyBmcmFtZWJ1ZmZlciBvZmZzZXQuCgkvL1ZhcmlhYmxlcyB1c2VkIGZvciBzY2FsaW5nIGluIEpTOgoJdGhpcy5vbnNjcmVlbldpZHRoID0gdGhpcy5vZmZzY3JlZW5XaWR0aCA9IDE2MDsKCXRoaXMub25zY3JlZW5IZWlnaHQgPSB0aGlzLm9mZnNjcmVlbkhlaWdodCA9IDE0NDsKCXRoaXMub2Zmc2NyZWVuUkdCQ291bnQgPSB0aGlzLm9uc2NyZWVuV2lkdGggKiB0aGlzLm9uc2NyZWVuSGVpZ2h0ICogNDsKCXRoaXMucmVzaXplUGF0aENsZWFyID0gdHJ1ZTsKCS8vSW5pdGlhbGl6ZSB0aGUgd2hpdGUgbm9pc2UgY2FjaGUgdGFibGVzIGFoZWFkIG9mIHRpbWU6Cgl0aGlzLmludGlhbGl6ZVdoaXRlTm9pc2UoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuR0JCT09UUk9NID0gWwkJLy9HQiBCT09UIFJPTQoJLy9BZGQgMjU2IGJ5dGUgYm9vdCByb20gaGVyZSBpZiB5b3UgYXJlIGdvaW5nIHRvIHVzZSBpdC4KXTsKR2FtZUJveUNvcmUucHJvdG90eXBlLkdCQ0JPT1RST00gPSBbCS8vR0JDIEJPT1QgUk9NCgkvL0FkZCAyMDQ4IGJ5dGUgYm9vdCByb20gaGVyZSBpZiB5b3UgYXJlIGdvaW5nIHRvIHVzZSBpdC4KXTsKR2FtZUJveUNvcmUucHJvdG90eXBlLmZmeHhEdW1wID0gWwkvL0R1bXAgb2YgdGhlIHBvc3QtQk9PVCBJL08gcmVnaXN0ZXIgc3RhdGUgKEZyb20gZ2FtYmF0dGUpOgoJMHgwRiwgMHgwMCwgMHg3QywgMHhGRiwgMHgwMCwgMHgwMCwgMHgwMCwgMHhGOCwgCTB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4MDEsCgkweDgwLCAweEJGLCAweEYzLCAweEZGLCAweEJGLCAweEZGLCAweDNGLCAweDAwLCAJMHhGRiwgMHhCRiwgMHg3RiwgMHhGRiwgMHg5RiwgMHhGRiwgMHhCRiwgMHhGRiwKCTB4RkYsIDB4MDAsIDB4MDAsIDB4QkYsIDB4NzcsIDB4RjMsIDB4RjEsIDB4RkYsIAkweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLAoJMHgwMCwgMHhGRiwgMHgwMCwgMHhGRiwgMHgwMCwgMHhGRiwgMHgwMCwgMHhGRiwgCTB4MDAsIDB4RkYsIDB4MDAsIDB4RkYsIDB4MDAsIDB4RkYsIDB4MDAsIDB4RkYsCgkweDkxLCAweDgwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweEZDLCAJMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHhGRiwgMHg3RSwgMHhGRiwgMHhGRSwKCTB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYsIDB4M0UsIDB4RkYsIAkweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLCAweEZGLAoJMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgCTB4QzAsIDB4RkYsIDB4QzEsIDB4MDAsIDB4RkUsIDB4RkYsIDB4RkYsIDB4RkYsCgkweEY4LCAweEZGLCAweDAwLCAweDAwLCAweDAwLCAweDhGLCAweDAwLCAweDAwLCAJMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiwKCTB4Q0UsIDB4RUQsIDB4NjYsIDB4NjYsIDB4Q0MsIDB4MEQsIDB4MDAsIDB4MEIsIAkweDAzLCAweDczLCAweDAwLCAweDgzLCAweDAwLCAweDBDLCAweDAwLCAweDBELAoJMHgwMCwgMHgwOCwgMHgxMSwgMHgxRiwgMHg4OCwgMHg4OSwgMHgwMCwgMHgwRSwgCTB4REMsIDB4Q0MsIDB4NkUsIDB4RTYsIDB4REQsIDB4REQsIDB4RDksIDB4OTksCgkweEJCLCAweEJCLCAweDY3LCAweDYzLCAweDZFLCAweDBFLCAweEVDLCAweENDLCAJMHhERCwgMHhEQywgMHg5OSwgMHg5RiwgMHhCQiwgMHhCOSwgMHgzMywgMHgzRSwKCTB4NDUsIDB4RUMsIDB4NTIsIDB4RkEsIDB4MDgsIDB4QjcsIDB4MDcsIDB4NUQsIAkweDAxLCAweEZELCAweEMwLCAweEZGLCAweDA4LCAweEZDLCAweDAwLCAweEU1LAoJMHgwQiwgMHhGOCwgMHhDMiwgMHhDRSwgMHhGNCwgMHhGOSwgMHgwRiwgMHg3RiwgCTB4NDUsIDB4NkQsIDB4M0QsIDB4RkUsIDB4NDYsIDB4OTcsIDB4MzMsIDB4NUUsCgkweDA4LCAweEVGLCAweEYxLCAweEZGLCAweDg2LCAweDgzLCAweDI0LCAweDc0LCAJMHgxMiwgMHhGQywgMHgwMCwgMHg5RiwgMHhCNCwgMHhCNywgMHgwNiwgMHhENSwKCTB4RDAsIDB4N0EsIDB4MDAsIDB4OUUsIDB4MDQsIDB4NUYsIDB4NDEsIDB4MkYsIAkweDFELCAweDc3LCAweDM2LCAweDc1LCAweDgxLCAweEFBLCAweDcwLCAweDNBLAoJMHg5OCwgMHhEMSwgMHg3MSwgMHgwMiwgMHg0RCwgMHgwMSwgMHhDMSwgMHhGRiwgCTB4MEQsIDB4MDAsIDB4RDMsIDB4MDUsIDB4RjksIDB4MDAsIDB4MEIsIDB4MDAKXTsKR2FtZUJveUNvcmUucHJvdG90eXBlLk9QQ09ERSA9IFsKCS8vTk9QCgkvLyMweDAwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vRG8gTm90aGluZy4uLgoJfSwKCS8vTEQgQkMsIG5uCgkvLyMweDAxOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvL0xEIChCQyksIEEKCS8vIzB4MDI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlKChwYXJlbnRPYmoucmVnaXN0ZXJCIDw8IDgpIHwgcGFyZW50T2JqLnJlZ2lzdGVyQywgcGFyZW50T2JqLnJlZ2lzdGVyQSk7Cgl9LAoJLy9JTkMgQkMKCS8vIzB4MDM6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gKChwYXJlbnRPYmoucmVnaXN0ZXJCIDw8IDgpIHwgcGFyZW50T2JqLnJlZ2lzdGVyQykgKyAxOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAodGVtcF92YXIgPj4gOCkgJiAweEZGOwoJCXBhcmVudE9iai5yZWdpc3RlckMgPSB0ZW1wX3ZhciAmIDB4RkY7Cgl9LAoJLy9JTkMgQgoJLy8jMHgwNDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCID0gKHBhcmVudE9iai5yZWdpc3RlckIgKyAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckIgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckIgJiAweEYpID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0RFQyBCCgkvLyMweDA1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAocGFyZW50T2JqLnJlZ2lzdGVyQiAtIDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQiA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4RikgPT0gMHhGKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0xEIEIsIG4KCS8vIzB4MDY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJfSwKCS8vUkxDQQoJLy8jMHgwNzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckEgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBIDw8IDEpICYgMHhGRikgfCAocGFyZW50T2JqLnJlZ2lzdGVyQSA+PiA3KTsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL0xEIChubiksIFNQCgkvLyMweDA4OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wX3ZhciA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMikgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlKHRlbXBfdmFyLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyICYgMHhGRik7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlKCh0ZW1wX3ZhciArIDEpICYgMHhGRkZGLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyID4+IDgpOwoJfSwKCS8vQUREIEhMLCBCQwoJLy8jMHgwOToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgKyAoKHBhcmVudE9iai5yZWdpc3RlckIgPDwgOCkgfCBwYXJlbnRPYmoucmVnaXN0ZXJDKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRkYpID4gKGRpcnR5U3VtICYgMHhGRkYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRkZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSBkaXJ0eVN1bSAmIDB4RkZGRjsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9MRCBBLCAoQkMpCgkvLyMweDBBOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnJlZ2lzdGVyQiA8PCA4KSB8IHBhcmVudE9iai5yZWdpc3RlckMpOwoJfSwKCS8vREVDIEJDCgkvLyMweDBCOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wX3ZhciA9ICgoKHBhcmVudE9iai5yZWdpc3RlckIgPDwgOCkgfCBwYXJlbnRPYmoucmVnaXN0ZXJDKSAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSB0ZW1wX3ZhciA+PiA4OwoJCXBhcmVudE9iai5yZWdpc3RlckMgPSB0ZW1wX3ZhciAmIDB4RkY7Cgl9LAoJLy9JTkMgQwoJLy8jMHgwQzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDID0gKHBhcmVudE9iai5yZWdpc3RlckMgKyAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckMgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckMgJiAweEYpID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0RFQyBDCgkvLyMweDBEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgPSAocGFyZW50T2JqLnJlZ2lzdGVyQyAtIDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4RikgPT0gMHhGKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0xEIEMsIG4KCS8vIzB4MEU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJfSwKCS8vUlJDQQoJLy8jMHgwRjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKHBhcmVudE9iai5yZWdpc3RlckEgPj4gMSkgfCAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAxKSA8PCA3KTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckEgPiAweDdGKTsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL1NUT1AKCS8vIzB4MTA6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKHBhcmVudE9iai5jR0JDKSB7CgkJCWlmICgocGFyZW50T2JqLm1lbW9yeVsweEZGNERdICYgMHgwMSkgPT0gMHgwMSkgewkJLy9TcGVlZCBjaGFuZ2UgcmVxdWVzdGVkLgoJCQkJaWYgKHBhcmVudE9iai5tZW1vcnlbMHhGRjREXSA+IDB4N0YpIHsJCQkJLy9HbyBiYWNrIHRvIHNpbmdsZSBzcGVlZCBtb2RlLgoJCQkJCWNvdXQoIkdvaW5nIGludG8gc2luZ2xlIGNsb2NrIHNwZWVkIG1vZGUuIiwgMCk7CgkJCQkJcGFyZW50T2JqLmRvdWJsZVNwZWVkU2hpZnRlciA9IDA7CgkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNERdICY9IDB4N0Y7CQkJCS8vQ2xlYXIgdGhlIGRvdWJsZSBzcGVlZCBtb2RlIGZsYWcuCgkJCQl9CgkJCQllbHNlIHsJCQkJCQkJCQkJCQkvL0dvIHRvIGRvdWJsZSBzcGVlZCBtb2RlLgoJCQkJCWNvdXQoIkdvaW5nIGludG8gZG91YmxlIGNsb2NrIHNwZWVkIG1vZGUuIiwgMCk7CgkJCQkJcGFyZW50T2JqLmRvdWJsZVNwZWVkU2hpZnRlciA9IDE7CgkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNERdIHw9IDB4ODA7CQkJCS8vU2V0IHRoZSBkb3VibGUgc3BlZWQgbW9kZSBmbGFnLgoJCQkJfQoJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNERdICY9IDB4RkU7CQkJCQkvL1Jlc2V0IHRoZSByZXF1ZXN0IGJpdC4KCQkJfQoJCQllbHNlIHsKCQkJCXBhcmVudE9iai5oYW5kbGVTVE9QKCk7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5oYW5kbGVTVE9QKCk7CgkJfQoJfSwKCS8vTEQgREUsIG5uCgkvLyMweDExOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5yZWdpc3RlckQgPSBwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvL0xEIChERSksIEEKCS8vIzB4MTI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlKChwYXJlbnRPYmoucmVnaXN0ZXJEIDw8IDgpIHwgcGFyZW50T2JqLnJlZ2lzdGVyRSwgcGFyZW50T2JqLnJlZ2lzdGVyQSk7Cgl9LAoJLy9JTkMgREUKCS8vIzB4MTM6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gKChwYXJlbnRPYmoucmVnaXN0ZXJEIDw8IDgpIHwgcGFyZW50T2JqLnJlZ2lzdGVyRSkgKyAxOwoJCXBhcmVudE9iai5yZWdpc3RlckQgPSAodGVtcF92YXIgPj4gOCkgJiAweEZGOwoJCXBhcmVudE9iai5yZWdpc3RlckUgPSB0ZW1wX3ZhciAmIDB4RkY7Cgl9LAoJLy9JTkMgRAoJLy8jMHgxNDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gKHBhcmVudE9iai5yZWdpc3RlckQgKyAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckQgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweEYpID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0RFQyBECgkvLyMweDE1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgPSAocGFyZW50T2JqLnJlZ2lzdGVyRCAtIDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRCA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRCAmIDB4RikgPT0gMHhGKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0xEIEQsIG4KCS8vIzB4MTY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJfSwKCS8vUkxBCgkvLyMweDE3OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBjYXJyeV9mbGFnID0gKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDA7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID4gMHg3Rik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSA8PCAxKSAmIDB4RkYpIHwgY2FycnlfZmxhZzsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL0pSIG4KCS8vIzB4MTg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArICgocGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKSA8PCAyNCkgPj4gMjQpICsgMSkgJiAweEZGRkY7Cgl9LAoJLy9BREQgSEwsIERFCgkvLyMweDE5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlcnNITCArICgocGFyZW50T2JqLnJlZ2lzdGVyRCA8PCA4KSB8IHBhcmVudE9iai5yZWdpc3RlckUpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGRikgPiAoZGlydHlTdW0gJiAweEZGRikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGRkYpOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IGRpcnR5U3VtICYgMHhGRkZGOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0xEIEEsIChERSkKCS8vIzB4MUE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmoucmVnaXN0ZXJEIDw8IDgpIHwgcGFyZW50T2JqLnJlZ2lzdGVyRSk7Cgl9LAoJLy9ERUMgREUKCS8vIzB4MUI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gKCgocGFyZW50T2JqLnJlZ2lzdGVyRCA8PCA4KSB8IHBhcmVudE9iai5yZWdpc3RlckUpIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCA9IHRlbXBfdmFyID4+IDg7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSA9IHRlbXBfdmFyICYgMHhGRjsKCX0sCgkvL0lOQyBFCgkvLyMweDFDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgPSAocGFyZW50T2JqLnJlZ2lzdGVyRSArIDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRSA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4RikgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vREVDIEUKCS8vIzB4MUQ6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSA9IChwYXJlbnRPYmoucmVnaXN0ZXJFIC0gMSkgJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJFID09IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJFICYgMHhGKSA9PSAweEYpOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSB0cnVlOwoJfSwKCS8vTEQgRSwgbgoJLy8jMHgxRToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkY7Cgl9LAoJLy9SUkEKCS8vIzB4MUY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGNhcnJ5X2ZsYWcgPSAocGFyZW50T2JqLkZDYXJyeSkgPyAweDgwIDogMDsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMSkgPT0gMSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID4+IDEpIHwgY2FycnlfZmxhZzsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL0pSIE5aLCBuCgkvLyMweDIwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWlmICghcGFyZW50T2JqLkZaZXJvKSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAoKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcikgPDwgMjQpID4+IDI0KSArIDEpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmouQ1BVVGlja3MgKz0gNDsKCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQl9Cgl9LAoJLy9MRCBITCwgbm4KCS8vIzB4MjE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvL0xESSAoSEwpLCBBCgkvLyMweDIyOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLnJlZ2lzdGVyQSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCArIDEpICYgMHhGRkZGOwoJfSwKCS8vSU5DIEhMCgkvLyMweDIzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgKyAxKSAmIDB4RkZGRjsKCX0sCgkvL0lOQyBICgkvLyMweDI0OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBIID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gOCkgKyAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKEggPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKEggJiAweEYpID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAoSCA8PCA4KSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCX0sCgkvL0RFQyBICgkvLyMweDI1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBIID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gOCkgLSAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKEggPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKEggJiAweEYpID09IDB4Rik7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKEggPDwgOCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRik7Cgl9LAoJLy9MRCBILCBuCgkvLyMweDI2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpIDw8IDgpIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCX0sCgkvL0RBQQoJLy8jMHgyNzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlpZiAoIXBhcmVudE9iai5GU3VidHJhY3QpIHsKCQkJaWYgKHBhcmVudE9iai5GQ2FycnkgfHwgcGFyZW50T2JqLnJlZ2lzdGVyQSA+IDB4OTkpIHsKCQkJCXBhcmVudE9iai5yZWdpc3RlckEgPSAocGFyZW50T2JqLnJlZ2lzdGVyQSArIDB4NjApICYgMHhGRjsKCQkJCXBhcmVudE9iai5GQ2FycnkgPSB0cnVlOwoJCQl9CgkJCWlmIChwYXJlbnRPYmouRkhhbGZDYXJyeSB8fCAocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPiAweDkpIHsKCQkJCXBhcmVudE9iai5yZWdpc3RlckEgPSAocGFyZW50T2JqLnJlZ2lzdGVyQSArIDB4MDYpICYgMHhGRjsKCQkJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7CgkJCX0KCQl9CgkJZWxzZSBpZiAocGFyZW50T2JqLkZDYXJyeSAmJiBwYXJlbnRPYmouRkhhbGZDYXJyeSkgewoJCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKHBhcmVudE9iai5yZWdpc3RlckEgKyAweDlBKSAmIDB4RkY7CgkJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7CgkJfQoJCWVsc2UgaWYgKHBhcmVudE9iai5GQ2FycnkpIHsKCQkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IChwYXJlbnRPYmoucmVnaXN0ZXJBICsgMHhBMCkgJiAweEZGOwoJCX0KCQllbHNlIGlmIChwYXJlbnRPYmouRkhhbGZDYXJyeSkgewoJCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKHBhcmVudE9iai5yZWdpc3RlckEgKyAweEZBKSAmIDB4RkY7CgkJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7CgkJfQoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJfSwKCS8vSlIgWiwgbgoJLy8jMHgyODoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlpZiAocGFyZW50T2JqLkZaZXJvKSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAoKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcikgPDwgMjQpID4+IDI0KSArIDEpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmouQ1BVVGlja3MgKz0gNDsKCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQl9Cgl9LAoJLy9BREQgSEwsIEhMCgkvLyMweDI5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGRikgPiAweDdGRik7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPiAweDdGRkYpOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPDwgMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vTERJIEEsIChITCkKCS8vIzB4MkE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCArIDEpICYgMHhGRkZGOwoJfSwKCS8vREVDIEhMCgkvLyMweDJCOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgLSAxKSAmIDB4RkZGRjsKCX0sCgkvL0lOQyBMCgkvLyMweDJDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCArIDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoTCA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoTCAmIDB4RikgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgTDsKCX0sCgkvL0RFQyBMCgkvLyMweDJEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAtIDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoTCA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoTCAmIDB4RikgPT0gMHhGKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjAwKSB8IEw7Cgl9LAoJLy9MRCBMLCBuCgkvLyMweDJFOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkY7Cgl9LAoJLy9DUEwKCS8vIzB4MkY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSBePSAweEZGOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7Cgl9LAoJLy9KUiBOQywgbgoJLy8jMHgzMDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlpZiAoIXBhcmVudE9iai5GQ2FycnkpIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArICgocGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKSA8PCAyNCkgPj4gMjQpICsgMSkgJiAweEZGRkY7CgkJCXBhcmVudE9iai5DUFVUaWNrcyArPSA0OwoJCX0KCQllbHNlIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCX0KCX0sCgkvL0xEIFNQLCBubgoJLy8jMHgzMToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvL0xERCAoSEwpLCBBCgkvLyMweDMyOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLnJlZ2lzdGVyQSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAtIDEpICYgMHhGRkZGOwoJfSwKCS8vSU5DIFNQCgkvLyMweDMzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciArIDEpICYgMHhGRkZGOwoJfSwKCS8vSU5DIChITCkKCS8vIzB4MzQ6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgKyAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHRlbXBfdmFyID09IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKCh0ZW1wX3ZhciAmIDB4RikgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgdGVtcF92YXIpOwoJfSwKCS8vREVDIChITCkKCS8vIzB4MzU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgLSAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHRlbXBfdmFyID09IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKCh0ZW1wX3ZhciAmIDB4RikgPT0gMHhGKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHRlbXBfdmFyKTsKCX0sCgkvL0xEIChITCksIG4KCS8vIzB4MzY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkY7Cgl9LAoJLy9TQ0YKCS8vIzB4Mzc6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9KUiBDLCBuCgkvLyMweDM4OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWlmIChwYXJlbnRPYmouRkNhcnJ5KSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAoKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcikgPDwgMjQpID4+IDI0KSArIDEpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmouQ1BVVGlja3MgKz0gNDsKCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQl9Cgl9LAoJLy9BREQgSEwsIFNQCgkvLyMweDM5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlcnNITCArIHBhcmVudE9iai5zdGFja1BvaW50ZXI7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkZGKSA+IChkaXJ0eVN1bSAmIDB4RkZGKSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA+IDB4RkZGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gZGlydHlTdW0gJiAweEZGRkY7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vTEREIEEsIChITCkKCS8vIzB4M0E6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAtIDEpICYgMHhGRkZGOwoJfSwKCS8vREVDIFNQCgkvLyMweDNCOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJfSwKCS8vSU5DIEEKCS8vIzB4M0M6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IChwYXJlbnRPYmoucmVnaXN0ZXJBICsgMSkgJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9ERUMgQQoJLy8jMHgzRDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKHBhcmVudE9iai5yZWdpc3RlckEgLSAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpID09IDB4Rik7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9MRCBBLCBuCgkvLyMweDNFOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCX0sCgkvL0NDRgoJLy8jMHgzRjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gIXBhcmVudE9iai5GQ2Fycnk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9MRCBCLCBCCgkvLyMweDQwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vRG8gbm90aGluZy4uLgoJfSwKCS8vTEQgQiwgQwoJLy8jMHg0MToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCID0gcGFyZW50T2JqLnJlZ2lzdGVyQzsKCX0sCgkvL0xEIEIsIEQKCS8vIzB4NDI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiA9IHBhcmVudE9iai5yZWdpc3RlckQ7Cgl9LAoJLy9MRCBCLCBFCgkvLyMweDQzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgPSBwYXJlbnRPYmoucmVnaXN0ZXJFOwoJfSwKCS8vTEQgQiwgSAoJLy8jMHg0NDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCID0gcGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDg7Cgl9LAoJLy9MRCBCLCBMCgkvLyMweDQ1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGOwoJfSwKCS8vTEQgQiwgKEhMKQoJLy8jMHg0NjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCX0sCgkvL0xEIEIsIEEKCS8vIzB4NDc6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiA9IHBhcmVudE9iai5yZWdpc3RlckE7Cgl9LAoJLy9MRCBDLCBCCgkvLyMweDQ4OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgPSBwYXJlbnRPYmoucmVnaXN0ZXJCOwoJfSwKCS8vTEQgQywgQwoJLy8jMHg0OToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQkvL0RvIG5vdGhpbmcuLi4KCX0sCgkvL0xEIEMsIEQKCS8vIzB4NEE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyA9IHBhcmVudE9iai5yZWdpc3RlckQ7Cgl9LAoJLy9MRCBDLCBFCgkvLyMweDRCOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgPSBwYXJlbnRPYmoucmVnaXN0ZXJFOwoJfSwKCS8vTEQgQywgSAoJLy8jMHg0QzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDID0gcGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDg7Cgl9LAoJLy9MRCBDLCBMCgkvLyMweDREOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGOwoJfSwKCS8vTEQgQywgKEhMKQoJLy8jMHg0RToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCX0sCgkvL0xEIEMsIEEKCS8vIzB4NEY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyA9IHBhcmVudE9iai5yZWdpc3RlckE7Cgl9LAoJLy9MRCBELCBCCgkvLyMweDUwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgPSBwYXJlbnRPYmoucmVnaXN0ZXJCOwoJfSwKCS8vTEQgRCwgQwoJLy8jMHg1MToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gcGFyZW50T2JqLnJlZ2lzdGVyQzsKCX0sCgkvL0xEIEQsIEQKCS8vIzB4NTI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9EbyBub3RoaW5nLi4uCgl9LAoJLy9MRCBELCBFCgkvLyMweDUzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgPSBwYXJlbnRPYmoucmVnaXN0ZXJFOwoJfSwKCS8vTEQgRCwgSAoJLy8jMHg1NDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gcGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDg7Cgl9LAoJLy9MRCBELCBMCgkvLyMweDU1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGOwoJfSwKCS8vTEQgRCwgKEhMKQoJLy8jMHg1NjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCX0sCgkvL0xEIEQsIEEKCS8vIzB4NTc6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCA9IHBhcmVudE9iai5yZWdpc3RlckE7Cgl9LAoJLy9MRCBFLCBCCgkvLyMweDU4OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgPSBwYXJlbnRPYmoucmVnaXN0ZXJCOwoJfSwKCS8vTEQgRSwgQwoJLy8jMHg1OToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID0gcGFyZW50T2JqLnJlZ2lzdGVyQzsKCX0sCgkvL0xEIEUsIEQKCS8vIzB4NUE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSA9IHBhcmVudE9iai5yZWdpc3RlckQ7Cgl9LAoJLy9MRCBFLCBFCgkvLyMweDVCOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vRG8gbm90aGluZy4uLgoJfSwKCS8vTEQgRSwgSAoJLy8jMHg1QzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID0gcGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDg7Cgl9LAoJLy9MRCBFLCBMCgkvLyMweDVEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGOwoJfSwKCS8vTEQgRSwgKEhMKQoJLy8jMHg1RToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCX0sCgkvL0xEIEUsIEEKCS8vIzB4NUY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSA9IHBhcmVudE9iai5yZWdpc3RlckE7Cgl9LAoJLy9MRCBILCBCCgkvLyMweDYwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJCIDw8IDgpIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJfSwKCS8vTEQgSCwgQwoJLy8jMHg2MToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA8PCA4KSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCX0sCgkvL0xEIEgsIEQKCS8vIzB4NjI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlckQgPDwgOCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRik7Cgl9LAoJLy9MRCBILCBFCgkvLyMweDYzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJFIDw8IDgpIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJfSwKCS8vTEQgSCwgSAoJLy8jMHg2NDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQkvL0RvIG5vdGhpbmcuLi4KCX0sCgkvL0xEIEgsIEwKCS8vIzB4NjU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpICogMHgxMDE7Cgl9LAoJLy9MRCBILCAoSEwpCgkvLyMweDY2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpIDw8IDgpIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJfSwKCS8vTEQgSCwgQQoJLy8jMHg2NzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA8PCA4KSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCX0sCgkvL0xEIEwsIEIKCS8vIzB4Njg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYwMCkgfCBwYXJlbnRPYmoucmVnaXN0ZXJCOwoJfSwKCS8vTEQgTCwgQwoJLy8jMHg2OToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjAwKSB8IHBhcmVudE9iai5yZWdpc3RlckM7Cgl9LAoJLy9MRCBMLCBECgkvLyMweDZBOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgcGFyZW50T2JqLnJlZ2lzdGVyRDsKCX0sCgkvL0xEIEwsIEUKCS8vIzB4NkI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYwMCkgfCBwYXJlbnRPYmoucmVnaXN0ZXJFOwoJfSwKCS8vTEQgTCwgSAoJLy8jMHg2QzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjAwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gOCk7Cgl9LAoJLy9MRCBMLCBMCgkvLyMweDZEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vRG8gbm90aGluZy4uLgoJfSwKCS8vTEQgTCwgKEhMKQoJLy8jMHg2RToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjAwKSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7Cgl9LAoJLy9MRCBMLCBBCgkvLyMweDZGOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgcGFyZW50T2JqLnJlZ2lzdGVyQTsKCX0sCgkvL0xEIChITCksIEIKCS8vIzB4NzA6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoucmVnaXN0ZXJCKTsKCX0sCgkvL0xEIChITCksIEMKCS8vIzB4NzE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoucmVnaXN0ZXJDKTsKCX0sCgkvL0xEIChITCksIEQKCS8vIzB4NzI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoucmVnaXN0ZXJEKTsKCX0sCgkvL0xEIChITCksIEUKCS8vIzB4NzM6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoucmVnaXN0ZXJFKTsKCX0sCgkvL0xEIChITCksIEgKCS8vIzB4NzQ6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gOCk7Cgl9LAoJLy9MRCAoSEwpLCBMCgkvLyMweDc1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRik7Cgl9LAoJLy9IQUxUCgkvLyMweDc2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vU2VlIGlmIHRoZXJlJ3MgYWxyZWFkeSBhbiBJUlEgbWF0Y2g6CgkJaWYgKChwYXJlbnRPYmouaW50ZXJydXB0c0VuYWJsZWQgJiBwYXJlbnRPYmouaW50ZXJydXB0c1JlcXVlc3RlZCAmIDB4MUYpID4gMCkgewoJCQlpZiAoIXBhcmVudE9iai5jR0JDICYmICFwYXJlbnRPYmoudXNlZEJvb3RST00pIHsKCQkJCS8vSEFMVCBidWcgaW4gdGhlIERNRyBDUFUgbW9kZWwgKFByb2dyYW0gQ291bnRlciBmYWlscyB0byBpbmNyZW1lbnQgZm9yIG9uZSBpbnN0cnVjdGlvbiBhZnRlciBIQUxUKToKCQkJCXBhcmVudE9iai5za2lwUENJbmNyZW1lbnQgPSB0cnVlOwoJCQl9CgkJCWVsc2UgewoJCQkJLy9DR0IgZ2V0cyBhcm91bmQgdGhlIEhBTFQgUEMgYnVnIGJ5IGRvdWJsaW5nIHRoZSBoaWRkZW4gTk9QLgoJCQkJcGFyZW50T2JqLkNQVVRpY2tzICs9IDQ7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCS8vQ1BVIGlzIHN0YWxsZWQgdW50aWwgdGhlIG5leHQgSVJRIG1hdGNoOgoJCQlwYXJlbnRPYmouY2FsY3VsYXRlSEFMVFBlcmlvZCgpOwoJCX0KCX0sCgkvL0xEIChITCksIEEKCS8vIzB4Nzc6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoucmVnaXN0ZXJBKTsKCX0sCgkvL0xEIEEsIEIKCS8vIzB4Nzg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5yZWdpc3RlckI7Cgl9LAoJLy9MRCBBLCBDCgkvLyMweDc5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBwYXJlbnRPYmoucmVnaXN0ZXJDOwoJfSwKCS8vTEQgQSwgRAoJLy8jMHg3QToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gcGFyZW50T2JqLnJlZ2lzdGVyRDsKCX0sCgkvL0xEIEEsIEUKCS8vIzB4N0I6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5yZWdpc3RlckU7Cgl9LAoJLy9MRCBBLCBICgkvLyMweDdDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gODsKCX0sCgkvL0xEIEEsIEwKCS8vIzB4N0Q6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkY7Cgl9LAoJLy9MRCwgQSwgKEhMKQoJLy8jMHg3RToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCX0sCgkvL0xEIEEsIEEKCS8vIzB4N0Y6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9EbyBOb3RoaW5nLi4uCgl9LAoJLy9BREQgQSwgQgoJLy8jMHg4MDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgcGFyZW50T2JqLnJlZ2lzdGVyQjsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpIDwgKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9BREQgQSwgQwoJLy8jMHg4MToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgcGFyZW50T2JqLnJlZ2lzdGVyQzsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpIDwgKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9BREQgQSwgRAoJLy8jMHg4MjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgcGFyZW50T2JqLnJlZ2lzdGVyRDsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpIDwgKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9BREQgQSwgRQoJLy8jMHg4MzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgcGFyZW50T2JqLnJlZ2lzdGVyRTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpIDwgKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9BREQgQSwgSAoJLy8jMHg4NDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgKHBhcmVudE9iai5yZWdpc3RlcnNITCA+PiA4KTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpIDwgKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9BREQgQSwgTAoJLy8jMHg4NToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChkaXJ0eVN1bSAmIDB4RikgPCAocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0FERCBBLCAoSEwpCgkvLyMweDg2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgKyBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChkaXJ0eVN1bSAmIDB4RikgPCAocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0FERCBBLCBBCgkvLyMweDg3OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHg4KSA9PSAweDgpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA+IDB4N0YpOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA8PCAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vQURDIEEsIEIKCS8vIzB4ODg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSArIHBhcmVudE9iai5yZWdpc3RlckIgKyAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSArIChwYXJlbnRPYmoucmVnaXN0ZXJCICYgMHhGKSArICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPiAweEYpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0FEQyBBLCBDCgkvLyMweDg5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgKyBwYXJlbnRPYmoucmVnaXN0ZXJDICsgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgKyAocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4RikgKyAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApID4gMHhGKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9BREMgQSwgRAoJLy8jMHg4QToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgcGFyZW50T2JqLnJlZ2lzdGVyRCArICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpICsgKHBhcmVudE9iai5yZWdpc3RlckQgJiAweEYpICsgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKSA+IDB4Rik7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA+IDB4RkYpOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBkaXJ0eVN1bSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vQURDIEEsIEUKCS8vIzB4OEI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSArIHBhcmVudE9iai5yZWdpc3RlckUgKyAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSArIChwYXJlbnRPYmoucmVnaXN0ZXJFICYgMHhGKSArICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPiAweEYpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0FEQyBBLCBICgkvLyMweDhDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wVmFsdWUgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDgpOwoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgKyB0ZW1wVmFsdWUgKyAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSArICh0ZW1wVmFsdWUgJiAweEYpICsgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKSA+IDB4Rik7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA+IDB4RkYpOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBkaXJ0eVN1bSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vQURDIEEsIEwKCS8vIzB4OEQ6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBWYWx1ZSA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgdGVtcFZhbHVlICsgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgKyAodGVtcFZhbHVlICYgMHhGKSArICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPiAweEYpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL0FEQyBBLCAoSEwpCgkvLyMweDhFOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wVmFsdWUgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgKyB0ZW1wVmFsdWUgKyAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSArICh0ZW1wVmFsdWUgJiAweEYpICsgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKSA+IDB4Rik7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA+IDB4RkYpOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBkaXJ0eVN1bSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfSwKCS8vQURDIEEsIEEKCS8vIzB4OEY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9zaGlmdCBsZWZ0IHJlZ2lzdGVyIEEgb25lIGJpdCBmb3Igc29tZSBvcHMgaGVyZSBhcyBhbiBvcHRpbWl6YXRpb246CgkJdmFyIGRpcnR5U3VtID0gKHBhcmVudE9iai5yZWdpc3RlckEgPDwgMSkgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKCgoKHBhcmVudE9iai5yZWdpc3RlckEgPDwgMSkgJiAweDFFKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkpID4gMHhGKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtID4gMHhGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9TVUIgQSwgQgoJLy8jMHg5MDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gcGFyZW50T2JqLnJlZ2lzdGVyQjsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPCAoZGlydHlTdW0gJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TVUIgQSwgQwoJLy8jMHg5MToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gcGFyZW50T2JqLnJlZ2lzdGVyQzsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPCAoZGlydHlTdW0gJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TVUIgQSwgRAoJLy8jMHg5MjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gcGFyZW50T2JqLnJlZ2lzdGVyRDsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPCAoZGlydHlTdW0gJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TVUIgQSwgRQoJLy8jMHg5MzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gcGFyZW50T2JqLnJlZ2lzdGVyRTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPCAoZGlydHlTdW0gJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TVUIgQSwgSAoJLy8jMHg5NDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA+PiA4KTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPCAoZGlydHlTdW0gJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TVUIgQSwgTAoJLy8jMHg5NToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSA8IChkaXJ0eVN1bSAmIDB4RikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPCAwKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL1NVQiBBLCAoSEwpCgkvLyMweDk2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgLSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSA8IChkaXJ0eVN1bSAmIDB4RikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPCAwKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL1NVQiBBLCBBCgkvLyMweDk3OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vbnVtYmVyIC0gc2FtZSBudW1iZXIgPT0gMAoJCXBhcmVudE9iai5yZWdpc3RlckEgPSAwOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZDYXJyeSA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IHBhcmVudE9iai5GU3VidHJhY3QgPSB0cnVlOwoJfSwKCS8vU0JDIEEsIEIKCS8vIzB4OTg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5yZWdpc3RlckIgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSAtIChwYXJlbnRPYmoucmVnaXN0ZXJCICYgMHhGKSAtICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPCAwKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL1NCQyBBLCBDCgkvLyMweDk5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgLSBwYXJlbnRPYmoucmVnaXN0ZXJDIC0gKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgLSAocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4RikgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApIDwgMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBkaXJ0eVN1bSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TQkMgQSwgRAoJLy8jMHg5QToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gcGFyZW50T2JqLnJlZ2lzdGVyRCAtICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpIC0gKHBhcmVudE9iai5yZWdpc3RlckQgJiAweEYpIC0gKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKSA8IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPCAwKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSB0cnVlOwoJfSwKCS8vU0JDIEEsIEUKCS8vIzB4OUI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5yZWdpc3RlckUgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSAtIChwYXJlbnRPYmoucmVnaXN0ZXJFICYgMHhGKSAtICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPCAwKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL1NCQyBBLCBICgkvLyMweDlDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wX3ZhciA9IHBhcmVudE9iai5yZWdpc3RlcnNITCA+PiA4OwoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgLSB0ZW1wX3ZhciAtICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpIC0gKHRlbXBfdmFyICYgMHhGKSAtICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPCAwKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL1NCQyBBLCBMCgkvLyMweDlEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgLSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRikgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSAtIChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEYpIC0gKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKSA8IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPCAwKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSB0cnVlOwoJfSwKCS8vU0JDIEEsIChITCkKCS8vIzB4OUU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gdGVtcF92YXIgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSAtICh0ZW1wX3ZhciAmIDB4RikgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApIDwgMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBkaXJ0eVN1bSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9TQkMgQSwgQQoJLy8jMHg5RjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQkvL09wdGltaXplZCBTQkMgQToKCQlpZiAocGFyZW50T2JqLkZDYXJyeSkgewoJCQlwYXJlbnRPYmouRlplcm8gPSBmYWxzZTsKCQkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZDYXJyeSA9IHRydWU7CgkJCXBhcmVudE9iai5yZWdpc3RlckEgPSAweEZGOwoJCX0KCQllbHNlIHsKCQkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7CgkJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRlplcm8gPSB0cnVlOwoJCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gMDsKCQl9Cgl9LAoJLy9BTkQgQgoJLy8jMHhBMDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IHBhcmVudE9iai5yZWdpc3RlckI7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9BTkQgQwoJLy8jMHhBMToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IHBhcmVudE9iai5yZWdpc3RlckM7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9BTkQgRAoJLy8jMHhBMjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IHBhcmVudE9iai5yZWdpc3RlckQ7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9BTkQgRQoJLy8jMHhBMzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IHBhcmVudE9iai5yZWdpc3RlckU7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9BTkQgSAoJLy8jMHhBNDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gOCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9BTkQgTAoJLy8jMHhBNToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IHBhcmVudE9iai5yZWdpc3RlcnNITDsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GQ2FycnkgPSBmYWxzZTsKCX0sCgkvL0FORCAoSEwpCgkvLyMweEE2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgJj0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GQ2FycnkgPSBmYWxzZTsKCX0sCgkvL0FORCBBCgkvLyMweEE3OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCS8vbnVtYmVyICYgc2FtZSBudW1iZXIgPSBzYW1lIG51bWJlcgoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IGZhbHNlOwoJfSwKCS8vWE9SIEIKCS8vIzB4QTg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSBePSBwYXJlbnRPYmoucmVnaXN0ZXJCOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GQ2FycnkgPSBmYWxzZTsKCX0sCgkvL1hPUiBDCgkvLyMweEE5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgXj0gcGFyZW50T2JqLnJlZ2lzdGVyQzsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9YT1IgRAoJLy8jMHhBQToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBIF49IHBhcmVudE9iai5yZWdpc3RlckQ7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZDYXJyeSA9IGZhbHNlOwoJfSwKCS8vWE9SIEUKCS8vIzB4QUI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSBePSBwYXJlbnRPYmoucmVnaXN0ZXJFOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GQ2FycnkgPSBmYWxzZTsKCX0sCgkvL1hPUiBICgkvLyMweEFDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgXj0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA+PiA4KTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9YT1IgTAoJLy8jMHhBRDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBIF49IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9YT1IgKEhMKQoJLy8jMHhBRToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBIF49IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZDYXJyeSA9IGZhbHNlOwoJfSwKCS8vWE9SIEEKCS8vIzB4QUY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9udW1iZXIgXiBzYW1lIG51bWJlciA9PSAwCgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IDA7CgkJcGFyZW50T2JqLkZaZXJvID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9PUiBCCgkvLyMweEIwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gcGFyZW50T2JqLnJlZ2lzdGVyQjsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9PUiBDCgkvLyMweEIxOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gcGFyZW50T2JqLnJlZ2lzdGVyQzsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9PUiBECgkvLyMweEIyOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gcGFyZW50T2JqLnJlZ2lzdGVyRDsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9PUiBFCgkvLyMweEIzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gcGFyZW50T2JqLnJlZ2lzdGVyRTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9PUiBICgkvLyMweEI0OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA+PiA4KTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9PUiBMCgkvLyMweEI1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL09SIChITCkKCS8vIzB4QjY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSB8PSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL09SIEEKCS8vIzB4Qjc6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9udW1iZXIgfCBzYW1lIG51bWJlciA9PSBzYW1lIG51bWJlcgoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBwYXJlbnRPYmouRkNhcnJ5ID0gcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBmYWxzZTsKCX0sCgkvL0NQIEIKCS8vIzB4Qjg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5yZWdpc3RlckI7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKGRpcnR5U3VtICYgMHhGKSA+IChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0NQIEMKCS8vIzB4Qjk6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5yZWdpc3RlckM7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKGRpcnR5U3VtICYgMHhGKSA+IChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0NQIEQKCS8vIzB4QkE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5yZWdpc3RlckQ7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKGRpcnR5U3VtICYgMHhGKSA+IChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0NQIEUKCS8vIzB4QkI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5yZWdpc3RlckU7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKGRpcnR5U3VtICYgMHhGKSA+IChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0NQIEgKCS8vIzB4QkM6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gOCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKGRpcnR5U3VtICYgMHhGKSA+IChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5GWmVybyA9IChkaXJ0eVN1bSA9PSAwKTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL0NQIEwKCS8vIzB4QkQ6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpID4gKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKGRpcnR5U3VtID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSB0cnVlOwoJfSwKCS8vQ1AgKEhMKQoJLy8jMHhCRToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgoZGlydHlTdW0gJiAweEYpID4gKHBhcmVudE9iai5yZWdpc3RlckEgJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKGRpcnR5U3VtID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSB0cnVlOwoJfSwKCS8vQ1AgQQoJLy8jMHhCRjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GQ2FycnkgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gdHJ1ZTsKCX0sCgkvL1JFVCAhRloKCS8vIzB4QzA6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKCFwYXJlbnRPYmouRlplcm8pIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIpOwoJCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAyKSAmIDB4RkZGRjsKCQkJcGFyZW50T2JqLkNQVVRpY2tzICs9IDEyOwoJCX0KCX0sCgkvL1BPUCBCQwoJLy8jMHhDMToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIpOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnN0YWNrUG9pbnRlciArIDEpICYgMHhGRkZGKTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvL0pQICFGWiwgbm4KCS8vIzB4QzI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKCFwYXJlbnRPYmouRlplcm8pIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCQlwYXJlbnRPYmouQ1BVVGlja3MgKz0gNDsKCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCQl9Cgl9LAoJLy9KUCBubgoJLy8jMHhDMzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7Cgl9LAoJLy9DQUxMICFGWiwgbm4KCS8vIzB4QzQ6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKCFwYXJlbnRPYmouRlplcm8pIHsKCQkJdmFyIHRlbXBfcGMgPSAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCQkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPj4gOCk7CgkJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyICYgMHhGRik7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IHRlbXBfcGM7CgkJCXBhcmVudE9iai5DUFVUaWNrcyArPSAxMjsKCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCQl9Cgl9LAoJLy9QVVNIIEJDCgkvLyMweEM1OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucmVnaXN0ZXJCKTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnJlZ2lzdGVyQyk7Cgl9LAoJLy9BREQsIG4KCS8vIzB4QzY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSArIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChkaXJ0eVN1bSAmIDB4RikgPCAocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL1JTVCAwCgkvLyMweEM3OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPj4gOCk7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciAmIDB4RkYpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IDA7Cgl9LAoJLy9SRVQgRloKCS8vIzB4Qzg6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKHBhcmVudE9iai5GWmVybykgewoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlcik7CgkJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciArIDIpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmouQ1BVVGlja3MgKz0gMTI7CgkJfQoJfSwKCS8vUkVUCgkvLyMweEM5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9ICAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlcik7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgMikgJiAweEZGRkY7Cgl9LAoJLy9KUCBGWiwgbm4KCS8vIzB4Q0E6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKHBhcmVudE9iai5GWmVybykgewoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJCXBhcmVudE9iai5DUFVUaWNrcyArPSA0OwoJCX0KCQllbHNlIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDIpICYgMHhGRkZGOwoJCX0KCX0sCgkvL1NlY29uZGFyeSBPUCBDb2RlIFNldDoKCS8vIzB4Q0I6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG9wY29kZSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJLy9JbmNyZW1lbnQgdGhlIHByb2dyYW0gY291bnRlciB0byB0aGUgbmV4dCBpbnN0cnVjdGlvbjoKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkY7CgkJLy9HZXQgaG93IG1hbnkgQ1BVIGN5Y2xlcyB0aGUgY3VycmVudCAweENCWFggb3AgY29kZSBjb3VudHMgZm9yOgoJCXBhcmVudE9iai5DUFVUaWNrcyArPSBwYXJlbnRPYmouU2Vjb25kYXJ5VElDS1RhYmxlW29wY29kZV07CgkJLy9FeGVjdXRlIHNlY29uZGFyeSBPUCBjb2RlcyBmb3IgdGhlIDB4Q0IgT1AgY29kZSBjYWxsLgoJCXBhcmVudE9iai5DQk9QQ09ERVtvcGNvZGVdKHBhcmVudE9iaik7Cgl9LAoJLy9DQUxMIEZaLCBubgoJLy8jMHhDQzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlpZiAocGFyZW50T2JqLkZaZXJvKSB7CgkJCXZhciB0ZW1wX3BjID0gKHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMikgJiAweEZGRkY7CgkJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID4+IDgpOwoJCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciAmIDB4RkYpOwoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSB0ZW1wX3BjOwoJCQlwYXJlbnRPYmouQ1BVVGlja3MgKz0gMTI7CgkJfQoJCWVsc2UgewoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMikgJiAweEZGRkY7CgkJfQoJfSwKCS8vQ0FMTCBubgoJLy8jMHhDRDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF9wYyA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMikgJiAweEZGRkY7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciA+PiA4KTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyICYgMHhGRik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gdGVtcF9wYzsKCX0sCgkvL0FEQyBBLCBuCgkvLyMweENFOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wVmFsdWUgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBICsgdGVtcFZhbHVlICsgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgKyAodGVtcFZhbHVlICYgMHhGKSArICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCkgPiAweEYpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPiAweEZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gZGlydHlTdW0gJiAweEZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0sCgkvL1JTVCAweDgKCS8vIzB4Q0Y6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciA+PiA4KTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyICYgMHhGRik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gMHg4OwoJfSwKCS8vUkVUICFGQwoJLy8jMHhEMDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlpZiAoIXBhcmVudE9iai5GQ2FycnkpIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIpOwoJCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAyKSAmIDB4RkZGRjsKCQkJcGFyZW50T2JqLkNQVVRpY2tzICs9IDEyOwoJCX0KCX0sCgkvL1BPUCBERQoJLy8jMHhEMToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIpOwoJCXBhcmVudE9iai5yZWdpc3RlckQgPSBwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnN0YWNrUG9pbnRlciArIDEpICYgMHhGRkZGKTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvL0pQICFGQywgbm4KCS8vIzB4RDI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKCFwYXJlbnRPYmouRkNhcnJ5KSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQkJcGFyZW50T2JqLkNQVVRpY2tzICs9IDQ7CgkJfQoJCWVsc2UgewoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMikgJiAweEZGRkY7CgkJfQoJfSwKCS8vMHhEMyAtIElsbGVnYWwKCS8vIzB4RDM6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJY291dCgiSWxsZWdhbCBvcCBjb2RlIDB4RDMgY2FsbGVkLCBwYXVzaW5nIGVtdWxhdGlvbi4iLCAyKTsKCQlwYXVzZSgpOwoJfSwKCS8vQ0FMTCAhRkMsIG5uCgkvLyMweEQ0OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWlmICghcGFyZW50T2JqLkZDYXJyeSkgewoJCQl2YXIgdGVtcF9wYyA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDIpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciA+PiA4KTsKCQkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgJiAweEZGKTsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gdGVtcF9wYzsKCQkJcGFyZW50T2JqLkNQVVRpY2tzICs9IDEyOwoJCX0KCQllbHNlIHsKCQkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDIpICYgMHhGRkZGOwoJCX0KCX0sCgkvL1BVU0ggREUKCS8vIzB4RDU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5yZWdpc3RlckQpOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucmVnaXN0ZXJFKTsKCX0sCgkvL1NVQiBBLCBuCgkvLyMweEQ2OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBkaXJ0eVN1bSA9IHBhcmVudE9iai5yZWdpc3RlckEgLSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikgPCAoZGlydHlTdW0gJiAweEYpKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKGRpcnR5U3VtIDwgMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IGRpcnR5U3VtICYgMHhGRjsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9SU1QgMHgxMAoJLy8jMHhENzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID4+IDgpOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgJiAweEZGKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAweDEwOwoJfSwKCS8vUkVUIEZDCgkvLyMweEQ4OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWlmIChwYXJlbnRPYmouRkNhcnJ5KSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnN0YWNrUG9pbnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyKTsKCQkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgMikgJiAweEZGRkY7CgkJCXBhcmVudE9iai5DUFVUaWNrcyArPSAxMjsKCQl9Cgl9LAoJLy9SRVRJCgkvLyMweEQ5OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnN0YWNrUG9pbnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyKTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAyKSAmIDB4RkZGRjsKCQkvL0ltbWVkaWF0ZSBmb3IgSEFMVDoKCQlwYXJlbnRPYmouSVJRRW5hYmxlRGVsYXkgPSAocGFyZW50T2JqLklSUUVuYWJsZURlbGF5ID09IDIgfHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKSA9PSAweDc2KSA/IDEgOiAyOwoJfSwKCS8vSlAgRkMsIG5uCgkvLyMweERBOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWlmIChwYXJlbnRPYmouRkNhcnJ5KSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQkJcGFyZW50T2JqLkNQVVRpY2tzICs9IDQ7CgkJfQoJCWVsc2UgewoJCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMikgJiAweEZGRkY7CgkJfQoJfSwKCS8vMHhEQiAtIElsbGVnYWwKCS8vIzB4REI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJY291dCgiSWxsZWdhbCBvcCBjb2RlIDB4REIgY2FsbGVkLCBwYXVzaW5nIGVtdWxhdGlvbi4iLCAyKTsKCQlwYXVzZSgpOwoJfSwKCS8vQ0FMTCBGQywgbm4KCS8vIzB4REM6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJaWYgKHBhcmVudE9iai5GQ2FycnkpIHsKCQkJdmFyIHRlbXBfcGMgPSAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCQkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPj4gOCk7CgkJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyICYgMHhGRik7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IHRlbXBfcGM7CgkJCXBhcmVudE9iai5DUFVUaWNrcyArPSAxMjsKCQl9CgkJZWxzZSB7CgkJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCQl9Cgl9LAoJLy8weEREIC0gSWxsZWdhbAoJLy8jMHhERDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQljb3V0KCJJbGxlZ2FsIG9wIGNvZGUgMHhERCBjYWxsZWQsIHBhdXNpbmcgZW11bGF0aW9uLiIsIDIpOwoJCXBhdXNlKCk7Cgl9LAoJLy9TQkMgQSwgbgoJLy8jMHhERToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YXIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQl2YXIgZGlydHlTdW0gPSBwYXJlbnRPYmoucmVnaXN0ZXJBIC0gdGVtcF92YXIgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSAtICh0ZW1wX3ZhciAmIDB4RikgLSAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApIDwgMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChkaXJ0eVN1bSA8IDApOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSBkaXJ0eVN1bSAmIDB4RkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9SU1QgMHgxOAoJLy8jMHhERjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID4+IDgpOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgJiAweEZGKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAweDE4OwoJfSwKCS8vTERIIChuKSwgQQoJLy8jMHhFMDoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5SGlnaFdyaXRlKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciksIHBhcmVudE9iai5yZWdpc3RlckEpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCX0sCgkvL1BPUCBITAoJLy8jMHhFMToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAxKSAmIDB4RkZGRikgPDwgOCkgfCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlcik7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgMikgJiAweEZGRkY7Cgl9LAoJLy9MRCAoMHhGRjAwICsgQyksIEEKCS8vIzB4RTI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeUhpZ2hXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyQ10ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJDLCBwYXJlbnRPYmoucmVnaXN0ZXJBKTsKCX0sCgkvLzB4RTMgLSBJbGxlZ2FsCgkvLyMweEUzOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEUzIGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvLzB4RTQgLSBJbGxlZ2FsCgkvLyMweEU0OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEU0IGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvL1BVU0ggSEwKCS8vIzB4RTU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5yZWdpc3RlcnNITCA+PiA4KTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRik7Cgl9LAoJLy9BTkQgbgoJLy8jMHhFNjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IGZhbHNlOwoJfSwKCS8vUlNUIDB4MjAKCS8vIzB4RTc6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciA+PiA4KTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyICYgMHhGRik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gMHgyMDsKCX0sCgkvL0FERCBTUCwgbgoJLy8jMHhFODoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YWx1ZTIgPSAocGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKSA8PCAyNCkgPj4gMjQ7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCXZhciB0ZW1wX3ZhbHVlID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyB0ZW1wX3ZhbHVlMikgJiAweEZGRkY7CgkJdGVtcF92YWx1ZTIgPSBwYXJlbnRPYmouc3RhY2tQb2ludGVyIF4gdGVtcF92YWx1ZTIgXiB0ZW1wX3ZhbHVlOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSB0ZW1wX3ZhbHVlOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHRlbXBfdmFsdWUyICYgMHgxMDApID09IDB4MTAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgodGVtcF92YWx1ZTIgJiAweDEwKSA9PSAweDEwKTsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9KUCwgKEhMKQoJLy8jMHhFOToKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSBwYXJlbnRPYmoucmVnaXN0ZXJzSEw7Cgl9LAoJLy9MRCBuLCBBCgkvLyMweEVBOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZSgocGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGKSA8PCA4KSB8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciksIHBhcmVudE9iai5yZWdpc3RlckEpOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAyKSAmIDB4RkZGRjsKCX0sCgkvLzB4RUIgLSBJbGxlZ2FsCgkvLyMweEVCOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEVCIGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvLzB4RUMgLSBJbGxlZ2FsCgkvLyMweEVDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEVDIGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvLzB4RUQgLSBJbGxlZ2FsCgkvLyMweEVEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEVEIGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvL1hPUiBuCgkvLyMweEVFOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgXj0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckEgPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZDYXJyeSA9IGZhbHNlOwoJfSwKCS8vUlNUIDB4MjgKCS8vIzB4RUY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5wcm9ncmFtQ291bnRlciA+PiA4KTsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyICYgMHhGRik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gMHgyODsKCX0sCgkvL0xESCBBLCAobikKCS8vIzB4RjA6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5tZW1vcnlIaWdoUmVhZChwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkY7Cgl9LAoJLy9QT1AgQUYKCS8vIzB4RjE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIpOwoJCXBhcmVudE9iai5GWmVybyA9ICh0ZW1wX3ZhciA+IDB4N0YpOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSAoKHRlbXBfdmFyICYgMHg0MCkgPT0gMHg0MCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSAoKHRlbXBfdmFyICYgMHgyMCkgPT0gMHgyMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgodGVtcF92YXIgJiAweDEwKSA9PSAweDEwKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gcGFyZW50T2JqLm1lbW9yeVJlYWQoKHBhcmVudE9iai5zdGFja1BvaW50ZXIgKyAxKSAmIDB4RkZGRik7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgMikgJiAweEZGRkY7Cgl9LAoJLy9MRCBBLCAoMHhGRjAwICsgQykKCS8vIzB4RjI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5tZW1vcnlIaWdoUmVhZGVyW3BhcmVudE9iai5yZWdpc3RlckNdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyQyk7Cgl9LAoJLy9ESQoJLy8jMHhGMzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouSU1FID0gZmFsc2U7CgkJcGFyZW50T2JqLklSUUVuYWJsZURlbGF5ID0gMDsKCX0sCgkvLzB4RjQgLSBJbGxlZ2FsCgkvLyMweEY0OgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEY0IGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvL1BVU0ggQUYKCS8vIzB4RjU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyIC0gMSkgJiAweEZGRkY7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmouc3RhY2tQb2ludGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5zdGFja1BvaW50ZXIsIHBhcmVudE9iai5yZWdpc3RlckEpOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCAoKHBhcmVudE9iai5GWmVybykgPyAweDgwIDogMCkgfCAoKHBhcmVudE9iai5GU3VidHJhY3QpID8gMHg0MCA6IDApIHwgKChwYXJlbnRPYmouRkhhbGZDYXJyeSkgPyAweDIwIDogMCkgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMHgxMCA6IDApKTsKCX0sCgkvL09SIG4KCS8vIzB4RjY6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSB8PSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5wcm9ncmFtQ291bnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIpOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5wcm9ncmFtQ291bnRlciA9IChwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgKyAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gZmFsc2U7Cgl9LAoJLy9SU1QgMHgzMAoJLy8jMHhGNzoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID4+IDgpOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgJiAweEZGKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAweDMwOwoJfSwKCS8vTERITCBTUCwgbgoJLy8jMHhGODoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YXIgPSAocGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKSA8PCAyNCkgPj4gMjQ7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmouc3RhY2tQb2ludGVyICsgdGVtcF92YXIpICYgMHhGRkZGOwoJCXRlbXBfdmFyID0gcGFyZW50T2JqLnN0YWNrUG9pbnRlciBeIHRlbXBfdmFyIF4gcGFyZW50T2JqLnJlZ2lzdGVyc0hMOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHRlbXBfdmFyICYgMHgxMDApID09IDB4MTAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9ICgodGVtcF92YXIgJiAweDEwKSA9PSAweDEwKTsKCQlwYXJlbnRPYmouRlplcm8gPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7Cgl9LAoJLy9MRCBTUCwgSEwKCS8vIzB4Rjk6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnN0YWNrUG9pbnRlciA9IHBhcmVudE9iai5yZWdpc3RlcnNITDsKCX0sCgkvL0xEIEEsIChubikKCS8vIzB4RkE6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9IHBhcmVudE9iai5tZW1vcnlSZWFkKChwYXJlbnRPYmoubWVtb3J5UmVhZCgocGFyZW50T2JqLnByb2dyYW1Db3VudGVyICsgMSkgJiAweEZGRkYpIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyKSk7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDIpICYgMHhGRkZGOwoJfSwKCS8vRUkKCS8vIzB4RkI6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJLy9JbW1lZGlhdGUgZm9yIEhBTFQ6CgkJcGFyZW50T2JqLklSUUVuYWJsZURlbGF5ID0gKHBhcmVudE9iai5JUlFFbmFibGVEZWxheSA9PSAyIHx8IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcikgPT0gMHg3NikgPyAxIDogMjsKCX0sCgkvLzB4RkMgLSBJbGxlZ2FsCgkvLyMweEZDOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEZDIGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvLzB4RkQgLSBJbGxlZ2FsCgkvLyMweEZEOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCWNvdXQoIklsbGVnYWwgb3AgY29kZSAweEZEIGNhbGxlZCwgcGF1c2luZyBlbXVsYXRpb24uIiwgMik7CgkJcGF1c2UoKTsKCX0sCgkvL0NQIG4KCS8vIzB4RkU6CglmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIGRpcnR5U3VtID0gcGFyZW50T2JqLnJlZ2lzdGVyQSAtIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnByb2dyYW1Db3VudGVyXShwYXJlbnRPYmosIHBhcmVudE9iai5wcm9ncmFtQ291bnRlcik7CgkJcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID0gKHBhcmVudE9iai5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gKChkaXJ0eVN1bSAmIDB4RikgPiAocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4RikpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoZGlydHlTdW0gPCAwKTsKCQlwYXJlbnRPYmouRlplcm8gPSAoZGlydHlTdW0gPT0gMCk7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IHRydWU7Cgl9LAoJLy9SU1QgMHgzOAoJLy8jMHhGRjoKCWZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouc3RhY2tQb2ludGVyID0gKHBhcmVudE9iai5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5zdGFja1BvaW50ZXJdKHBhcmVudE9iaiwgcGFyZW50T2JqLnN0YWNrUG9pbnRlciwgcGFyZW50T2JqLnByb2dyYW1Db3VudGVyID4+IDgpOwoJCXBhcmVudE9iai5zdGFja1BvaW50ZXIgPSAocGFyZW50T2JqLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnN0YWNrUG9pbnRlcl0ocGFyZW50T2JqLCBwYXJlbnRPYmouc3RhY2tQb2ludGVyLCBwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgJiAweEZGKTsKCQlwYXJlbnRPYmoucHJvZ3JhbUNvdW50ZXIgPSAweDM4OwoJfQpdOwpHYW1lQm95Q29yZS5wcm90b3R5cGUuQ0JPUENPREUgPSBbCgkvL1JMQyBCCgkvLyMweDAwOgoJZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyQiA+IDB4N0YpOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAoKHBhcmVudE9iai5yZWdpc3RlckIgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckIgPT0gMCk7Cgl9CgkvL1JMQyBDCgkvLyMweDAxOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckMgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDID0gKChwYXJlbnRPYmoucmVnaXN0ZXJDIDw8IDEpICYgMHhGRikgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJDID09IDApOwoJfQoJLy9STEMgRAoJLy8jMHgwMjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChwYXJlbnRPYmoucmVnaXN0ZXJEID4gMHg3Rik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRCA8PCAxKSAmIDB4RkYpIHwgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRCA9PSAwKTsKCX0KCS8vUkxDIEUKCS8vIzB4MDM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyRSA+IDB4N0YpOwoJCXBhcmVudE9iai5yZWdpc3RlckUgPSAoKHBhcmVudE9iai5yZWdpc3RlckUgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckUgPT0gMCk7Cgl9CgkvL1JMQyBICgkvLyMweDA0OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA+IDB4N0ZGRik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPDwgMSkgJiAweEZFMDApIHwgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDB4MTAwIDogMCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRik7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA8IDB4MTAwKTsKCX0KCS8vUkxDIEwKCS8vIzB4MDU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4ODApID09IDB4ODApOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKSA9PSAwKTsKCX0KCS8vUkxDIChITCkKCS8vIzB4MDY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wX3ZhciA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICh0ZW1wX3ZhciA+IDB4N0YpOwoJCXRlbXBfdmFyID0gKCh0ZW1wX3ZhciA8PCAxKSAmIDB4RkYpIHwgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHRlbXBfdmFyKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAodGVtcF92YXIgPT0gMCk7Cgl9CgkvL1JMQyBBCgkvLyMweDA3OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckEgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBIDw8IDEpICYgMHhGRikgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJfQoJLy9SUkMgQgoJLy8jMHgwODoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHBhcmVudE9iai5yZWdpc3RlckIgPj4gMSk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckIgPT0gMCk7Cgl9CgkvL1JSQyBDCgkvLyMweDA5OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJDICYgMHgwMSkgPT0gMHgwMSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyA9ICgocGFyZW50T2JqLkZDYXJyeSkgPyAweDgwIDogMCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyQyA+PiAxKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA9PSAwKTsKCX0KCS8vUlJDIEQKCS8vIzB4MEE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gKChwYXJlbnRPYmouRkNhcnJ5KSA/IDB4ODAgOiAwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJEID4+IDEpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJEID09IDApOwoJfQoJLy9SUkMgRQoJLy8jMHgwQjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckUgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHBhcmVudE9iai5yZWdpc3RlckUgPj4gMSk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckUgPT0gMCk7Cgl9CgkvL1JSQyBICgkvLyMweDBDOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDAxMDApID09IDB4MDEwMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKChwYXJlbnRPYmouRkNhcnJ5KSA/IDB4ODAwMCA6IDApIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gMSkgJiAweEZGMDApIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPCAweDEwMCk7Cgl9CgkvL1JSQyBMCgkvLyMweDBEOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjAwKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAweDgwIDogMCkgfCAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpID4+IDEpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRikgPT0gMCk7Cgl9CgkvL1JSQyAoSEwpCgkvLyMweDBFOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YXIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHRlbXBfdmFyICYgMHgwMSkgPT0gMHgwMSk7CgkJdGVtcF92YXIgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHRlbXBfdmFyID4+IDEpOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgdGVtcF92YXIpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICh0ZW1wX3ZhciA9PSAwKTsKCX0KCS8vUlJDIEEKCS8vIzB4MEY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKChwYXJlbnRPYmouRkNhcnJ5KSA/IDB4ODAgOiAwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJBID4+IDEpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJfQoJLy9STCBCCgkvLyMweDEwOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgbmV3RkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckIgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCID0gKChwYXJlbnRPYmoucmVnaXN0ZXJCIDw8IDEpICYgMHhGRikgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSBuZXdGQ2Fycnk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckIgPT0gMCk7Cgl9CgkvL1JMIEMKCS8vIzB4MTE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBuZXdGQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA+IDB4N0YpOwoJCXBhcmVudE9iai5yZWdpc3RlckMgPSAoKHBhcmVudE9iai5yZWdpc3RlckMgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA9PSAwKTsKCX0KCS8vUkwgRAoJLy8jMHgxMjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG5ld0ZDYXJyeSA9IChwYXJlbnRPYmoucmVnaXN0ZXJEID4gMHg3Rik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRCA8PCAxKSAmIDB4RkYpIHwgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDEgOiAwKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gbmV3RkNhcnJ5OwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJEID09IDApOwoJfQoJLy9STCBFCgkvLyMweDEzOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgbmV3RkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckUgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID0gKChwYXJlbnRPYmoucmVnaXN0ZXJFIDw8IDEpICYgMHhGRikgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMSA6IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSBuZXdGQ2Fycnk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckUgPT0gMCk7Cgl9CgkvL1JMIEgKCS8vIzB4MTQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBuZXdGQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMID4gMHg3RkZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCA8PCAxKSAmIDB4RkUwMCkgfCAoKHBhcmVudE9iai5GQ2FycnkpID8gMHgxMDAgOiAwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gbmV3RkNhcnJ5OwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPCAweDEwMCk7Cgl9CgkvL1JMIEwKCS8vIzB4MTU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBuZXdGQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4ODApID09IDB4ODApOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpID09IDApOwoJfQoJLy9STCAoSEwpCgkvLyMweDE2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YXIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXZhciBuZXdGQ2FycnkgPSAodGVtcF92YXIgPiAweDdGKTsKCQl0ZW1wX3ZhciA9ICgodGVtcF92YXIgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHRlbXBfdmFyKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAodGVtcF92YXIgPT0gMCk7Cgl9CgkvL1JMIEEKCS8vIzB4MTc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBuZXdGQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA+IDB4N0YpOwoJCXBhcmVudE9iai5yZWdpc3RlckEgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgPDwgMSkgJiAweEZGKSB8ICgocGFyZW50T2JqLkZDYXJyeSkgPyAxIDogMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCX0KCS8vUlIgQgoJLy8jMHgxODoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG5ld0ZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHBhcmVudE9iai5yZWdpc3RlckIgPj4gMSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQiA9PSAwKTsKCX0KCS8vUlIgQwoJLy8jMHgxOToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG5ld0ZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckMgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHBhcmVudE9iai5yZWdpc3RlckMgPj4gMSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA9PSAwKTsKCX0KCS8vUlIgRAoJLy8jMHgxQToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG5ld0ZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRCAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckQgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHBhcmVudE9iai5yZWdpc3RlckQgPj4gMSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRCA9PSAwKTsKCX0KCS8vUlIgRQoJLy8jMHgxQjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG5ld0ZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckUgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHBhcmVudE9iai5yZWdpc3RlckUgPj4gMSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRSA9PSAwKTsKCX0KCS8vUlIgSAoJLy8jMHgxQzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIG5ld0ZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMTAwKSA9PSAweDAxMDApOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9ICgocGFyZW50T2JqLkZDYXJyeSkgPyAweDgwMDAgOiAwKSB8ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDEpICYgMHhGRjAwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gbmV3RkNhcnJ5OwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPCAweDEwMCk7Cgl9CgkvL1JSIEwKCS8vIzB4MUQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciBuZXdGQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgKChwYXJlbnRPYmouRkNhcnJ5KSA/IDB4ODAgOiAwKSB8ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRikgPj4gMSk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IG5ld0ZDYXJyeTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpID09IDApOwoJfQoJLy9SUiAoSEwpCgkvLyMweDFFOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YXIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXZhciBuZXdGQ2FycnkgPSAoKHRlbXBfdmFyICYgMHgwMSkgPT0gMHgwMSk7CgkJdGVtcF92YXIgPSAoKHBhcmVudE9iai5GQ2FycnkpID8gMHg4MCA6IDApIHwgKHRlbXBfdmFyID4+IDEpOwoJCXBhcmVudE9iai5GQ2FycnkgPSBuZXdGQ2Fycnk7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCB0ZW1wX3Zhcik7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHRlbXBfdmFyID09IDApOwoJfQoJLy9SUiBBCgkvLyMweDFGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgbmV3RkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHgwMSkgPT0gMHgwMSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA9ICgocGFyZW50T2JqLkZDYXJyeSkgPyAweDgwIDogMCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyQSA+PiAxKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gbmV3RkNhcnJ5OwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJfQoJLy9TTEEgQgoJLy8jMHgyMDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChwYXJlbnRPYmoucmVnaXN0ZXJCID4gMHg3Rik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiA9IChwYXJlbnRPYmoucmVnaXN0ZXJCIDw8IDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQiA9PSAwKTsKCX0KCS8vU0xBIEMKCS8vIzB4MjE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA+IDB4N0YpOwoJCXBhcmVudE9iai5yZWdpc3RlckMgPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA8PCAxKSAmIDB4RkY7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckMgPT0gMCk7Cgl9CgkvL1NMQSBECgkvLyMweDIyOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckQgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gKHBhcmVudE9iai5yZWdpc3RlckQgPDwgMSkgJiAweEZGOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJEID09IDApOwoJfQoJLy9TTEEgRQoJLy8jMHgyMzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9IChwYXJlbnRPYmoucmVnaXN0ZXJFID4gMHg3Rik7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSA9IChwYXJlbnRPYmoucmVnaXN0ZXJFIDw8IDEpICYgMHhGRjsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRSA9PSAwKTsKCX0KCS8vU0xBIEgKCS8vIzB4MjQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMID4gMHg3RkZGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCA8PCAxKSAmIDB4RkUwMCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRik7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA8IDB4MTAwKTsKCX0KCS8vU0xBIEwKCS8vIzB4MjU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MDA4MCkgPT0gMHgwMDgwKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjAwKSB8ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMIDw8IDEpICYgMHhGRik7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKSA9PSAwKTsKCX0KCS8vU0xBIChITCkKCS8vIzB4MjY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wX3ZhciA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICh0ZW1wX3ZhciA+IDB4N0YpOwoJCXRlbXBfdmFyID0gKHRlbXBfdmFyIDw8IDEpICYgMHhGRjsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHRlbXBfdmFyKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAodGVtcF92YXIgPT0gMCk7Cgl9CgkvL1NMQSBBCgkvLyMweDI3OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKHBhcmVudE9iai5yZWdpc3RlckEgPiAweDdGKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKHBhcmVudE9iai5yZWdpc3RlckEgPDwgMSkgJiAweEZGOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJfQoJLy9TUkEgQgoJLy8jMHgyODoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4ODApIHwgKHBhcmVudE9iai5yZWdpc3RlckIgPj4gMSk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckIgPT0gMCk7Cgl9CgkvL1NSQSBDCgkvLyMweDI5OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJDICYgMHgwMSkgPT0gMHgwMSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyA9IChwYXJlbnRPYmoucmVnaXN0ZXJDICYgMHg4MCkgfCAocGFyZW50T2JqLnJlZ2lzdGVyQyA+PiAxKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQyA9PSAwKTsKCX0KCS8vU1JBIEQKCS8vIzB4MkE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEID0gKHBhcmVudE9iai5yZWdpc3RlckQgJiAweDgwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJEID4+IDEpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJEID09IDApOwoJfQoJLy9TUkEgRQoJLy8jMHgyQjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckUgPSAocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4ODApIHwgKHBhcmVudE9iai5yZWdpc3RlckUgPj4gMSk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckUgPT0gMCk7Cgl9CgkvL1NSQSBICgkvLyMweDJDOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDAxMDApID09IDB4MDEwMCk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPj4gMSkgJiAweEZGMDApIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4ODBGRik7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlcnNITCA8IDB4MTAwKTsKCX0KCS8vU1JBIEwKCS8vIzB4MkQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MDAwMSkgPT0gMHgwMDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRjgwKSB8ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGRikgPj4gMSk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKSA9PSAwKTsKCX0KCS8vU1JBIChITCkKCS8vIzB4MkU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXZhciB0ZW1wX3ZhciA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgodGVtcF92YXIgJiAweDAxKSA9PSAweDAxKTsKCQl0ZW1wX3ZhciA9ICh0ZW1wX3ZhciAmIDB4ODApIHwgKHRlbXBfdmFyID4+IDEpOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgdGVtcF92YXIpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICh0ZW1wX3ZhciA9PSAwKTsKCX0KCS8vU1JBIEEKCS8vIzB4MkY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKHBhcmVudE9iai5yZWdpc3RlckEgJiAweDgwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJBID4+IDEpOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJfQoJLy9TV0FQIEIKCS8vIzB4MzA6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgPSAoKHBhcmVudE9iai5yZWdpc3RlckIgJiAweEYpIDw8IDQpIHwgKHBhcmVudE9iai5yZWdpc3RlckIgPj4gNCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckIgPT0gMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfQoJLy9TV0FQIEMKCS8vIzB4MzE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgPSAoKHBhcmVudE9iai5yZWdpc3RlckMgJiAweEYpIDw8IDQpIHwgKHBhcmVudE9iai5yZWdpc3RlckMgPj4gNCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckMgPT0gMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfQoJLy9TV0FQIEQKCS8vIzB4MzI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweEYpIDw8IDQpIHwgKHBhcmVudE9iai5yZWdpc3RlckQgPj4gNCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckQgPT0gMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfQoJLy9TV0FQIEUKCS8vIzB4MzM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgPSAoKHBhcmVudE9iai5yZWdpc3RlckUgJiAweEYpIDw8IDQpIHwgKHBhcmVudE9iai5yZWdpc3RlckUgPj4gNCk7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckUgPT0gMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfQoJLy9TV0FQIEgKCS8vIzB4MzQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHhGMDApIDw8IDQpIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEYwMDApID4+IDQpIHwgKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgPCAweDEwMCk7CgkJcGFyZW50T2JqLkZDYXJyeSA9IHBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJfQoJLy9TV0FQIEwKCS8vIzB4MzU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEYpIDw8IDQpIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEYwKSA+PiA0KTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpID09IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSBwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0KCS8vU1dBUCAoSEwpCgkvLyMweDM2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQl2YXIgdGVtcF92YXIgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpOwoJCXRlbXBfdmFyID0gKCh0ZW1wX3ZhciAmIDB4RikgPDwgNCkgfCAodGVtcF92YXIgPj4gNCk7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCB0ZW1wX3Zhcik7CgkJcGFyZW50T2JqLkZaZXJvID0gKHRlbXBfdmFyID09IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSBwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0KCS8vU1dBUCBBCgkvLyMweDM3OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHhGKSA8PCA0KSB8IChwYXJlbnRPYmoucmVnaXN0ZXJBID4+IDQpOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJBID09IDApOwoJCXBhcmVudE9iai5GQ2FycnkgPSBwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCX0KCS8vU1JMIEIKCS8vIzB4Mzg6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckIgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCID4+PSAxOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJCID09IDApOwoJfQoJLy9TUkwgQwoJLy8jMHgzOToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5yZWdpc3RlckMgPj49IDE7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHBhcmVudE9iai5yZWdpc3RlckMgPT0gMCk7Cgl9CgkvL1NSTCBECgkvLyMweDNBOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJEICYgMHgwMSkgPT0gMHgwMSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCA+Pj0gMTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyRCA9PSAwKTsKCX0KCS8vU1JMIEUKCS8vIzB4M0I6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GQ2FycnkgPSAoKHBhcmVudE9iai5yZWdpc3RlckUgJiAweDAxKSA9PSAweDAxKTsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFID4+PSAxOwoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9IChwYXJlbnRPYmoucmVnaXN0ZXJFID09IDApOwoJfQoJLy9TUkwgSAoJLy8jMHgzQzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMTAwKSA9PSAweDAxMDApOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMID4+IDEpICYgMHhGRjAwKSB8IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyc0hMIDwgMHgxMDApOwoJfQoJLy9TUkwgTAoJLy8jMHgzRDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZDYXJyeSA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMDAxKSA9PSAweDAwMDEpOwoJCXBhcmVudE9iai5yZWdpc3RlcnNITCA9IChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGMDApIHwgKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweEZGKSA+PiAxKTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4RkYpID09IDApOwoJfQoJLy9TUkwgKEhMKQoJLy8jMHgzRToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJdmFyIHRlbXBfdmFyID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKTsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKCh0ZW1wX3ZhciAmIDB4MDEpID09IDB4MDEpOwoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgdGVtcF92YXIgPj4gMSk7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSBwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKHRlbXBfdmFyIDwgMik7Cgl9CgkvL1NSTCBBCgkvLyMweDNGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkNhcnJ5ID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHgwMSkgPT0gMHgwMSk7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSA+Pj0gMTsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAocGFyZW50T2JqLnJlZ2lzdGVyQSA9PSAwKTsKCX0KCS8vQklUIDAsIEIKCS8vIzB4NDA6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJCICYgMHgwMSkgPT0gMCk7Cgl9CgkvL0JJVCAwLCBDCgkvLyMweDQxOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4MDEpID09IDApOwoJfQoJLy9CSVQgMCwgRAoJLy8jMHg0MjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweDAxKSA9PSAwKTsKCX0KCS8vQklUIDAsIEUKCS8vIzB4NDM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJFICYgMHgwMSkgPT0gMCk7Cgl9CgkvL0JJVCAwLCBICgkvLyMweDQ0OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMTAwKSA9PSAwKTsKCX0KCS8vQklUIDAsIEwKCS8vIzB4NDU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDAwMDEpID09IDApOwoJfQoJLy9CSVQgMCwgKEhMKQoJLy8jMHg0NjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgJiAweDAxKSA9PSAwKTsKCX0KCS8vQklUIDAsIEEKCS8vIzB4NDc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHgwMSkgPT0gMCk7Cgl9CgkvL0JJVCAxLCBCCgkvLyMweDQ4OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4MDIpID09IDApOwoJfQoJLy9CSVQgMSwgQwoJLy8jMHg0OToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckMgJiAweDAyKSA9PSAwKTsKCX0KCS8vQklUIDEsIEQKCS8vIzB4NEE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJEICYgMHgwMikgPT0gMCk7Cgl9CgkvL0JJVCAxLCBFCgkvLyMweDRCOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4MDIpID09IDApOwoJfQoJLy9CSVQgMSwgSAoJLy8jMHg0QzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MDIwMCkgPT0gMCk7Cgl9CgkvL0JJVCAxLCBMCgkvLyMweDREOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMDAyKSA9PSAwKTsKCX0KCS8vQklUIDEsIChITCkKCS8vIzB4NEU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpICYgMHgwMikgPT0gMCk7Cgl9CgkvL0JJVCAxLCBBCgkvLyMweDRGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4MDIpID09IDApOwoJfQoJLy9CSVQgMiwgQgoJLy8jMHg1MDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckIgJiAweDA0KSA9PSAwKTsKCX0KCS8vQklUIDIsIEMKCS8vIzB4NTE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJDICYgMHgwNCkgPT0gMCk7Cgl9CgkvL0JJVCAyLCBECgkvLyMweDUyOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRCAmIDB4MDQpID09IDApOwoJfQoJLy9CSVQgMiwgRQoJLy8jMHg1MzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckUgJiAweDA0KSA9PSAwKTsKCX0KCS8vQklUIDIsIEgKCS8vIzB4NTQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDA0MDApID09IDApOwoJfQoJLy9CSVQgMiwgTAoJLy8jMHg1NToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MDAwNCkgPT0gMCk7Cgl9CgkvL0JJVCAyLCAoSEwpCgkvLyMweDU2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSAmIDB4MDQpID09IDApOwoJfQoJLy9CSVQgMiwgQQoJLy8jMHg1NzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweDA0KSA9PSAwKTsKCX0KCS8vQklUIDMsIEIKCS8vIzB4NTg6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJCICYgMHgwOCkgPT0gMCk7Cgl9CgkvL0JJVCAzLCBDCgkvLyMweDU5OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4MDgpID09IDApOwoJfQoJLy9CSVQgMywgRAoJLy8jMHg1QToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweDA4KSA9PSAwKTsKCX0KCS8vQklUIDMsIEUKCS8vIzB4NUI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJFICYgMHgwOCkgPT0gMCk7Cgl9CgkvL0JJVCAzLCBICgkvLyMweDVDOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwODAwKSA9PSAwKTsKCX0KCS8vQklUIDMsIEwKCS8vIzB4NUQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDAwMDgpID09IDApOwoJfQoJLy9CSVQgMywgKEhMKQoJLy8jMHg1RToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgJiAweDA4KSA9PSAwKTsKCX0KCS8vQklUIDMsIEEKCS8vIzB4NUY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHgwOCkgPT0gMCk7Cgl9CgkvL0JJVCA0LCBCCgkvLyMweDYwOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4MTApID09IDApOwoJfQoJLy9CSVQgNCwgQwoJLy8jMHg2MToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckMgJiAweDEwKSA9PSAwKTsKCX0KCS8vQklUIDQsIEQKCS8vIzB4NjI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJEICYgMHgxMCkgPT0gMCk7Cgl9CgkvL0JJVCA0LCBFCgkvLyMweDYzOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4MTApID09IDApOwoJfQoJLy9CSVQgNCwgSAoJLy8jMHg2NDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MTAwMCkgPT0gMCk7Cgl9CgkvL0JJVCA0LCBMCgkvLyMweDY1OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMDEwKSA9PSAwKTsKCX0KCS8vQklUIDQsIChITCkKCS8vIzB4NjY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpICYgMHgxMCkgPT0gMCk7Cgl9CgkvL0JJVCA0LCBBCgkvLyMweDY3OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4MTApID09IDApOwoJfQoJLy9CSVQgNSwgQgoJLy8jMHg2ODoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckIgJiAweDIwKSA9PSAwKTsKCX0KCS8vQklUIDUsIEMKCS8vIzB4Njk6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJDICYgMHgyMCkgPT0gMCk7Cgl9CgkvL0JJVCA1LCBECgkvLyMweDZBOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRCAmIDB4MjApID09IDApOwoJfQoJLy9CSVQgNSwgRQoJLy8jMHg2QjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckUgJiAweDIwKSA9PSAwKTsKCX0KCS8vQklUIDUsIEgKCS8vIzB4NkM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDIwMDApID09IDApOwoJfQoJLy9CSVQgNSwgTAoJLy8jMHg2RDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4MDAyMCkgPT0gMCk7Cgl9CgkvL0JJVCA1LCAoSEwpCgkvLyMweDZFOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSAmIDB4MjApID09IDApOwoJfQoJLy9CSVQgNSwgQQoJLy8jMHg2RjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckEgJiAweDIwKSA9PSAwKTsKCX0KCS8vQklUIDYsIEIKCS8vIzB4NzA6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJCICYgMHg0MCkgPT0gMCk7Cgl9CgkvL0JJVCA2LCBDCgkvLyMweDcxOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQyAmIDB4NDApID09IDApOwoJfQoJLy9CSVQgNiwgRAoJLy8jMHg3MjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckQgJiAweDQwKSA9PSAwKTsKCX0KCS8vQklUIDYsIEUKCS8vIzB4NzM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJFICYgMHg0MCkgPT0gMCk7Cgl9CgkvL0JJVCA2LCBICgkvLyMweDc0OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHg0MDAwKSA9PSAwKTsKCX0KCS8vQklUIDYsIEwKCS8vIzB4NzU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJiAweDAwNDApID09IDApOwoJfQoJLy9CSVQgNiwgKEhMKQoJLy8jMHg3NjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgJiAweDQwKSA9PSAwKTsKCX0KCS8vQklUIDYsIEEKCS8vIzB4Nzc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJBICYgMHg0MCkgPT0gMCk7Cgl9CgkvL0JJVCA3LCBCCgkvLyMweDc4OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQiAmIDB4ODApID09IDApOwoJfQoJLy9CSVQgNywgQwoJLy8jMHg3OToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlckMgJiAweDgwKSA9PSAwKTsKCX0KCS8vQklUIDcsIEQKCS8vIzB4N0E6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoucmVnaXN0ZXJEICYgMHg4MCkgPT0gMCk7Cgl9CgkvL0JJVCA3LCBFCgkvLyMweDdCOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyRSAmIDB4ODApID09IDApOwoJfQoJLy9CSVQgNywgSAoJLy8jMHg3QzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLkZIYWxmQ2FycnkgPSB0cnVlOwoJCXBhcmVudE9iai5GU3VidHJhY3QgPSBmYWxzZTsKCQlwYXJlbnRPYmouRlplcm8gPSAoKHBhcmVudE9iai5yZWdpc3RlcnNITCAmIDB4ODAwMCkgPT0gMCk7Cgl9CgkvL0JJVCA3LCBMCgkvLyMweDdEOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyc0hMICYgMHgwMDgwKSA9PSAwKTsKCX0KCS8vQklUIDcsIChITCkKCS8vIzB4N0U6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5GSGFsZkNhcnJ5ID0gdHJ1ZTsKCQlwYXJlbnRPYmouRlN1YnRyYWN0ID0gZmFsc2U7CgkJcGFyZW50T2JqLkZaZXJvID0gKChwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpICYgMHg4MCkgPT0gMCk7Cgl9CgkvL0JJVCA3LCBBCgkvLyMweDdGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmouRkhhbGZDYXJyeSA9IHRydWU7CgkJcGFyZW50T2JqLkZTdWJ0cmFjdCA9IGZhbHNlOwoJCXBhcmVudE9iai5GWmVybyA9ICgocGFyZW50T2JqLnJlZ2lzdGVyQSAmIDB4ODApID09IDApOwoJfQoJLy9SRVMgMCwgQgoJLy8jMHg4MDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiAmPSAweEZFOwoJfQoJLy9SRVMgMCwgQwoJLy8jMHg4MToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyAmPSAweEZFOwoJfQoJLy9SRVMgMCwgRAoJLy8jMHg4MjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCAmPSAweEZFOwoJfQoJLy9SRVMgMCwgRQoJLy8jMHg4MzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSAmPSAweEZFOwoJfQoJLy9SRVMgMCwgSAoJLy8jMHg4NDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMICY9IDB4RkVGRjsKCX0KCS8vUkVTIDAsIEwKCS8vIzB4ODU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCAmPSAweEZGRkU7Cgl9CgkvL1JFUyAwLCAoSEwpCgkvLyMweDg2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgJiAweEZFKTsKCX0KCS8vUkVTIDAsIEEKCS8vIzB4ODc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgJj0gMHhGRTsKCX0KCS8vUkVTIDEsIEIKCS8vIzB4ODg6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgJj0gMHhGRDsKCX0KCS8vUkVTIDEsIEMKCS8vIzB4ODk6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgJj0gMHhGRDsKCX0KCS8vUkVTIDEsIEQKCS8vIzB4OEE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgJj0gMHhGRDsKCX0KCS8vUkVTIDEsIEUKCS8vIzB4OEI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgJj0gMHhGRDsKCX0KCS8vUkVTIDEsIEgKCS8vIzB4OEM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCAmPSAweEZERkY7Cgl9CgkvL1JFUyAxLCBMCgkvLyMweDhEOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJj0gMHhGRkZEOwoJfQoJLy9SRVMgMSwgKEhMKQoJLy8jMHg4RToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpICYgMHhGRCk7Cgl9CgkvL1JFUyAxLCBBCgkvLyMweDhGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IDB4RkQ7Cgl9CgkvL1JFUyAyLCBCCgkvLyMweDkwOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCICY9IDB4RkI7Cgl9CgkvL1JFUyAyLCBDCgkvLyMweDkxOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDICY9IDB4RkI7Cgl9CgkvL1JFUyAyLCBECgkvLyMweDkyOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEICY9IDB4RkI7Cgl9CgkvL1JFUyAyLCBFCgkvLyMweDkzOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFICY9IDB4RkI7Cgl9CgkvL1JFUyAyLCBICgkvLyMweDk0OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJj0gMHhGQkZGOwoJfQoJLy9SRVMgMiwgTAoJLy8jMHg5NToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMICY9IDB4RkZGQjsKCX0KCS8vUkVTIDIsIChITCkKCS8vIzB4OTY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSAmIDB4RkIpOwoJfQoJLy9SRVMgMiwgQQoJLy8jMHg5NzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSAmPSAweEZCOwoJfQoJLy9SRVMgMywgQgoJLy8jMHg5ODoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiAmPSAweEY3OwoJfQoJLy9SRVMgMywgQwoJLy8jMHg5OToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyAmPSAweEY3OwoJfQoJLy9SRVMgMywgRAoJLy8jMHg5QToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCAmPSAweEY3OwoJfQoJLy9SRVMgMywgRQoJLy8jMHg5QjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSAmPSAweEY3OwoJfQoJLy9SRVMgMywgSAoJLy8jMHg5QzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMICY9IDB4RjdGRjsKCX0KCS8vUkVTIDMsIEwKCS8vIzB4OUQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCAmPSAweEZGRjc7Cgl9CgkvL1JFUyAzLCAoSEwpCgkvLyMweDlFOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgJiAweEY3KTsKCX0KCS8vUkVTIDMsIEEKCS8vIzB4OUY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgJj0gMHhGNzsKCX0KCS8vUkVTIDMsIEIKCS8vIzB4QTA6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgJj0gMHhFRjsKCX0KCS8vUkVTIDQsIEMKCS8vIzB4QTE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgJj0gMHhFRjsKCX0KCS8vUkVTIDQsIEQKCS8vIzB4QTI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgJj0gMHhFRjsKCX0KCS8vUkVTIDQsIEUKCS8vIzB4QTM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgJj0gMHhFRjsKCX0KCS8vUkVTIDQsIEgKCS8vIzB4QTQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCAmPSAweEVGRkY7Cgl9CgkvL1JFUyA0LCBMCgkvLyMweEE1OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJj0gMHhGRkVGOwoJfQoJLy9SRVMgNCwgKEhMKQoJLy8jMHhBNjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpICYgMHhFRik7Cgl9CgkvL1JFUyA0LCBBCgkvLyMweEE3OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IDB4RUY7Cgl9CgkvL1JFUyA1LCBCCgkvLyMweEE4OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCICY9IDB4REY7Cgl9CgkvL1JFUyA1LCBDCgkvLyMweEE5OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDICY9IDB4REY7Cgl9CgkvL1JFUyA1LCBECgkvLyMweEFBOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEICY9IDB4REY7Cgl9CgkvL1JFUyA1LCBFCgkvLyMweEFCOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFICY9IDB4REY7Cgl9CgkvL1JFUyA1LCBICgkvLyMweEFDOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJj0gMHhERkZGOwoJfQoJLy9SRVMgNSwgTAoJLy8jMHhBRDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMICY9IDB4RkZERjsKCX0KCS8vUkVTIDUsIChITCkKCS8vIzB4QUU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSAmIDB4REYpOwoJfQoJLy9SRVMgNSwgQQoJLy8jMHhBRjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSAmPSAweERGOwoJfQoJLy9SRVMgNiwgQgoJLy8jMHhCMDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiAmPSAweEJGOwoJfQoJLy9SRVMgNiwgQwoJLy8jMHhCMToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyAmPSAweEJGOwoJfQoJLy9SRVMgNiwgRAoJLy8jMHhCMjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCAmPSAweEJGOwoJfQoJLy9SRVMgNiwgRQoJLy8jMHhCMzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSAmPSAweEJGOwoJfQoJLy9SRVMgNiwgSAoJLy8jMHhCNDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMICY9IDB4QkZGRjsKCX0KCS8vUkVTIDYsIEwKCS8vIzB4QjU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCAmPSAweEZGQkY7Cgl9CgkvL1JFUyA2LCAoSEwpCgkvLyMweEI2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgJiAweEJGKTsKCX0KCS8vUkVTIDYsIEEKCS8vIzB4Qjc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgJj0gMHhCRjsKCX0KCS8vUkVTIDcsIEIKCS8vIzB4Qjg6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgJj0gMHg3RjsKCX0KCS8vUkVTIDcsIEMKCS8vIzB4Qjk6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgJj0gMHg3RjsKCX0KCS8vUkVTIDcsIEQKCS8vIzB4QkE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgJj0gMHg3RjsKCX0KCS8vUkVTIDcsIEUKCS8vIzB4QkI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgJj0gMHg3RjsKCX0KCS8vUkVTIDcsIEgKCS8vIzB4QkM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCAmPSAweDdGRkY7Cgl9CgkvL1JFUyA3LCBMCgkvLyMweEJEOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgJj0gMHhGRjdGOwoJfQoJLy9SRVMgNywgKEhMKQoJLy8jMHhCRToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpICYgMHg3Rik7Cgl9CgkvL1JFUyA3LCBBCgkvLyMweEJGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBICY9IDB4N0Y7Cgl9CgkvL1NFVCAwLCBCCgkvLyMweEMwOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCIHw9IDB4MDE7Cgl9CgkvL1NFVCAwLCBDCgkvLyMweEMxOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDIHw9IDB4MDE7Cgl9CgkvL1NFVCAwLCBECgkvLyMweEMyOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEIHw9IDB4MDE7Cgl9CgkvL1NFVCAwLCBFCgkvLyMweEMzOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFIHw9IDB4MDE7Cgl9CgkvL1NFVCAwLCBICgkvLyMweEM0OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgfD0gMHgwMTAwOwoJfQoJLy9TRVQgMCwgTAoJLy8jMHhDNToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMIHw9IDB4MDE7Cgl9CgkvL1NFVCAwLCAoSEwpCgkvLyMweEM2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgfCAweDAxKTsKCX0KCS8vU0VUIDAsIEEKCS8vIzB4Qzc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gMHgwMTsKCX0KCS8vU0VUIDEsIEIKCS8vIzB4Qzg6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgfD0gMHgwMjsKCX0KCS8vU0VUIDEsIEMKCS8vIzB4Qzk6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgfD0gMHgwMjsKCX0KCS8vU0VUIDEsIEQKCS8vIzB4Q0E6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgfD0gMHgwMjsKCX0KCS8vU0VUIDEsIEUKCS8vIzB4Q0I6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgfD0gMHgwMjsKCX0KCS8vU0VUIDEsIEgKCS8vIzB4Q0M6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCB8PSAweDAyMDA7Cgl9CgkvL1NFVCAxLCBMCgkvLyMweENEOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgfD0gMHgwMjsKCX0KCS8vU0VUIDEsIChITCkKCS8vIzB4Q0U6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSB8IDB4MDIpOwoJfQoJLy9TRVQgMSwgQQoJLy8jMHhDRjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSB8PSAweDAyOwoJfQoJLy9TRVQgMiwgQgoJLy8jMHhEMDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiB8PSAweDA0OwoJfQoJLy9TRVQgMiwgQwoJLy8jMHhEMToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyB8PSAweDA0OwoJfQoJLy9TRVQgMiwgRAoJLy8jMHhEMjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCB8PSAweDA0OwoJfQoJLy9TRVQgMiwgRQoJLy8jMHhEMzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSB8PSAweDA0OwoJfQoJLy9TRVQgMiwgSAoJLy8jMHhENDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMIHw9IDB4MDQwMDsKCX0KCS8vU0VUIDIsIEwKCS8vIzB4RDU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCB8PSAweDA0OwoJfQoJLy9TRVQgMiwgKEhMKQoJLy8jMHhENjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpIHwgMHgwNCk7Cgl9CgkvL1NFVCAyLCBBCgkvLyMweEQ3OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBIHw9IDB4MDQ7Cgl9CgkvL1NFVCAzLCBCCgkvLyMweEQ4OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCIHw9IDB4MDg7Cgl9CgkvL1NFVCAzLCBDCgkvLyMweEQ5OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDIHw9IDB4MDg7Cgl9CgkvL1NFVCAzLCBECgkvLyMweERBOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEIHw9IDB4MDg7Cgl9CgkvL1NFVCAzLCBFCgkvLyMweERCOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFIHw9IDB4MDg7Cgl9CgkvL1NFVCAzLCBICgkvLyMweERDOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgfD0gMHgwODAwOwoJfQoJLy9TRVQgMywgTAoJLy8jMHhERDoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMIHw9IDB4MDg7Cgl9CgkvL1NFVCAzLCAoSEwpCgkvLyMweERFOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgfCAweDA4KTsKCX0KCS8vU0VUIDMsIEEKCS8vIzB4REY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gMHgwODsKCX0KCS8vU0VUIDQsIEIKCS8vIzB4RTA6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgfD0gMHgxMDsKCX0KCS8vU0VUIDQsIEMKCS8vIzB4RTE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgfD0gMHgxMDsKCX0KCS8vU0VUIDQsIEQKCS8vIzB4RTI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgfD0gMHgxMDsKCX0KCS8vU0VUIDQsIEUKCS8vIzB4RTM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgfD0gMHgxMDsKCX0KCS8vU0VUIDQsIEgKCS8vIzB4RTQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCB8PSAweDEwMDA7Cgl9CgkvL1NFVCA0LCBMCgkvLyMweEU1OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgfD0gMHgxMDsKCX0KCS8vU0VUIDQsIChITCkKCS8vIzB4RTY6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSB8IDB4MTApOwoJfQoJLy9TRVQgNCwgQQoJLy8jMHhFNzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSB8PSAweDEwOwoJfQoJLy9TRVQgNSwgQgoJLy8jMHhFODoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQiB8PSAweDIwOwoJfQoJLy9TRVQgNSwgQwoJLy8jMHhFOToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQyB8PSAweDIwOwoJfQoJLy9TRVQgNSwgRAoJLy8jMHhFQToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRCB8PSAweDIwOwoJfQoJLy9TRVQgNSwgRQoJLy8jMHhFQjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyRSB8PSAweDIwOwoJfQoJLy9TRVQgNSwgSAoJLy8jMHhFQzoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMIHw9IDB4MjAwMDsKCX0KCS8vU0VUIDUsIEwKCS8vIzB4RUQ6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCB8PSAweDIwOwoJfQoJLy9TRVQgNSwgKEhMKQoJLy8jMHhFRToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLm1lbW9yeVdyaXRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMLCBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwpIHwgMHgyMCk7Cgl9CgkvL1NFVCA1LCBBCgkvLyMweEVGOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJBIHw9IDB4MjA7Cgl9CgkvL1NFVCA2LCBCCgkvLyMweEYwOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJCIHw9IDB4NDA7Cgl9CgkvL1NFVCA2LCBDCgkvLyMweEYxOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJDIHw9IDB4NDA7Cgl9CgkvL1NFVCA2LCBECgkvLyMweEYyOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJEIHw9IDB4NDA7Cgl9CgkvL1NFVCA2LCBFCgkvLyMweEYzOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJFIHw9IDB4NDA7Cgl9CgkvL1NFVCA2LCBICgkvLyMweEY0OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgfD0gMHg0MDAwOwoJfQoJLy9TRVQgNiwgTAoJLy8jMHhGNToKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyc0hMIHw9IDB4NDA7Cgl9CgkvL1NFVCA2LCAoSEwpCgkvLyMweEY2OgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW3BhcmVudE9iai5yZWdpc3RlcnNITF0ocGFyZW50T2JqLCBwYXJlbnRPYmoucmVnaXN0ZXJzSEwsIHBhcmVudE9iai5tZW1vcnlSZWFkZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCkgfCAweDQwKTsKCX0KCS8vU0VUIDYsIEEKCS8vIzB4Rjc6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckEgfD0gMHg0MDsKCX0KCS8vU0VUIDcsIEIKCS8vIzB4Rjg6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckIgfD0gMHg4MDsKCX0KCS8vU0VUIDcsIEMKCS8vIzB4Rjk6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckMgfD0gMHg4MDsKCX0KCS8vU0VUIDcsIEQKCS8vIzB4RkE6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckQgfD0gMHg4MDsKCX0KCS8vU0VUIDcsIEUKCS8vIzB4RkI6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlckUgfD0gMHg4MDsKCX0KCS8vU0VUIDcsIEgKCS8vIzB4RkM6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5yZWdpc3RlcnNITCB8PSAweDgwMDA7Cgl9CgkvL1NFVCA3LCBMCgkvLyMweEZEOgoJLGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQlwYXJlbnRPYmoucmVnaXN0ZXJzSEwgfD0gMHg4MDsKCX0KCS8vU0VUIDcsIChITCkKCS8vIzB4RkU6CgksZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCXBhcmVudE9iai5tZW1vcnlXcml0ZXJbcGFyZW50T2JqLnJlZ2lzdGVyc0hMXShwYXJlbnRPYmosIHBhcmVudE9iai5yZWdpc3RlcnNITCwgcGFyZW50T2JqLm1lbW9yeVJlYWRlcltwYXJlbnRPYmoucmVnaXN0ZXJzSExdKHBhcmVudE9iaiwgcGFyZW50T2JqLnJlZ2lzdGVyc0hMKSB8IDB4ODApOwoJfQoJLy9TRVQgNywgQQoJLy8jMHhGRjoKCSxmdW5jdGlvbiAocGFyZW50T2JqKSB7CgkJcGFyZW50T2JqLnJlZ2lzdGVyQSB8PSAweDgwOwoJfQpdOwpHYW1lQm95Q29yZS5wcm90b3R5cGUuVElDS1RhYmxlID0gWwkJLy9OdW1iZXIgb2YgbWFjaGluZSBjeWNsZXMgZm9yIGVhY2ggaW5zdHJ1Y3Rpb246Ci8qICAgMCwgIDEsICAyLCAgMywgIDQsICA1LCAgNiwgIDcsICAgICAgOCwgIDksICBBLCBCLCAgQywgIEQsIEUsICBGKi8KICAgICA0LCAxMiwgIDgsICA4LCAgNCwgIDQsICA4LCAgNCwgICAgIDIwLCAgOCwgIDgsIDgsICA0LCAgNCwgOCwgIDQsICAvLzAKICAgICA0LCAxMiwgIDgsICA4LCAgNCwgIDQsICA4LCAgNCwgICAgIDEyLCAgOCwgIDgsIDgsICA0LCAgNCwgOCwgIDQsICAvLzEKICAgICA4LCAxMiwgIDgsICA4LCAgNCwgIDQsICA4LCAgNCwgICAgICA4LCAgOCwgIDgsIDgsICA0LCAgNCwgOCwgIDQsICAvLzIKICAgICA4LCAxMiwgIDgsICA4LCAxMiwgMTIsIDEyLCAgNCwgICAgICA4LCAgOCwgIDgsIDgsICA0LCAgNCwgOCwgIDQsICAvLzMKCiAgICAgNCwgIDQsICA0LCAgNCwgIDQsICA0LCAgOCwgIDQsICAgICAgNCwgIDQsICA0LCA0LCAgNCwgIDQsIDgsICA0LCAgLy80CiAgICAgNCwgIDQsICA0LCAgNCwgIDQsICA0LCAgOCwgIDQsICAgICAgNCwgIDQsICA0LCA0LCAgNCwgIDQsIDgsICA0LCAgLy81CiAgICAgNCwgIDQsICA0LCAgNCwgIDQsICA0LCAgOCwgIDQsICAgICAgNCwgIDQsICA0LCA0LCAgNCwgIDQsIDgsICA0LCAgLy82CiAgICAgOCwgIDgsICA4LCAgOCwgIDgsICA4LCAgNCwgIDgsICAgICAgNCwgIDQsICA0LCA0LCAgNCwgIDQsIDgsICA0LCAgLy83CgogICAgIDQsICA0LCAgNCwgIDQsICA0LCAgNCwgIDgsICA0LCAgICAgIDQsICA0LCAgNCwgNCwgIDQsICA0LCA4LCAgNCwgIC8vOAogICAgIDQsICA0LCAgNCwgIDQsICA0LCAgNCwgIDgsICA0LCAgICAgIDQsICA0LCAgNCwgNCwgIDQsICA0LCA4LCAgNCwgIC8vOQogICAgIDQsICA0LCAgNCwgIDQsICA0LCAgNCwgIDgsICA0LCAgICAgIDQsICA0LCAgNCwgNCwgIDQsICA0LCA4LCAgNCwgIC8vQQogICAgIDQsICA0LCAgNCwgIDQsICA0LCAgNCwgIDgsICA0LCAgICAgIDQsICA0LCAgNCwgNCwgIDQsICA0LCA4LCAgNCwgIC8vQgoKICAgICA4LCAxMiwgMTIsIDE2LCAxMiwgMTYsICA4LCAxNiwgICAgICA4LCAxNiwgMTIsIDAsIDEyLCAyNCwgOCwgMTYsICAvL0MKICAgICA4LCAxMiwgMTIsICA0LCAxMiwgMTYsICA4LCAxNiwgICAgICA4LCAxNiwgMTIsIDQsIDEyLCAgNCwgOCwgMTYsICAvL0QKICAgIDEyLCAxMiwgIDgsICA0LCAgNCwgMTYsICA4LCAxNiwgICAgIDE2LCAgNCwgMTYsIDQsICA0LCAgNCwgOCwgMTYsICAvL0UKICAgIDEyLCAxMiwgIDgsICA0LCAgNCwgMTYsICA4LCAxNiwgICAgIDEyLCAgOCwgMTYsIDQsICAwLCAgNCwgOCwgMTYgICAvL0YKXTsKR2FtZUJveUNvcmUucHJvdG90eXBlLlNlY29uZGFyeVRJQ0tUYWJsZSA9IFsJLy9OdW1iZXIgb2YgbWFjaGluZSBjeWNsZXMgZm9yIGVhY2ggMHhDQlhYIGluc3RydWN0aW9uOgovKiAgMCwgMSwgMiwgMywgNCwgNSwgIDYsIDcsICAgICAgICA4LCA5LCBBLCBCLCBDLCBELCAgRSwgRiovCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy8wCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy8xCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy8yCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy8zCgogICAgOCwgOCwgOCwgOCwgOCwgOCwgMTIsIDgsICAgICAgICA4LCA4LCA4LCA4LCA4LCA4LCAxMiwgOCwgIC8vNAogICAgOCwgOCwgOCwgOCwgOCwgOCwgMTIsIDgsICAgICAgICA4LCA4LCA4LCA4LCA4LCA4LCAxMiwgOCwgIC8vNQogICAgOCwgOCwgOCwgOCwgOCwgOCwgMTIsIDgsICAgICAgICA4LCA4LCA4LCA4LCA4LCA4LCAxMiwgOCwgIC8vNgogICAgOCwgOCwgOCwgOCwgOCwgOCwgMTIsIDgsICAgICAgICA4LCA4LCA4LCA4LCA4LCA4LCAxMiwgOCwgIC8vNwoKICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgICAgICAgOCwgOCwgOCwgOCwgOCwgOCwgMTYsIDgsICAvLzgKICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgICAgICAgOCwgOCwgOCwgOCwgOCwgOCwgMTYsIDgsICAvLzkKICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgICAgICAgOCwgOCwgOCwgOCwgOCwgOCwgMTYsIDgsICAvL0EKICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgICAgICAgOCwgOCwgOCwgOCwgOCwgOCwgMTYsIDgsICAvL0IKCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy9DCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy9ECiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4LCAgLy9FCiAgICA4LCA4LCA4LCA4LCA4LCA4LCAxNiwgOCwgICAgICAgIDgsIDgsIDgsIDgsIDgsIDgsIDE2LCA4ICAgLy9GCl07CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5zYXZlU1JBTVN0YXRlID0gZnVuY3Rpb24gKCkgewoJaWYgKCF0aGlzLmNCQVRUIHx8IHRoaXMuTUJDUmFtLmxlbmd0aCA9PSAwKSB7CgkJLy9ObyBiYXR0ZXJ5IGJhY2t1cC4uLgoJCXJldHVybiBbXTsKCX0KCWVsc2UgewoJCS8vUmV0dXJuIHRoZSBNQkMgUkFNIGZvciBiYWNrdXAuLi4KCQlyZXR1cm4gdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLk1CQ1JhbSk7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnNhdmVSVENTdGF0ZSA9IGZ1bmN0aW9uICgpIHsKCWlmICghdGhpcy5jVElNRVIpIHsKCQkvL05vIGJhdHRlcnkgYmFja3VwLi4uCgkJcmV0dXJuIFtdOwoJfQoJZWxzZSB7CgkJLy9SZXR1cm4gdGhlIE1CQyBSQU0gZm9yIGJhY2t1cC4uLgoJCXJldHVybiBbCgkJCXRoaXMubGFzdEl0ZXJhdGlvbiwKCQkJdGhpcy5SVENpc0xhdGNoZWQsCgkJCXRoaXMubGF0Y2hlZFNlY29uZHMsCgkJCXRoaXMubGF0Y2hlZE1pbnV0ZXMsCgkJCXRoaXMubGF0Y2hlZEhvdXJzLAoJCQl0aGlzLmxhdGNoZWRMRGF5cywKCQkJdGhpcy5sYXRjaGVkSERheXMsCgkJCXRoaXMuUlRDU2Vjb25kcywKCQkJdGhpcy5SVENNaW51dGVzLAoJCQl0aGlzLlJUQ0hvdXJzLAoJCQl0aGlzLlJUQ0RheXMsCgkJCXRoaXMuUlRDRGF5T3ZlckZsb3csCgkJCXRoaXMuUlRDSEFMVAoJCV07Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnNhdmVTdGF0ZSA9IGZ1bmN0aW9uICgpIHsKCXJldHVybiBbCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLlJPTSksCgkJdGhpcy5pbkJvb3RzdHJhcCwKCQl0aGlzLnJlZ2lzdGVyQSwKCQl0aGlzLkZaZXJvLAoJCXRoaXMuRlN1YnRyYWN0LAoJCXRoaXMuRkhhbGZDYXJyeSwKCQl0aGlzLkZDYXJyeSwKCQl0aGlzLnJlZ2lzdGVyQiwKCQl0aGlzLnJlZ2lzdGVyQywKCQl0aGlzLnJlZ2lzdGVyRCwKCQl0aGlzLnJlZ2lzdGVyRSwKCQl0aGlzLnJlZ2lzdGVyc0hMLAoJCXRoaXMuc3RhY2tQb2ludGVyLAoJCXRoaXMucHJvZ3JhbUNvdW50ZXIsCgkJdGhpcy5oYWx0LAoJCXRoaXMuSU1FLAoJCXRoaXMuaGRtYVJ1bm5pbmcsCgkJdGhpcy5DUFVUaWNrcywKCQl0aGlzLmRvdWJsZVNwZWVkU2hpZnRlciwKCQl0aGlzLmZyb21UeXBlZEFycmF5KHRoaXMubWVtb3J5KSwKCQl0aGlzLmZyb21UeXBlZEFycmF5KHRoaXMuTUJDUmFtKSwKCQl0aGlzLmZyb21UeXBlZEFycmF5KHRoaXMuVlJBTSksCgkJdGhpcy5jdXJyVlJBTUJhbmssCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLkdCQ01lbW9yeSksCgkJdGhpcy5NQkMxTW9kZSwKCQl0aGlzLk1CQ1JBTUJhbmtzRW5hYmxlZCwKCQl0aGlzLmN1cnJNQkNSQU1CYW5rLAoJCXRoaXMuY3Vyck1CQ1JBTUJhbmtQb3NpdGlvbiwKCQl0aGlzLmNHQkMsCgkJdGhpcy5nYmNSYW1CYW5rLAoJCXRoaXMuZ2JjUmFtQmFua1Bvc2l0aW9uLAoJCXRoaXMuUk9NQmFuazFvZmZzLAoJCXRoaXMuY3VycmVudFJPTUJhbmssCgkJdGhpcy5jYXJ0cmlkZ2VUeXBlLAoJCXRoaXMubmFtZSwKCQl0aGlzLmdhbWVDb2RlLAoJCXRoaXMubW9kZVNUQVQsCgkJdGhpcy5MWUNNYXRjaFRyaWdnZXJTVEFULAoJCXRoaXMubW9kZTJUcmlnZ2VyU1RBVCwKCQl0aGlzLm1vZGUxVHJpZ2dlclNUQVQsCgkJdGhpcy5tb2RlMFRyaWdnZXJTVEFULAoJCXRoaXMuTENEaXNPbiwKCQl0aGlzLmdmeFdpbmRvd0NIUkJhbmtQb3NpdGlvbiwKCQl0aGlzLmdmeFdpbmRvd0Rpc3BsYXksCgkJdGhpcy5nZnhTcHJpdGVTaG93LAoJCXRoaXMuZ2Z4U3ByaXRlTm9ybWFsSGVpZ2h0LAoJCXRoaXMuZ2Z4QmFja2dyb3VuZENIUkJhbmtQb3NpdGlvbiwKCQl0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0LAoJCXRoaXMuVElNQUVuYWJsZWQsCgkJdGhpcy5ESVZUaWNrcywKCQl0aGlzLkxDRFRpY2tzLAoJCXRoaXMudGltZXJUaWNrcywKCQl0aGlzLlRBQ0Nsb2NrZXIsCgkJdGhpcy5zZXJpYWxUaW1lciwKCQl0aGlzLnNlcmlhbFNoaWZ0VGltZXIsCgkJdGhpcy5zZXJpYWxTaGlmdFRpbWVyQWxsb2NhdGVkLAoJCXRoaXMuSVJRRW5hYmxlRGVsYXksCgkJdGhpcy5sYXN0SXRlcmF0aW9uLAoJCXRoaXMuY01CQzEsCgkJdGhpcy5jTUJDMiwKCQl0aGlzLmNNQkMzLAoJCXRoaXMuY01CQzUsCgkJdGhpcy5jTUJDNywKCQl0aGlzLmNTUkFNLAoJCXRoaXMuY01NTU8xLAoJCXRoaXMuY1JVTUJMRSwKCQl0aGlzLmNDYW1lcmEsCgkJdGhpcy5jVEFNQTUsCgkJdGhpcy5jSHVDMywKCQl0aGlzLmNIdUMxLAoJCXRoaXMuZHJld0JsYW5rLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5mcmFtZUJ1ZmZlciksCgkJdGhpcy5iZ0VuYWJsZWQsCgkJdGhpcy5CR1ByaW9yaXR5RW5hYmxlZCwKCQl0aGlzLmNoYW5uZWwxRnJlcXVlbmN5VHJhY2tlciwKCQl0aGlzLmNoYW5uZWwxRnJlcXVlbmN5Q291bnRlciwKCQl0aGlzLmNoYW5uZWwxdG90YWxMZW5ndGgsCgkJdGhpcy5jaGFubmVsMWVudmVsb3BlVm9sdW1lLAoJCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVR5cGUsCgkJdGhpcy5jaGFubmVsMWVudmVsb3BlU3dlZXBzLAoJCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVN3ZWVwc0xhc3QsCgkJdGhpcy5jaGFubmVsMWNvbnNlY3V0aXZlLAoJCXRoaXMuY2hhbm5lbDFmcmVxdWVuY3ksCgkJdGhpcy5jaGFubmVsMVN3ZWVwRmF1bHQsCgkJdGhpcy5jaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSwKCQl0aGlzLmNoYW5uZWwxdGltZVN3ZWVwLAoJCXRoaXMuY2hhbm5lbDFsYXN0VGltZVN3ZWVwLAoJCXRoaXMuY2hhbm5lbDFTd2VwdCwKCQl0aGlzLmNoYW5uZWwxZnJlcXVlbmN5U3dlZXBEaXZpZGVyLAoJCXRoaXMuY2hhbm5lbDFkZWNyZWFzZVN3ZWVwLAoJCXRoaXMuY2hhbm5lbDJGcmVxdWVuY3lUcmFja2VyLAoJCXRoaXMuY2hhbm5lbDJGcmVxdWVuY3lDb3VudGVyLAoJCXRoaXMuY2hhbm5lbDJ0b3RhbExlbmd0aCwKCQl0aGlzLmNoYW5uZWwyZW52ZWxvcGVWb2x1bWUsCgkJdGhpcy5jaGFubmVsMmVudmVsb3BlVHlwZSwKCQl0aGlzLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHMsCgkJdGhpcy5jaGFubmVsMmVudmVsb3BlU3dlZXBzTGFzdCwKCQl0aGlzLmNoYW5uZWwyY29uc2VjdXRpdmUsCgkJdGhpcy5jaGFubmVsMmZyZXF1ZW5jeSwKCQl0aGlzLmNoYW5uZWwzY2FuUGxheSwKCQl0aGlzLmNoYW5uZWwzdG90YWxMZW5ndGgsCgkJdGhpcy5jaGFubmVsM3BhdHRlcm5UeXBlLAoJCXRoaXMuY2hhbm5lbDNmcmVxdWVuY3ksCgkJdGhpcy5jaGFubmVsM2NvbnNlY3V0aXZlLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5jaGFubmVsM1BDTSksCgkJdGhpcy5jaGFubmVsNEZyZXF1ZW5jeVBlcmlvZCwKCQl0aGlzLmNoYW5uZWw0bGFzdFNhbXBsZUxvb2t1cCwKCQl0aGlzLmNoYW5uZWw0dG90YWxMZW5ndGgsCgkJdGhpcy5jaGFubmVsNGVudmVsb3BlVm9sdW1lLAoJCXRoaXMuY2hhbm5lbDRjdXJyZW50Vm9sdW1lLAoJCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVR5cGUsCgkJdGhpcy5jaGFubmVsNGVudmVsb3BlU3dlZXBzLAoJCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwc0xhc3QsCgkJdGhpcy5jaGFubmVsNGNvbnNlY3V0aXZlLAoJCXRoaXMuY2hhbm5lbDRCaXRSYW5nZSwKCQl0aGlzLnNvdW5kTWFzdGVyRW5hYmxlZCwKCQl0aGlzLlZpbkxlZnRDaGFubmVsTWFzdGVyVm9sdW1lLAoJCXRoaXMuVmluUmlnaHRDaGFubmVsTWFzdGVyVm9sdW1lLAoJCXRoaXMubGVmdENoYW5uZWwxLAoJCXRoaXMubGVmdENoYW5uZWwyLAoJCXRoaXMubGVmdENoYW5uZWwzLAoJCXRoaXMubGVmdENoYW5uZWw0LAoJCXRoaXMucmlnaHRDaGFubmVsMSwKCQl0aGlzLnJpZ2h0Q2hhbm5lbDIsCgkJdGhpcy5yaWdodENoYW5uZWwzLAoJCXRoaXMucmlnaHRDaGFubmVsNCwKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZUxlZnQsCgkJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVSaWdodCwKCQl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnQsCgkJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVSaWdodCwKCQl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZUxlZnQsCgkJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVSaWdodCwKCQl0aGlzLmNoYW5uZWw0Y3VycmVudFNhbXBsZUxlZnQsCgkJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVSaWdodCwKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnksCgkJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSwKCQl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnksCgkJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSwKCQl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnksCgkJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSwKCQl0aGlzLmNoYW5uZWw0Y3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnksCgkJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSwKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZUxlZnRUcmltYXJ5LAoJCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHRUcmltYXJ5LAoJCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlTGVmdFRyaW1hcnksCgkJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVSaWdodFRyaW1hcnksCgkJdGhpcy5taXhlck91dHB1dENhY2hlLAoJCXRoaXMuY2hhbm5lbDFEdXR5VHJhY2tlciwKCQl0aGlzLmNoYW5uZWwxQ2FjaGVkRHV0eSwKCQl0aGlzLmNoYW5uZWwyRHV0eVRyYWNrZXIsCgkJdGhpcy5jaGFubmVsMkNhY2hlZER1dHksCgkJdGhpcy5jaGFubmVsMUVuYWJsZWQsCgkJdGhpcy5jaGFubmVsMkVuYWJsZWQsCgkJdGhpcy5jaGFubmVsM0VuYWJsZWQsCgkJdGhpcy5jaGFubmVsNEVuYWJsZWQsCgkJdGhpcy5zZXF1ZW5jZXJDbG9ja3MsCgkJdGhpcy5zZXF1ZW5jZVBvc2l0aW9uLAoJCXRoaXMuY2hhbm5lbDNDb3VudGVyLAoJCXRoaXMuY2hhbm5lbDRDb3VudGVyLAoJCXRoaXMuY2FjaGVkQ2hhbm5lbDNTYW1wbGUsCgkJdGhpcy5jYWNoZWRDaGFubmVsNFNhbXBsZSwKCQl0aGlzLmNoYW5uZWwzRnJlcXVlbmN5UGVyaW9kLAoJCXRoaXMuY2hhbm5lbDNsYXN0U2FtcGxlTG9va3VwLAoJCXRoaXMuYWN0dWFsU2NhbkxpbmUsCgkJdGhpcy5sYXN0VW5yZW5kZXJlZExpbmUsCgkJdGhpcy5xdWV1ZWRTY2FuTGluZXMsCgkJdGhpcy5SVENpc0xhdGNoZWQsCgkJdGhpcy5sYXRjaGVkU2Vjb25kcywKCQl0aGlzLmxhdGNoZWRNaW51dGVzLAoJCXRoaXMubGF0Y2hlZEhvdXJzLAoJCXRoaXMubGF0Y2hlZExEYXlzLAoJCXRoaXMubGF0Y2hlZEhEYXlzLAoJCXRoaXMuUlRDU2Vjb25kcywKCQl0aGlzLlJUQ01pbnV0ZXMsCgkJdGhpcy5SVENIb3VycywKCQl0aGlzLlJUQ0RheXMsCgkJdGhpcy5SVENEYXlPdmVyRmxvdywKCQl0aGlzLlJUQ0hBTFQsCgkJdGhpcy51c2VkQm9vdFJPTSwKCQl0aGlzLnNraXBQQ0luY3JlbWVudCwKCQl0aGlzLlNUQVRUcmFja2VyLAoJCXRoaXMuZ2JjUmFtQmFua1Bvc2l0aW9uRUNITywKCQl0aGlzLm51bVJBTUJhbmtzLAoJCXRoaXMud2luZG93WSwKCQl0aGlzLndpbmRvd1gsCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLmdiY09CSlJhd1BhbGV0dGUpLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5nYmNCR1Jhd1BhbGV0dGUpLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5nYk9CSlBhbGV0dGUpLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5nYkJHUGFsZXR0ZSksCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLmdiY09CSlBhbGV0dGUpLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5nYmNCR1BhbGV0dGUpLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5nYkJHQ29sb3JpemVkUGFsZXR0ZSksCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLmdiT0JKQ29sb3JpemVkUGFsZXR0ZSksCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLmNhY2hlZEJHUGFsZXR0ZUNvbnZlcnNpb24pLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5jYWNoZWRPQkpQYWxldHRlQ29udmVyc2lvbiksCgkJdGhpcy5mcm9tVHlwZWRBcnJheSh0aGlzLkJHQ0hSQmFuazEpLAoJCXRoaXMuZnJvbVR5cGVkQXJyYXkodGhpcy5CR0NIUkJhbmsyKSwKCQl0aGlzLmhhbHRQb3N0Q2xvY2tzLAoJCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCwKCQl0aGlzLmludGVycnVwdHNFbmFibGVkLAoJCXRoaXMucmVtYWluaW5nQ2xvY2tzLAoJCXRoaXMuY29sb3JpemVkR0JQYWxldHRlcywKCQl0aGlzLmJhY2tncm91bmRZLAoJCXRoaXMuYmFja2dyb3VuZFgsCgkJdGhpcy5DUFVTdG9wcGVkLAoJCXRoaXMuYXVkaW9DbG9ja3NVbnRpbE5leHRFdmVudCwKCQl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyCgldOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5yZXR1cm5Gcm9tU3RhdGUgPSBmdW5jdGlvbiAocmV0dXJuZWRGcm9tKSB7Cgl2YXIgaW5kZXggPSAwOwoJdmFyIHN0YXRlID0gcmV0dXJuZWRGcm9tLnNsaWNlKDApOwoJdGhpcy5ST00gPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgInVpbnQ4Iik7Cgl0aGlzLlJPTUJhbmtFZGdlID0gTWF0aC5mbG9vcih0aGlzLlJPTS5sZW5ndGggLyAweDQwMDApOwoJdGhpcy5pbkJvb3RzdHJhcCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5yZWdpc3RlckEgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuRlplcm8gPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuRlN1YnRyYWN0ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLkZIYWxmQ2FycnkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuRkNhcnJ5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnJlZ2lzdGVyQiA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5yZWdpc3RlckMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMucmVnaXN0ZXJEID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnJlZ2lzdGVyRSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5yZWdpc3RlcnNITCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5zdGFja1BvaW50ZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMucHJvZ3JhbUNvdW50ZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuaGFsdCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5JTUUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuaGRtYVJ1bm5pbmcgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuQ1BVVGlja3MgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuZG91YmxlU3BlZWRTaGlmdGVyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLm1lbW9yeSA9IHRoaXMudG9UeXBlZEFycmF5KHN0YXRlW2luZGV4KytdLCAidWludDgiKTsKCXRoaXMuTUJDUmFtID0gdGhpcy50b1R5cGVkQXJyYXkoc3RhdGVbaW5kZXgrK10sICJ1aW50OCIpOwoJdGhpcy5WUkFNID0gdGhpcy50b1R5cGVkQXJyYXkoc3RhdGVbaW5kZXgrK10sICJ1aW50OCIpOwoJdGhpcy5jdXJyVlJBTUJhbmsgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuR0JDTWVtb3J5ID0gdGhpcy50b1R5cGVkQXJyYXkoc3RhdGVbaW5kZXgrK10sICJ1aW50OCIpOwoJdGhpcy5NQkMxTW9kZSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5NQkNSQU1CYW5rc0VuYWJsZWQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY3Vyck1CQ1JBTUJhbmsgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY3Vyck1CQ1JBTUJhbmtQb3NpdGlvbiA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jR0JDID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmdiY1JhbUJhbmsgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuZ2JjUmFtQmFua1Bvc2l0aW9uID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLlJPTUJhbmsxb2ZmcyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jdXJyZW50Uk9NQmFuayA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jYXJ0cmlkZ2VUeXBlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLm5hbWUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuZ2FtZUNvZGUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMubW9kZVNUQVQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuTFlDTWF0Y2hUcmlnZ2VyU1RBVCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5tb2RlMlRyaWdnZXJTVEFUID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLm1vZGUxVHJpZ2dlclNUQVQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMubW9kZTBUcmlnZ2VyU1RBVCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5MQ0Rpc09uID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmdmeFdpbmRvd0NIUkJhbmtQb3NpdGlvbiA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5nZnhXaW5kb3dEaXNwbGF5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmdmeFNwcml0ZVNob3cgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuZ2Z4U3ByaXRlTm9ybWFsSGVpZ2h0ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmdmeEJhY2tncm91bmRDSFJCYW5rUG9zaXRpb24gPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuVElNQUVuYWJsZWQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuRElWVGlja3MgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuTENEVGlja3MgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMudGltZXJUaWNrcyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5UQUNDbG9ja2VyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnNlcmlhbFRpbWVyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnNlcmlhbFNoaWZ0VGltZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuc2VyaWFsU2hpZnRUaW1lckFsbG9jYXRlZCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5JUlFFbmFibGVEZWxheSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sYXN0SXRlcmF0aW9uID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNNQkMxID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNNQkMyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNNQkMzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNNQkM1ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNNQkM3ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNTUkFNID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNNTU1PMSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jUlVNQkxFID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNDYW1lcmEgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY1RBTUE1ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNIdUMzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNIdUMxID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmRyZXdCbGFuayA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5mcmFtZUJ1ZmZlciA9IHRoaXMudG9UeXBlZEFycmF5KHN0YXRlW2luZGV4KytdLCAiaW50MzIiKTsKCXRoaXMuYmdFbmFibGVkID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLkJHUHJpb3JpdHlFbmFibGVkID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxRnJlcXVlbmN5VHJhY2tlciA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMUZyZXF1ZW5jeUNvdW50ZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDF0b3RhbExlbmd0aCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMWVudmVsb3BlVm9sdW1lID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxZW52ZWxvcGVUeXBlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxZW52ZWxvcGVTd2VlcHMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVN3ZWVwc0xhc3QgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFjb25zZWN1dGl2ZSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMWZyZXF1ZW5jeSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMVN3ZWVwRmF1bHQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDF0aW1lU3dlZXAgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFsYXN0VGltZVN3ZWVwID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxU3dlcHQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFmcmVxdWVuY3lTd2VlcERpdmlkZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFkZWNyZWFzZVN3ZWVwID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyRnJlcXVlbmN5VHJhY2tlciA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMkZyZXF1ZW5jeUNvdW50ZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDJ0b3RhbExlbmd0aCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMmVudmVsb3BlVm9sdW1lID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyZW52ZWxvcGVUeXBlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDJlbnZlbG9wZVN3ZWVwc0xhc3QgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDJjb25zZWN1dGl2ZSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMmZyZXF1ZW5jeSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsM2NhblBsYXkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDN0b3RhbExlbmd0aCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsM3BhdHRlcm5UeXBlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwzZnJlcXVlbmN5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwzY29uc2VjdXRpdmUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDNQQ00gPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgImludDgiKTsKCXRoaXMuY2hhbm5lbDRGcmVxdWVuY3lQZXJpb2QgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDRsYXN0U2FtcGxlTG9va3VwID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWw0dG90YWxMZW5ndGggPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVZvbHVtZSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsNGN1cnJlbnRWb2x1bWUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVR5cGUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwcyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsNGVudmVsb3BlU3dlZXBzTGFzdCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsNGNvbnNlY3V0aXZlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWw0Qml0UmFuZ2UgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuc291bmRNYXN0ZXJFbmFibGVkID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLlZpbkxlZnRDaGFubmVsTWFzdGVyVm9sdW1lID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLlZpblJpZ2h0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sZWZ0Q2hhbm5lbDEgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMubGVmdENoYW5uZWwyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmxlZnRDaGFubmVsMyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sZWZ0Q2hhbm5lbDQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMucmlnaHRDaGFubmVsMSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5yaWdodENoYW5uZWwyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnJpZ2h0Q2hhbm5lbDMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMucmlnaHRDaGFubmVsNCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDNjdXJyZW50U2FtcGxlTGVmdCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVSaWdodCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWw0Y3VycmVudFNhbXBsZVJpZ2h0ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlTGVmdFNlY29uZGFyeSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZVJpZ2h0U2Vjb25kYXJ5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWw0Y3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDRjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlTGVmdFRyaW1hcnkgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHRUcmltYXJ5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnRUcmltYXJ5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZVJpZ2h0VHJpbWFyeSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5taXhlck91dHB1dENhY2hlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxRHV0eVRyYWNrZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDFDYWNoZWREdXR5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwyRHV0eVRyYWNrZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDJDYWNoZWREdXR5ID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwxRW5hYmxlZCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsMkVuYWJsZWQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDNFbmFibGVkID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWw0RW5hYmxlZCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5zZXF1ZW5jZXJDbG9ja3MgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuc2VxdWVuY2VQb3NpdGlvbiA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5jaGFubmVsM0NvdW50ZXIgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hhbm5lbDRDb3VudGVyID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNhY2hlZENoYW5uZWwzU2FtcGxlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNhY2hlZENoYW5uZWw0U2FtcGxlID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwzRnJlcXVlbmN5UGVyaW9kID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmNoYW5uZWwzbGFzdFNhbXBsZUxvb2t1cCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5hY3R1YWxTY2FuTGluZSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sYXN0VW5yZW5kZXJlZExpbmUgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMucXVldWVkU2NhbkxpbmVzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLlJUQ2lzTGF0Y2hlZCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sYXRjaGVkU2Vjb25kcyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sYXRjaGVkTWludXRlcyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5sYXRjaGVkSG91cnMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMubGF0Y2hlZExEYXlzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmxhdGNoZWRIRGF5cyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5SVENTZWNvbmRzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLlJUQ01pbnV0ZXMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuUlRDSG91cnMgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuUlRDRGF5cyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5SVENEYXlPdmVyRmxvdyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5SVENIQUxUID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnVzZWRCb290Uk9NID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLnNraXBQQ0luY3JlbWVudCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5TVEFUVHJhY2tlciA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5nYmNSYW1CYW5rUG9zaXRpb25FQ0hPID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLm51bVJBTUJhbmtzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLndpbmRvd1kgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMud2luZG93WCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5nYmNPQkpSYXdQYWxldHRlID0gdGhpcy50b1R5cGVkQXJyYXkoc3RhdGVbaW5kZXgrK10sICJ1aW50OCIpOwoJdGhpcy5nYmNCR1Jhd1BhbGV0dGUgPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgInVpbnQ4Iik7Cgl0aGlzLmdiT0JKUGFsZXR0ZSA9IHRoaXMudG9UeXBlZEFycmF5KHN0YXRlW2luZGV4KytdLCAiaW50MzIiKTsKCXRoaXMuZ2JCR1BhbGV0dGUgPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgImludDMyIik7Cgl0aGlzLmdiY09CSlBhbGV0dGUgPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgImludDMyIik7Cgl0aGlzLmdiY0JHUGFsZXR0ZSA9IHRoaXMudG9UeXBlZEFycmF5KHN0YXRlW2luZGV4KytdLCAiaW50MzIiKTsKCXRoaXMuZ2JCR0NvbG9yaXplZFBhbGV0dGUgPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgImludDMyIik7Cgl0aGlzLmdiT0JKQ29sb3JpemVkUGFsZXR0ZSA9IHRoaXMudG9UeXBlZEFycmF5KHN0YXRlW2luZGV4KytdLCAiaW50MzIiKTsKCXRoaXMuY2FjaGVkQkdQYWxldHRlQ29udmVyc2lvbiA9IHRoaXMudG9UeXBlZEFycmF5KHN0YXRlW2luZGV4KytdLCAiaW50MzIiKTsKCXRoaXMuY2FjaGVkT0JKUGFsZXR0ZUNvbnZlcnNpb24gPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgImludDMyIik7Cgl0aGlzLkJHQ0hSQmFuazEgPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgInVpbnQ4Iik7Cgl0aGlzLkJHQ0hSQmFuazIgPSB0aGlzLnRvVHlwZWRBcnJheShzdGF0ZVtpbmRleCsrXSwgInVpbnQ4Iik7Cgl0aGlzLmhhbHRQb3N0Q2xvY2tzID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmludGVycnVwdHNSZXF1ZXN0ZWQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuaW50ZXJydXB0c0VuYWJsZWQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY2hlY2tJUlFNYXRjaGluZygpOwoJdGhpcy5yZW1haW5pbmdDbG9ja3MgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuY29sb3JpemVkR0JQYWxldHRlcyA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5iYWNrZ3JvdW5kWSA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5iYWNrZ3JvdW5kWCA9IHN0YXRlW2luZGV4KytdOwoJdGhpcy5DUFVTdG9wcGVkID0gc3RhdGVbaW5kZXgrK107Cgl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnQgPSBzdGF0ZVtpbmRleCsrXTsKCXRoaXMuYXVkaW9DbG9ja3NVbnRpbE5leHRFdmVudENvdW50ZXIgPSBzdGF0ZVtpbmRleF07Cgl0aGlzLmZyb21TYXZlU3RhdGUgPSB0cnVlOwoJdGhpcy5USUNLVGFibGUgPSB0aGlzLnRvVHlwZWRBcnJheSh0aGlzLlRJQ0tUYWJsZSwgInVpbnQ4Iik7Cgl0aGlzLlNlY29uZGFyeVRJQ0tUYWJsZSA9IHRoaXMudG9UeXBlZEFycmF5KHRoaXMuU2Vjb25kYXJ5VElDS1RhYmxlLCAidWludDgiKTsKCXRoaXMuaW5pdGlhbGl6ZVJlZmVyZW5jZXNGcm9tU2F2ZVN0YXRlKCk7Cgl0aGlzLm1lbW9yeVJlYWRKdW1wQ29tcGlsZSgpOwoJdGhpcy5tZW1vcnlXcml0ZUp1bXBDb21waWxlKCk7Cgl0aGlzLmluaXRMQ0QoKTsKCXRoaXMuaW5pdFNvdW5kKCk7Cgl0aGlzLm5vaXNlU2FtcGxlVGFibGUgPSAodGhpcy5jaGFubmVsNEJpdFJhbmdlID09IDB4N0ZGRikgPyB0aGlzLkxTRlIxNVRhYmxlIDogdGhpcy5MU0ZSN1RhYmxlOwoJdGhpcy5jaGFubmVsNFZvbHVtZVNoaWZ0ZXIgPSAodGhpcy5jaGFubmVsNEJpdFJhbmdlID09IDB4N0ZGRikgPyAxNSA6IDc7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnJldHVybkZyb21SVENTdGF0ZSA9IGZ1bmN0aW9uICgpIHsKCWlmICh0eXBlb2YgdGhpcy5vcGVuUlRDID09ICJmdW5jdGlvbiIgJiYgdGhpcy5jVElNRVIpIHsKCQl2YXIgcnRjRGF0YSA9IHRoaXMub3BlblJUQyh0aGlzLm5hbWUpOwoJCXZhciBpbmRleCA9IDA7CgkJdGhpcy5sYXN0SXRlcmF0aW9uID0gcnRjRGF0YVtpbmRleCsrXTsKCQl0aGlzLlJUQ2lzTGF0Y2hlZCA9IHJ0Y0RhdGFbaW5kZXgrK107CgkJdGhpcy5sYXRjaGVkU2Vjb25kcyA9IHJ0Y0RhdGFbaW5kZXgrK107CgkJdGhpcy5sYXRjaGVkTWludXRlcyA9IHJ0Y0RhdGFbaW5kZXgrK107CgkJdGhpcy5sYXRjaGVkSG91cnMgPSBydGNEYXRhW2luZGV4KytdOwoJCXRoaXMubGF0Y2hlZExEYXlzID0gcnRjRGF0YVtpbmRleCsrXTsKCQl0aGlzLmxhdGNoZWRIRGF5cyA9IHJ0Y0RhdGFbaW5kZXgrK107CgkJdGhpcy5SVENTZWNvbmRzID0gcnRjRGF0YVtpbmRleCsrXTsKCQl0aGlzLlJUQ01pbnV0ZXMgPSBydGNEYXRhW2luZGV4KytdOwoJCXRoaXMuUlRDSG91cnMgPSBydGNEYXRhW2luZGV4KytdOwoJCXRoaXMuUlRDRGF5cyA9IHJ0Y0RhdGFbaW5kZXgrK107CgkJdGhpcy5SVENEYXlPdmVyRmxvdyA9IHJ0Y0RhdGFbaW5kZXgrK107CgkJdGhpcy5SVENIQUxUID0gcnRjRGF0YVtpbmRleF07Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkgewoJdGhpcy5pbml0TWVtb3J5KCk7CS8vV3JpdGUgdGhlIHN0YXJ0dXAgbWVtb3J5LgoJdGhpcy5ST01Mb2FkKCk7CQkvL0xvYWQgdGhlIFJPTSBpbnRvIG1lbW9yeSBhbmQgZ2V0IGNhcnRyaWRnZSBpbmZvcm1hdGlvbiBmcm9tIGl0LgoJdGhpcy5pbml0TENEKCk7CQkvL0luaXRpYWxpemUgdGhlIGdyYXBoaWNzLgoJdGhpcy5pbml0U291bmQoKTsJLy9Tb3VuZCBvYmplY3QgaW5pdGlhbGl6YXRpb24uCgl0aGlzLnJ1bigpOwkJCS8vU3RhcnQgdGhlIGVtdWxhdGlvbi4KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuaW5pdE1lbW9yeSA9IGZ1bmN0aW9uICgpIHsKCS8vSW5pdGlhbGl6ZSB0aGUgUkFNOgoJdGhpcy5tZW1vcnkgPSB0aGlzLmdldFR5cGVkQXJyYXkoMHgxMDAwMCwgMCwgInVpbnQ4Iik7Cgl0aGlzLmZyYW1lQnVmZmVyID0gdGhpcy5nZXRUeXBlZEFycmF5KDIzMDQwLCAweEY4RjhGOCwgImludDMyIik7Cgl0aGlzLkJHQ0hSQmFuazEgPSB0aGlzLmdldFR5cGVkQXJyYXkoMHg4MDAsIDAsICJ1aW50OCIpOwoJdGhpcy5USUNLVGFibGUgPSB0aGlzLnRvVHlwZWRBcnJheSh0aGlzLlRJQ0tUYWJsZSwgInVpbnQ4Iik7Cgl0aGlzLlNlY29uZGFyeVRJQ0tUYWJsZSA9IHRoaXMudG9UeXBlZEFycmF5KHRoaXMuU2Vjb25kYXJ5VElDS1RhYmxlLCAidWludDgiKTsKCXRoaXMuY2hhbm5lbDNQQ00gPSB0aGlzLmdldFR5cGVkQXJyYXkoMHgyMCwgMCwgImludDgiKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ2VuZXJhdGVDYWNoZUFycmF5ID0gZnVuY3Rpb24gKHRpbGVBbW91bnQpIHsKCXZhciB0aWxlQXJyYXkgPSBbXTsKCXZhciB0aWxlTnVtYmVyID0gMDsKCXdoaWxlICh0aWxlTnVtYmVyIDwgdGlsZUFtb3VudCkgewoJCXRpbGVBcnJheVt0aWxlTnVtYmVyKytdID0gdGhpcy5nZXRUeXBlZEFycmF5KDY0LCAwLCAidWludDgiKTsKCX0KCXJldHVybiB0aWxlQXJyYXk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmluaXRTa2lwQm9vdHN0cmFwID0gZnVuY3Rpb24gKCkgewoJLy9GaWxsIGluIHRoZSBib290IFJPTSBzZXQgcmVnaXN0ZXIgdmFsdWVzCgkvL0RlZmF1bHQgdmFsdWVzIHRvIHRoZSBHQiBib290IFJPTSB2YWx1ZXMsIHRoZW4gZmlsbCBpbiB0aGUgR0JDIGJvb3QgUk9NIHZhbHVlcyBhZnRlciBST00gbG9hZGluZwoJdmFyIGluZGV4ID0gMHhGRjsKCXdoaWxlIChpbmRleCA+PSAwKSB7CgkJaWYgKGluZGV4ID49IDB4MzAgJiYgaW5kZXggPCAweDQwKSB7CgkJCXRoaXMubWVtb3J5V3JpdGUoMHhGRjAwIHwgaW5kZXgsIHRoaXMuZmZ4eER1bXBbaW5kZXhdKTsKCQl9CgkJZWxzZSB7CgkJCXN3aXRjaCAoaW5kZXgpIHsKCQkJCWNhc2UgMHgwMDoKCQkJCWNhc2UgMHgwMToKCQkJCWNhc2UgMHgwMjoKCQkJCWNhc2UgMHgwNToKCQkJCWNhc2UgMHgwNzoKCQkJCWNhc2UgMHgwRjoKCQkJCWNhc2UgMHhGRjoKCQkJCQl0aGlzLm1lbW9yeVdyaXRlKDB4RkYwMCB8IGluZGV4LCB0aGlzLmZmeHhEdW1wW2luZGV4XSk7CgkJCQkJYnJlYWs7CgkJCQlkZWZhdWx0OgoJCQkJCXRoaXMubWVtb3J5WzB4RkYwMCB8IGluZGV4XSA9IHRoaXMuZmZ4eER1bXBbaW5kZXhdOwoJCQl9CgkJfQoJCS0taW5kZXg7Cgl9CglpZiAodGhpcy5jR0JDKSB7CgkJdGhpcy5tZW1vcnlbMHhGRjZDXSA9IDB4RkU7CgkJdGhpcy5tZW1vcnlbMHhGRjc0XSA9IDB4RkU7Cgl9CgllbHNlIHsKCQl0aGlzLm1lbW9yeVsweEZGNDhdID0gMHhGRjsKCQl0aGlzLm1lbW9yeVsweEZGNDldID0gMHhGRjsKCQl0aGlzLm1lbW9yeVsweEZGNkNdID0gMHhGRjsKCQl0aGlzLm1lbW9yeVsweEZGNzRdID0gMHhGRjsKCX0KCS8vU3RhcnQgYXMgYW4gdW5zZXQgZGV2aWNlOgoJY291dCgiU3RhcnRpbmcgd2l0aG91dCB0aGUgR0JDIGJvb3QgUk9NLiIsIDApOwoJdGhpcy5yZWdpc3RlckEgPSAodGhpcy5jR0JDKSA/IDB4MTEgOiAweDE7Cgl0aGlzLnJlZ2lzdGVyQiA9IDA7Cgl0aGlzLnJlZ2lzdGVyQyA9IDB4MTM7Cgl0aGlzLnJlZ2lzdGVyRCA9IDA7Cgl0aGlzLnJlZ2lzdGVyRSA9IDB4RDg7Cgl0aGlzLkZaZXJvID0gdHJ1ZTsKCXRoaXMuRlN1YnRyYWN0ID0gZmFsc2U7Cgl0aGlzLkZIYWxmQ2FycnkgPSB0cnVlOwoJdGhpcy5GQ2FycnkgPSB0cnVlOwoJdGhpcy5yZWdpc3RlcnNITCA9IDB4MDE0RDsKCXRoaXMuTENEQ09OVFJPTCA9IHRoaXMuTElORUNPTlRST0w7Cgl0aGlzLklNRSA9IGZhbHNlOwoJdGhpcy5JUlFMaW5lTWF0Y2hlZCA9IDA7Cgl0aGlzLmludGVycnVwdHNSZXF1ZXN0ZWQgPSAyMjU7Cgl0aGlzLmludGVycnVwdHNFbmFibGVkID0gMDsKCXRoaXMuaGRtYVJ1bm5pbmcgPSBmYWxzZTsKCXRoaXMuQ1BVVGlja3MgPSAxMjsKCXRoaXMuU1RBVFRyYWNrZXIgPSAwOwoJdGhpcy5tb2RlU1RBVCA9IDE7Cgl0aGlzLnNwcml0ZUNvdW50ID0gMjUyOwoJdGhpcy5MWUNNYXRjaFRyaWdnZXJTVEFUID0gZmFsc2U7Cgl0aGlzLm1vZGUyVHJpZ2dlclNUQVQgPSBmYWxzZTsKCXRoaXMubW9kZTFUcmlnZ2VyU1RBVCA9IGZhbHNlOwoJdGhpcy5tb2RlMFRyaWdnZXJTVEFUID0gZmFsc2U7Cgl0aGlzLkxDRGlzT24gPSB0cnVlOwoJdGhpcy5jaGFubmVsMUZyZXF1ZW5jeVRyYWNrZXIgPSAweDIwMDA7Cgl0aGlzLmNoYW5uZWwxRHV0eVRyYWNrZXIgPSAwOwoJdGhpcy5jaGFubmVsMUNhY2hlZER1dHkgPSB0aGlzLmR1dHlMb29rdXBbMl07Cgl0aGlzLmNoYW5uZWwxdG90YWxMZW5ndGggPSAwOwoJdGhpcy5jaGFubmVsMWVudmVsb3BlVm9sdW1lID0gMDsKCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVR5cGUgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVN3ZWVwcyA9IDA7Cgl0aGlzLmNoYW5uZWwxZW52ZWxvcGVTd2VlcHNMYXN0ID0gMDsKCXRoaXMuY2hhbm5lbDFjb25zZWN1dGl2ZSA9IHRydWU7Cgl0aGlzLmNoYW5uZWwxZnJlcXVlbmN5ID0gMTk4NTsKCXRoaXMuY2hhbm5lbDFTd2VlcEZhdWx0ID0gdHJ1ZTsKCXRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgPSAxOTg1OwoJdGhpcy5jaGFubmVsMXRpbWVTd2VlcCA9IDE7Cgl0aGlzLmNoYW5uZWwxbGFzdFRpbWVTd2VlcCA9IDA7Cgl0aGlzLmNoYW5uZWwxU3dlcHQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDFmcmVxdWVuY3lTd2VlcERpdmlkZXIgPSAwOwoJdGhpcy5jaGFubmVsMWRlY3JlYXNlU3dlZXAgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDJGcmVxdWVuY3lUcmFja2VyID0gMHgyMDAwOwoJdGhpcy5jaGFubmVsMkR1dHlUcmFja2VyID0gMDsKCXRoaXMuY2hhbm5lbDJDYWNoZWREdXR5ID0gdGhpcy5kdXR5TG9va3VwWzJdOwoJdGhpcy5jaGFubmVsMnRvdGFsTGVuZ3RoID0gMDsKCXRoaXMuY2hhbm5lbDJlbnZlbG9wZVZvbHVtZSA9IDA7Cgl0aGlzLmNoYW5uZWwyZW52ZWxvcGVUeXBlID0gZmFsc2U7Cgl0aGlzLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHMgPSAwOwoJdGhpcy5jaGFubmVsMmVudmVsb3BlU3dlZXBzTGFzdCA9IDA7Cgl0aGlzLmNoYW5uZWwyY29uc2VjdXRpdmUgPSB0cnVlOwoJdGhpcy5jaGFubmVsMmZyZXF1ZW5jeSA9IDA7Cgl0aGlzLmNoYW5uZWwzY2FuUGxheSA9IGZhbHNlOwoJdGhpcy5jaGFubmVsM3RvdGFsTGVuZ3RoID0gMDsKCXRoaXMuY2hhbm5lbDNwYXR0ZXJuVHlwZSA9IDQ7Cgl0aGlzLmNoYW5uZWwzZnJlcXVlbmN5ID0gMDsKCXRoaXMuY2hhbm5lbDNjb25zZWN1dGl2ZSA9IHRydWU7Cgl0aGlzLmNoYW5uZWwzQ291bnRlciA9IDB4NDE4OwoJdGhpcy5jaGFubmVsNEZyZXF1ZW5jeVBlcmlvZCA9IDg7Cgl0aGlzLmNoYW5uZWw0dG90YWxMZW5ndGggPSAwOwoJdGhpcy5jaGFubmVsNGVudmVsb3BlVm9sdW1lID0gMDsKCXRoaXMuY2hhbm5lbDRjdXJyZW50Vm9sdW1lID0gMDsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVR5cGUgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwcyA9IDA7Cgl0aGlzLmNoYW5uZWw0ZW52ZWxvcGVTd2VlcHNMYXN0ID0gMDsKCXRoaXMuY2hhbm5lbDRjb25zZWN1dGl2ZSA9IHRydWU7Cgl0aGlzLmNoYW5uZWw0Qml0UmFuZ2UgPSAweDdGRkY7Cgl0aGlzLmNoYW5uZWw0Vm9sdW1lU2hpZnRlciA9IDE1OwoJdGhpcy5jaGFubmVsMUZyZXF1ZW5jeUNvdW50ZXIgPSAweDIwMDsKCXRoaXMuY2hhbm5lbDJGcmVxdWVuY3lDb3VudGVyID0gMHgyMDA7Cgl0aGlzLmNoYW5uZWwzQ291bnRlciA9IDB4ODAwOwoJdGhpcy5jaGFubmVsM0ZyZXF1ZW5jeVBlcmlvZCA9IDB4ODAwOwoJdGhpcy5jaGFubmVsM2xhc3RTYW1wbGVMb29rdXAgPSAwOwoJdGhpcy5jaGFubmVsNGxhc3RTYW1wbGVMb29rdXAgPSAwOwoJdGhpcy5WaW5MZWZ0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IDg7Cgl0aGlzLlZpblJpZ2h0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IDg7Cgl0aGlzLnNvdW5kTWFzdGVyRW5hYmxlZCA9IHRydWU7Cgl0aGlzLmxlZnRDaGFubmVsMSA9IHRydWU7Cgl0aGlzLmxlZnRDaGFubmVsMiA9IHRydWU7Cgl0aGlzLmxlZnRDaGFubmVsMyA9IHRydWU7Cgl0aGlzLmxlZnRDaGFubmVsNCA9IHRydWU7Cgl0aGlzLnJpZ2h0Q2hhbm5lbDEgPSB0cnVlOwoJdGhpcy5yaWdodENoYW5uZWwyID0gdHJ1ZTsKCXRoaXMucmlnaHRDaGFubmVsMyA9IGZhbHNlOwoJdGhpcy5yaWdodENoYW5uZWw0ID0gZmFsc2U7Cgl0aGlzLkRJVlRpY2tzID0gMjcwNDQ7Cgl0aGlzLkxDRFRpY2tzID0gMTYwOwoJdGhpcy50aW1lclRpY2tzID0gMDsKCXRoaXMuVElNQUVuYWJsZWQgPSBmYWxzZTsKCXRoaXMuVEFDQ2xvY2tlciA9IDEwMjQ7Cgl0aGlzLnNlcmlhbFRpbWVyID0gMDsKCXRoaXMuc2VyaWFsU2hpZnRUaW1lciA9IDA7Cgl0aGlzLnNlcmlhbFNoaWZ0VGltZXJBbGxvY2F0ZWQgPSAwOwoJdGhpcy5JUlFFbmFibGVEZWxheSA9IDA7Cgl0aGlzLmFjdHVhbFNjYW5MaW5lID0gMTQ0OwoJdGhpcy5sYXN0VW5yZW5kZXJlZExpbmUgPSAwOwoJdGhpcy5nZnhXaW5kb3dEaXNwbGF5ID0gZmFsc2U7Cgl0aGlzLmdmeFNwcml0ZVNob3cgPSBmYWxzZTsKCXRoaXMuZ2Z4U3ByaXRlTm9ybWFsSGVpZ2h0ID0gdHJ1ZTsKCXRoaXMuYmdFbmFibGVkID0gdHJ1ZTsKCXRoaXMuQkdQcmlvcml0eUVuYWJsZWQgPSB0cnVlOwoJdGhpcy5nZnhXaW5kb3dDSFJCYW5rUG9zaXRpb24gPSAwOwoJdGhpcy5nZnhCYWNrZ3JvdW5kQ0hSQmFua1Bvc2l0aW9uID0gMDsKCXRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQgPSAwOwoJdGhpcy53aW5kb3dZID0gMDsKCXRoaXMud2luZG93WCA9IDA7Cgl0aGlzLmRyZXdCbGFuayA9IDA7Cgl0aGlzLm1pZFNjYW5saW5lT2Zmc2V0ID0gLTE7Cgl0aGlzLmN1cnJlbnRYID0gMDsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuaW5pdEJvb3RzdHJhcCA9IGZ1bmN0aW9uICgpIHsKCS8vU3RhcnQgYXMgYW4gdW5zZXQgZGV2aWNlOgoJY291dCgiU3RhcnRpbmcgdGhlIHNlbGVjdGVkIGJvb3QgUk9NLiIsIDApOwoJdGhpcy5wcm9ncmFtQ291bnRlciA9IDA7Cgl0aGlzLnN0YWNrUG9pbnRlciA9IDA7Cgl0aGlzLklNRSA9IGZhbHNlOwoJdGhpcy5MQ0RUaWNrcyA9IDA7Cgl0aGlzLkRJVlRpY2tzID0gMDsKCXRoaXMucmVnaXN0ZXJBID0gMDsKCXRoaXMucmVnaXN0ZXJCID0gMDsKCXRoaXMucmVnaXN0ZXJDID0gMDsKCXRoaXMucmVnaXN0ZXJEID0gMDsKCXRoaXMucmVnaXN0ZXJFID0gMDsKCXRoaXMuRlplcm8gPSB0aGlzLkZTdWJ0cmFjdCA9IHRoaXMuRkhhbGZDYXJyeSA9IHRoaXMuRkNhcnJ5ID0gZmFsc2U7Cgl0aGlzLnJlZ2lzdGVyc0hMID0gMDsKCXRoaXMubGVmdENoYW5uZWwxID0gZmFsc2U7Cgl0aGlzLmxlZnRDaGFubmVsMiA9IGZhbHNlOwoJdGhpcy5sZWZ0Q2hhbm5lbDMgPSBmYWxzZTsKCXRoaXMubGVmdENoYW5uZWw0ID0gZmFsc2U7Cgl0aGlzLnJpZ2h0Q2hhbm5lbDEgPSBmYWxzZTsKCXRoaXMucmlnaHRDaGFubmVsMiA9IGZhbHNlOwoJdGhpcy5yaWdodENoYW5uZWwzID0gZmFsc2U7Cgl0aGlzLnJpZ2h0Q2hhbm5lbDQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDJmcmVxdWVuY3kgPSB0aGlzLmNoYW5uZWwxZnJlcXVlbmN5ID0gMDsKCXRoaXMuY2hhbm5lbDRjb25zZWN1dGl2ZSA9IHRoaXMuY2hhbm5lbDJjb25zZWN1dGl2ZSA9IHRoaXMuY2hhbm5lbDFjb25zZWN1dGl2ZSA9IGZhbHNlOwoJdGhpcy5WaW5MZWZ0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IDg7Cgl0aGlzLlZpblJpZ2h0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IDg7Cgl0aGlzLm1lbW9yeVsweEZGMDBdID0gMHhGOwkvL1NldCB0aGUgam95cGFkIHN0YXRlLgp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5ST01Mb2FkID0gZnVuY3Rpb24gKCkgewoJLy9Mb2FkIHRoZSBmaXJzdCB0d28gUk9NIGJhbmtzICgweDAwMDAgLSAweDdGRkYpIGludG8gcmVndWxhciBnYW1lYm95IG1lbW9yeToKCXRoaXMuUk9NID0gW107Cgl0aGlzLnVzZWRCb290Uk9NID0gc2V0dGluZ3NbMV0gJiYgKCghc2V0dGluZ3NbMTFdICYmIHRoaXMuR0JDQk9PVFJPTS5sZW5ndGggPT0gMHg4MDApIHx8IChzZXR0aW5nc1sxMV0gJiYgdGhpcy5HQkJPT1RST00ubGVuZ3RoID09IDB4MTAwKSk7Cgl2YXIgbWF4TGVuZ3RoID0gdGhpcy5ST01JbWFnZS5sZW5ndGg7CglpZiAobWF4TGVuZ3RoIDwgMHg0MDAwKSB7CgkJdGhyb3cobmV3IEVycm9yKCJST00gaW1hZ2Ugc2l6ZSB0b28gc21hbGwuIikpOwoJfQoJdGhpcy5ST00gPSB0aGlzLmdldFR5cGVkQXJyYXkobWF4TGVuZ3RoLCAwLCAidWludDgiKTsKCXZhciByb21JbmRleCA9IDA7CglpZiAodGhpcy51c2VkQm9vdFJPTSkgewoJCWlmICghc2V0dGluZ3NbMTFdKSB7CgkJCS8vUGF0Y2ggaW4gdGhlIEdCQyBib290IFJPTSBpbnRvIHRoZSBtZW1vcnkgbWFwOgoJCQlmb3IgKDsgcm9tSW5kZXggPCAweDEwMDsgKytyb21JbmRleCkgewoJCQkJdGhpcy5tZW1vcnlbcm9tSW5kZXhdID0gdGhpcy5HQkNCT09UUk9NW3JvbUluZGV4XTsJCQkJCQkJCQkJCS8vTG9hZCBpbiB0aGUgR2FtZUJveSBDb2xvciBCT09UIFJPTS4KCQkJCXRoaXMuUk9NW3JvbUluZGV4XSA9ICh0aGlzLlJPTUltYWdlLmNoYXJDb2RlQXQocm9tSW5kZXgpICYgMHhGRik7CQkJCQkJCS8vRGVjb2RlIHRoZSBST00gYmluYXJ5IGZvciB0aGUgc3dpdGNoIG91dC4KCQkJfQoJCQlmb3IgKDsgcm9tSW5kZXggPCAweDIwMDsgKytyb21JbmRleCkgewoJCQkJdGhpcy5tZW1vcnlbcm9tSW5kZXhdID0gdGhpcy5ST01bcm9tSW5kZXhdID0gKHRoaXMuUk9NSW1hZ2UuY2hhckNvZGVBdChyb21JbmRleCkgJiAweEZGKTsJLy9Mb2FkIGluIHRoZSBnYW1lIFJPTS4KCQkJfQoJCQlmb3IgKDsgcm9tSW5kZXggPCAweDkwMDsgKytyb21JbmRleCkgewoJCQkJdGhpcy5tZW1vcnlbcm9tSW5kZXhdID0gdGhpcy5HQkNCT09UUk9NW3JvbUluZGV4IC0gMHgxMDBdOwkJCQkJCQkJCS8vTG9hZCBpbiB0aGUgR2FtZUJveSBDb2xvciBCT09UIFJPTS4KCQkJCXRoaXMuUk9NW3JvbUluZGV4XSA9ICh0aGlzLlJPTUltYWdlLmNoYXJDb2RlQXQocm9tSW5kZXgpICYgMHhGRik7CQkJCQkJCS8vRGVjb2RlIHRoZSBST00gYmluYXJ5IGZvciB0aGUgc3dpdGNoIG91dC4KCQkJfQoJCQl0aGlzLnVzZWRHQkNCb290Uk9NID0gdHJ1ZTsKCQl9CgkJZWxzZSB7CgkJCS8vUGF0Y2ggaW4gdGhlIEdCQyBib290IFJPTSBpbnRvIHRoZSBtZW1vcnkgbWFwOgoJCQlmb3IgKDsgcm9tSW5kZXggPCAweDEwMDsgKytyb21JbmRleCkgewoJCQkJdGhpcy5tZW1vcnlbcm9tSW5kZXhdID0gdGhpcy5HQkJPT1RST01bcm9tSW5kZXhdOwkJCQkJCQkJCQkJLy9Mb2FkIGluIHRoZSBHYW1lQm95IENvbG9yIEJPT1QgUk9NLgoJCQkJdGhpcy5ST01bcm9tSW5kZXhdID0gKHRoaXMuUk9NSW1hZ2UuY2hhckNvZGVBdChyb21JbmRleCkgJiAweEZGKTsJCQkJCQkJLy9EZWNvZGUgdGhlIFJPTSBiaW5hcnkgZm9yIHRoZSBzd2l0Y2ggb3V0LgoJCQl9CgkJfQoJCWZvciAoOyByb21JbmRleCA8IDB4NDAwMDsgKytyb21JbmRleCkgewoJCQl0aGlzLm1lbW9yeVtyb21JbmRleF0gPSB0aGlzLlJPTVtyb21JbmRleF0gPSAodGhpcy5ST01JbWFnZS5jaGFyQ29kZUF0KHJvbUluZGV4KSAmIDB4RkYpOwkvL0xvYWQgaW4gdGhlIGdhbWUgUk9NLgoJCX0KCX0KCWVsc2UgewoJCS8vRG9uJ3QgbG9hZCBpbiB0aGUgYm9vdCBST006CgkJZm9yICg7IHJvbUluZGV4IDwgMHg0MDAwOyArK3JvbUluZGV4KSB7CgkJCXRoaXMubWVtb3J5W3JvbUluZGV4XSA9IHRoaXMuUk9NW3JvbUluZGV4XSA9ICh0aGlzLlJPTUltYWdlLmNoYXJDb2RlQXQocm9tSW5kZXgpICYgMHhGRik7CS8vTG9hZCBpbiB0aGUgZ2FtZSBST00uCgkJfQoJfQoJLy9GaW5pc2ggdGhlIGRlY29kaW5nIG9mIHRoZSBST00gYmluYXJ5OgoJZm9yICg7IHJvbUluZGV4IDwgbWF4TGVuZ3RoOyArK3JvbUluZGV4KSB7CgkJdGhpcy5ST01bcm9tSW5kZXhdID0gKHRoaXMuUk9NSW1hZ2UuY2hhckNvZGVBdChyb21JbmRleCkgJiAweEZGKTsKCX0KCXRoaXMuUk9NQmFua0VkZ2UgPSBNYXRoLmZsb29yKHRoaXMuUk9NLmxlbmd0aCAvIDB4NDAwMCk7CgkvL1NldCB1cCB0aGUgZW11bGF0b3IgZm9yIHRoZSBjYXJ0aWRnZSBzcGVjaWZpY3M6Cgl0aGlzLmludGVycHJldENhcnRyaWRnZSgpOwoJLy9DaGVjayBmb3IgSVJRIG1hdGNoaW5nIHVwb24gaW5pdGlhbGl6YXRpb246Cgl0aGlzLmNoZWNrSVJRTWF0Y2hpbmcoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ2V0Uk9NSW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkvL1JldHVybiB0aGUgYmluYXJ5IHZlcnNpb24gb2YgdGhlIFJPTSBpbWFnZSBjdXJyZW50bHkgcnVubmluZzoKCWlmICh0aGlzLlJPTUltYWdlLmxlbmd0aCA+IDApIHsKCQlyZXR1cm4gdGhpcy5ST01JbWFnZS5sZW5ndGg7Cgl9Cgl2YXIgbGVuZ3RoID0gdGhpcy5ST00ubGVuZ3RoOwoJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewoJCXRoaXMuUk9NSW1hZ2UgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSh0aGlzLlJPTVtpbmRleF0pOwoJfQoJcmV0dXJuIHRoaXMuUk9NSW1hZ2U7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmludGVycHJldENhcnRyaWRnZSA9IGZ1bmN0aW9uICgpIHsKCS8vIFJPTSBuYW1lCglmb3IgKHZhciBpbmRleCA9IDB4MTM0OyBpbmRleCA8IDB4MTNGOyBpbmRleCsrKSB7CgkJaWYgKHRoaXMuUk9NSW1hZ2UuY2hhckNvZGVBdChpbmRleCkgPiAwKSB7CgkJCXRoaXMubmFtZSArPSB0aGlzLlJPTUltYWdlW2luZGV4XTsKCQl9Cgl9CgkvLyBST00gZ2FtZSBjb2RlIChmb3IgbmV3ZXIgZ2FtZXMpCglmb3IgKHZhciBpbmRleCA9IDB4MTNGOyBpbmRleCA8IDB4MTQzOyBpbmRleCsrKSB7CgkJaWYgKHRoaXMuUk9NSW1hZ2UuY2hhckNvZGVBdChpbmRleCkgPiAwKSB7CgkJCXRoaXMuZ2FtZUNvZGUgKz0gdGhpcy5ST01JbWFnZVtpbmRleF07CgkJfQoJfQoJY291dCgiR2FtZSBUaXRsZTogIiArIHRoaXMubmFtZSArICJbIiArIHRoaXMuZ2FtZUNvZGUgKyAiXVsiICsgdGhpcy5ST01JbWFnZVsweDE0M10gKyAiXSIsIDApOwoJY291dCgiR2FtZSBDb2RlOiAiICsgdGhpcy5nYW1lQ29kZSwgMCk7CgkvLyBDYXJ0cmlkZ2UgdHlwZQoJdGhpcy5jYXJ0cmlkZ2VUeXBlID0gdGhpcy5ST01bMHgxNDddOwoJY291dCgiQ2FydHJpZGdlIHR5cGUgIyIgKyB0aGlzLmNhcnRyaWRnZVR5cGUsIDApOwoJLy9NYXAgb3V0IFJPTSBjYXJ0cmlkZ2Ugc3ViLXR5cGVzLgoJdmFyIE1CQ1R5cGUgPSAiIjsKCXN3aXRjaCAodGhpcy5jYXJ0cmlkZ2VUeXBlKSB7CgkJY2FzZSAweDAwOgoJCQkvL1JPTSB3L28gYmFuayBzd2l0Y2hpbmcKCQkJaWYgKCFzZXR0aW5nc1s5XSkgewoJCQkJTUJDVHlwZSA9ICJST00iOwoJCQkJYnJlYWs7CgkJCX0KCQljYXNlIDB4MDE6CgkJCXRoaXMuY01CQzEgPSB0cnVlOwoJCQlNQkNUeXBlID0gIk1CQzEiOwoJCQlicmVhazsKCQljYXNlIDB4MDI6CgkJCXRoaXMuY01CQzEgPSB0cnVlOwoJCQl0aGlzLmNTUkFNID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkMxICsgU1JBTSI7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMzoKCQkJdGhpcy5jTUJDMSA9IHRydWU7CgkJCXRoaXMuY1NSQU0gPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkMxICsgU1JBTSArIEJBVFQiOwoJCQlicmVhazsKCQljYXNlIDB4MDU6CgkJCXRoaXMuY01CQzIgPSB0cnVlOwoJCQlNQkNUeXBlID0gIk1CQzIiOwoJCQlicmVhazsKCQljYXNlIDB4MDY6CgkJCXRoaXMuY01CQzIgPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkMyICsgQkFUVCI7CgkJCWJyZWFrOwoJCWNhc2UgMHgwODoKCQkJdGhpcy5jU1JBTSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiUk9NICsgU1JBTSI7CgkJCWJyZWFrOwoJCWNhc2UgMHgwOToKCQkJdGhpcy5jU1JBTSA9IHRydWU7CgkJCXRoaXMuY0JBVFQgPSB0cnVlOwoJCQlNQkNUeXBlID0gIlJPTSArIFNSQU0gKyBCQVRUIjsKCQkJYnJlYWs7CgkJY2FzZSAweDBCOgoJCQl0aGlzLmNNTU1PMSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiTU1NTzEiOwoJCQlicmVhazsKCQljYXNlIDB4MEM6CgkJCXRoaXMuY01NTU8xID0gdHJ1ZTsKCQkJdGhpcy5jU1JBTSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiTU1NTzEgKyBTUkFNIjsKCQkJYnJlYWs7CgkJY2FzZSAweDBEOgoJCQl0aGlzLmNNTU1PMSA9IHRydWU7CgkJCXRoaXMuY1NSQU0gPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNTU1PMSArIFNSQU0gKyBCQVRUIjsKCQkJYnJlYWs7CgkJY2FzZSAweDBGOgoJCQl0aGlzLmNNQkMzID0gdHJ1ZTsKCQkJdGhpcy5jVElNRVIgPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkMzICsgVElNRVIgKyBCQVRUIjsKCQkJYnJlYWs7CgkJY2FzZSAweDEwOgoJCQl0aGlzLmNNQkMzID0gdHJ1ZTsKCQkJdGhpcy5jVElNRVIgPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJdGhpcy5jU1JBTSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiTUJDMyArIFRJTUVSICsgQkFUVCArIFNSQU0iOwoJCQlicmVhazsKCQljYXNlIDB4MTE6CgkJCXRoaXMuY01CQzMgPSB0cnVlOwoJCQlNQkNUeXBlID0gIk1CQzMiOwoJCQlicmVhazsKCQljYXNlIDB4MTI6CgkJCXRoaXMuY01CQzMgPSB0cnVlOwoJCQl0aGlzLmNTUkFNID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkMzICsgU1JBTSI7CgkJCWJyZWFrOwoJCWNhc2UgMHgxMzoKCQkJdGhpcy5jTUJDMyA9IHRydWU7CgkJCXRoaXMuY1NSQU0gPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkMzICsgU1JBTSArIEJBVFQiOwoJCQlicmVhazsKCQljYXNlIDB4MTk6CgkJCXRoaXMuY01CQzUgPSB0cnVlOwoJCQlNQkNUeXBlID0gIk1CQzUiOwoJCQlicmVhazsKCQljYXNlIDB4MUE6CgkJCXRoaXMuY01CQzUgPSB0cnVlOwoJCQl0aGlzLmNTUkFNID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkM1ICsgU1JBTSI7CgkJCWJyZWFrOwoJCWNhc2UgMHgxQjoKCQkJdGhpcy5jTUJDNSA9IHRydWU7CgkJCXRoaXMuY1NSQU0gPSB0cnVlOwoJCQl0aGlzLmNCQVRUID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJNQkM1ICsgU1JBTSArIEJBVFQiOwoJCQlicmVhazsKCQljYXNlIDB4MUM6CgkJCXRoaXMuY1JVTUJMRSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiUlVNQkxFIjsKCQkJYnJlYWs7CgkJY2FzZSAweDFEOgoJCQl0aGlzLmNSVU1CTEUgPSB0cnVlOwoJCQl0aGlzLmNTUkFNID0gdHJ1ZTsKCQkJTUJDVHlwZSA9ICJSVU1CTEUgKyBTUkFNIjsKCQkJYnJlYWs7CgkJY2FzZSAweDFFOgoJCQl0aGlzLmNSVU1CTEUgPSB0cnVlOwoJCQl0aGlzLmNTUkFNID0gdHJ1ZTsKCQkJdGhpcy5jQkFUVCA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiUlVNQkxFICsgU1JBTSArIEJBVFQiOwoJCQlicmVhazsKCQljYXNlIDB4MUY6CgkJCXRoaXMuY0NhbWVyYSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiR2FtZUJveSBDYW1lcmEiOwoJCQlicmVhazsKCQljYXNlIDB4MjI6CgkJCXRoaXMuY01CQzcgPSB0cnVlOwoJCQl0aGlzLmNTUkFNID0gdHJ1ZTsKCQkJdGhpcy5jQkFUVCA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiTUJDNyArIFNSQU0gKyBCQVRUIjsKCQkJYnJlYWs7CgkJY2FzZSAweEZEOgoJCQl0aGlzLmNUQU1BNSA9IHRydWU7CgkJCU1CQ1R5cGUgPSAiVEFNQTUiOwoJCQlicmVhazsKCQljYXNlIDB4RkU6CgkJCXRoaXMuY0h1QzMgPSB0cnVlOwoJCQlNQkNUeXBlID0gIkh1QzMiOwoJCQlicmVhazsKCQljYXNlIDB4RkY6CgkJCXRoaXMuY0h1QzEgPSB0cnVlOwoJCQlNQkNUeXBlID0gIkh1QzEiOwoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQlNQkNUeXBlID0gIlVua25vd24iOwoJCQljb3V0KCJDYXJ0cmlkZ2UgdHlwZSBpcyB1bmtub3duLiIsIDIpOwoJCQlwYXVzZSgpOwoJfQoJY291dCgiQ2FydHJpZGdlIFR5cGU6ICIgKyBNQkNUeXBlICsgIi4iLCAwKTsKCS8vIFJPTSBhbmQgUkFNIGJhbmtzCgl0aGlzLm51bVJPTUJhbmtzID0gdGhpcy5ST01CYW5rc1t0aGlzLlJPTVsweDE0OF1dOwoJY291dCh0aGlzLm51bVJPTUJhbmtzICsgIiBST00gYmFua3MuIiwgMCk7Cglzd2l0Y2ggKHRoaXMuUkFNQmFua3NbdGhpcy5ST01bMHgxNDldXSkgewoJCWNhc2UgMDoKCQkJY291dCgiTm8gUkFNIGJhbmtpbmcgcmVxdWVzdGVkIGZvciBhbGxvY2F0aW9uIG9yIE1CQyBpcyBvZiB0eXBlIDIuIiwgMCk7CgkJCWJyZWFrOwoJCWNhc2UgMjoKCQkJY291dCgiMSBSQU0gYmFuayByZXF1ZXN0ZWQgZm9yIGFsbG9jYXRpb24uIiwgMCk7CgkJCWJyZWFrOwoJCWNhc2UgMzoKCQkJY291dCgiNCBSQU0gYmFua3MgcmVxdWVzdGVkIGZvciBhbGxvY2F0aW9uLiIsIDApOwoJCQlicmVhazsKCQljYXNlIDQ6CgkJCWNvdXQoIjE2IFJBTSBiYW5rcyByZXF1ZXN0ZWQgZm9yIGFsbG9jYXRpb24uIiwgMCk7CgkJCWJyZWFrOwoJCWRlZmF1bHQ6CgkJCWNvdXQoIlJBTSBiYW5rIGFtb3VudCByZXF1ZXN0ZWQgaXMgdW5rbm93biwgd2lsbCB1c2UgbWF4aW11bSBhbGxvd2VkIGJ5IHNwZWNpZmllZCBNQkMgdHlwZS4iLCAwKTsKCX0KCS8vQ2hlY2sgdGhlIEdCL0dCQyBtb2RlIGJ5dGU6CglpZiAoIXRoaXMudXNlZEJvb3RST00pIHsKCQlzd2l0Y2ggKHRoaXMuUk9NWzB4MTQzXSkgewoJCQljYXNlIDB4MDA6CS8vT25seSBHQiBtb2RlCgkJCQl0aGlzLmNHQkMgPSBmYWxzZTsKCQkJCWNvdXQoIk9ubHkgR0IgbW9kZSBkZXRlY3RlZC4iLCAwKTsKCQkJCWJyZWFrOwoJCQljYXNlIDB4MzI6CS8vRXhjZXB0aW9uIHRvIHRoZSBHQkMgaWRlbnRpZnlpbmcgY29kZToKCQkJCWlmICghc2V0dGluZ3NbMl0gJiYgdGhpcy5uYW1lICsgdGhpcy5nYW1lQ29kZSArIHRoaXMuUk9NWzB4MTQzXSA9PSAiR2FtZSBhbmQgV2F0Y2ggNTAiKSB7CgkJCQkJdGhpcy5jR0JDID0gdHJ1ZTsKCQkJCQljb3V0KCJDcmVhdGVkIGEgYm9vdCBleGNlcHRpb24gZm9yIEdhbWUgYW5kIFdhdGNoIEdhbGxlcnkgMiAoR0JDIElEIGJ5dGUgaXMgd3Jvbmcgb24gdGhlIGNhcnRyaWRnZSkuIiwgMSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQl0aGlzLmNHQkMgPSBmYWxzZTsKCQkJCX0KCQkJCWJyZWFrOwoJCQljYXNlIDB4ODA6CS8vQm90aCBHQiArIEdCQyBtb2RlcwoJCQkJdGhpcy5jR0JDID0gIXNldHRpbmdzWzJdOwoJCQkJY291dCgiR0IgYW5kIEdCQyBtb2RlIGRldGVjdGVkLiIsIDApOwoJCQkJYnJlYWs7CgkJCWNhc2UgMHhDMDoJLy9Pbmx5IEdCQyBtb2RlCgkJCQl0aGlzLmNHQkMgPSB0cnVlOwoJCQkJY291dCgiT25seSBHQkMgbW9kZSBkZXRlY3RlZC4iLCAwKTsKCQkJCWJyZWFrOwoJCQlkZWZhdWx0OgoJCQkJdGhpcy5jR0JDID0gZmFsc2U7CgkJCQljb3V0KCJVbmtub3duIEdhbWVCb3kgZ2FtZSB0eXBlIGNvZGUgIyIgKyB0aGlzLlJPTVsweDE0M10gKyAiLCBkZWZhdWx0aW5nIHRvIEdCIG1vZGUgKE9sZCBnYW1lcyBkb24ndCBoYXZlIGEgdHlwZSBjb2RlKS4iLCAxKTsKCQl9CgkJdGhpcy5pbkJvb3RzdHJhcCA9IGZhbHNlOwoJCXRoaXMuc2V0dXBSQU0oKTsJLy9DUFUvKFYpUkFNIGluaXRpYWxpemF0aW9uLgoJCXRoaXMuaW5pdFNraXBCb290c3RyYXAoKTsKCX0KCWVsc2UgewoJCXRoaXMuY0dCQyA9IHRoaXMudXNlZEdCQ0Jvb3RST007CS8vQWxsb3cgdGhlIEdCQyBib290IFJPTSB0byBydW4gaW4gR0JDIG1vZGUuLi4KCQl0aGlzLnNldHVwUkFNKCk7CS8vQ1BVLyhWKVJBTSBpbml0aWFsaXphdGlvbi4KCQl0aGlzLmluaXRCb290c3RyYXAoKTsKCX0KCXRoaXMuaW5pdGlhbGl6ZU1vZGVTcGVjaWZpY0FycmF5cygpOwoJLy9MaWNlbnNlIENvZGUgTG9va3VwOgoJdmFyIGNPbGRMaWNlbnNlID0gdGhpcy5ST01bMHgxNEJdOwoJdmFyIGNOZXdMaWNlbnNlID0gKHRoaXMuUk9NWzB4MTQ0XSAmIDB4RkYwMCkgfCAodGhpcy5ST01bMHgxNDVdICYgMHhGRik7CglpZiAoY09sZExpY2Vuc2UgIT0gMHgzMykgewoJCS8vT2xkIFN0eWxlIExpY2Vuc2UgSGVhZGVyCgkJY291dCgiT2xkIHN0eWxlIGxpY2Vuc2UgY29kZTogIiArIGNPbGRMaWNlbnNlLCAwKTsKCX0KCWVsc2UgewoJCS8vTmV3IFN0eWxlIExpY2Vuc2UgSGVhZGVyCgkJY291dCgiTmV3IHN0eWxlIGxpY2Vuc2UgY29kZTogIiArIGNOZXdMaWNlbnNlLCAwKTsKCX0KCXRoaXMuUk9NSW1hZ2UgPSAiIjsJLy9NZW1vcnkgY29uc3VtcHRpb24gcmVkdWN0aW9uLgp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5kaXNhYmxlQm9vdFJPTSA9IGZ1bmN0aW9uICgpIHsKCS8vUmVtb3ZlIGFueSB0cmFjZXMgb2YgdGhlIGJvb3QgUk9NIGZyb20gUk9NIG1lbW9yeS4KCWZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCAweDEwMDsgKytpbmRleCkgewoJCXRoaXMubWVtb3J5W2luZGV4XSA9IHRoaXMuUk9NW2luZGV4XTsJLy9SZXBsYWNlIHRoZSBHYW1lQm95IG9yIEdhbWVCb3kgQ29sb3IgYm9vdCBST00gd2l0aCB0aGUgZ2FtZSBST00uCgl9CglpZiAodGhpcy51c2VkR0JDQm9vdFJPTSkgewoJCS8vUmVtb3ZlIGFueSB0cmFjZXMgb2YgdGhlIGJvb3QgUk9NIGZyb20gUk9NIG1lbW9yeS4KCQlmb3IgKGluZGV4ID0gMHgyMDA7IGluZGV4IDwgMHg5MDA7ICsraW5kZXgpIHsKCQkJdGhpcy5tZW1vcnlbaW5kZXhdID0gdGhpcy5ST01baW5kZXhdOwkvL1JlcGxhY2UgdGhlIEdhbWVCb3kgQ29sb3IgYm9vdCBST00gd2l0aCB0aGUgZ2FtZSBST00uCgkJfQoJCWlmICghdGhpcy5jR0JDKSB7CgkJCS8vQ2xlYW4gdXAgdGhlIHBvc3QtYm9vdCAoR0IgbW9kZSBvbmx5KSBzdGF0ZToKCQkJdGhpcy5HQkN0b0dCTW9kZUFkanVzdCgpOwoJCX0KCQllbHNlIHsKCQkJdGhpcy5yZWNvbXBpbGVCb290SU9Xcml0ZUhhbmRsaW5nKCk7CgkJfQoJfQoJZWxzZSB7CgkJdGhpcy5yZWNvbXBpbGVCb290SU9Xcml0ZUhhbmRsaW5nKCk7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmluaXRpYWxpemVUaW1pbmcgPSBmdW5jdGlvbiAoKSB7CgkvL0VtdWxhdG9yIFRpbWluZzoKCXRoaXMuY2xvY2tzUGVyU2Vjb25kID0gdGhpcy5lbXVsYXRvclNwZWVkICogMHg0MDAwMDA7Cgl0aGlzLmJhc2VDUFVDeWNsZXNQZXJJdGVyYXRpb24gPSB0aGlzLmNsb2Nrc1BlclNlY29uZCAvIDEwMDAgKiBzZXR0aW5nc1s2XTsKCXRoaXMuQ1BVQ3ljbGVzVG90YWxSb3VuZG9mZiA9IHRoaXMuYmFzZUNQVUN5Y2xlc1Blckl0ZXJhdGlvbiAlIDQ7Cgl0aGlzLkNQVUN5Y2xlc1RvdGFsQmFzZSA9IHRoaXMuQ1BVQ3ljbGVzVG90YWwgPSAodGhpcy5iYXNlQ1BVQ3ljbGVzUGVySXRlcmF0aW9uIC0gdGhpcy5DUFVDeWNsZXNUb3RhbFJvdW5kb2ZmKSB8IDA7Cgl0aGlzLkNQVUN5Y2xlc1RvdGFsQ3VycmVudCA9IDA7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnNldFNwZWVkID0gZnVuY3Rpb24gKHNwZWVkKSB7Cgl0aGlzLmVtdWxhdG9yU3BlZWQgPSBzcGVlZDsKCXRoaXMuaW5pdGlhbGl6ZVRpbWluZygpOwoJaWYgKHRoaXMuYXVkaW9IYW5kbGUpIHsKCQl0aGlzLmluaXRTb3VuZCgpOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5zZXR1cFJBTSA9IGZ1bmN0aW9uICgpIHsKCS8vU2V0dXAgdGhlIGF1eGlsbGlhcnkvc3dpdGNoYWJsZSBSQU06CglpZiAodGhpcy5jTUJDMikgewoJCXRoaXMubnVtUkFNQmFua3MgPSAxIC8gMTY7Cgl9CgllbHNlIGlmICh0aGlzLmNNQkMxIHx8IHRoaXMuY1JVTUJMRSB8fCB0aGlzLmNNQkMzIHx8IHRoaXMuY0h1QzMpIHsKCQl0aGlzLm51bVJBTUJhbmtzID0gNDsKCX0KCWVsc2UgaWYgKHRoaXMuY01CQzUpIHsKCQl0aGlzLm51bVJBTUJhbmtzID0gMTY7Cgl9CgllbHNlIGlmICh0aGlzLmNTUkFNKSB7CgkJdGhpcy5udW1SQU1CYW5rcyA9IDE7Cgl9CglpZiAodGhpcy5udW1SQU1CYW5rcyA+IDApIHsKCQlpZiAoIXRoaXMuTUJDUkFNVXRpbGl6ZWQoKSkgewoJCQkvL0ZvciBST00gYW5kIHVua25vd24gTUJDIGNhcnRyaWRnZXMgdXNpbmcgdGhlIGV4dGVybmFsIFJBTToKCQkJdGhpcy5NQkNSQU1CYW5rc0VuYWJsZWQgPSB0cnVlOwoJCX0KCQkvL1N3aXRjaGVkIFJBTSBVc2VkCgkJdmFyIE1CQ1JhbSA9ICh0eXBlb2YgdGhpcy5vcGVuTUJDID09ICJmdW5jdGlvbiIpID8gdGhpcy5vcGVuTUJDKHRoaXMubmFtZSkgOiBbXTsKCQlpZiAoTUJDUmFtLmxlbmd0aCA+IDApIHsKCQkJLy9GbGFzaCB0aGUgU1JBTSBpbnRvIG1lbW9yeToKCQkJdGhpcy5NQkNSYW0gPSB0aGlzLnRvVHlwZWRBcnJheShNQkNSYW0sICJ1aW50OCIpOwoJCX0KCQllbHNlIHsKCQkJdGhpcy5NQkNSYW0gPSB0aGlzLmdldFR5cGVkQXJyYXkodGhpcy5udW1SQU1CYW5rcyAqIDB4MjAwMCwgMCwgInVpbnQ4Iik7CgkJfQoJfQoJY291dCgiQWN0dWFsIGJ5dGVzIG9mIE1CQyBSQU0gYWxsb2NhdGVkOiAiICsgKHRoaXMubnVtUkFNQmFua3MgKiAweDIwMDApLCAwKTsKCXRoaXMucmV0dXJuRnJvbVJUQ1N0YXRlKCk7CgkvL1NldHVwIHRoZSBSQU0gZm9yIEdCQyBtb2RlLgoJaWYgKHRoaXMuY0dCQykgewoJCXRoaXMuVlJBTSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgweDIwMDAsIDAsICJ1aW50OCIpOwoJCXRoaXMuR0JDTWVtb3J5ID0gdGhpcy5nZXRUeXBlZEFycmF5KDB4NzAwMCwgMCwgInVpbnQ4Iik7Cgl9Cgl0aGlzLm1lbW9yeVJlYWRKdW1wQ29tcGlsZSgpOwoJdGhpcy5tZW1vcnlXcml0ZUp1bXBDb21waWxlKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLk1CQ1JBTVV0aWxpemVkID0gZnVuY3Rpb24gKCkgewoJcmV0dXJuIHRoaXMuY01CQzEgfHwgdGhpcy5jTUJDMiB8fCB0aGlzLmNNQkMzIHx8IHRoaXMuY01CQzUgfHwgdGhpcy5jTUJDNyB8fCB0aGlzLmNSVU1CTEU7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnJlY29tcHV0ZURpbWVuc2lvbiA9IGZ1bmN0aW9uICgpIHsKCWluaXROZXdDYW52YXMoKTsKCgkvL0NhY2hlIHNvbWUgZGltZW5zaW9uIGluZm86Cgl0aGlzLm9uc2NyZWVuV2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aDsKCXRoaXMub25zY3JlZW5IZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQ7CglpZiAod2luZG93ICYmIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgKG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJnZWNrbyIpICE9IC0xICYmIG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJsaWtlIGdlY2tvIikgPT0gLTEpKSB7CgkJLy9GaXJlZm94IHNsb3duZXNzIGhhY2s6CgkJdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLm9uc2NyZWVuV2lkdGggPSAoIXNldHRpbmdzWzEyXSkgPyAxNjAgOiB0aGlzLmNhbnZhcy53aWR0aDsKCQl0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLm9uc2NyZWVuSGVpZ2h0ID0gKCFzZXR0aW5nc1sxMl0pID8gMTQ0IDogdGhpcy5jYW52YXMuaGVpZ2h0OwoJfQoJZWxzZSB7CgkJdGhpcy5vbnNjcmVlbldpZHRoID0gdGhpcy5jYW52YXMud2lkdGg7CgkJdGhpcy5vbnNjcmVlbkhlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodDsKCX0KCXRoaXMub2Zmc2NyZWVuV2lkdGggPSAoIXNldHRpbmdzWzEyXSkgPyAxNjAgOiB0aGlzLmNhbnZhcy53aWR0aDsKCXRoaXMub2Zmc2NyZWVuSGVpZ2h0ID0gKCFzZXR0aW5nc1sxMl0pID8gMTQ0IDogdGhpcy5jYW52YXMuaGVpZ2h0OwoJdGhpcy5vZmZzY3JlZW5SR0JDb3VudCA9IHRoaXMub2Zmc2NyZWVuV2lkdGggKiB0aGlzLm9mZnNjcmVlbkhlaWdodCAqIDQ7CgoJY29uc29sZS5sb2coewoJCXc6IHRoaXMuY2FudmFzLndpZHRoLAoJCWg6IHRoaXMuY2FudmFzLmhlaWdodAoJfSkKCgp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5pbml0TENEID0gZnVuY3Rpb24gKCkgewoJdGhpcy5yZWNvbXB1dGVEaW1lbnNpb24oKTsKCWlmICh0aGlzLm9mZnNjcmVlblJHQkNvdW50ICE9IDkyMTYwKSB7CgkJLy9Pbmx5IGNyZWF0ZSB0aGUgcmVzaXplciBoYW5kbGUgaWYgd2UgbmVlZCBpdDoKCQl0aGlzLmNvbXBpbGVSZXNpemVGcmFtZUJ1ZmZlckZ1bmN0aW9uKCk7Cgl9CgllbHNlIHsKCQkvL1Jlc2l6ZXIgbm90IG5lZWRlZDoKCQl0aGlzLnJlc2l6ZXIgPSBudWxsOwoJfQoJdHJ5IHsKCQl0aGlzLmNhbnZhc09mZnNjcmVlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwoJCXRoaXMuY2FudmFzT2Zmc2NyZWVuLndpZHRoID0gdGhpcy5vZmZzY3JlZW5XaWR0aDsKCQl0aGlzLmNhbnZhc09mZnNjcmVlbi5oZWlnaHQgPSB0aGlzLm9mZnNjcmVlbkhlaWdodDsKCQl0aGlzLmRyYXdDb250ZXh0T2Zmc2NyZWVuID0gdGhpcy5jYW52YXNPZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKCQl0aGlzLmRyYXdDb250ZXh0T25zY3JlZW4gPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwoKCQkvL0dldCBhIENhbnZhc1BpeGVsQXJyYXkgYnVmZmVyOgoJCXRyeSB7CgkJCXRoaXMuY2FudmFzQnVmZmVyID0gdGhpcy5kcmF3Q29udGV4dE9mZnNjcmVlbi5jcmVhdGVJbWFnZURhdGEodGhpcy5vZmZzY3JlZW5XaWR0aCwgdGhpcy5vZmZzY3JlZW5IZWlnaHQpOwoJCX0KCQljYXRjaCAoZXJyb3IpIHsKCQkJY291dCgiRmFsbGluZyBiYWNrIHRvIHRoZSBnZXRJbWFnZURhdGEgaW5pdGlhbGl6YXRpb24gKEVycm9yIFwiIiArIGVycm9yLm1lc3NhZ2UgKyAiXCIpLiIsIDEpOwoJCQl0aGlzLmNhbnZhc0J1ZmZlciA9IHRoaXMuZHJhd0NvbnRleHRPZmZzY3JlZW4uZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMub2Zmc2NyZWVuV2lkdGgsIHRoaXMub2Zmc2NyZWVuSGVpZ2h0KTsKCQl9CgkJdmFyIGluZGV4ID0gdGhpcy5vZmZzY3JlZW5SR0JDb3VudDsKCQl3aGlsZSAoaW5kZXggPiAwKSB7CgkJCXRoaXMuY2FudmFzQnVmZmVyLmRhdGFbaW5kZXggLT0gNF0gPSAweEY4OwoJCQl0aGlzLmNhbnZhc0J1ZmZlci5kYXRhW2luZGV4ICsgMV0gPSAweEY4OwoJCQl0aGlzLmNhbnZhc0J1ZmZlci5kYXRhW2luZGV4ICsgMl0gPSAweEY4OwoJCQl0aGlzLmNhbnZhc0J1ZmZlci5kYXRhW2luZGV4ICsgM10gPSAweEZGOwoJCX0KCQl0aGlzLmdyYXBoaWNzQmxpdCgpOwoJCWlmICh0aGlzLnN3aXp6bGVkRnJhbWUgPT0gbnVsbCkgewoJCQl0aGlzLnN3aXp6bGVkRnJhbWUgPSB0aGlzLmdldFR5cGVkQXJyYXkoNjkxMjAsIDB4RkYsICJ1aW50OCIpOwoJCX0KCQkvL1Rlc3QgdGhlIGRyYXcgc3lzdGVtIGFuZCBicm93c2VyIHZibGFuayBsYXRjaGluZzoKCQl0aGlzLmRyZXdGcmFtZSA9IHRydWU7CQkJCQkJCQkJCS8vQ29weSB0aGUgbGF0ZXN0IGdyYXBoaWNzIHRvIGJ1ZmZlci4KCQl0aGlzLnJlcXVlc3REcmF3KCk7Cgl9CgljYXRjaCAoZXJyb3IpIHsKCQl0aHJvdyhuZXcgRXJyb3IoIkhUTUw1IENhbnZhcyBzdXBwb3J0IHJlcXVpcmVkOiAiICsgZXJyb3IubWVzc2FnZSArICJmaWxlOiAiICsgZXJyb3IuZmlsZU5hbWUgKyAiLCBsaW5lOiAiICsgZXJyb3IubGluZU51bWJlcikpOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5ncmFwaGljc0JsaXQgPSBmdW5jdGlvbiAoKSB7CglpZiAodGhpcy5vZmZzY3JlZW5XaWR0aCA9PSB0aGlzLm9uc2NyZWVuV2lkdGggJiYgdGhpcy5vZmZzY3JlZW5IZWlnaHQgPT0gdGhpcy5vbnNjcmVlbkhlaWdodCkgewoJCXRoaXMuZHJhd0NvbnRleHRPbnNjcmVlbi5wdXRJbWFnZURhdGEodGhpcy5jYW52YXNCdWZmZXIsIDAsIDApOwoJfQoJZWxzZSB7CgkJdGhpcy5kcmF3Q29udGV4dE9mZnNjcmVlbi5wdXRJbWFnZURhdGEodGhpcy5jYW52YXNCdWZmZXIsIDAsIDApOwoJCXRoaXMuZHJhd0NvbnRleHRPbnNjcmVlbi5kcmF3SW1hZ2UodGhpcy5jYW52YXNPZmZzY3JlZW4sIDAsIDAsIHRoaXMub25zY3JlZW5XaWR0aCwgdGhpcy5vbnNjcmVlbkhlaWdodCk7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLkpveVBhZEV2ZW50ID0gZnVuY3Rpb24gKGtleSwgZG93bikgewoJaWYgKGRvd24pIHsKCQl0aGlzLkpveVBhZCAmPSAweEZGIF4gKDEgPDwga2V5KTsKCQlpZiAoIXRoaXMuY0dCQyAmJiAoIXRoaXMudXNlZEJvb3RST00gfHwgIXRoaXMudXNlZEdCQ0Jvb3RST00pKSB7CgkJCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDEwOwkvL0EgcmVhbCBHQkMgZG9lc24ndCBzZXQgdGhpcyEKCQkJdGhpcy5yZW1haW5pbmdDbG9ja3MgPSAwOwoJCQl0aGlzLmNoZWNrSVJRTWF0Y2hpbmcoKTsKCQl9Cgl9CgllbHNlIHsKCQl0aGlzLkpveVBhZCB8PSAoMSA8PCBrZXkpOwoJfQoJdGhpcy5tZW1vcnlbMHhGRjAwXSA9ICh0aGlzLm1lbW9yeVsweEZGMDBdICYgMHgzMCkgKyAoKCgodGhpcy5tZW1vcnlbMHhGRjAwXSAmIDB4MjApID09IDApID8gKHRoaXMuSm95UGFkID4+IDQpIDogMHhGKSAmICgoKHRoaXMubWVtb3J5WzB4RkYwMF0gJiAweDEwKSA9PSAwKSA/ICh0aGlzLkpveVBhZCAmIDB4RikgOiAweEYpKTsKCXRoaXMuQ1BVU3RvcHBlZCA9IGZhbHNlOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5HeXJvRXZlbnQgPSBmdW5jdGlvbiAoeCwgeSkgewoJeCAqPSAtMTAwOwoJeCArPSAyMDQ3OwoJdGhpcy5oaWdoWCA9IHggPj4gODsKCXRoaXMubG93WCA9IHggJiAweEZGOwoJeSAqPSAtMTAwOwoJeSArPSAyMDQ3OwoJdGhpcy5oaWdoWSA9IHkgPj4gODsKCXRoaXMubG93WSA9IHkgJiAweEZGOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5pbml0U291bmQgPSBmdW5jdGlvbiAoKSB7Cgljb25zb2xlLmxvZygiSU5UIFNPVU5EIikKCXRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IgPSBNYXRoLm1heChNYXRoLm1pbihNYXRoLmZsb29yKHRoaXMuY2xvY2tzUGVyU2Vjb25kIC8gNDQxMDApLCBNYXRoLmZsb29yKDB4RkZGRiAvIDB4MUUwKSksIDEpOwoJdGhpcy5kb3duU2FtcGxlSW5wdXREaXZpZGVyID0gMC41IC8gKHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IgKiAweEYwKTsgLy8gUmVkdWNlZCB0byAwLjUgZnJvbSAxIHRvIGhhbGYgdm9sdW1lLgoJaWYgKHNldHRpbmdzWzBdKSB7CgkJdGhpcy5hdWRpb0hhbmRsZSA9IG5ldyBYQXVkaW9TZXJ2ZXIoMiwgdGhpcy5jbG9ja3NQZXJTZWNvbmQgLyB0aGlzLmF1ZGlvUmVzYW1wbGVyRmlyc3RQYXNzRmFjdG9yLCAwLCBNYXRoLm1heCh0aGlzLmJhc2VDUFVDeWNsZXNQZXJJdGVyYXRpb24gKiBzZXR0aW5nc1s4XSAvIHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IsIDgxOTIpIDw8IDEsIG51bGwsIHNldHRpbmdzWzNdLCBmdW5jdGlvbiAoKSB7CgkJCXNldHRpbmdzWzBdID0gZmFsc2U7CgkJfSk7CgkJdGhpcy5pbml0QXVkaW9CdWZmZXIoKTsKCX0KCWVsc2UgaWYgKHRoaXMuYXVkaW9IYW5kbGUpIHsKCQljb25zb2xlLmxvZygiTVVURSIpCgkJLy9NdXRlIHRoZSBhdWRpbyBvdXRwdXQsIGFzIGl0IGhhcyBhbiBpbW1lZGlhdGUgc2lsZW5jaW5nIGVmZmVjdDoKCQl0aGlzLmF1ZGlvSGFuZGxlLmNoYW5nZVZvbHVtZSgwKTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbmdlVm9sdW1lID0gZnVuY3Rpb24gKCkgewoJaWYgKHNldHRpbmdzWzBdICYmIHRoaXMuYXVkaW9IYW5kbGUpIHsKCQl0aGlzLmF1ZGlvSGFuZGxlLmNoYW5nZVZvbHVtZShzZXR0aW5nc1szXSk7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmluaXRBdWRpb0J1ZmZlciA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuYXVkaW9JbmRleCA9IDA7Cgl0aGlzLmF1ZGlvRGVzdGluYXRpb25Qb3NpdGlvbiA9IDA7Cgl0aGlzLmRvd25zYW1wbGVJbnB1dCA9IDA7Cgl0aGlzLmJ1ZmZlckNvbnRhaW5BbW91bnQgPSBNYXRoLm1heCh0aGlzLmJhc2VDUFVDeWNsZXNQZXJJdGVyYXRpb24gKiBzZXR0aW5nc1s3XSAvIHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IsIDQwOTYpIDw8IDE7Cgl0aGlzLm51bVNhbXBsZXNUb3RhbCA9ICh0aGlzLmJhc2VDUFVDeWNsZXNQZXJJdGVyYXRpb24gLyB0aGlzLmF1ZGlvUmVzYW1wbGVyRmlyc3RQYXNzRmFjdG9yKSA8PCAxOwoJdGhpcy5hdWRpb0J1ZmZlciA9IHRoaXMuZ2V0VHlwZWRBcnJheSh0aGlzLm51bVNhbXBsZXNUb3RhbCwgMCwgImZsb2F0MzIiKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuaW50aWFsaXplV2hpdGVOb2lzZSA9IGZ1bmN0aW9uICgpIHsKCS8vTm9pc2UgU2FtcGxlIFRhYmxlczoKCXZhciByYW5kb21GYWN0b3IgPSAxOwoJLy8xNS1iaXQgTFNGUiBDYWNoZSBHZW5lcmF0aW9uOgoJdGhpcy5MU0ZSMTVUYWJsZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgweDgwMDAwLCAwLCAiaW50OCIpOwoJdmFyIExTRlIgPSAweDdGRkY7CS8vU2VlZCB2YWx1ZSBoYXMgYWxsIGl0cyBiaXRzIHNldC4KCXZhciBMU0ZSU2hpZnRlZCA9IDB4M0ZGRjsKCWZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCAweDgwMDA7ICsraW5kZXgpIHsKCQkvL05vcm1hbGl6ZSB0aGUgbGFzdCBMU0ZSIHZhbHVlIGZvciB1c2FnZToKCQlyYW5kb21GYWN0b3IgPSAxIC0gKExTRlIgJiAxKTsJLy9Eb2NzIHNheSBpdCdzIHRoZSBpbnZlcnNlLgoJCS8vQ2FjaGUgdGhlIGRpZmZlcmVudCB2b2x1bWUgbGV2ZWwgcmVzdWx0czoKCQl0aGlzLkxTRlIxNVRhYmxlWzB4MDgwMDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3I7CgkJdGhpcy5MU0ZSMTVUYWJsZVsweDEwMDAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHgyOwoJCXRoaXMuTFNGUjE1VGFibGVbMHgxODAwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4MzsKCQl0aGlzLkxTRlIxNVRhYmxlWzB4MjAwMDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweDQ7CgkJdGhpcy5MU0ZSMTVUYWJsZVsweDI4MDAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHg1OwoJCXRoaXMuTFNGUjE1VGFibGVbMHgzMDAwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4NjsKCQl0aGlzLkxTRlIxNVRhYmxlWzB4MzgwMDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweDc7CgkJdGhpcy5MU0ZSMTVUYWJsZVsweDQwMDAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHg4OwoJCXRoaXMuTFNGUjE1VGFibGVbMHg0ODAwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4OTsKCQl0aGlzLkxTRlIxNVRhYmxlWzB4NTAwMDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweEE7CgkJdGhpcy5MU0ZSMTVUYWJsZVsweDU4MDAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHhCOwoJCXRoaXMuTFNGUjE1VGFibGVbMHg2MDAwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4QzsKCQl0aGlzLkxTRlIxNVRhYmxlWzB4NjgwMDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweEQ7CgkJdGhpcy5MU0ZSMTVUYWJsZVsweDcwMDAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHhFOwoJCXRoaXMuTFNGUjE1VGFibGVbMHg3ODAwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4RjsKCQkvL1JlY29tcHV0ZSB0aGUgTFNGUiBhbGdvcml0aG06CgkJTFNGUlNoaWZ0ZWQgPSBMU0ZSID4+IDE7CgkJTFNGUiA9IExTRlJTaGlmdGVkIHwgKCgoTFNGUlNoaWZ0ZWQgXiBMU0ZSKSAmIDB4MSkgPDwgMTQpOwoJfQoJLy83LWJpdCBMU0ZSIENhY2hlIEdlbmVyYXRpb246Cgl0aGlzLkxTRlI3VGFibGUgPSB0aGlzLmdldFR5cGVkQXJyYXkoMHg4MDAsIDAsICJpbnQ4Iik7CglMU0ZSID0gMHg3RjsJLy9TZWVkIHZhbHVlIGhhcyBhbGwgaXRzIGJpdHMgc2V0LgoJZm9yIChpbmRleCA9IDA7IGluZGV4IDwgMHg4MDsgKytpbmRleCkgewoJCS8vTm9ybWFsaXplIHRoZSBsYXN0IExTRlIgdmFsdWUgZm9yIHVzYWdlOgoJCXJhbmRvbUZhY3RvciA9IDEgLSAoTFNGUiAmIDEpOwkvL0RvY3Mgc2F5IGl0J3MgdGhlIGludmVyc2UuCgkJLy9DYWNoZSB0aGUgZGlmZmVyZW50IHZvbHVtZSBsZXZlbCByZXN1bHRzOgoJCXRoaXMuTFNGUjdUYWJsZVsweDA4MCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvcjsKCQl0aGlzLkxTRlI3VGFibGVbMHgxMDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweDI7CgkJdGhpcy5MU0ZSN1RhYmxlWzB4MTgwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHgzOwoJCXRoaXMuTFNGUjdUYWJsZVsweDIwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4NDsKCQl0aGlzLkxTRlI3VGFibGVbMHgyODAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweDU7CgkJdGhpcy5MU0ZSN1RhYmxlWzB4MzAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHg2OwoJCXRoaXMuTFNGUjdUYWJsZVsweDM4MCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4NzsKCQl0aGlzLkxTRlI3VGFibGVbMHg0MDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweDg7CgkJdGhpcy5MU0ZSN1RhYmxlWzB4NDgwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHg5OwoJCXRoaXMuTFNGUjdUYWJsZVsweDUwMCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4QTsKCQl0aGlzLkxTRlI3VGFibGVbMHg1ODAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweEI7CgkJdGhpcy5MU0ZSN1RhYmxlWzB4NjAwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHhDOwoJCXRoaXMuTFNGUjdUYWJsZVsweDY4MCB8IGluZGV4XSA9IHJhbmRvbUZhY3RvciAqIDB4RDsKCQl0aGlzLkxTRlI3VGFibGVbMHg3MDAgfCBpbmRleF0gPSByYW5kb21GYWN0b3IgKiAweEU7CgkJdGhpcy5MU0ZSN1RhYmxlWzB4NzgwIHwgaW5kZXhdID0gcmFuZG9tRmFjdG9yICogMHhGOwoJCS8vUmVjb21wdXRlIHRoZSBMU0ZSIGFsZ29yaXRobToKCQlMU0ZSU2hpZnRlZCA9IExTRlIgPj4gMTsKCQlMU0ZSID0gTFNGUlNoaWZ0ZWQgfCAoKChMU0ZSU2hpZnRlZCBeIExTRlIpICYgMHgxKSA8PCA2KTsKCX0KCS8vU2V0IHRoZSBkZWZhdWx0IG5vaXNlIHRhYmxlOgoJdGhpcy5ub2lzZVNhbXBsZVRhYmxlID0gdGhpcy5MU0ZSMTVUYWJsZTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuYXVkaW9VbmRlcnJ1bkFkanVzdG1lbnQgPSBmdW5jdGlvbiAoKSB7CglpZiAoc2V0dGluZ3NbMF0pIHsKCQl2YXIgdW5kZXJydW5BbW91bnQgPSB0aGlzLmF1ZGlvSGFuZGxlLnJlbWFpbmluZ0J1ZmZlcigpOwoJCWlmICh0eXBlb2YgdW5kZXJydW5BbW91bnQgPT0gIm51bWJlciIpIHsKCQkJdW5kZXJydW5BbW91bnQgPSB0aGlzLmJ1ZmZlckNvbnRhaW5BbW91bnQgLSBNYXRoLm1heCh1bmRlcnJ1bkFtb3VudCwgMCk7CgkJCWlmICh1bmRlcnJ1bkFtb3VudCA+IDApIHsKCQkJCXRoaXMucmVjYWxjdWxhdGVJdGVyYXRpb25DbG9ja0xpbWl0Rm9yQXVkaW8oKHVuZGVycnVuQW1vdW50ID4+IDEpICogdGhpcy5hdWRpb1Jlc2FtcGxlckZpcnN0UGFzc0ZhY3Rvcik7CgkJCX0KCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmluaXRpYWxpemVBdWRpb1N0YXJ0U3RhdGUgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLmNoYW5uZWwxRnJlcXVlbmN5VHJhY2tlciA9IDB4MjAwMDsKCXRoaXMuY2hhbm5lbDFEdXR5VHJhY2tlciA9IDA7Cgl0aGlzLmNoYW5uZWwxQ2FjaGVkRHV0eSA9IHRoaXMuZHV0eUxvb2t1cFsyXTsKCXRoaXMuY2hhbm5lbDF0b3RhbExlbmd0aCA9IDA7Cgl0aGlzLmNoYW5uZWwxZW52ZWxvcGVWb2x1bWUgPSAwOwoJdGhpcy5jaGFubmVsMWVudmVsb3BlVHlwZSA9IGZhbHNlOwoJdGhpcy5jaGFubmVsMWVudmVsb3BlU3dlZXBzID0gMDsKCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVN3ZWVwc0xhc3QgPSAwOwoJdGhpcy5jaGFubmVsMWNvbnNlY3V0aXZlID0gdHJ1ZTsKCXRoaXMuY2hhbm5lbDFmcmVxdWVuY3kgPSAwOwoJdGhpcy5jaGFubmVsMVN3ZWVwRmF1bHQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgPSAwOwoJdGhpcy5jaGFubmVsMXRpbWVTd2VlcCA9IDE7Cgl0aGlzLmNoYW5uZWwxbGFzdFRpbWVTd2VlcCA9IDA7Cgl0aGlzLmNoYW5uZWwxU3dlcHQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDFmcmVxdWVuY3lTd2VlcERpdmlkZXIgPSAwOwoJdGhpcy5jaGFubmVsMWRlY3JlYXNlU3dlZXAgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDJGcmVxdWVuY3lUcmFja2VyID0gMHgyMDAwOwoJdGhpcy5jaGFubmVsMkR1dHlUcmFja2VyID0gMDsKCXRoaXMuY2hhbm5lbDJDYWNoZWREdXR5ID0gdGhpcy5kdXR5TG9va3VwWzJdOwoJdGhpcy5jaGFubmVsMnRvdGFsTGVuZ3RoID0gMDsKCXRoaXMuY2hhbm5lbDJlbnZlbG9wZVZvbHVtZSA9IDA7Cgl0aGlzLmNoYW5uZWwyZW52ZWxvcGVUeXBlID0gZmFsc2U7Cgl0aGlzLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHMgPSAwOwoJdGhpcy5jaGFubmVsMmVudmVsb3BlU3dlZXBzTGFzdCA9IDA7Cgl0aGlzLmNoYW5uZWwyY29uc2VjdXRpdmUgPSB0cnVlOwoJdGhpcy5jaGFubmVsMmZyZXF1ZW5jeSA9IDA7Cgl0aGlzLmNoYW5uZWwzY2FuUGxheSA9IGZhbHNlOwoJdGhpcy5jaGFubmVsM3RvdGFsTGVuZ3RoID0gMDsKCXRoaXMuY2hhbm5lbDNwYXR0ZXJuVHlwZSA9IDQ7Cgl0aGlzLmNoYW5uZWwzZnJlcXVlbmN5ID0gMDsKCXRoaXMuY2hhbm5lbDNjb25zZWN1dGl2ZSA9IHRydWU7Cgl0aGlzLmNoYW5uZWwzQ291bnRlciA9IDB4ODAwOwoJdGhpcy5jaGFubmVsNEZyZXF1ZW5jeVBlcmlvZCA9IDg7Cgl0aGlzLmNoYW5uZWw0dG90YWxMZW5ndGggPSAwOwoJdGhpcy5jaGFubmVsNGVudmVsb3BlVm9sdW1lID0gMDsKCXRoaXMuY2hhbm5lbDRjdXJyZW50Vm9sdW1lID0gMDsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVR5cGUgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwcyA9IDA7Cgl0aGlzLmNoYW5uZWw0ZW52ZWxvcGVTd2VlcHNMYXN0ID0gMDsKCXRoaXMuY2hhbm5lbDRjb25zZWN1dGl2ZSA9IHRydWU7Cgl0aGlzLmNoYW5uZWw0Qml0UmFuZ2UgPSAweDdGRkY7Cgl0aGlzLm5vaXNlU2FtcGxlVGFibGUgPSB0aGlzLkxTRlIxNVRhYmxlOwoJdGhpcy5jaGFubmVsNFZvbHVtZVNoaWZ0ZXIgPSAxNTsKCXRoaXMuY2hhbm5lbDFGcmVxdWVuY3lDb3VudGVyID0gMHgyMDAwOwoJdGhpcy5jaGFubmVsMkZyZXF1ZW5jeUNvdW50ZXIgPSAweDIwMDA7Cgl0aGlzLmNoYW5uZWwzQ291bnRlciA9IDB4ODAwOwoJdGhpcy5jaGFubmVsM0ZyZXF1ZW5jeVBlcmlvZCA9IDB4ODAwOwoJdGhpcy5jaGFubmVsM2xhc3RTYW1wbGVMb29rdXAgPSAwOwoJdGhpcy5jaGFubmVsNGxhc3RTYW1wbGVMb29rdXAgPSAwOwoJdGhpcy5WaW5MZWZ0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IDg7Cgl0aGlzLlZpblJpZ2h0Q2hhbm5lbE1hc3RlclZvbHVtZSA9IDg7Cgl0aGlzLm1peGVyT3V0cHV0Q2FjaGUgPSAwOwoJdGhpcy5zZXF1ZW5jZXJDbG9ja3MgPSAweDIwMDA7Cgl0aGlzLnNlcXVlbmNlUG9zaXRpb24gPSAwOwoJdGhpcy5jaGFubmVsNEZyZXF1ZW5jeVBlcmlvZCA9IDg7Cgl0aGlzLmNoYW5uZWw0Q291bnRlciA9IDg7Cgl0aGlzLmNhY2hlZENoYW5uZWwzU2FtcGxlID0gMDsKCXRoaXMuY2FjaGVkQ2hhbm5lbDRTYW1wbGUgPSAwOwoJdGhpcy5jaGFubmVsMUVuYWJsZWQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDJFbmFibGVkID0gZmFsc2U7Cgl0aGlzLmNoYW5uZWwzRW5hYmxlZCA9IGZhbHNlOwoJdGhpcy5jaGFubmVsNEVuYWJsZWQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDFjYW5QbGF5ID0gZmFsc2U7Cgl0aGlzLmNoYW5uZWwyY2FuUGxheSA9IGZhbHNlOwoJdGhpcy5jaGFubmVsNGNhblBsYXkgPSBmYWxzZTsKCXRoaXMuYXVkaW9DbG9ja3NVbnRpbE5leHRFdmVudCA9IDE7Cgl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyID0gMTsKCXRoaXMuY2hhbm5lbDFPdXRwdXRMZXZlbENhY2hlKCk7Cgl0aGlzLmNoYW5uZWwyT3V0cHV0TGV2ZWxDYWNoZSgpOwoJdGhpcy5jaGFubmVsM091dHB1dExldmVsQ2FjaGUoKTsKCXRoaXMuY2hhbm5lbDRPdXRwdXRMZXZlbENhY2hlKCk7Cgl0aGlzLm5vaXNlU2FtcGxlVGFibGUgPSB0aGlzLkxTRlIxNVRhYmxlOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5vdXRwdXRBdWRpbyA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuYXVkaW9CdWZmZXJbdGhpcy5hdWRpb0Rlc3RpbmF0aW9uUG9zaXRpb24rK10gPSAodGhpcy5kb3duc2FtcGxlSW5wdXQgPj4+IDE2KSAqIHRoaXMuZG93blNhbXBsZUlucHV0RGl2aWRlcjsKCXRoaXMuYXVkaW9CdWZmZXJbdGhpcy5hdWRpb0Rlc3RpbmF0aW9uUG9zaXRpb24rK10gPSAodGhpcy5kb3duc2FtcGxlSW5wdXQgJiAweEZGRkYpICogdGhpcy5kb3duU2FtcGxlSW5wdXREaXZpZGVyOyAvL2hhZCAtIDEsIHJlbW92aW5nIGZpeGVzIHBvcAoJaWYgKHRoaXMuYXVkaW9EZXN0aW5hdGlvblBvc2l0aW9uID09IHRoaXMubnVtU2FtcGxlc1RvdGFsKSB7CgkJdGhpcy5hdWRpb0hhbmRsZS53cml0ZUF1ZGlvTm9DYWxsYmFjayh0aGlzLmF1ZGlvQnVmZmVyKTsKCQl0aGlzLmF1ZGlvRGVzdGluYXRpb25Qb3NpdGlvbiA9IDA7Cgl9Cgl0aGlzLmRvd25zYW1wbGVJbnB1dCA9IDA7Cn0KLy9CZWxvdyBhcmUgdGhlIGF1ZGlvIGdlbmVyYXRpb24gZnVuY3Rpb25zIHRpbWVkIGFnYWluc3QgdGhlIENQVToKR2FtZUJveUNvcmUucHJvdG90eXBlLmdlbmVyYXRlQXVkaW8gPSBmdW5jdGlvbiAobnVtU2FtcGxlcykgewoJdmFyIG11bHRpcGxpZXIgPSAwOwoJaWYgKHRoaXMuc291bmRNYXN0ZXJFbmFibGVkICYmICF0aGlzLkNQVVN0b3BwZWQpIHsKCQlmb3IgKHZhciBjbG9ja1VwVG8gPSAwOyBudW1TYW1wbGVzID4gMDspIHsKCQkJY2xvY2tVcFRvID0gTWF0aC5taW4odGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50Q291bnRlciwgdGhpcy5zZXF1ZW5jZXJDbG9ja3MsIG51bVNhbXBsZXMpOwoJCQl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyIC09IGNsb2NrVXBUbzsKCQkJdGhpcy5zZXF1ZW5jZXJDbG9ja3MgLT0gY2xvY2tVcFRvOwoJCQludW1TYW1wbGVzIC09IGNsb2NrVXBUbzsKCQkJd2hpbGUgKGNsb2NrVXBUbyA+IDApIHsKCQkJCW11bHRpcGxpZXIgPSBNYXRoLm1pbihjbG9ja1VwVG8sIHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IgLSB0aGlzLmF1ZGlvSW5kZXgpOwoJCQkJY2xvY2tVcFRvIC09IG11bHRpcGxpZXI7CgkJCQl0aGlzLmF1ZGlvSW5kZXggKz0gbXVsdGlwbGllcjsKCQkJCXRoaXMuZG93bnNhbXBsZUlucHV0ICs9IHRoaXMubWl4ZXJPdXRwdXRDYWNoZSAqIG11bHRpcGxpZXI7CgkJCQlpZiAodGhpcy5hdWRpb0luZGV4ID09IHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IpIHsKCQkJCQl0aGlzLmF1ZGlvSW5kZXggPSAwOwoJCQkJCXRoaXMub3V0cHV0QXVkaW8oKTsKCQkJCX0KCQkJfQoJCQlpZiAodGhpcy5zZXF1ZW5jZXJDbG9ja3MgPT0gMCkgewoJCQkJdGhpcy5hdWRpb0NvbXB1dGVTZXF1ZW5jZXIoKTsKCQkJCXRoaXMuc2VxdWVuY2VyQ2xvY2tzID0gMHgyMDAwOwoJCQl9CgkJCWlmICh0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyID09IDApIHsKCQkJCXRoaXMuY29tcHV0ZUF1ZGlvQ2hhbm5lbHMoKTsKCQkJfQoJCX0KCX0KCWVsc2UgewoJCS8vU0lMRU5UIE9VVFBVVDoKCQl3aGlsZSAobnVtU2FtcGxlcyA+IDApIHsKCQkJbXVsdGlwbGllciA9IE1hdGgubWluKG51bVNhbXBsZXMsIHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IgLSB0aGlzLmF1ZGlvSW5kZXgpOwoJCQludW1TYW1wbGVzIC09IG11bHRpcGxpZXI7CgkJCXRoaXMuYXVkaW9JbmRleCArPSBtdWx0aXBsaWVyOwoJCQlpZiAodGhpcy5hdWRpb0luZGV4ID09IHRoaXMuYXVkaW9SZXNhbXBsZXJGaXJzdFBhc3NGYWN0b3IpIHsKCQkJCXRoaXMuYXVkaW9JbmRleCA9IDA7CgkJCQl0aGlzLm91dHB1dEF1ZGlvKCk7CgkJCX0KCQl9Cgl9Cn0KLy9HZW5lcmF0ZSBhdWRpbywgYnV0IGRvbid0IGFjdHVhbGx5IG91dHB1dCBpdCAoVXNlZCBmb3Igd2hlbiBzb3VuZCBpcyBkaXNhYmxlZCBieSB1c2VyL2Jyb3dzZXIpOgpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ2VuZXJhdGVBdWRpb0Zha2UgPSBmdW5jdGlvbiAobnVtU2FtcGxlcykgewoJaWYgKHRoaXMuc291bmRNYXN0ZXJFbmFibGVkICYmICF0aGlzLkNQVVN0b3BwZWQpIHsKCQlmb3IgKHZhciBjbG9ja1VwVG8gPSAwOyBudW1TYW1wbGVzID4gMDspIHsKCQkJY2xvY2tVcFRvID0gTWF0aC5taW4odGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50Q291bnRlciwgdGhpcy5zZXF1ZW5jZXJDbG9ja3MsIG51bVNhbXBsZXMpOwoJCQl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyIC09IGNsb2NrVXBUbzsKCQkJdGhpcy5zZXF1ZW5jZXJDbG9ja3MgLT0gY2xvY2tVcFRvOwoJCQludW1TYW1wbGVzIC09IGNsb2NrVXBUbzsKCQkJaWYgKHRoaXMuc2VxdWVuY2VyQ2xvY2tzID09IDApIHsKCQkJCXRoaXMuYXVkaW9Db21wdXRlU2VxdWVuY2VyKCk7CgkJCQl0aGlzLnNlcXVlbmNlckNsb2NrcyA9IDB4MjAwMDsKCQkJfQoJCQlpZiAodGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50Q291bnRlciA9PSAwKSB7CgkJCQl0aGlzLmNvbXB1dGVBdWRpb0NoYW5uZWxzKCk7CgkJCX0KCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmF1ZGlvSklUID0gZnVuY3Rpb24gKCkgewoJLy9BdWRpbyBTYW1wbGUgR2VuZXJhdGlvbiBUaW1pbmc6CglpZiAoc2V0dGluZ3NbMF0pIHsKCQl0aGlzLmdlbmVyYXRlQXVkaW8odGhpcy5hdWRpb1RpY2tzKTsKCX0KCWVsc2UgewoJCXRoaXMuZ2VuZXJhdGVBdWRpb0Zha2UodGhpcy5hdWRpb1RpY2tzKTsKCX0KCXRoaXMuYXVkaW9UaWNrcyA9IDA7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmF1ZGlvQ29tcHV0ZVNlcXVlbmNlciA9IGZ1bmN0aW9uICgpIHsKCXN3aXRjaCAodGhpcy5zZXF1ZW5jZVBvc2l0aW9uKyspIHsKCQljYXNlIDA6CgkJCXRoaXMuY2xvY2tBdWRpb0xlbmd0aCgpOwoJCQlicmVhazsKCQljYXNlIDI6CgkJCXRoaXMuY2xvY2tBdWRpb0xlbmd0aCgpOwoJCQl0aGlzLmNsb2NrQXVkaW9Td2VlcCgpOwoJCQlicmVhazsKCQljYXNlIDQ6CgkJCXRoaXMuY2xvY2tBdWRpb0xlbmd0aCgpOwoJCQlicmVhazsKCQljYXNlIDY6CgkJCXRoaXMuY2xvY2tBdWRpb0xlbmd0aCgpOwoJCQl0aGlzLmNsb2NrQXVkaW9Td2VlcCgpOwoJCQlicmVhazsKCQljYXNlIDc6CgkJCXRoaXMuY2xvY2tBdWRpb0VudmVsb3BlKCk7CgkJCXRoaXMuc2VxdWVuY2VQb3NpdGlvbiA9IDA7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNsb2NrQXVkaW9MZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkvL0NoYW5uZWwgMToKCWlmICh0aGlzLmNoYW5uZWwxdG90YWxMZW5ndGggPiAxKSB7CgkJLS10aGlzLmNoYW5uZWwxdG90YWxMZW5ndGg7Cgl9CgllbHNlIGlmICh0aGlzLmNoYW5uZWwxdG90YWxMZW5ndGggPT0gMSkgewoJCXRoaXMuY2hhbm5lbDF0b3RhbExlbmd0aCA9IDA7CgkJdGhpcy5jaGFubmVsMUVuYWJsZUNoZWNrKCk7CgkJdGhpcy5tZW1vcnlbMHhGRjI2XSAmPSAweEZFOwkvL0NoYW5uZWwgIzEgT24gRmxhZyBPZmYKCX0KCS8vQ2hhbm5lbCAyOgoJaWYgKHRoaXMuY2hhbm5lbDJ0b3RhbExlbmd0aCA+IDEpIHsKCQktLXRoaXMuY2hhbm5lbDJ0b3RhbExlbmd0aDsKCX0KCWVsc2UgaWYgKHRoaXMuY2hhbm5lbDJ0b3RhbExlbmd0aCA9PSAxKSB7CgkJdGhpcy5jaGFubmVsMnRvdGFsTGVuZ3RoID0gMDsKCQl0aGlzLmNoYW5uZWwyRW5hYmxlQ2hlY2soKTsKCQl0aGlzLm1lbW9yeVsweEZGMjZdICY9IDB4RkQ7CS8vQ2hhbm5lbCAjMiBPbiBGbGFnIE9mZgoJfQoJLy9DaGFubmVsIDM6CglpZiAodGhpcy5jaGFubmVsM3RvdGFsTGVuZ3RoID4gMSkgewoJCS0tdGhpcy5jaGFubmVsM3RvdGFsTGVuZ3RoOwoJfQoJZWxzZSBpZiAodGhpcy5jaGFubmVsM3RvdGFsTGVuZ3RoID09IDEpIHsKCQl0aGlzLmNoYW5uZWwzdG90YWxMZW5ndGggPSAwOwoJCXRoaXMuY2hhbm5lbDNFbmFibGVDaGVjaygpOwoJCXRoaXMubWVtb3J5WzB4RkYyNl0gJj0gMHhGQjsJLy9DaGFubmVsICMzIE9uIEZsYWcgT2ZmCgl9CgkvL0NoYW5uZWwgNDoKCWlmICh0aGlzLmNoYW5uZWw0dG90YWxMZW5ndGggPiAxKSB7CgkJLS10aGlzLmNoYW5uZWw0dG90YWxMZW5ndGg7Cgl9CgllbHNlIGlmICh0aGlzLmNoYW5uZWw0dG90YWxMZW5ndGggPT0gMSkgewoJCXRoaXMuY2hhbm5lbDR0b3RhbExlbmd0aCA9IDA7CgkJdGhpcy5jaGFubmVsNEVuYWJsZUNoZWNrKCk7CgkJdGhpcy5tZW1vcnlbMHhGRjI2XSAmPSAweEY3OwkvL0NoYW5uZWwgIzQgT24gRmxhZyBPZmYKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2xvY2tBdWRpb1N3ZWVwID0gZnVuY3Rpb24gKCkgewoJLy9DaGFubmVsIDE6CglpZiAoIXRoaXMuY2hhbm5lbDFTd2VlcEZhdWx0ICYmIHRoaXMuY2hhbm5lbDF0aW1lU3dlZXAgPiAwKSB7CgkJaWYgKC0tdGhpcy5jaGFubmVsMXRpbWVTd2VlcCA9PSAwKSB7CgkJCXRoaXMucnVuQXVkaW9Td2VlcCgpOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUucnVuQXVkaW9Td2VlcCA9IGZ1bmN0aW9uICgpIHsKCS8vQ2hhbm5lbCAxOgoJaWYgKHRoaXMuY2hhbm5lbDFsYXN0VGltZVN3ZWVwID4gMCkgewoJCWlmICh0aGlzLmNoYW5uZWwxZnJlcXVlbmN5U3dlZXBEaXZpZGVyID4gMCkgewoJCQl0aGlzLmNoYW5uZWwxU3dlcHQgPSB0cnVlOwoJCQlpZiAodGhpcy5jaGFubmVsMWRlY3JlYXNlU3dlZXApIHsKCQkJCXRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgLT0gdGhpcy5jaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSA+PiB0aGlzLmNoYW5uZWwxZnJlcXVlbmN5U3dlZXBEaXZpZGVyOwoJCQkJdGhpcy5jaGFubmVsMWZyZXF1ZW5jeSA9IHRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgJiAweDdGRjsKCQkJCXRoaXMuY2hhbm5lbDFGcmVxdWVuY3lUcmFja2VyID0gKDB4ODAwIC0gdGhpcy5jaGFubmVsMWZyZXF1ZW5jeSkgPDwgMjsKCQkJfQoJCQllbHNlIHsKCQkJCXRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgKz0gdGhpcy5jaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSA+PiB0aGlzLmNoYW5uZWwxZnJlcXVlbmN5U3dlZXBEaXZpZGVyOwoJCQkJdGhpcy5jaGFubmVsMWZyZXF1ZW5jeSA9IHRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3k7CgkJCQlpZiAodGhpcy5jaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSA8PSAweDdGRikgewoJCQkJCXRoaXMuY2hhbm5lbDFGcmVxdWVuY3lUcmFja2VyID0gKDB4ODAwIC0gdGhpcy5jaGFubmVsMWZyZXF1ZW5jeSkgPDwgMjsKCQkJCQkvL1J1biBvdmVyZmxvdyBjaGVjayB0d2ljZToKCQkJCQlpZiAoKHRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgKyAodGhpcy5jaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSA+PiB0aGlzLmNoYW5uZWwxZnJlcXVlbmN5U3dlZXBEaXZpZGVyKSkgPiAweDdGRikgewoJCQkJCQl0aGlzLmNoYW5uZWwxU3dlZXBGYXVsdCA9IHRydWU7CgkJCQkJCXRoaXMuY2hhbm5lbDFFbmFibGVDaGVjaygpOwoJCQkJCQl0aGlzLm1lbW9yeVsweEZGMjZdICY9IDB4RkU7CS8vQ2hhbm5lbCAjMSBPbiBGbGFnIE9mZgoJCQkJCX0KCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRoaXMuY2hhbm5lbDFmcmVxdWVuY3kgJj0gMHg3RkY7CgkJCQkJdGhpcy5jaGFubmVsMVN3ZWVwRmF1bHQgPSB0cnVlOwoJCQkJCXRoaXMuY2hhbm5lbDFFbmFibGVDaGVjaygpOwoJCQkJCXRoaXMubWVtb3J5WzB4RkYyNl0gJj0gMHhGRTsJLy9DaGFubmVsICMxIE9uIEZsYWcgT2ZmCgkJCQl9CgkJCX0KCQkJdGhpcy5jaGFubmVsMXRpbWVTd2VlcCA9IHRoaXMuY2hhbm5lbDFsYXN0VGltZVN3ZWVwOwoJCX0KCQllbHNlIHsKCQkJLy9DaGFubmVsIGhhcyBzd2VlcCBkaXNhYmxlZCBhbmQgdGltZXIgYmVjb21lcyBhIGxlbmd0aCBjb3VudGVyOgoJCQl0aGlzLmNoYW5uZWwxU3dlZXBGYXVsdCA9IHRydWU7CgkJCXRoaXMuY2hhbm5lbDFFbmFibGVDaGVjaygpOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDFBdWRpb1N3ZWVwUGVyZm9ybUR1bW15ID0gZnVuY3Rpb24gKCkgewoJLy9DaGFubmVsIDE6CglpZiAodGhpcy5jaGFubmVsMWZyZXF1ZW5jeVN3ZWVwRGl2aWRlciA+IDApIHsKCQlpZiAoIXRoaXMuY2hhbm5lbDFkZWNyZWFzZVN3ZWVwKSB7CgkJCXZhciBjaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSA9IHRoaXMuY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgKyAodGhpcy5jaGFubmVsMVNoYWRvd0ZyZXF1ZW5jeSA+PiB0aGlzLmNoYW5uZWwxZnJlcXVlbmN5U3dlZXBEaXZpZGVyKTsKCQkJaWYgKGNoYW5uZWwxU2hhZG93RnJlcXVlbmN5IDw9IDB4N0ZGKSB7CgkJCQkvL1J1biBvdmVyZmxvdyBjaGVjayB0d2ljZToKCQkJCWlmICgoY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgKyAoY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgPj4gdGhpcy5jaGFubmVsMWZyZXF1ZW5jeVN3ZWVwRGl2aWRlcikpID4gMHg3RkYpIHsKCQkJCQl0aGlzLmNoYW5uZWwxU3dlZXBGYXVsdCA9IHRydWU7CgkJCQkJdGhpcy5jaGFubmVsMUVuYWJsZUNoZWNrKCk7CgkJCQkJdGhpcy5tZW1vcnlbMHhGRjI2XSAmPSAweEZFOwkvL0NoYW5uZWwgIzEgT24gRmxhZyBPZmYKCQkJCX0KCQkJfQoJCQllbHNlIHsKCQkJCXRoaXMuY2hhbm5lbDFTd2VlcEZhdWx0ID0gdHJ1ZTsKCQkJCXRoaXMuY2hhbm5lbDFFbmFibGVDaGVjaygpOwoJCQkJdGhpcy5tZW1vcnlbMHhGRjI2XSAmPSAweEZFOwkvL0NoYW5uZWwgIzEgT24gRmxhZyBPZmYKCQkJfQoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2xvY2tBdWRpb0VudmVsb3BlID0gZnVuY3Rpb24gKCkgewoJLy9DaGFubmVsIDE6CglpZiAodGhpcy5jaGFubmVsMWVudmVsb3BlU3dlZXBzTGFzdCA+IC0xKSB7CgkJaWYgKHRoaXMuY2hhbm5lbDFlbnZlbG9wZVN3ZWVwcyA+IDApIHsKCQkJLS10aGlzLmNoYW5uZWwxZW52ZWxvcGVTd2VlcHM7CgkJfQoJCWVsc2UgewoJCQlpZiAoIXRoaXMuY2hhbm5lbDFlbnZlbG9wZVR5cGUpIHsKCQkJCWlmICh0aGlzLmNoYW5uZWwxZW52ZWxvcGVWb2x1bWUgPiAwKSB7CgkJCQkJLS10aGlzLmNoYW5uZWwxZW52ZWxvcGVWb2x1bWU7CgkJCQkJdGhpcy5jaGFubmVsMWVudmVsb3BlU3dlZXBzID0gdGhpcy5jaGFubmVsMWVudmVsb3BlU3dlZXBzTGFzdDsKCQkJCQl0aGlzLmNoYW5uZWwxT3V0cHV0TGV2ZWxDYWNoZSgpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdGhpcy5jaGFubmVsMWVudmVsb3BlU3dlZXBzTGFzdCA9IC0xOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKHRoaXMuY2hhbm5lbDFlbnZlbG9wZVZvbHVtZSA8IDB4RikgewoJCQkJKyt0aGlzLmNoYW5uZWwxZW52ZWxvcGVWb2x1bWU7CgkJCQl0aGlzLmNoYW5uZWwxZW52ZWxvcGVTd2VlcHMgPSB0aGlzLmNoYW5uZWwxZW52ZWxvcGVTd2VlcHNMYXN0OwoJCQkJdGhpcy5jaGFubmVsMU91dHB1dExldmVsQ2FjaGUoKTsKCQkJfQoJCQllbHNlIHsKCQkJCXRoaXMuY2hhbm5lbDFlbnZlbG9wZVN3ZWVwc0xhc3QgPSAtMTsKCQkJfQoJCX0KCX0KCS8vQ2hhbm5lbCAyOgoJaWYgKHRoaXMuY2hhbm5lbDJlbnZlbG9wZVN3ZWVwc0xhc3QgPiAtMSkgewoJCWlmICh0aGlzLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHMgPiAwKSB7CgkJCS0tdGhpcy5jaGFubmVsMmVudmVsb3BlU3dlZXBzOwoJCX0KCQllbHNlIHsKCQkJaWYgKCF0aGlzLmNoYW5uZWwyZW52ZWxvcGVUeXBlKSB7CgkJCQlpZiAodGhpcy5jaGFubmVsMmVudmVsb3BlVm9sdW1lID4gMCkgewoJCQkJCS0tdGhpcy5jaGFubmVsMmVudmVsb3BlVm9sdW1lOwoJCQkJCXRoaXMuY2hhbm5lbDJlbnZlbG9wZVN3ZWVwcyA9IHRoaXMuY2hhbm5lbDJlbnZlbG9wZVN3ZWVwc0xhc3Q7CgkJCQkJdGhpcy5jaGFubmVsMk91dHB1dExldmVsQ2FjaGUoKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRoaXMuY2hhbm5lbDJlbnZlbG9wZVN3ZWVwc0xhc3QgPSAtMTsKCQkJCX0KCQkJfQoJCQllbHNlIGlmICh0aGlzLmNoYW5uZWwyZW52ZWxvcGVWb2x1bWUgPCAweEYpIHsKCQkJCSsrdGhpcy5jaGFubmVsMmVudmVsb3BlVm9sdW1lOwoJCQkJdGhpcy5jaGFubmVsMmVudmVsb3BlU3dlZXBzID0gdGhpcy5jaGFubmVsMmVudmVsb3BlU3dlZXBzTGFzdDsKCQkJCXRoaXMuY2hhbm5lbDJPdXRwdXRMZXZlbENhY2hlKCk7CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHNMYXN0ID0gLTE7CgkJCX0KCQl9Cgl9CgkvL0NoYW5uZWwgNDoKCWlmICh0aGlzLmNoYW5uZWw0ZW52ZWxvcGVTd2VlcHNMYXN0ID4gLTEpIHsKCQlpZiAodGhpcy5jaGFubmVsNGVudmVsb3BlU3dlZXBzID4gMCkgewoJCQktLXRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwczsKCQl9CgkJZWxzZSB7CgkJCWlmICghdGhpcy5jaGFubmVsNGVudmVsb3BlVHlwZSkgewoJCQkJaWYgKHRoaXMuY2hhbm5lbDRlbnZlbG9wZVZvbHVtZSA+IDApIHsKCQkJCQl0aGlzLmNoYW5uZWw0Y3VycmVudFZvbHVtZSA9IC0tdGhpcy5jaGFubmVsNGVudmVsb3BlVm9sdW1lIDw8IHRoaXMuY2hhbm5lbDRWb2x1bWVTaGlmdGVyOwoJCQkJCXRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwcyA9IHRoaXMuY2hhbm5lbDRlbnZlbG9wZVN3ZWVwc0xhc3Q7CgkJCQkJdGhpcy5jaGFubmVsNFVwZGF0ZUNhY2hlKCk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQl0aGlzLmNoYW5uZWw0ZW52ZWxvcGVTd2VlcHNMYXN0ID0gLTE7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAodGhpcy5jaGFubmVsNGVudmVsb3BlVm9sdW1lIDwgMHhGKSB7CgkJCQl0aGlzLmNoYW5uZWw0Y3VycmVudFZvbHVtZSA9ICsrdGhpcy5jaGFubmVsNGVudmVsb3BlVm9sdW1lIDw8IHRoaXMuY2hhbm5lbDRWb2x1bWVTaGlmdGVyOwoJCQkJdGhpcy5jaGFubmVsNGVudmVsb3BlU3dlZXBzID0gdGhpcy5jaGFubmVsNGVudmVsb3BlU3dlZXBzTGFzdDsKCQkJCXRoaXMuY2hhbm5lbDRVcGRhdGVDYWNoZSgpOwoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5jaGFubmVsNGVudmVsb3BlU3dlZXBzTGFzdCA9IC0xOwoJCQl9CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jb21wdXRlQXVkaW9DaGFubmVscyA9IGZ1bmN0aW9uICgpIHsKCS8vQ2xvY2sgZG93biB0aGUgZm91ciBhdWRpbyBjaGFubmVscyB0byB0aGUgbmV4dCBjbG9zZXN0IGF1ZGlvIGV2ZW50OgoJdGhpcy5jaGFubmVsMUZyZXF1ZW5jeUNvdW50ZXIgLT0gdGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50OwoJdGhpcy5jaGFubmVsMkZyZXF1ZW5jeUNvdW50ZXIgLT0gdGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50OwoJdGhpcy5jaGFubmVsM0NvdW50ZXIgLT0gdGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50OwoJdGhpcy5jaGFubmVsNENvdW50ZXIgLT0gdGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50OwoJLy9DaGFubmVsIDEgY291bnRlcjoKCWlmICh0aGlzLmNoYW5uZWwxRnJlcXVlbmN5Q291bnRlciA9PSAwKSB7CgkJdGhpcy5jaGFubmVsMUZyZXF1ZW5jeUNvdW50ZXIgPSB0aGlzLmNoYW5uZWwxRnJlcXVlbmN5VHJhY2tlcjsKCQl0aGlzLmNoYW5uZWwxRHV0eVRyYWNrZXIgPSAodGhpcy5jaGFubmVsMUR1dHlUcmFja2VyICsgMSkgJiAweDc7CgkJdGhpcy5jaGFubmVsMU91dHB1dExldmVsVHJpbWFyeUNhY2hlKCk7Cgl9CgkvL0NoYW5uZWwgMiBjb3VudGVyOgoJaWYgKHRoaXMuY2hhbm5lbDJGcmVxdWVuY3lDb3VudGVyID09IDApIHsKCQl0aGlzLmNoYW5uZWwyRnJlcXVlbmN5Q291bnRlciA9IHRoaXMuY2hhbm5lbDJGcmVxdWVuY3lUcmFja2VyOwoJCXRoaXMuY2hhbm5lbDJEdXR5VHJhY2tlciA9ICh0aGlzLmNoYW5uZWwyRHV0eVRyYWNrZXIgKyAxKSAmIDB4NzsKCQl0aGlzLmNoYW5uZWwyT3V0cHV0TGV2ZWxUcmltYXJ5Q2FjaGUoKTsKCX0KCS8vQ2hhbm5lbCAzIGNvdW50ZXI6CglpZiAodGhpcy5jaGFubmVsM0NvdW50ZXIgPT0gMCkgewoJCWlmICh0aGlzLmNoYW5uZWwzY2FuUGxheSkgewoJCQl0aGlzLmNoYW5uZWwzbGFzdFNhbXBsZUxvb2t1cCA9ICh0aGlzLmNoYW5uZWwzbGFzdFNhbXBsZUxvb2t1cCArIDEpICYgMHgxRjsKCQl9CgkJdGhpcy5jaGFubmVsM0NvdW50ZXIgPSB0aGlzLmNoYW5uZWwzRnJlcXVlbmN5UGVyaW9kOwoJCXRoaXMuY2hhbm5lbDNVcGRhdGVDYWNoZSgpOwoJfQoJLy9DaGFubmVsIDQgY291bnRlcjoKCWlmICh0aGlzLmNoYW5uZWw0Q291bnRlciA9PSAwKSB7CgkJdGhpcy5jaGFubmVsNGxhc3RTYW1wbGVMb29rdXAgPSAodGhpcy5jaGFubmVsNGxhc3RTYW1wbGVMb29rdXAgKyAxKSAmIHRoaXMuY2hhbm5lbDRCaXRSYW5nZTsKCQl0aGlzLmNoYW5uZWw0Q291bnRlciA9IHRoaXMuY2hhbm5lbDRGcmVxdWVuY3lQZXJpb2Q7CgkJdGhpcy5jaGFubmVsNFVwZGF0ZUNhY2hlKCk7Cgl9CgkvL0ZpbmQgdGhlIG51bWJlciBvZiBjbG9ja3MgdG8gbmV4dCBjbG9zZXN0IGNvdW50ZXIgZXZlbnQ6Cgl0aGlzLmF1ZGlvQ2xvY2tzVW50aWxOZXh0RXZlbnRDb3VudGVyID0gdGhpcy5hdWRpb0Nsb2Nrc1VudGlsTmV4dEV2ZW50ID0gTWF0aC5taW4odGhpcy5jaGFubmVsMUZyZXF1ZW5jeUNvdW50ZXIsIHRoaXMuY2hhbm5lbDJGcmVxdWVuY3lDb3VudGVyLCB0aGlzLmNoYW5uZWwzQ291bnRlciwgdGhpcy5jaGFubmVsNENvdW50ZXIpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsMUVuYWJsZUNoZWNrID0gZnVuY3Rpb24gKCkgewoJdGhpcy5jaGFubmVsMUVuYWJsZWQgPSAoKHRoaXMuY2hhbm5lbDFjb25zZWN1dGl2ZSB8fCB0aGlzLmNoYW5uZWwxdG90YWxMZW5ndGggPiAwKSAmJiAhdGhpcy5jaGFubmVsMVN3ZWVwRmF1bHQgJiYgdGhpcy5jaGFubmVsMWNhblBsYXkpOwoJdGhpcy5jaGFubmVsMU91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDFWb2x1bWVFbmFibGVDaGVjayA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuY2hhbm5lbDFjYW5QbGF5ID0gKHRoaXMubWVtb3J5WzB4RkYxMl0gPiA3KTsKCXRoaXMuY2hhbm5lbDFFbmFibGVDaGVjaygpOwoJdGhpcy5jaGFubmVsMU91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDFPdXRwdXRMZXZlbENhY2hlID0gZnVuY3Rpb24gKCkgewoJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0ID0gKHRoaXMubGVmdENoYW5uZWwxKSA/IHRoaXMuY2hhbm5lbDFlbnZlbG9wZVZvbHVtZSA6IDA7Cgl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0ID0gKHRoaXMucmlnaHRDaGFubmVsMSkgPyB0aGlzLmNoYW5uZWwxZW52ZWxvcGVWb2x1bWUgOiAwOwoJdGhpcy5jaGFubmVsMU91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDFPdXRwdXRMZXZlbFNlY29uZGFyeUNhY2hlID0gZnVuY3Rpb24gKCkgewoJaWYgKHRoaXMuY2hhbm5lbDFFbmFibGVkKSB7CgkJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0OwoJCXRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSB0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0OwoJfQoJZWxzZSB7CgkJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gMDsKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0U2Vjb25kYXJ5ID0gMDsKCX0KCXRoaXMuY2hhbm5lbDFPdXRwdXRMZXZlbFRyaW1hcnlDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsMU91dHB1dExldmVsVHJpbWFyeUNhY2hlID0gZnVuY3Rpb24gKCkgewoJaWYgKHRoaXMuY2hhbm5lbDFDYWNoZWREdXR5W3RoaXMuY2hhbm5lbDFEdXR5VHJhY2tlcl0gJiYgc2V0dGluZ3NbMTRdWzBdKSB7CgkJdGhpcy5jaGFubmVsMWN1cnJlbnRTYW1wbGVMZWZ0VHJpbWFyeSA9IHRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlTGVmdFNlY29uZGFyeTsKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0VHJpbWFyeSA9IHRoaXMuY2hhbm5lbDFjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnk7Cgl9CgllbHNlIHsKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZUxlZnRUcmltYXJ5ID0gMDsKCQl0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0VHJpbWFyeSA9IDA7Cgl9Cgl0aGlzLm1peGVyT3V0cHV0TGV2ZWxDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsMkVuYWJsZUNoZWNrID0gZnVuY3Rpb24gKCkgewoJdGhpcy5jaGFubmVsMkVuYWJsZWQgPSAoKHRoaXMuY2hhbm5lbDJjb25zZWN1dGl2ZSB8fCB0aGlzLmNoYW5uZWwydG90YWxMZW5ndGggPiAwKSAmJiB0aGlzLmNoYW5uZWwyY2FuUGxheSk7Cgl0aGlzLmNoYW5uZWwyT3V0cHV0TGV2ZWxTZWNvbmRhcnlDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsMlZvbHVtZUVuYWJsZUNoZWNrID0gZnVuY3Rpb24gKCkgewoJdGhpcy5jaGFubmVsMmNhblBsYXkgPSAodGhpcy5tZW1vcnlbMHhGRjE3XSA+IDcpOwoJdGhpcy5jaGFubmVsMkVuYWJsZUNoZWNrKCk7Cgl0aGlzLmNoYW5uZWwyT3V0cHV0TGV2ZWxTZWNvbmRhcnlDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsMk91dHB1dExldmVsQ2FjaGUgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnQgPSAodGhpcy5sZWZ0Q2hhbm5lbDIpID8gdGhpcy5jaGFubmVsMmVudmVsb3BlVm9sdW1lIDogMDsKCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHQgPSAodGhpcy5yaWdodENoYW5uZWwyKSA/IHRoaXMuY2hhbm5lbDJlbnZlbG9wZVZvbHVtZSA6IDA7Cgl0aGlzLmNoYW5uZWwyT3V0cHV0TGV2ZWxTZWNvbmRhcnlDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsMk91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUgPSBmdW5jdGlvbiAoKSB7CglpZiAodGhpcy5jaGFubmVsMkVuYWJsZWQpIHsKCQl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnkgPSB0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnQ7CgkJdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSA9IHRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHQ7Cgl9CgllbHNlIHsKCQl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnkgPSAwOwoJCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSAwOwoJfQoJdGhpcy5jaGFubmVsMk91dHB1dExldmVsVHJpbWFyeUNhY2hlKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNoYW5uZWwyT3V0cHV0TGV2ZWxUcmltYXJ5Q2FjaGUgPSBmdW5jdGlvbiAoKSB7CglpZiAodGhpcy5jaGFubmVsMkNhY2hlZER1dHlbdGhpcy5jaGFubmVsMkR1dHlUcmFja2VyXSAmJiBzZXR0aW5nc1sxNF1bMV0pIHsKCQl0aGlzLmNoYW5uZWwyY3VycmVudFNhbXBsZUxlZnRUcmltYXJ5ID0gdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5OwoJCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHRUcmltYXJ5ID0gdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeTsKCX0KCWVsc2UgewoJCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlTGVmdFRyaW1hcnkgPSAwOwoJCXRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHRUcmltYXJ5ID0gMDsKCX0KCXRoaXMubWl4ZXJPdXRwdXRMZXZlbENhY2hlKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNoYW5uZWwzRW5hYmxlQ2hlY2sgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLmNoYW5uZWwzRW5hYmxlZCA9ICgvKnRoaXMuY2hhbm5lbDNjYW5QbGF5ICYmICovKHRoaXMuY2hhbm5lbDNjb25zZWN1dGl2ZSB8fCB0aGlzLmNoYW5uZWwzdG90YWxMZW5ndGggPiAwKSk7Cgl0aGlzLmNoYW5uZWwzT3V0cHV0TGV2ZWxTZWNvbmRhcnlDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsM091dHB1dExldmVsQ2FjaGUgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZUxlZnQgPSAodGhpcy5sZWZ0Q2hhbm5lbDMpID8gdGhpcy5jYWNoZWRDaGFubmVsM1NhbXBsZSA6IDA7Cgl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZVJpZ2h0ID0gKHRoaXMucmlnaHRDaGFubmVsMykgPyB0aGlzLmNhY2hlZENoYW5uZWwzU2FtcGxlIDogMDsKCXRoaXMuY2hhbm5lbDNPdXRwdXRMZXZlbFNlY29uZGFyeUNhY2hlKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNoYW5uZWwzT3V0cHV0TGV2ZWxTZWNvbmRhcnlDYWNoZSA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLmNoYW5uZWwzRW5hYmxlZCAmJiBzZXR0aW5nc1sxNF1bMl0pIHsKCQl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnkgPSB0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZUxlZnQ7CgkJdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSA9IHRoaXMuY2hhbm5lbDNjdXJyZW50U2FtcGxlUmlnaHQ7Cgl9CgllbHNlIHsKCQl0aGlzLmNoYW5uZWwzY3VycmVudFNhbXBsZUxlZnRTZWNvbmRhcnkgPSAwOwoJCXRoaXMuY2hhbm5lbDNjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSAwOwoJfQoJdGhpcy5taXhlck91dHB1dExldmVsQ2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDRFbmFibGVDaGVjayA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuY2hhbm5lbDRFbmFibGVkID0gKCh0aGlzLmNoYW5uZWw0Y29uc2VjdXRpdmUgfHwgdGhpcy5jaGFubmVsNHRvdGFsTGVuZ3RoID4gMCkgJiYgdGhpcy5jaGFubmVsNGNhblBsYXkpOwoJdGhpcy5jaGFubmVsNE91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDRWb2x1bWVFbmFibGVDaGVjayA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuY2hhbm5lbDRjYW5QbGF5ID0gKHRoaXMubWVtb3J5WzB4RkYyMV0gPiA3KTsKCXRoaXMuY2hhbm5lbDRFbmFibGVDaGVjaygpOwoJdGhpcy5jaGFubmVsNE91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDRPdXRwdXRMZXZlbENhY2hlID0gZnVuY3Rpb24gKCkgewoJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0ID0gKHRoaXMubGVmdENoYW5uZWw0KSA/IHRoaXMuY2FjaGVkQ2hhbm5lbDRTYW1wbGUgOiAwOwoJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVSaWdodCA9ICh0aGlzLnJpZ2h0Q2hhbm5lbDQpID8gdGhpcy5jYWNoZWRDaGFubmVsNFNhbXBsZSA6IDA7Cgl0aGlzLmNoYW5uZWw0T3V0cHV0TGV2ZWxTZWNvbmRhcnlDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsNE91dHB1dExldmVsU2Vjb25kYXJ5Q2FjaGUgPSBmdW5jdGlvbiAoKSB7CglpZiAodGhpcy5jaGFubmVsNEVuYWJsZWQgJiYgc2V0dGluZ3NbMTRdWzNdKSB7CgkJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0OwoJCXRoaXMuY2hhbm5lbDRjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkgPSB0aGlzLmNoYW5uZWw0Y3VycmVudFNhbXBsZVJpZ2h0OwoJfQoJZWxzZSB7CgkJdGhpcy5jaGFubmVsNGN1cnJlbnRTYW1wbGVMZWZ0U2Vjb25kYXJ5ID0gMDsKCQl0aGlzLmNoYW5uZWw0Y3VycmVudFNhbXBsZVJpZ2h0U2Vjb25kYXJ5ID0gMDsKCX0KCXRoaXMubWl4ZXJPdXRwdXRMZXZlbENhY2hlKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1peGVyT3V0cHV0TGV2ZWxDYWNoZSA9IGZ1bmN0aW9uICgpIHsKCXRoaXMubWl4ZXJPdXRwdXRDYWNoZSA9ICgoKCh0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZUxlZnRUcmltYXJ5ICsgdGhpcy5jaGFubmVsMmN1cnJlbnRTYW1wbGVMZWZ0VHJpbWFyeSArIHRoaXMuY2hhbm5lbDNjdXJyZW50U2FtcGxlTGVmdFNlY29uZGFyeSArIHRoaXMuY2hhbm5lbDRjdXJyZW50U2FtcGxlTGVmdFNlY29uZGFyeSkgKiB0aGlzLlZpbkxlZnRDaGFubmVsTWFzdGVyVm9sdW1lKSA8PCAxNikgfAoJKCh0aGlzLmNoYW5uZWwxY3VycmVudFNhbXBsZVJpZ2h0VHJpbWFyeSArIHRoaXMuY2hhbm5lbDJjdXJyZW50U2FtcGxlUmlnaHRUcmltYXJ5ICsgdGhpcy5jaGFubmVsM2N1cnJlbnRTYW1wbGVSaWdodFNlY29uZGFyeSArIHRoaXMuY2hhbm5lbDRjdXJyZW50U2FtcGxlUmlnaHRTZWNvbmRhcnkpICogdGhpcy5WaW5SaWdodENoYW5uZWxNYXN0ZXJWb2x1bWUpKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hhbm5lbDNVcGRhdGVDYWNoZSA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuY2FjaGVkQ2hhbm5lbDNTYW1wbGUgPSB0aGlzLmNoYW5uZWwzUENNW3RoaXMuY2hhbm5lbDNsYXN0U2FtcGxlTG9va3VwXSA+PiB0aGlzLmNoYW5uZWwzcGF0dGVyblR5cGU7Cgl0aGlzLmNoYW5uZWwzT3V0cHV0TGV2ZWxDYWNoZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jaGFubmVsM1dyaXRlUkFNID0gZnVuY3Rpb24gKGFkZHJlc3MsIGRhdGEpIHsKCWlmICh0aGlzLmNoYW5uZWwzY2FuUGxheSkgewoJCXRoaXMuYXVkaW9KSVQoKTsKCQkvL2FkZHJlc3MgPSB0aGlzLmNoYW5uZWwzbGFzdFNhbXBsZUxvb2t1cCA+PiAxOwoJfQoJdGhpcy5tZW1vcnlbMHhGRjMwIHwgYWRkcmVzc10gPSBkYXRhOwoJYWRkcmVzcyA8PD0gMTsKCXRoaXMuY2hhbm5lbDNQQ01bYWRkcmVzc10gPSBkYXRhID4+IDQ7Cgl0aGlzLmNoYW5uZWwzUENNW2FkZHJlc3MgfCAxXSA9IGRhdGEgJiAweEY7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNoYW5uZWw0VXBkYXRlQ2FjaGUgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLmNhY2hlZENoYW5uZWw0U2FtcGxlID0gdGhpcy5ub2lzZVNhbXBsZVRhYmxlW3RoaXMuY2hhbm5lbDRjdXJyZW50Vm9sdW1lIHwgdGhpcy5jaGFubmVsNGxhc3RTYW1wbGVMb29rdXBdOwoJdGhpcy5jaGFubmVsNE91dHB1dExldmVsQ2FjaGUoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkgewoJLy9UaGUgcHJlcHJvY2Vzc2luZyBiZWZvcmUgdGhlIGFjdHVhbCBpdGVyYXRpb24gbG9vcDoKCWlmICgodGhpcy5zdG9wRW11bGF0b3IgJiAyKSA9PSAwKSB7CgkJaWYgKCh0aGlzLnN0b3BFbXVsYXRvciAmIDEpID09IDEpIHsKCQkJaWYgKCF0aGlzLkNQVVN0b3BwZWQpIHsKCQkJCXRoaXMuc3RvcEVtdWxhdG9yID0gMDsKCQkJCXRoaXMuYXVkaW9VbmRlcnJ1bkFkanVzdG1lbnQoKTsKCQkJCXRoaXMuY2xvY2tVcGRhdGUoKTsJCQkvL1JUQyBjbG9ja2luZy4KCQkJCWlmICghdGhpcy5oYWx0KSB7CgkJCQkJdGhpcy5leGVjdXRlSXRlcmF0aW9uKCk7CgkJCQl9CgkJCQllbHNlIHsJCQkJCQkvL0ZpbmlzaCB0aGUgSEFMVCBydW5kb3duIGV4ZWN1dGlvbi4KCQkJCQl0aGlzLkNQVVRpY2tzID0gMDsKCQkJCQl0aGlzLmNhbGN1bGF0ZUhBTFRQZXJpb2QoKTsKCQkJCQlpZiAodGhpcy5oYWx0KSB7CgkJCQkJCXRoaXMudXBkYXRlQ29yZSgpOwoJCQkJCQl0aGlzLml0ZXJhdGlvbkVuZFJvdXRpbmUoKTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXRoaXMuZXhlY3V0ZUl0ZXJhdGlvbigpOwoJCQkJCX0KCQkJCX0KCQkJCS8vUmVxdWVzdCB0aGUgZ3JhcGhpY3MgdGFyZ2V0IHRvIGJlIHVwZGF0ZWQ6CgkJCQl0aGlzLnJlcXVlc3REcmF3KCk7CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLmF1ZGlvVW5kZXJydW5BZGp1c3RtZW50KCk7CgkJCQl0aGlzLmF1ZGlvVGlja3MgKz0gdGhpcy5DUFVDeWNsZXNUb3RhbDsKCQkJCXRoaXMuYXVkaW9KSVQoKTsKCQkJCXRoaXMuc3RvcEVtdWxhdG9yIHw9IDE7CQkJLy9FbmQgY3VycmVudCBsb29wLgoJCQl9CgkJfQoJCWVsc2UgewkJLy9XZSBjYW4gb25seSBnZXQgaGVyZSBpZiB0aGVyZSB3YXMgYW4gaW50ZXJuYWwgZXJyb3IsIGJ1dCB0aGUgbG9vcCB3YXMgcmVzdGFydGVkLgoJCQljb3V0KCJJdGVyYXRvciByZXN0YXJ0ZWQgYSBmYXVsdGVkIGNvcmUuIiwgMik7CgkJCXBhdXNlKCk7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5leGVjdXRlSXRlcmF0aW9uID0gZnVuY3Rpb24gKCkgewoJLy9JdGVyYXRlIHRoZSBpbnRlcnByZXRlciBsb29wOgoJdmFyIG9wY29kZVRvRXhlY3V0ZSA9IDA7Cgl2YXIgdGltZWRUaWNrcyA9IDA7Cgl3aGlsZSAodGhpcy5zdG9wRW11bGF0b3IgPT0gMCkgewoJCS8vSW50ZXJydXB0IEFybWluZzoKCQlzd2l0Y2ggKHRoaXMuSVJRRW5hYmxlRGVsYXkpIHsKCQkJY2FzZSAxOgoJCQkJdGhpcy5JTUUgPSB0cnVlOwoJCQkJdGhpcy5jaGVja0lSUU1hdGNoaW5nKCk7CgkJCWNhc2UgMjoKCQkJCS0tdGhpcy5JUlFFbmFibGVEZWxheTsKCQl9CgkJLy9JcyBhbiBJUlEgc2V0IHRvIGZpcmU/OgoJCWlmICh0aGlzLklSUUxpbmVNYXRjaGVkID4gMCkgewoJCQkvL0lNRSBpcyB0cnVlIGFuZCBhbmQgaW50ZXJydXB0IHdhcyBtYXRjaGVkOgoJCQl0aGlzLmxhdW5jaElSUSgpOwoJCX0KCQkvL0ZldGNoIHRoZSBjdXJyZW50IG9wY29kZToKCQlvcGNvZGVUb0V4ZWN1dGUgPSB0aGlzLm1lbW9yeVJlYWRlclt0aGlzLnByb2dyYW1Db3VudGVyXSh0aGlzLCB0aGlzLnByb2dyYW1Db3VudGVyKTsKCQkvL0luY3JlbWVudCB0aGUgcHJvZ3JhbSBjb3VudGVyIHRvIHRoZSBuZXh0IGluc3RydWN0aW9uOgoJCXRoaXMucHJvZ3JhbUNvdW50ZXIgPSAodGhpcy5wcm9ncmFtQ291bnRlciArIDEpICYgMHhGRkZGOwoJCS8vQ2hlY2sgZm9yIHRoZSBwcm9ncmFtIGNvdW50ZXIgcXVpcms6CgkJaWYgKHRoaXMuc2tpcFBDSW5jcmVtZW50KSB7CgkJCXRoaXMucHJvZ3JhbUNvdW50ZXIgPSAodGhpcy5wcm9ncmFtQ291bnRlciAtIDEpICYgMHhGRkZGOwoJCQl0aGlzLnNraXBQQ0luY3JlbWVudCA9IGZhbHNlOwoJCX0KCQkvL0dldCBob3cgbWFueSBDUFUgY3ljbGVzIHRoZSBjdXJyZW50IGluc3RydWN0aW9uIGNvdW50cyBmb3I6CgkJdGhpcy5DUFVUaWNrcyA9IHRoaXMuVElDS1RhYmxlW29wY29kZVRvRXhlY3V0ZV07CgkJLy9FeGVjdXRlIHRoZSBjdXJyZW50IGluc3RydWN0aW9uOgoJCXRoaXMuT1BDT0RFW29wY29kZVRvRXhlY3V0ZV0odGhpcyk7CgkJLy9VcGRhdGUgdGhlIHN0YXRlIChJbmxpbmVkIHVwZGF0ZUNvcmVGdWxsIG1hbnVhbGx5IGhlcmUpOgoJCS8vVXBkYXRlIHRoZSBjbG9ja2luZyBmb3IgdGhlIExDRCBlbXVsYXRpb246CgkJdGhpcy5MQ0RUaWNrcyArPSB0aGlzLkNQVVRpY2tzID4+IHRoaXMuZG91YmxlU3BlZWRTaGlmdGVyOwkvL0xDRCBUaW1pbmcKCQl0aGlzLkxDRENPTlRST0xbdGhpcy5hY3R1YWxTY2FuTGluZV0odGhpcyk7CQkJCQkvL1NjYW4gTGluZSBhbmQgU1RBVCBNb2RlIENvbnRyb2wKCQkvL1NpbmdsZS1zcGVlZCByZWxhdGl2ZSB0aW1pbmcgZm9yIEEvViBlbXVsYXRpb246CgkJdGltZWRUaWNrcyA9IHRoaXMuQ1BVVGlja3MgPj4gdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXI7CQkvL0NQVSBjbG9ja2luZyBjYW4gYmUgdXBkYXRlZCBmcm9tIHRoZSBMQ0QgaGFuZGxpbmcuCgkJdGhpcy5hdWRpb1RpY2tzICs9IHRpbWVkVGlja3M7CQkJCQkJCQkvL0F1ZGlvIFRpbWluZwoJCXRoaXMuZW11bGF0b3JUaWNrcyArPSB0aW1lZFRpY2tzOwkJCQkJCQkvL0VtdWxhdG9yIFRpbWluZwoJCS8vQ1BVIFRpbWVyczoKCQl0aGlzLkRJVlRpY2tzICs9IHRoaXMuQ1BVVGlja3M7CQkJCQkJCQkvL0RJViBUaW1pbmcKCQlpZiAodGhpcy5USU1BRW5hYmxlZCkgewkJCQkJCQkJCQkvL1RJTUEgVGltaW5nCgkJCXRoaXMudGltZXJUaWNrcyArPSB0aGlzLkNQVVRpY2tzOwoJCQl3aGlsZSAodGhpcy50aW1lclRpY2tzID49IHRoaXMuVEFDQ2xvY2tlcikgewoJCQkJdGhpcy50aW1lclRpY2tzIC09IHRoaXMuVEFDQ2xvY2tlcjsKCQkJCWlmICgrK3RoaXMubWVtb3J5WzB4RkYwNV0gPT0gMHgxMDApIHsKCQkJCQl0aGlzLm1lbW9yeVsweEZGMDVdID0gdGhpcy5tZW1vcnlbMHhGRjA2XTsKCQkJCQl0aGlzLmludGVycnVwdHNSZXF1ZXN0ZWQgfD0gMHg0OwoJCQkJCXRoaXMuY2hlY2tJUlFNYXRjaGluZygpOwoJCQkJfQoJCQl9CgkJfQoJCWlmICh0aGlzLnNlcmlhbFRpbWVyID4gMCkgewkJCQkJCQkJCQkvL1NlcmlhbCBUaW1pbmcKCQkJLy9JUlEgQ291bnRlcjoKCQkJdGhpcy5zZXJpYWxUaW1lciAtPSB0aGlzLkNQVVRpY2tzOwoJCQlpZiAodGhpcy5zZXJpYWxUaW1lciA8PSAwKSB7CgkJCQl0aGlzLmludGVycnVwdHNSZXF1ZXN0ZWQgfD0gMHg4OwoJCQkJdGhpcy5jaGVja0lSUU1hdGNoaW5nKCk7CgkJCX0KCQkJLy9CaXQgU2hpdCBDb3VudGVyOgoJCQl0aGlzLnNlcmlhbFNoaWZ0VGltZXIgLT0gdGhpcy5DUFVUaWNrczsKCQkJaWYgKHRoaXMuc2VyaWFsU2hpZnRUaW1lciA8PSAwKSB7CgkJCQl0aGlzLnNlcmlhbFNoaWZ0VGltZXIgPSB0aGlzLnNlcmlhbFNoaWZ0VGltZXJBbGxvY2F0ZWQ7CgkJCQl0aGlzLm1lbW9yeVsweEZGMDFdID0gKCh0aGlzLm1lbW9yeVsweEZGMDFdIDw8IDEpICYgMHhGRSkgfCAweDAxOwkvL1dlIGNvdWxkIHNoaWZ0IGluIGFjdHVhbCBsaW5rIGRhdGEgaGVyZSBpZiB3ZSB3ZXJlIHRvIGltcGxlbWVudCBzdWNoISEhCgkJCX0KCQl9CgkJLy9FbmQgb2YgaXRlcmF0aW9uIHJvdXRpbmU6CgkJaWYgKHRoaXMuZW11bGF0b3JUaWNrcyA+PSB0aGlzLkNQVUN5Y2xlc1RvdGFsKSB7CgkJCXRoaXMuaXRlcmF0aW9uRW5kUm91dGluZSgpOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuaXRlcmF0aW9uRW5kUm91dGluZSA9IGZ1bmN0aW9uICgpIHsKCWlmICgodGhpcy5zdG9wRW11bGF0b3IgJiAweDEpID09IDApIHsKCQl0aGlzLmF1ZGlvSklUKCk7CS8vTWFrZSBzdXJlIHdlIGF0IGxlYXN0IG91dHB1dCBvbmNlIHBlciBpdGVyYXRpb24uCgkJLy9VcGRhdGUgRElWIEFsaWdubWVudCAoSW50ZWdlciBvdmVyZmxvdyBzYWZldHkpOgoJCXRoaXMubWVtb3J5WzB4RkYwNF0gPSAodGhpcy5tZW1vcnlbMHhGRjA0XSArICh0aGlzLkRJVlRpY2tzID4+IDgpKSAmIDB4RkY7CgkJdGhpcy5ESVZUaWNrcyAmPSAweEZGOwoJCS8vVXBkYXRlIGVtdWxhdG9yIGZsYWdzOgoJCXRoaXMuc3RvcEVtdWxhdG9yIHw9IDE7CQkJLy9FbmQgY3VycmVudCBsb29wLgoJCXRoaXMuZW11bGF0b3JUaWNrcyAtPSB0aGlzLkNQVUN5Y2xlc1RvdGFsOwoJCXRoaXMuQ1BVQ3ljbGVzVG90YWxDdXJyZW50ICs9IHRoaXMuQ1BVQ3ljbGVzVG90YWxSb3VuZG9mZjsKCQl0aGlzLnJlY2FsY3VsYXRlSXRlcmF0aW9uQ2xvY2tMaW1pdCgpOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5oYW5kbGVTVE9QID0gZnVuY3Rpb24gKCkgewoJdGhpcy5DUFVTdG9wcGVkID0gdHJ1ZTsJCQkJCQkvL1N0b3AgQ1BVIHVudGlsIGpveXBhZCBpbnB1dCBjaGFuZ2VzLgoJdGhpcy5pdGVyYXRpb25FbmRSb3V0aW5lKCk7CglpZiAodGhpcy5lbXVsYXRvclRpY2tzIDwgMCkgewoJCXRoaXMuYXVkaW9UaWNrcyAtPSB0aGlzLmVtdWxhdG9yVGlja3M7CgkJdGhpcy5hdWRpb0pJVCgpOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5yZWNhbGN1bGF0ZUl0ZXJhdGlvbkNsb2NrTGltaXQgPSBmdW5jdGlvbiAoKSB7Cgl2YXIgZW5kTW9kdWx1cyA9IHRoaXMuQ1BVQ3ljbGVzVG90YWxDdXJyZW50ICUgNDsKCXRoaXMuQ1BVQ3ljbGVzVG90YWwgPSB0aGlzLkNQVUN5Y2xlc1RvdGFsQmFzZSArIHRoaXMuQ1BVQ3ljbGVzVG90YWxDdXJyZW50IC0gZW5kTW9kdWx1czsKCXRoaXMuQ1BVQ3ljbGVzVG90YWxDdXJyZW50ID0gZW5kTW9kdWx1czsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUucmVjYWxjdWxhdGVJdGVyYXRpb25DbG9ja0xpbWl0Rm9yQXVkaW8gPSBmdW5jdGlvbiAoYXVkaW9DbG9ja2luZykgewoJdGhpcy5DUFVDeWNsZXNUb3RhbCArPSBNYXRoLm1pbigoYXVkaW9DbG9ja2luZyA+PiAyKSA8PCAyLCB0aGlzLkNQVUN5Y2xlc1RvdGFsQmFzZSA8PCAxKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuc2NhbkxpbmVNb2RlMiA9IGZ1bmN0aW9uICgpIHsJLy9PQU0gU2VhcmNoIFBlcmlvZAoJaWYgKHRoaXMuU1RBVFRyYWNrZXIgIT0gMSkgewoJCWlmICh0aGlzLm1vZGUyVHJpZ2dlclNUQVQpIHsKCQkJdGhpcy5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJdGhpcy5jaGVja0lSUU1hdGNoaW5nKCk7CgkJfQoJCXRoaXMuU1RBVFRyYWNrZXIgPSAxOwoJCXRoaXMubW9kZVNUQVQgPSAyOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5zY2FuTGluZU1vZGUzID0gZnVuY3Rpb24gKCkgewkvL1NjYW4gTGluZSBEcmF3aW5nIFBlcmlvZAoJaWYgKHRoaXMubW9kZVNUQVQgIT0gMykgewoJCWlmICh0aGlzLlNUQVRUcmFja2VyID09IDAgJiYgdGhpcy5tb2RlMlRyaWdnZXJTVEFUKSB7CgkJCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDI7CgkJCXRoaXMuY2hlY2tJUlFNYXRjaGluZygpOwoJCX0KCQl0aGlzLlNUQVRUcmFja2VyID0gMTsKCQl0aGlzLm1vZGVTVEFUID0gMzsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuc2NhbkxpbmVNb2RlMCA9IGZ1bmN0aW9uICgpIHsJLy9Ib3Jpem9udGFsIEJsYW5raW5nIFBlcmlvZAoJaWYgKHRoaXMubW9kZVNUQVQgIT0gMCkgewoJCWlmICh0aGlzLlNUQVRUcmFja2VyICE9IDIpIHsKCQkJaWYgKHRoaXMuU1RBVFRyYWNrZXIgPT0gMCkgewoJCQkJaWYgKHRoaXMubW9kZTJUcmlnZ2VyU1RBVCkgewoJCQkJCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDI7CgkJCQkJdGhpcy5jaGVja0lSUU1hdGNoaW5nKCk7CgkJCQl9CgkJCQl0aGlzLm1vZGVTVEFUID0gMzsKCQkJfQoJCQl0aGlzLmluY3JlbWVudFNjYW5MaW5lUXVldWUoKTsKCQkJdGhpcy51cGRhdGVTcHJpdGVDb3VudCh0aGlzLmFjdHVhbFNjYW5MaW5lKTsKCQkJdGhpcy5TVEFUVHJhY2tlciA9IDI7CgkJfQoJCWlmICh0aGlzLkxDRFRpY2tzID49IHRoaXMuc3ByaXRlQ291bnQpIHsKCQkJaWYgKHRoaXMuaGRtYVJ1bm5pbmcpIHsKCQkJCXRoaXMuZXhlY3V0ZUhETUEoKTsKCQkJfQoJCQlpZiAodGhpcy5tb2RlMFRyaWdnZXJTVEFUKSB7CgkJCQl0aGlzLmludGVycnVwdHNSZXF1ZXN0ZWQgfD0gMHgyOwoJCQkJdGhpcy5jaGVja0lSUU1hdGNoaW5nKCk7CgkJCX0KCQkJdGhpcy5TVEFUVHJhY2tlciA9IDM7CgkJCXRoaXMubW9kZVNUQVQgPSAwOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2xvY2tzVW50aWxMWUNNYXRjaCA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLm1lbW9yeVsweEZGNDVdICE9IDApIHsKCQlpZiAodGhpcy5tZW1vcnlbMHhGRjQ1XSA+IHRoaXMuYWN0dWFsU2NhbkxpbmUpIHsKCQkJcmV0dXJuIDQ1NiAqICh0aGlzLm1lbW9yeVsweEZGNDVdIC0gdGhpcy5hY3R1YWxTY2FuTGluZSk7CgkJfQoJCXJldHVybiA0NTYgKiAoMTU0IC0gdGhpcy5hY3R1YWxTY2FuTGluZSArIHRoaXMubWVtb3J5WzB4RkY0NV0pOwoJfQoJcmV0dXJuICg0NTYgKiAoKHRoaXMuYWN0dWFsU2NhbkxpbmUgPT0gMTUzICYmIHRoaXMubWVtb3J5WzB4RkY0NF0gPT0gMCkgPyAxNTQgOiAoMTUzIC0gdGhpcy5hY3R1YWxTY2FuTGluZSkpKSArIDg7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNsb2Nrc1VudGlsTW9kZTAgPSBmdW5jdGlvbiAoKSB7Cglzd2l0Y2ggKHRoaXMubW9kZVNUQVQpIHsKCQljYXNlIDA6CgkJCWlmICh0aGlzLmFjdHVhbFNjYW5MaW5lID09IDE0MykgewoJCQkJdGhpcy51cGRhdGVTcHJpdGVDb3VudCgwKTsKCQkJCXJldHVybiB0aGlzLnNwcml0ZUNvdW50ICsgNTAxNjsKCQkJfQoJCQl0aGlzLnVwZGF0ZVNwcml0ZUNvdW50KHRoaXMuYWN0dWFsU2NhbkxpbmUgKyAxKTsKCQkJcmV0dXJuIHRoaXMuc3ByaXRlQ291bnQgKyA0NTY7CgkJY2FzZSAyOgoJCWNhc2UgMzoKCQkJdGhpcy51cGRhdGVTcHJpdGVDb3VudCh0aGlzLmFjdHVhbFNjYW5MaW5lKTsKCQkJcmV0dXJuIHRoaXMuc3ByaXRlQ291bnQ7CgkJY2FzZSAxOgoJCQl0aGlzLnVwZGF0ZVNwcml0ZUNvdW50KDApOwoJCQlyZXR1cm4gdGhpcy5zcHJpdGVDb3VudCArICg0NTYgKiAoMTU0IC0gdGhpcy5hY3R1YWxTY2FuTGluZSkpOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS51cGRhdGVTcHJpdGVDb3VudCA9IGZ1bmN0aW9uIChsaW5lKSB7Cgl0aGlzLnNwcml0ZUNvdW50ID0gMjUyOwoJaWYgKHRoaXMuY0dCQyAmJiB0aGlzLmdmeFNwcml0ZVNob3cpIHsJCQkJCQkJCQkJLy9JcyB0aGUgd2luZG93IGVuYWJsZWQgYW5kIGFyZSB3ZSBpbiBDR0IgbW9kZT8KCQl2YXIgbGluZUFkanVzdGVkID0gbGluZSArIDB4MTA7CgkJdmFyIHlvZmZzZXQgPSAwOwoJCXZhciB5Q2FwID0gKHRoaXMuZ2Z4U3ByaXRlTm9ybWFsSGVpZ2h0KSA/IDB4OCA6IDB4MTA7CgkJZm9yICh2YXIgT0FNQWRkcmVzcyA9IDB4RkUwMDsgT0FNQWRkcmVzcyA8IDB4RkVBMCAmJiB0aGlzLnNwcml0ZUNvdW50IDwgMzEyOyBPQU1BZGRyZXNzICs9IDQpIHsKCQkJeW9mZnNldCA9IGxpbmVBZGp1c3RlZCAtIHRoaXMubWVtb3J5W09BTUFkZHJlc3NdOwoJCQlpZiAoeW9mZnNldCA+IC0xICYmIHlvZmZzZXQgPCB5Q2FwKSB7CgkJCQl0aGlzLnNwcml0ZUNvdW50ICs9IDY7CgkJCX0KCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1hdGNoTFlDID0gZnVuY3Rpb24gKCkgewkvL0xZQyBSZWdpc3RlciBDb21wYXJlCglpZiAodGhpcy5tZW1vcnlbMHhGRjQ0XSA9PSB0aGlzLm1lbW9yeVsweEZGNDVdKSB7CgkJdGhpcy5tZW1vcnlbMHhGRjQxXSB8PSAweDA0OwoJCWlmICh0aGlzLkxZQ01hdGNoVHJpZ2dlclNUQVQpIHsKCQkJdGhpcy5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJdGhpcy5jaGVja0lSUU1hdGNoaW5nKCk7CgkJfQoJfQoJZWxzZSB7CgkJdGhpcy5tZW1vcnlbMHhGRjQxXSAmPSAweDdCOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS51cGRhdGVDb3JlID0gZnVuY3Rpb24gKCkgewoJLy9VcGRhdGUgdGhlIGNsb2NraW5nIGZvciB0aGUgTENEIGVtdWxhdGlvbjoKCXRoaXMuTENEVGlja3MgKz0gdGhpcy5DUFVUaWNrcyA+PiB0aGlzLmRvdWJsZVNwZWVkU2hpZnRlcjsJLy9MQ0QgVGltaW5nCgl0aGlzLkxDRENPTlRST0xbdGhpcy5hY3R1YWxTY2FuTGluZV0odGhpcyk7CQkJCQkvL1NjYW4gTGluZSBhbmQgU1RBVCBNb2RlIENvbnRyb2wKCS8vU2luZ2xlLXNwZWVkIHJlbGF0aXZlIHRpbWluZyBmb3IgQS9WIGVtdWxhdGlvbjoKCXZhciB0aW1lZFRpY2tzID0gdGhpcy5DUFVUaWNrcyA+PiB0aGlzLmRvdWJsZVNwZWVkU2hpZnRlcjsJLy9DUFUgY2xvY2tpbmcgY2FuIGJlIHVwZGF0ZWQgZnJvbSB0aGUgTENEIGhhbmRsaW5nLgoJdGhpcy5hdWRpb1RpY2tzICs9IHRpbWVkVGlja3M7CQkJCQkJCQkvL0F1ZGlvIFRpbWluZwoJdGhpcy5lbXVsYXRvclRpY2tzICs9IHRpbWVkVGlja3M7CQkJCQkJCS8vRW11bGF0b3IgVGltaW5nCgkvL0NQVSBUaW1lcnM6Cgl0aGlzLkRJVlRpY2tzICs9IHRoaXMuQ1BVVGlja3M7CQkJCQkJCQkvL0RJViBUaW1pbmcKCWlmICh0aGlzLlRJTUFFbmFibGVkKSB7CQkJCQkJCQkJCS8vVElNQSBUaW1pbmcKCQl0aGlzLnRpbWVyVGlja3MgKz0gdGhpcy5DUFVUaWNrczsKCQl3aGlsZSAodGhpcy50aW1lclRpY2tzID49IHRoaXMuVEFDQ2xvY2tlcikgewoJCQl0aGlzLnRpbWVyVGlja3MgLT0gdGhpcy5UQUNDbG9ja2VyOwoJCQlpZiAoKyt0aGlzLm1lbW9yeVsweEZGMDVdID09IDB4MTAwKSB7CgkJCQl0aGlzLm1lbW9yeVsweEZGMDVdID0gdGhpcy5tZW1vcnlbMHhGRjA2XTsKCQkJCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDQ7CgkJCQl0aGlzLmNoZWNrSVJRTWF0Y2hpbmcoKTsKCQkJfQoJCX0KCX0KCWlmICh0aGlzLnNlcmlhbFRpbWVyID4gMCkgewkJCQkJCQkJCQkvL1NlcmlhbCBUaW1pbmcKCQkvL0lSUSBDb3VudGVyOgoJCXRoaXMuc2VyaWFsVGltZXIgLT0gdGhpcy5DUFVUaWNrczsKCQlpZiAodGhpcy5zZXJpYWxUaW1lciA8PSAwKSB7CgkJCXRoaXMuaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDg7CgkJCXRoaXMuY2hlY2tJUlFNYXRjaGluZygpOwoJCX0KCQkvL0JpdCBTaGl0IENvdW50ZXI6CgkJdGhpcy5zZXJpYWxTaGlmdFRpbWVyIC09IHRoaXMuQ1BVVGlja3M7CgkJaWYgKHRoaXMuc2VyaWFsU2hpZnRUaW1lciA8PSAwKSB7CgkJCXRoaXMuc2VyaWFsU2hpZnRUaW1lciA9IHRoaXMuc2VyaWFsU2hpZnRUaW1lckFsbG9jYXRlZDsKCQkJdGhpcy5tZW1vcnlbMHhGRjAxXSA9ICgodGhpcy5tZW1vcnlbMHhGRjAxXSA8PCAxKSAmIDB4RkUpIHwgMHgwMTsJLy9XZSBjb3VsZCBzaGlmdCBpbiBhY3R1YWwgbGluayBkYXRhIGhlcmUgaWYgd2Ugd2VyZSB0byBpbXBsZW1lbnQgc3VjaCEhIQoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUudXBkYXRlQ29yZUZ1bGwgPSBmdW5jdGlvbiAoKSB7CgkvL1VwZGF0ZSB0aGUgc3RhdGUgbWFjaGluZToKCXRoaXMudXBkYXRlQ29yZSgpOwoJLy9FbmQgb2YgaXRlcmF0aW9uIHJvdXRpbmU6CglpZiAodGhpcy5lbXVsYXRvclRpY2tzID49IHRoaXMuQ1BVQ3ljbGVzVG90YWwpIHsKCQl0aGlzLml0ZXJhdGlvbkVuZFJvdXRpbmUoKTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUxDRENvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7CgkvL0Rpc3BsYXkgb24gaGFubGRpbmc6Cgl2YXIgbGluZSA9IDA7Cgl3aGlsZSAobGluZSA8IDE1NCkgewoJCWlmIChsaW5lIDwgMTQzKSB7CgkJCS8vV2UncmUgb24gYSBub3JtYWwgc2NhbiBsaW5lOgoJCQl0aGlzLkxJTkVDT05UUk9MW2xpbmVdID0gZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCQkJaWYgKHBhcmVudE9iai5MQ0RUaWNrcyA8IDgwKSB7CgkJCQkJcGFyZW50T2JqLnNjYW5MaW5lTW9kZTIoKTsKCQkJCX0KCQkJCWVsc2UgaWYgKHBhcmVudE9iai5MQ0RUaWNrcyA8IDI1MikgewoJCQkJCXBhcmVudE9iai5zY2FuTGluZU1vZGUzKCk7CgkJCQl9CgkJCQllbHNlIGlmIChwYXJlbnRPYmouTENEVGlja3MgPCA0NTYpIHsKCQkJCQlwYXJlbnRPYmouc2NhbkxpbmVNb2RlMCgpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJLy9XZSdyZSBvbiBhIG5ldyBzY2FuIGxpbmU6CgkJCQkJcGFyZW50T2JqLkxDRFRpY2tzIC09IDQ1NjsKCQkJCQlpZiAocGFyZW50T2JqLlNUQVRUcmFja2VyICE9IDMpIHsKCQkJCQkJLy9NYWtlIHN1cmUgdGhlIG1vZGUgMCBoYW5kbGVyIHdhcyBydW4gYXQgbGVhc3Qgb25jZSBwZXIgc2NhbiBsaW5lOgoJCQkJCQlpZiAocGFyZW50T2JqLlNUQVRUcmFja2VyICE9IDIpIHsKCQkJCQkJCWlmIChwYXJlbnRPYmouU1RBVFRyYWNrZXIgPT0gMCAmJiBwYXJlbnRPYmoubW9kZTJUcmlnZ2VyU1RBVCkgewoJCQkJCQkJCXBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJCQkJCX0KCQkJCQkJCXBhcmVudE9iai5pbmNyZW1lbnRTY2FuTGluZVF1ZXVlKCk7CgkJCQkJCX0KCQkJCQkJaWYgKHBhcmVudE9iai5oZG1hUnVubmluZykgewoJCQkJCQkJcGFyZW50T2JqLmV4ZWN1dGVIRE1BKCk7CgkJCQkJCX0KCQkJCQkJaWYgKHBhcmVudE9iai5tb2RlMFRyaWdnZXJTVEFUKSB7CgkJCQkJCQlwYXJlbnRPYmouaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDI7CgkJCQkJCX0KCQkJCQl9CgkJCQkJLy9VcGRhdGUgdGhlIHNjYW5saW5lIHJlZ2lzdGVycyBhbmQgYXNzZXJ0IHRoZSBMWUMgY291bnRlcjoKCQkJCQlwYXJlbnRPYmouYWN0dWFsU2NhbkxpbmUgPSArK3BhcmVudE9iai5tZW1vcnlbMHhGRjQ0XTsKCQkJCQkvL1BlcmZvcm0gYSBMWUMgY291bnRlciBhc3NlcnQ6CgkJCQkJaWYgKHBhcmVudE9iai5hY3R1YWxTY2FuTGluZSA9PSBwYXJlbnRPYmoubWVtb3J5WzB4RkY0NV0pIHsKCQkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNDFdIHw9IDB4MDQ7CgkJCQkJCWlmIChwYXJlbnRPYmouTFlDTWF0Y2hUcmlnZ2VyU1RBVCkgewoJCQkJCQkJcGFyZW50T2JqLmludGVycnVwdHNSZXF1ZXN0ZWQgfD0gMHgyOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MV0gJj0gMHg3QjsKCQkJCQl9CgkJCQkJcGFyZW50T2JqLmNoZWNrSVJRTWF0Y2hpbmcoKTsKCQkJCQkvL1Jlc2V0IG91ciBtb2RlIGNvbnRpbmdlbmN5IHZhcmlhYmxlczoKCQkJCQlwYXJlbnRPYmouU1RBVFRyYWNrZXIgPSAwOwoJCQkJCXBhcmVudE9iai5tb2RlU1RBVCA9IDI7CgkJCQkJcGFyZW50T2JqLkxJTkVDT05UUk9MW3BhcmVudE9iai5hY3R1YWxTY2FuTGluZV0ocGFyZW50T2JqKTsJLy9TY2FuIExpbmUgYW5kIFNUQVQgTW9kZSBDb250cm9sLgoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgaWYgKGxpbmUgPT0gMTQzKSB7CgkJCS8vV2UncmUgb24gdGhlIGxhc3QgdmlzaWJsZSBzY2FuIGxpbmUgb2YgdGhlIExDRCBzY3JlZW46CgkJCXRoaXMuTElORUNPTlRST0xbMTQzXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQkJCWlmIChwYXJlbnRPYmouTENEVGlja3MgPCA4MCkgewoJCQkJCXBhcmVudE9iai5zY2FuTGluZU1vZGUyKCk7CgkJCQl9CgkJCQllbHNlIGlmIChwYXJlbnRPYmouTENEVGlja3MgPCAyNTIpIHsKCQkJCQlwYXJlbnRPYmouc2NhbkxpbmVNb2RlMygpOwoJCQkJfQoJCQkJZWxzZSBpZiAocGFyZW50T2JqLkxDRFRpY2tzIDwgNDU2KSB7CgkJCQkJcGFyZW50T2JqLnNjYW5MaW5lTW9kZTAoKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vU3RhcnRpbmcgVi1CbGFuazoKCQkJCQkvL0p1c3QgZmluaXNoZWQgdGhlIGxhc3QgdmlzaWJsZSBzY2FuIGxpbmU6CgkJCQkJcGFyZW50T2JqLkxDRFRpY2tzIC09IDQ1NjsKCQkJCQlpZiAocGFyZW50T2JqLlNUQVRUcmFja2VyICE9IDMpIHsKCQkJCQkJLy9NYWtlIHN1cmUgdGhlIG1vZGUgMCBoYW5kbGVyIHdhcyBydW4gYXQgbGVhc3Qgb25jZSBwZXIgc2NhbiBsaW5lOgoJCQkJCQlpZiAocGFyZW50T2JqLlNUQVRUcmFja2VyICE9IDIpIHsKCQkJCQkJCWlmIChwYXJlbnRPYmouU1RBVFRyYWNrZXIgPT0gMCAmJiBwYXJlbnRPYmoubW9kZTJUcmlnZ2VyU1RBVCkgewoJCQkJCQkJCXBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJCQkJCX0KCQkJCQkJCXBhcmVudE9iai5pbmNyZW1lbnRTY2FuTGluZVF1ZXVlKCk7CgkJCQkJCX0KCQkJCQkJaWYgKHBhcmVudE9iai5oZG1hUnVubmluZykgewoJCQkJCQkJcGFyZW50T2JqLmV4ZWN1dGVIRE1BKCk7CgkJCQkJCX0KCQkJCQkJaWYgKHBhcmVudE9iai5tb2RlMFRyaWdnZXJTVEFUKSB7CgkJCQkJCQlwYXJlbnRPYmouaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDI7CgkJCQkJCX0KCQkJCQl9CgkJCQkJLy9VcGRhdGUgdGhlIHNjYW5saW5lIHJlZ2lzdGVycyBhbmQgYXNzZXJ0IHRoZSBMWUMgY291bnRlcjoKCQkJCQlwYXJlbnRPYmouYWN0dWFsU2NhbkxpbmUgPSBwYXJlbnRPYmoubWVtb3J5WzB4RkY0NF0gPSAxNDQ7CgkJCQkJLy9QZXJmb3JtIGEgTFlDIGNvdW50ZXIgYXNzZXJ0OgoJCQkJCWlmIChwYXJlbnRPYmoubWVtb3J5WzB4RkY0NV0gPT0gMTQ0KSB7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjQxXSB8PSAweDA0OwoJCQkJCQlpZiAocGFyZW50T2JqLkxZQ01hdGNoVHJpZ2dlclNUQVQpIHsKCQkJCQkJCXBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNDFdICY9IDB4N0I7CgkJCQkJfQoJCQkJCS8vUmVzZXQgb3VyIG1vZGUgY29udGluZ2VuY3kgdmFyaWFibGVzOgoJCQkJCXBhcmVudE9iai5TVEFUVHJhY2tlciA9IDA7CgkJCQkJLy9VcGRhdGUgb3VyIHN0YXRlIGZvciB2LWJsYW5rOgoJCQkJCXBhcmVudE9iai5tb2RlU1RBVCA9IDE7CgkJCQkJcGFyZW50T2JqLmludGVycnVwdHNSZXF1ZXN0ZWQgfD0gKHBhcmVudE9iai5tb2RlMVRyaWdnZXJTVEFUKSA/IDB4MyA6IDB4MTsKCQkJCQlwYXJlbnRPYmouY2hlY2tJUlFNYXRjaGluZygpOwoJCQkJCS8vQXR0ZW1wdCB0byBibGl0IG91dCB0byBvdXIgY2FudmFzOgoJCQkJCWlmIChwYXJlbnRPYmouZHJld0JsYW5rID09IDApIHsKCQkJCQkJLy9FbnN1cmUgSklUIGZyYW1pbmcgYWxpZ25tZW50OgoJCQkJCQlpZiAocGFyZW50T2JqLnRvdGFsTGluZXNQYXNzZWQgPCAxNDQgfHwgKHBhcmVudE9iai50b3RhbExpbmVzUGFzc2VkID09IDE0NCAmJiBwYXJlbnRPYmoubWlkU2NhbmxpbmVPZmZzZXQgPiAtMSkpIHsKCQkJCQkJCS8vTWFrZSBzdXJlIG91ciBnZnggYXJlIHVwLXRvLWRhdGU6CgkJCQkJCQlwYXJlbnRPYmouZ3JhcGhpY3NKSVRWQmxhbmsoKTsKCQkJCQkJCS8vRHJhdyB0aGUgZnJhbWU6CgkJCQkJCQlwYXJlbnRPYmoucHJlcGFyZUZyYW1lKCk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCS8vTENEIG9mZiB0YWtlcyBhdCBsZWFzdCAyIGZyYW1lczoKCQkJCQkJLS1wYXJlbnRPYmouZHJld0JsYW5rOwoJCQkJCX0KCQkJCQlwYXJlbnRPYmouTElORUNPTlRST0xbMTQ0XShwYXJlbnRPYmopOwkvL1NjYW4gTGluZSBhbmQgU1RBVCBNb2RlIENvbnRyb2wuCgkJCQl9CgkJCX0KCQl9CgkJZWxzZSBpZiAobGluZSA8IDE1MykgewoJCQkvL0luIFZCbGFuawoJCQl0aGlzLkxJTkVDT05UUk9MW2xpbmVdID0gZnVuY3Rpb24gKHBhcmVudE9iaikgewoJCQkJaWYgKHBhcmVudE9iai5MQ0RUaWNrcyA+PSA0NTYpIHsKCQkJCQkvL1dlJ3JlIG9uIGEgbmV3IHNjYW4gbGluZToKCQkJCQlwYXJlbnRPYmouTENEVGlja3MgLT0gNDU2OwoJCQkJCXBhcmVudE9iai5hY3R1YWxTY2FuTGluZSA9ICsrcGFyZW50T2JqLm1lbW9yeVsweEZGNDRdOwoJCQkJCS8vUGVyZm9ybSBhIExZQyBjb3VudGVyIGFzc2VydDoKCQkJCQlpZiAocGFyZW50T2JqLmFjdHVhbFNjYW5MaW5lID09IHBhcmVudE9iai5tZW1vcnlbMHhGRjQ1XSkgewoJCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MV0gfD0gMHgwNDsKCQkJCQkJaWYgKHBhcmVudE9iai5MWUNNYXRjaFRyaWdnZXJTVEFUKSB7CgkJCQkJCQlwYXJlbnRPYmouaW50ZXJydXB0c1JlcXVlc3RlZCB8PSAweDI7CgkJCQkJCQlwYXJlbnRPYmouY2hlY2tJUlFNYXRjaGluZygpOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MV0gJj0gMHg3QjsKCQkJCQl9CgkJCQkJcGFyZW50T2JqLkxJTkVDT05UUk9MW3BhcmVudE9iai5hY3R1YWxTY2FuTGluZV0ocGFyZW50T2JqKTsJLy9TY2FuIExpbmUgYW5kIFNUQVQgTW9kZSBDb250cm9sLgoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgewoJCQkvL1ZCbGFuayBFbmRpbmcgKFdlJ3JlIG9uIHRoZSBsYXN0IGFjdHVhbCBzY2FuIGxpbmUpCgkJCXRoaXMuTElORUNPTlRST0xbMTUzXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmopIHsKCQkJCWlmIChwYXJlbnRPYmouTENEVGlja3MgPj0gOCkgewoJCQkJCWlmIChwYXJlbnRPYmouU1RBVFRyYWNrZXIgIT0gNCAmJiBwYXJlbnRPYmoubWVtb3J5WzB4RkY0NF0gPT0gMTUzKSB7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjQ0XSA9IDA7CS8vTFkgcmVnaXN0ZXIgcmVzZXRzIHRvIDAgZWFybHkuCgkJCQkJCS8vUGVyZm9ybSBhIExZQyBjb3VudGVyIGFzc2VydDoKCQkJCQkJaWYgKHBhcmVudE9iai5tZW1vcnlbMHhGRjQ1XSA9PSAwKSB7CgkJCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MV0gfD0gMHgwNDsKCQkJCQkJCWlmIChwYXJlbnRPYmouTFlDTWF0Y2hUcmlnZ2VyU1RBVCkgewoJCQkJCQkJCXBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJCQkJCQlwYXJlbnRPYmouY2hlY2tJUlFNYXRjaGluZygpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNDFdICY9IDB4N0I7CgkJCQkJCX0KCQkJCQkJcGFyZW50T2JqLlNUQVRUcmFja2VyID0gNDsKCQkJCQl9CgkJCQkJaWYgKHBhcmVudE9iai5MQ0RUaWNrcyA+PSA0NTYpIHsKCQkJCQkJLy9XZSByZXNldCBiYWNrIHRvIHRoZSBiZWdpbm5pbmc6CgkJCQkJCXBhcmVudE9iai5MQ0RUaWNrcyAtPSA0NTY7CgkJCQkJCXBhcmVudE9iai5TVEFUVHJhY2tlciA9IHBhcmVudE9iai5hY3R1YWxTY2FuTGluZSA9IDA7CgkJCQkJCXBhcmVudE9iai5MSU5FQ09OVFJPTFswXShwYXJlbnRPYmopOwkvL1NjYW4gTGluZSBhbmQgU1RBVCBNb2RlIENvbnRyb2wuCgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCSsrbGluZTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuRGlzcGxheVNob3dPZmYgPSBmdW5jdGlvbiAoKSB7CglpZiAodGhpcy5kcmV3QmxhbmsgPT0gMCkgewoJCS8vT3V0cHV0IGEgYmxhbmsgc2NyZWVuIHRvIHRoZSBvdXRwdXQgZnJhbWVidWZmZXI6CgkJdGhpcy5jbGVhckZyYW1lQnVmZmVyKCk7CgkJdGhpcy5kcmV3RnJhbWUgPSB0cnVlOwoJfQoJdGhpcy5kcmV3QmxhbmsgPSAyOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5leGVjdXRlSERNQSA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuRE1BV3JpdGUoMSk7CglpZiAodGhpcy5oYWx0KSB7CgkJaWYgKCh0aGlzLkxDRFRpY2tzIC0gdGhpcy5zcHJpdGVDb3VudCkgPCAoKDQgPj4gdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXIpIHwgMHgyMCkpIHsKCQkJLy9IQUxUIGNsb2NraW5nIGNvcnJlY3Rpb246CgkJCXRoaXMuQ1BVVGlja3MgPSA0ICsgKCgweDIwICsgdGhpcy5zcHJpdGVDb3VudCkgPDwgdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXIpOwoJCQl0aGlzLkxDRFRpY2tzID0gdGhpcy5zcHJpdGVDb3VudCArICgoNCA+PiB0aGlzLmRvdWJsZVNwZWVkU2hpZnRlcikgfCAweDIwKTsKCQl9Cgl9CgllbHNlIHsKCQl0aGlzLkxDRFRpY2tzICs9ICg0ID4+IHRoaXMuZG91YmxlU3BlZWRTaGlmdGVyKSB8IDB4MjA7CQkJLy9MQ0QgVGltaW5nIFVwZGF0ZSBGb3IgSERNQS4KCX0KCWlmICh0aGlzLm1lbW9yeVsweEZGNTVdID09IDApIHsKCQl0aGlzLmhkbWFSdW5uaW5nID0gZmFsc2U7CgkJdGhpcy5tZW1vcnlbMHhGRjU1XSA9IDB4RkY7CS8vVHJhbnNmZXIgY29tcGxldGVkICgiSGlkZGVuIGxhc3Qgc3RlcCwiIHNpbmNlIHNvbWUgUk9NcyBkb24ndCBpbXBseSB0aGlzLCBidXQgbW9zdCBkbykuCgl9CgllbHNlIHsKCQktLXRoaXMubWVtb3J5WzB4RkY1NV07Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmNsb2NrVXBkYXRlID0gZnVuY3Rpb24gKCkgewoJaWYgKHRoaXMuY1RJTUVSKSB7CgkJdmFyIGRhdGVPYmogPSBuZXcgRGF0ZSgpOwoJCXZhciBuZXdUaW1lID0gZGF0ZU9iai5nZXRUaW1lKCk7CgkJdmFyIHRpbWVFbGFwc2VkID0gbmV3VGltZSAtIHRoaXMubGFzdEl0ZXJhdGlvbjsJLy9HZXQgdGhlIG51bW5iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIHRoaXMgbGFzdCBleGVjdXRlZC4KCQl0aGlzLmxhc3RJdGVyYXRpb24gPSBuZXdUaW1lOwoJCWlmICh0aGlzLmNUSU1FUiAmJiAhdGhpcy5SVENIQUxUKSB7CgkJCS8vVXBkYXRlIHRoZSBNQkMzIFJUQzoKCQkJdGhpcy5SVENTZWNvbmRzICs9IHRpbWVFbGFwc2VkIC8gMTAwMDsKCQkJd2hpbGUgKHRoaXMuUlRDU2Vjb25kcyA+PSA2MCkgewkvL1N5c3RlbSBjYW4gc3R1dHRlciwgc28gdGhlIHNlY29uZHMgZGlmZmVyZW5jZSBjYW4gZ2V0IGxhcmdlLCB0aHVzIHRoZSAid2hpbGUiLgoJCQkJdGhpcy5SVENTZWNvbmRzIC09IDYwOwoJCQkJKyt0aGlzLlJUQ01pbnV0ZXM7CgkJCQlpZiAodGhpcy5SVENNaW51dGVzID49IDYwKSB7CgkJCQkJdGhpcy5SVENNaW51dGVzIC09IDYwOwoJCQkJCSsrdGhpcy5SVENIb3VyczsKCQkJCQlpZiAodGhpcy5SVENIb3VycyA+PSAyNCkgewoJCQkJCQl0aGlzLlJUQ0hvdXJzIC09IDI0CgkJCQkJCSsrdGhpcy5SVENEYXlzOwoJCQkJCQlpZiAodGhpcy5SVENEYXlzID49IDUxMikgewoJCQkJCQkJdGhpcy5SVENEYXlzIC09IDUxMjsKCQkJCQkJCXRoaXMuUlRDRGF5T3ZlckZsb3cgPSB0cnVlOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5wcmVwYXJlRnJhbWUgPSBmdW5jdGlvbiAoKSB7CgkvL0NvcHkgdGhlIGludGVybmFsIGZyYW1lIGJ1ZmZlciB0byB0aGUgb3V0cHV0IGJ1ZmZlcjoKCXRoaXMuc3dpenpsZUZyYW1lQnVmZmVyKCk7Cgl0aGlzLmRyZXdGcmFtZSA9IHRydWU7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnJlcXVlc3REcmF3ID0gZnVuY3Rpb24gKCkgewoJaWYgKHRoaXMuZHJld0ZyYW1lKSB7CgkJdGhpcy5kaXNwYXRjaERyYXcoKTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuZGlzcGF0Y2hEcmF3ID0gZnVuY3Rpb24gKCkgewoJaWYgKHRoaXMub2Zmc2NyZWVuUkdCQ291bnQgPiAwKSB7CgkJLy9XZSBhY3R1YWxseSB1cGRhdGVkIHRoZSBncmFwaGljcyBpbnRlcm5hbGx5LCBzbyBjb3B5IG91dDoKCQlpZiAodGhpcy5vZmZzY3JlZW5SR0JDb3VudCA9PSA5MjE2MCkgewoJCQl0aGlzLnByb2Nlc3NEcmF3KHRoaXMuc3dpenpsZWRGcmFtZSk7CgkJfQoJCWVsc2UgewoJCQl0aGlzLnJlc2l6ZUZyYW1lQnVmZmVyKCk7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5wcm9jZXNzRHJhdyA9IGZ1bmN0aW9uIChmcmFtZUJ1ZmZlcikgewoJdmFyIGNhbnZhc1JHQkFMZW5ndGggPSB0aGlzLm9mZnNjcmVlblJHQkNvdW50OwoJdmFyIGNhbnZhc0RhdGEgPSB0aGlzLmNhbnZhc0J1ZmZlci5kYXRhOwoJdmFyIGJ1ZmZlckluZGV4ID0gMDsKCWZvciAodmFyIGNhbnZhc0luZGV4ID0gMDsgY2FudmFzSW5kZXggPCBjYW52YXNSR0JBTGVuZ3RoOyArK2NhbnZhc0luZGV4KSB7CgkJY2FudmFzRGF0YVtjYW52YXNJbmRleCsrXSA9IGZyYW1lQnVmZmVyW2J1ZmZlckluZGV4KytdOwoJCWNhbnZhc0RhdGFbY2FudmFzSW5kZXgrK10gPSBmcmFtZUJ1ZmZlcltidWZmZXJJbmRleCsrXTsKCQljYW52YXNEYXRhW2NhbnZhc0luZGV4KytdID0gZnJhbWVCdWZmZXJbYnVmZmVySW5kZXgrK107Cgl9Cgl0aGlzLmdyYXBoaWNzQmxpdCgpOwoJdGhpcy5kcmV3RnJhbWUgPSBmYWxzZTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuc3dpenpsZUZyYW1lQnVmZmVyID0gZnVuY3Rpb24gKCkgewoJLy9Db252ZXJ0IG91ciBkaXJ0eSAyNC1iaXQgKDI0LWJpdCwgd2l0aCBpbnRlcm5hbCByZW5kZXIgZmxhZ3MgYWJvdmUgaXQpIGZyYW1lYnVmZmVyIHRvIGFuIDgtYml0IGJ1ZmZlciB3aXRoIHNlcGFyYXRlIGluZGljZXMgZm9yIHRoZSBSR0IgY2hhbm5lbHM6Cgl2YXIgZnJhbWVCdWZmZXIgPSB0aGlzLmZyYW1lQnVmZmVyOwoJdmFyIHN3aXp6bGVkRnJhbWUgPSB0aGlzLnN3aXp6bGVkRnJhbWU7Cgl2YXIgYnVmZmVySW5kZXggPSAwOwoJZm9yICh2YXIgY2FudmFzSW5kZXggPSAwOyBjYW52YXNJbmRleCA8IDY5MTIwOykgewoJCXN3aXp6bGVkRnJhbWVbY2FudmFzSW5kZXgrK10gPSAoZnJhbWVCdWZmZXJbYnVmZmVySW5kZXhdID4+IDE2KSAmIDB4RkY7CQkvL1JlZAoJCXN3aXp6bGVkRnJhbWVbY2FudmFzSW5kZXgrK10gPSAoZnJhbWVCdWZmZXJbYnVmZmVySW5kZXhdID4+IDgpICYgMHhGRjsJCS8vR3JlZW4KCQlzd2l6emxlZEZyYW1lW2NhbnZhc0luZGV4KytdID0gZnJhbWVCdWZmZXJbYnVmZmVySW5kZXgrK10gJiAweEZGOwkJCS8vQmx1ZQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jbGVhckZyYW1lQnVmZmVyID0gZnVuY3Rpb24gKCkgewoJdmFyIGJ1ZmZlckluZGV4ID0gMDsKCXZhciBmcmFtZUJ1ZmZlciA9IHRoaXMuc3dpenpsZWRGcmFtZTsKCWlmICh0aGlzLmNHQkMgfHwgdGhpcy5jb2xvcml6ZWRHQlBhbGV0dGVzKSB7CgkJd2hpbGUgKGJ1ZmZlckluZGV4IDwgNjkxMjApIHsKCQkJZnJhbWVCdWZmZXJbYnVmZmVySW5kZXgrK10gPSAyNDg7CgkJfQoJfQoJZWxzZSB7CgkJd2hpbGUgKGJ1ZmZlckluZGV4IDwgNjkxMjApIHsKCQkJZnJhbWVCdWZmZXJbYnVmZmVySW5kZXgrK10gPSAyMzk7CgkJCWZyYW1lQnVmZmVyW2J1ZmZlckluZGV4KytdID0gMjU1OwoJCQlmcmFtZUJ1ZmZlcltidWZmZXJJbmRleCsrXSA9IDIyMjsKCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnJlc2l6ZUZyYW1lQnVmZmVyID0gZnVuY3Rpb24gKCkgewoJLy9SZXNpemUgaW4gamF2YXNjcmlwdCB3aXRoIHJlc2l6ZS5qczoKCWlmICh0aGlzLnJlc2l6ZVBhdGhDbGVhcikgewoJCXRoaXMucmVzaXplUGF0aENsZWFyID0gZmFsc2U7CgkJdGhpcy5yZXNpemVyLnJlc2l6ZSh0aGlzLnN3aXp6bGVkRnJhbWUpOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jb21waWxlUmVzaXplRnJhbWVCdWZmZXJGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLm9mZnNjcmVlblJHQkNvdW50ID4gMCkgewoJCXZhciBwYXJlbnRPYmogPSB0aGlzOwoJCXRoaXMucmVzaXplciA9IG5ldyBSZXNpemUoMTYwLCAxNDQsIHRoaXMub2Zmc2NyZWVuV2lkdGgsIHRoaXMub2Zmc2NyZWVuSGVpZ2h0LCBmYWxzZSwgc2V0dGluZ3NbMTNdLCBmYWxzZSwgZnVuY3Rpb24gKGJ1ZmZlcikgewoJCQlpZiAoKGJ1ZmZlci5sZW5ndGggLyAzICogNCkgPT0gcGFyZW50T2JqLm9mZnNjcmVlblJHQkNvdW50KSB7CgkJCQlwYXJlbnRPYmoucHJvY2Vzc0RyYXcoYnVmZmVyKTsKCQkJfQoJCQlwYXJlbnRPYmoucmVzaXplUGF0aENsZWFyID0gdHJ1ZTsKCQl9KTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUucmVuZGVyU2NhbkxpbmUgPSBmdW5jdGlvbiAoc2NhbmxpbmVUb1JlbmRlcikgewoJdGhpcy5waXhlbFN0YXJ0ID0gc2NhbmxpbmVUb1JlbmRlciAqIDE2MDsKCWlmICh0aGlzLmJnRW5hYmxlZCkgewoJCXRoaXMucGl4ZWxFbmQgPSAxNjA7CgkJdGhpcy5CR0xheWVyUmVuZGVyKHNjYW5saW5lVG9SZW5kZXIpOwoJCXRoaXMuV2luZG93TGF5ZXJSZW5kZXIoc2NhbmxpbmVUb1JlbmRlcik7Cgl9CgllbHNlIHsKCQl2YXIgcGl4ZWxMaW5lID0gKHNjYW5saW5lVG9SZW5kZXIgKyAxKSAqIDE2MDsKCQl2YXIgZGVmYXVsdENvbG9yID0gKHRoaXMuY0dCQyB8fCB0aGlzLmNvbG9yaXplZEdCUGFsZXR0ZXMpID8gMHhGOEY4RjggOiAweEVGRkZERTsKCQlmb3IgKHZhciBwaXhlbFBvc2l0aW9uID0gKHNjYW5saW5lVG9SZW5kZXIgKiAxNjApICsgdGhpcy5jdXJyZW50WDsgcGl4ZWxQb3NpdGlvbiA8IHBpeGVsTGluZTsgcGl4ZWxQb3NpdGlvbisrKSB7CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbl0gPSBkZWZhdWx0Q29sb3I7CgkJfQoJfQoJdGhpcy5TcHJpdGVMYXllclJlbmRlcihzY2FubGluZVRvUmVuZGVyKTsKCXRoaXMuY3VycmVudFggPSAwOwoJdGhpcy5taWRTY2FubGluZU9mZnNldCA9IC0xOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5yZW5kZXJNaWRTY2FuTGluZSA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLmFjdHVhbFNjYW5MaW5lIDwgMTQ0ICYmIHRoaXMubW9kZVNUQVQgPT0gMykgewoJCS8vVE9ETzogR2V0IHRoaXMgYWNjdXJhdGU6CgkJaWYgKHRoaXMubWlkU2NhbmxpbmVPZmZzZXQgPT0gLTEpIHsKCQkJdGhpcy5taWRTY2FubGluZU9mZnNldCA9IHRoaXMuYmFja2dyb3VuZFggJiAweDc7CgkJfQoJCWlmICh0aGlzLkxDRFRpY2tzID49IDgyKSB7CgkJCXRoaXMucGl4ZWxFbmQgPSB0aGlzLkxDRFRpY2tzIC0gNzQ7CgkJCXRoaXMucGl4ZWxFbmQgPSBNYXRoLm1pbih0aGlzLnBpeGVsRW5kIC0gdGhpcy5taWRTY2FubGluZU9mZnNldCAtICh0aGlzLnBpeGVsRW5kICUgMHg4KSwgMTYwKTsKCQkJaWYgKHRoaXMuYmdFbmFibGVkKSB7CgkJCQl0aGlzLnBpeGVsU3RhcnQgPSB0aGlzLmxhc3RVbnJlbmRlcmVkTGluZSAqIDE2MDsKCQkJCXRoaXMuQkdMYXllclJlbmRlcih0aGlzLmxhc3RVbnJlbmRlcmVkTGluZSk7CgkJCQl0aGlzLldpbmRvd0xheWVyUmVuZGVyKHRoaXMubGFzdFVucmVuZGVyZWRMaW5lKTsKCQkJCS8vVE9ETzogRG8gbWlkc2NhbmxpbmUgSklUIGZvciBzcHJpdGVzLi4uCgkJCX0KCQkJZWxzZSB7CgkJCQl2YXIgcGl4ZWxMaW5lID0gKHRoaXMubGFzdFVucmVuZGVyZWRMaW5lICogMTYwKSArIHRoaXMucGl4ZWxFbmQ7CgkJCQl2YXIgZGVmYXVsdENvbG9yID0gKHRoaXMuY0dCQyB8fCB0aGlzLmNvbG9yaXplZEdCUGFsZXR0ZXMpID8gMHhGOEY4RjggOiAweEVGRkZERTsKCQkJCWZvciAodmFyIHBpeGVsUG9zaXRpb24gPSAodGhpcy5sYXN0VW5yZW5kZXJlZExpbmUgKiAxNjApICsgdGhpcy5jdXJyZW50WDsgcGl4ZWxQb3NpdGlvbiA8IHBpeGVsTGluZTsgcGl4ZWxQb3NpdGlvbisrKSB7CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uXSA9IGRlZmF1bHRDb2xvcjsKCQkJCX0KCQkJfQoJCQl0aGlzLmN1cnJlbnRYID0gdGhpcy5waXhlbEVuZDsKCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmluaXRpYWxpemVNb2RlU3BlY2lmaWNBcnJheXMgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLkxDRENPTlRST0wgPSAodGhpcy5MQ0Rpc09uKSA/IHRoaXMuTElORUNPTlRST0wgOiB0aGlzLkRJU1BMQVlPRkZDT05UUk9MOwoJaWYgKHRoaXMuY0dCQykgewoJCXRoaXMuZ2JjT0JKUmF3UGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgweDQwLCAwLCAidWludDgiKTsKCQl0aGlzLmdiY0JHUmF3UGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgweDQwLCAwLCAidWludDgiKTsKCQl0aGlzLmdiY09CSlBhbGV0dGUgPSB0aGlzLmdldFR5cGVkQXJyYXkoMHgyMCwgMHgxMDAwMDAwLCAiaW50MzIiKTsKCQl0aGlzLmdiY0JHUGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgweDQwLCAwLCAiaW50MzIiKTsKCQl0aGlzLkJHQ0hSQmFuazIgPSB0aGlzLmdldFR5cGVkQXJyYXkoMHg4MDAsIDAsICJ1aW50OCIpOwoJCXRoaXMuQkdDSFJDdXJyZW50QmFuayA9ICh0aGlzLmN1cnJWUkFNQmFuayA+IDApID8gdGhpcy5CR0NIUkJhbmsyIDogdGhpcy5CR0NIUkJhbmsxOwoJCXRoaXMudGlsZUNhY2hlID0gdGhpcy5nZW5lcmF0ZUNhY2hlQXJyYXkoMHhGODApOwoJfQoJZWxzZSB7CgkJdGhpcy5nYk9CSlBhbGV0dGUgPSB0aGlzLmdldFR5cGVkQXJyYXkoOCwgMCwgImludDMyIik7CgkJdGhpcy5nYkJHUGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSg0LCAwLCAiaW50MzIiKTsKCQl0aGlzLkJHUGFsZXR0ZSA9IHRoaXMuZ2JCR1BhbGV0dGU7CgkJdGhpcy5PQkpQYWxldHRlID0gdGhpcy5nYk9CSlBhbGV0dGU7CgkJdGhpcy50aWxlQ2FjaGUgPSB0aGlzLmdlbmVyYXRlQ2FjaGVBcnJheSgweDcwMCk7CgkJdGhpcy5zb3J0QnVmZmVyID0gdGhpcy5nZXRUeXBlZEFycmF5KDB4MTAwLCAwLCAidWludDgiKTsKCQl0aGlzLk9BTUFkZHJlc3NDYWNoZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgxMCwgMCwgImludDMyIik7Cgl9Cgl0aGlzLnJlbmRlclBhdGhCdWlsZCgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5HQkN0b0dCTW9kZUFkanVzdCA9IGZ1bmN0aW9uICgpIHsKCWNvdXQoIlN0ZXBwaW5nIGRvd24gZnJvbSBHQkMgbW9kZS4iLCAwKTsKCXRoaXMuVlJBTSA9IHRoaXMuR0JDTWVtb3J5ID0gdGhpcy5CR0NIUkN1cnJlbnRCYW5rID0gdGhpcy5CR0NIUkJhbmsyID0gbnVsbDsKCXRoaXMudGlsZUNhY2hlLmxlbmd0aCA9IDB4NzAwOwoJaWYgKHNldHRpbmdzWzRdKSB7CgkJdGhpcy5nYkJHQ29sb3JpemVkUGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSg0LCAwLCAiaW50MzIiKTsKCQl0aGlzLmdiT0JKQ29sb3JpemVkUGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSg4LCAwLCAiaW50MzIiKTsKCQl0aGlzLmNhY2hlZEJHUGFsZXR0ZUNvbnZlcnNpb24gPSB0aGlzLmdldFR5cGVkQXJyYXkoNCwgMCwgImludDMyIik7CgkJdGhpcy5jYWNoZWRPQkpQYWxldHRlQ29udmVyc2lvbiA9IHRoaXMuZ2V0VHlwZWRBcnJheSg4LCAwLCAiaW50MzIiKTsKCQl0aGlzLkJHUGFsZXR0ZSA9IHRoaXMuZ2JCR0NvbG9yaXplZFBhbGV0dGU7CgkJdGhpcy5PQkpQYWxldHRlID0gdGhpcy5nYk9CSkNvbG9yaXplZFBhbGV0dGU7CgkJdGhpcy5nYk9CSlBhbGV0dGUgPSB0aGlzLmdiQkdQYWxldHRlID0gbnVsbDsKCQl0aGlzLmdldEdCQ0NvbG9yKCk7Cgl9CgllbHNlIHsKCQl0aGlzLmdiT0JKUGFsZXR0ZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSg4LCAwLCAiaW50MzIiKTsKCQl0aGlzLmdiQkdQYWxldHRlID0gdGhpcy5nZXRUeXBlZEFycmF5KDQsIDAsICJpbnQzMiIpOwoJCXRoaXMuQkdQYWxldHRlID0gdGhpcy5nYkJHUGFsZXR0ZTsKCQl0aGlzLk9CSlBhbGV0dGUgPSB0aGlzLmdiT0JKUGFsZXR0ZTsKCX0KCXRoaXMuc29ydEJ1ZmZlciA9IHRoaXMuZ2V0VHlwZWRBcnJheSgweDEwMCwgMCwgInVpbnQ4Iik7Cgl0aGlzLk9BTUFkZHJlc3NDYWNoZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgxMCwgMCwgImludDMyIik7Cgl0aGlzLnJlbmRlclBhdGhCdWlsZCgpOwoJdGhpcy5tZW1vcnlSZWFkSnVtcENvbXBpbGUoKTsKCXRoaXMubWVtb3J5V3JpdGVKdW1wQ29tcGlsZSgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5yZW5kZXJQYXRoQnVpbGQgPSBmdW5jdGlvbiAoKSB7CglpZiAoIXRoaXMuY0dCQykgewoJCXRoaXMuQkdMYXllclJlbmRlciA9IHRoaXMuQkdHQkxheWVyUmVuZGVyOwoJCXRoaXMuV2luZG93TGF5ZXJSZW5kZXIgPSB0aGlzLldpbmRvd0dCTGF5ZXJSZW5kZXI7CgkJdGhpcy5TcHJpdGVMYXllclJlbmRlciA9IHRoaXMuU3ByaXRlR0JMYXllclJlbmRlcjsKCX0KCWVsc2UgewoJCXRoaXMucHJpb3JpdHlGbGFnZ2luZ1BhdGhSZWJ1aWxkKCk7CgkJdGhpcy5TcHJpdGVMYXllclJlbmRlciA9IHRoaXMuU3ByaXRlR0JDTGF5ZXJSZW5kZXI7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnByaW9yaXR5RmxhZ2dpbmdQYXRoUmVidWlsZCA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLkJHUHJpb3JpdHlFbmFibGVkKSB7CgkJdGhpcy5CR0xheWVyUmVuZGVyID0gdGhpcy5CR0dCQ0xheWVyUmVuZGVyOwoJCXRoaXMuV2luZG93TGF5ZXJSZW5kZXIgPSB0aGlzLldpbmRvd0dCQ0xheWVyUmVuZGVyOwoJfQoJZWxzZSB7CgkJdGhpcy5CR0xheWVyUmVuZGVyID0gdGhpcy5CR0dCQ0xheWVyUmVuZGVyTm9Qcmlvcml0eUZsYWdnaW5nOwoJCXRoaXMuV2luZG93TGF5ZXJSZW5kZXIgPSB0aGlzLldpbmRvd0dCQ0xheWVyUmVuZGVyTm9Qcmlvcml0eUZsYWdnaW5nOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5pbml0aWFsaXplUmVmZXJlbmNlc0Zyb21TYXZlU3RhdGUgPSBmdW5jdGlvbiAoKSB7Cgl0aGlzLkxDRENPTlRST0wgPSAodGhpcy5MQ0Rpc09uKSA/IHRoaXMuTElORUNPTlRST0wgOiB0aGlzLkRJU1BMQVlPRkZDT05UUk9MOwoJdmFyIHRpbGVJbmRleCA9IDA7CglpZiAoIXRoaXMuY0dCQykgewoJCWlmICh0aGlzLmNvbG9yaXplZEdCUGFsZXR0ZXMpIHsKCQkJdGhpcy5CR1BhbGV0dGUgPSB0aGlzLmdiQkdDb2xvcml6ZWRQYWxldHRlOwoJCQl0aGlzLk9CSlBhbGV0dGUgPSB0aGlzLmdiT0JKQ29sb3JpemVkUGFsZXR0ZTsKCQkJdGhpcy51cGRhdGVHQkJHUGFsZXR0ZSA9IHRoaXMudXBkYXRlR0JDb2xvcml6ZWRCR1BhbGV0dGU7CgkJCXRoaXMudXBkYXRlR0JPQkpQYWxldHRlID0gdGhpcy51cGRhdGVHQkNvbG9yaXplZE9CSlBhbGV0dGU7CgoJCX0KCQllbHNlIHsKCQkJdGhpcy5CR1BhbGV0dGUgPSB0aGlzLmdiQkdQYWxldHRlOwoJCQl0aGlzLk9CSlBhbGV0dGUgPSB0aGlzLmdiT0JKUGFsZXR0ZTsKCQl9CgkJdGhpcy50aWxlQ2FjaGUgPSB0aGlzLmdlbmVyYXRlQ2FjaGVBcnJheSgweDcwMCk7CgkJZm9yICh0aWxlSW5kZXggPSAweDgwMDA7IHRpbGVJbmRleCA8IDB4OTAwMDsgdGlsZUluZGV4ICs9IDIpIHsKCQkJdGhpcy5nZW5lcmF0ZUdCT0FNVGlsZUxpbmUodGlsZUluZGV4KTsKCQl9CgkJZm9yICh0aWxlSW5kZXggPSAweDkwMDA7IHRpbGVJbmRleCA8IDB4OTgwMDsgdGlsZUluZGV4ICs9IDIpIHsKCQkJdGhpcy5nZW5lcmF0ZUdCVGlsZUxpbmUodGlsZUluZGV4KTsKCQl9CgkJdGhpcy5zb3J0QnVmZmVyID0gdGhpcy5nZXRUeXBlZEFycmF5KDB4MTAwLCAwLCAidWludDgiKTsKCQl0aGlzLk9BTUFkZHJlc3NDYWNoZSA9IHRoaXMuZ2V0VHlwZWRBcnJheSgxMCwgMCwgImludDMyIik7Cgl9CgllbHNlIHsKCQl0aGlzLkJHQ0hSQ3VycmVudEJhbmsgPSAodGhpcy5jdXJyVlJBTUJhbmsgPiAwKSA/IHRoaXMuQkdDSFJCYW5rMiA6IHRoaXMuQkdDSFJCYW5rMTsKCQl0aGlzLnRpbGVDYWNoZSA9IHRoaXMuZ2VuZXJhdGVDYWNoZUFycmF5KDB4RjgwKTsKCQlmb3IgKDsgdGlsZUluZGV4IDwgMHgxODAwOyB0aWxlSW5kZXggKz0gMHgxMCkgewoJCQl0aGlzLmdlbmVyYXRlR0JDVGlsZUJhbmsxKHRpbGVJbmRleCk7CgkJCXRoaXMuZ2VuZXJhdGVHQkNUaWxlQmFuazIodGlsZUluZGV4KTsKCQl9Cgl9Cgl0aGlzLnJlbmRlclBhdGhCdWlsZCgpOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5SR0JUaW50ID0gZnVuY3Rpb24gKHZhbHVlKSB7CgkvL0FkanVzdG1lbnQgZm9yIHRoZSBHQkMncyB0aW50aW5nIChBY2NvcmRpbmcgdG8gR2FtYmF0dGUpOgoJdmFyIHIgPSB2YWx1ZSAmIDB4MUY7Cgl2YXIgZyA9ICh2YWx1ZSA+PiA1KSAmIDB4MUY7Cgl2YXIgYiA9ICh2YWx1ZSA+PiAxMCkgJiAweDFGOwoJcmV0dXJuICgociAqIDEzICsgZyAqIDIgKyBiKSA+PiAxKSA8PCAxNiB8IChnICogMyArIGIpIDw8IDkgfCAociAqIDMgKyBnICogMiArIGIgKiAxMSkgPj4gMTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ2V0R0JDQ29sb3IgPSBmdW5jdGlvbiAoKSB7CgkvL0dCQyBDb2xvcml6YXRpb24gb2YgRE1HIFJPTXM6CgkvL0JHCglmb3IgKHZhciBjb3VudGVyID0gMDsgY291bnRlciA8IDQ7IGNvdW50ZXIrKykgewoJCXZhciBhZGp1c3RlZEluZGV4ID0gY291bnRlciA8PCAxOwoJCS8vQkcKCQl0aGlzLmNhY2hlZEJHUGFsZXR0ZUNvbnZlcnNpb25bY291bnRlcl0gPSB0aGlzLlJHQlRpbnQoKHRoaXMuZ2JjQkdSYXdQYWxldHRlW2FkanVzdGVkSW5kZXggfCAxXSA8PCA4KSB8IHRoaXMuZ2JjQkdSYXdQYWxldHRlW2FkanVzdGVkSW5kZXhdKTsKCQkvL09CSiAxCgkJdGhpcy5jYWNoZWRPQkpQYWxldHRlQ29udmVyc2lvbltjb3VudGVyXSA9IHRoaXMuUkdCVGludCgodGhpcy5nYmNPQkpSYXdQYWxldHRlW2FkanVzdGVkSW5kZXggfCAxXSA8PCA4KSB8IHRoaXMuZ2JjT0JKUmF3UGFsZXR0ZVthZGp1c3RlZEluZGV4XSk7Cgl9CgkvL09CSiAyCglmb3IgKGNvdW50ZXIgPSA0OyBjb3VudGVyIDwgODsgY291bnRlcisrKSB7CgkJYWRqdXN0ZWRJbmRleCA9IGNvdW50ZXIgPDwgMTsKCQl0aGlzLmNhY2hlZE9CSlBhbGV0dGVDb252ZXJzaW9uW2NvdW50ZXJdID0gdGhpcy5SR0JUaW50KCh0aGlzLmdiY09CSlJhd1BhbGV0dGVbYWRqdXN0ZWRJbmRleCB8IDFdIDw8IDgpIHwgdGhpcy5nYmNPQkpSYXdQYWxldHRlW2FkanVzdGVkSW5kZXhdKTsKCX0KCS8vVXBkYXRlIHRoZSBwYWxldHRlIGVudHJpZXM6Cgl0aGlzLnVwZGF0ZUdCQkdQYWxldHRlID0gdGhpcy51cGRhdGVHQkNvbG9yaXplZEJHUGFsZXR0ZTsKCXRoaXMudXBkYXRlR0JPQkpQYWxldHRlID0gdGhpcy51cGRhdGVHQkNvbG9yaXplZE9CSlBhbGV0dGU7Cgl0aGlzLnVwZGF0ZUdCQkdQYWxldHRlKHRoaXMubWVtb3J5WzB4RkY0N10pOwoJdGhpcy51cGRhdGVHQk9CSlBhbGV0dGUoMCwgdGhpcy5tZW1vcnlbMHhGRjQ4XSk7Cgl0aGlzLnVwZGF0ZUdCT0JKUGFsZXR0ZSgxLCB0aGlzLm1lbW9yeVsweEZGNDldKTsKCXRoaXMuY29sb3JpemVkR0JQYWxldHRlcyA9IHRydWU7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnVwZGF0ZUdCUmVndWxhckJHUGFsZXR0ZSA9IGZ1bmN0aW9uIChkYXRhKSB7Cgl0aGlzLmdiQkdQYWxldHRlWzBdID0gdGhpcy5jb2xvcnNbZGF0YSAmIDB4MDNdIHwgMHgyMDAwMDAwOwoJdGhpcy5nYkJHUGFsZXR0ZVsxXSA9IHRoaXMuY29sb3JzWyhkYXRhID4+IDIpICYgMHgwM107Cgl0aGlzLmdiQkdQYWxldHRlWzJdID0gdGhpcy5jb2xvcnNbKGRhdGEgPj4gNCkgJiAweDAzXTsKCXRoaXMuZ2JCR1BhbGV0dGVbM10gPSB0aGlzLmNvbG9yc1tkYXRhID4+IDZdOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS51cGRhdGVHQkNvbG9yaXplZEJHUGFsZXR0ZSA9IGZ1bmN0aW9uIChkYXRhKSB7CgkvL0dCIGNvbG9yaXphdGlvbjoKCXRoaXMuZ2JCR0NvbG9yaXplZFBhbGV0dGVbMF0gPSB0aGlzLmNhY2hlZEJHUGFsZXR0ZUNvbnZlcnNpb25bZGF0YSAmIDB4MDNdIHwgMHgyMDAwMDAwOwoJdGhpcy5nYkJHQ29sb3JpemVkUGFsZXR0ZVsxXSA9IHRoaXMuY2FjaGVkQkdQYWxldHRlQ29udmVyc2lvblsoZGF0YSA+PiAyKSAmIDB4MDNdOwoJdGhpcy5nYkJHQ29sb3JpemVkUGFsZXR0ZVsyXSA9IHRoaXMuY2FjaGVkQkdQYWxldHRlQ29udmVyc2lvblsoZGF0YSA+PiA0KSAmIDB4MDNdOwoJdGhpcy5nYkJHQ29sb3JpemVkUGFsZXR0ZVszXSA9IHRoaXMuY2FjaGVkQkdQYWxldHRlQ29udmVyc2lvbltkYXRhID4+IDZdOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS51cGRhdGVHQlJlZ3VsYXJPQkpQYWxldHRlID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhKSB7Cgl0aGlzLmdiT0JKUGFsZXR0ZVtpbmRleCB8IDFdID0gdGhpcy5jb2xvcnNbKGRhdGEgPj4gMikgJiAweDAzXTsKCXRoaXMuZ2JPQkpQYWxldHRlW2luZGV4IHwgMl0gPSB0aGlzLmNvbG9yc1soZGF0YSA+PiA0KSAmIDB4MDNdOwoJdGhpcy5nYk9CSlBhbGV0dGVbaW5kZXggfCAzXSA9IHRoaXMuY29sb3JzW2RhdGEgPj4gNl07Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnVwZGF0ZUdCQ29sb3JpemVkT0JKUGFsZXR0ZSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSkgewoJLy9HQiBjb2xvcml6YXRpb246Cgl0aGlzLmdiT0JKQ29sb3JpemVkUGFsZXR0ZVtpbmRleCB8IDFdID0gdGhpcy5jYWNoZWRPQkpQYWxldHRlQ29udmVyc2lvbltpbmRleCB8ICgoZGF0YSA+PiAyKSAmIDB4MDMpXTsKCXRoaXMuZ2JPQkpDb2xvcml6ZWRQYWxldHRlW2luZGV4IHwgMl0gPSB0aGlzLmNhY2hlZE9CSlBhbGV0dGVDb252ZXJzaW9uW2luZGV4IHwgKChkYXRhID4+IDQpICYgMHgwMyldOwoJdGhpcy5nYk9CSkNvbG9yaXplZFBhbGV0dGVbaW5kZXggfCAzXSA9IHRoaXMuY2FjaGVkT0JKUGFsZXR0ZUNvbnZlcnNpb25baW5kZXggfCAoZGF0YSA+PiA2KV07Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnVwZGF0ZUdCQ0JHUGFsZXR0ZSA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSkgewoJaWYgKHRoaXMuZ2JjQkdSYXdQYWxldHRlW2luZGV4XSAhPSBkYXRhKSB7CgkJdGhpcy5taWRTY2FuTGluZUpJVCgpOwoJCS8vVXBkYXRlIHRoZSBjb2xvciBwYWxldHRlIGZvciBCRyB0aWxlcyBzaW5jZSBpdCBjaGFuZ2VkOgoJCXRoaXMuZ2JjQkdSYXdQYWxldHRlW2luZGV4XSA9IGRhdGE7CgkJaWYgKChpbmRleCAmIDB4MDYpID09IDApIHsKCQkJLy9QYWxldHRlIDAgKFNwZWNpYWwgdGlsZSBQcmlvcml0eSBzdHVmZikKCQkJZGF0YSA9IDB4MjAwMDAwMCB8IHRoaXMuUkdCVGludCgodGhpcy5nYmNCR1Jhd1BhbGV0dGVbaW5kZXggfCAxXSA8PCA4KSB8IHRoaXMuZ2JjQkdSYXdQYWxldHRlW2luZGV4ICYgMHgzRV0pOwoJCQlpbmRleCA+Pj0gMTsKCQkJdGhpcy5nYmNCR1BhbGV0dGVbaW5kZXhdID0gZGF0YTsKCQkJdGhpcy5nYmNCR1BhbGV0dGVbMHgyMCB8IGluZGV4XSA9IDB4MTAwMDAwMCB8IGRhdGE7CgkJfQoJCWVsc2UgewoJCQkvL1JlZ3VsYXIgUGFsZXR0ZXMgKE5vIHNwZWNpYWwgY3JhcCkKCQkJZGF0YSA9IHRoaXMuUkdCVGludCgodGhpcy5nYmNCR1Jhd1BhbGV0dGVbaW5kZXggfCAxXSA8PCA4KSB8IHRoaXMuZ2JjQkdSYXdQYWxldHRlW2luZGV4ICYgMHgzRV0pOwoJCQlpbmRleCA+Pj0gMTsKCQkJdGhpcy5nYmNCR1BhbGV0dGVbaW5kZXhdID0gZGF0YTsKCQkJdGhpcy5nYmNCR1BhbGV0dGVbMHgyMCB8IGluZGV4XSA9IDB4MTAwMDAwMCB8IGRhdGE7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS51cGRhdGVHQkNPQkpQYWxldHRlID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhKSB7CglpZiAodGhpcy5nYmNPQkpSYXdQYWxldHRlW2luZGV4XSAhPSBkYXRhKSB7CgkJLy9VcGRhdGUgdGhlIGNvbG9yIHBhbGV0dGUgZm9yIE9CSiB0aWxlcyBzaW5jZSBpdCBjaGFuZ2VkOgoJCXRoaXMuZ2JjT0JKUmF3UGFsZXR0ZVtpbmRleF0gPSBkYXRhOwoJCWlmICgoaW5kZXggJiAweDA2KSA+IDApIHsKCQkJLy9SZWd1bGFyIFBhbGV0dGVzIChObyBzcGVjaWFsIGNyYXApCgkJCXRoaXMubWlkU2NhbkxpbmVKSVQoKTsKCQkJdGhpcy5nYmNPQkpQYWxldHRlW2luZGV4ID4+IDFdID0gMHgxMDAwMDAwIHwgdGhpcy5SR0JUaW50KCh0aGlzLmdiY09CSlJhd1BhbGV0dGVbaW5kZXggfCAxXSA8PCA4KSB8IHRoaXMuZ2JjT0JKUmF3UGFsZXR0ZVtpbmRleCAmIDB4M0VdKTsKCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLkJHR0JMYXllclJlbmRlciA9IGZ1bmN0aW9uIChzY2FubGluZVRvUmVuZGVyKSB7Cgl2YXIgc2Nyb2xsWUFkanVzdGVkID0gKHRoaXMuYmFja2dyb3VuZFkgKyBzY2FubGluZVRvUmVuZGVyKSAmIDB4RkY7CQkJCQkJLy9UaGUgbGluZSBvZiB0aGUgQkcgd2UncmUgYXQuCgl2YXIgdGlsZVlMaW5lID0gKHNjcm9sbFlBZGp1c3RlZCAmIDcpIDw8IDM7Cgl2YXIgdGlsZVlEb3duID0gdGhpcy5nZnhCYWNrZ3JvdW5kQ0hSQmFua1Bvc2l0aW9uIHwgKChzY3JvbGxZQWRqdXN0ZWQgJiAweEY4KSA8PCAyKTsJLy9UaGUgcm93IG9mIGNhY2hlZCB0aWxlcyB3ZSdyZSBmZXRjaGluZyBmcm9tLgoJdmFyIHNjcm9sbFhBZGp1c3RlZCA9ICh0aGlzLmJhY2tncm91bmRYICsgdGhpcy5jdXJyZW50WCkgJiAweEZGOwkJCQkJCS8vVGhlIHNjcm9sbCBhbW91bnQgb2YgdGhlIEJHLgoJdmFyIHBpeGVsUG9zaXRpb24gPSB0aGlzLnBpeGVsU3RhcnQgKyB0aGlzLmN1cnJlbnRYOwkJCQkJCQkJCS8vQ3VycmVudCBwaXhlbCB3ZSdyZSB3b3JraW5nIG9uLgoJdmFyIHBpeGVsUG9zaXRpb25FbmQgPSB0aGlzLnBpeGVsU3RhcnQgKyAoKHRoaXMuZ2Z4V2luZG93RGlzcGxheSAmJiAoc2NhbmxpbmVUb1JlbmRlciAtIHRoaXMud2luZG93WSkgPj0gMCkgPyBNYXRoLm1pbihNYXRoLm1heCh0aGlzLndpbmRvd1gsIDApICsgdGhpcy5jdXJyZW50WCwgdGhpcy5waXhlbEVuZCkgOiB0aGlzLnBpeGVsRW5kKTsJLy9NYWtlIHN1cmUgd2UgZG8gYXQgbW9zdCAxNjAgcGl4ZWxzIGEgc2NhbmxpbmUuCgl2YXIgdGlsZU51bWJlciA9IHRpbGVZRG93biArIChzY3JvbGxYQWRqdXN0ZWQgPj4gMyk7Cgl2YXIgY2hyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMVt0aWxlTnVtYmVyXTsKCWlmIChjaHJDb2RlIDwgdGhpcy5nZnhCYWNrZ3JvdW5kQmFua09mZnNldCkgewoJCWNockNvZGUgfD0gMHgxMDA7Cgl9Cgl2YXIgdGlsZSA9IHRoaXMudGlsZUNhY2hlW2NockNvZGVdOwoJZm9yICh2YXIgdGV4ZWwgPSAoc2Nyb2xsWEFkanVzdGVkICYgMHg3KTsgdGV4ZWwgPCA4ICYmIHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kICYmIHNjcm9sbFhBZGp1c3RlZCA8IDB4MTAwOyArK3Njcm9sbFhBZGp1c3RlZCkgewoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuQkdQYWxldHRlW3RpbGVbdGlsZVlMaW5lIHwgdGV4ZWwrK11dOwoJfQoJdmFyIHNjcm9sbFhBZGp1c3RlZEFsaWduZWQgPSBNYXRoLm1pbihwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbiwgMHgxMDAgLSBzY3JvbGxYQWRqdXN0ZWQpID4+IDM7CglzY3JvbGxYQWRqdXN0ZWQgKz0gc2Nyb2xsWEFkanVzdGVkQWxpZ25lZCA8PCAzOwoJc2Nyb2xsWEFkanVzdGVkQWxpZ25lZCArPSB0aWxlTnVtYmVyOwoJd2hpbGUgKHRpbGVOdW1iZXIgPCBzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkKSB7CgkJY2hyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMVsrK3RpbGVOdW1iZXJdOwoJCWlmIChjaHJDb2RlIDwgdGhpcy5nZnhCYWNrZ3JvdW5kQmFua09mZnNldCkgewoJCQljaHJDb2RlIHw9IDB4MTAwOwoJCX0KCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbY2hyQ29kZV07CgkJdGV4ZWwgPSB0aWxlWUxpbmU7CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbF1dOwoJfQoJaWYgKHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kKSB7CgkJaWYgKHNjcm9sbFhBZGp1c3RlZCA8IDB4MTAwKSB7CgkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbKyt0aWxlTnVtYmVyXTsKCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQljaHJDb2RlIHw9IDB4MTAwOwoJCQl9CgkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVtjaHJDb2RlXTsKCQkJZm9yICh0ZXhlbCA9IHRpbGVZTGluZSAtIDE7IHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kICYmIHNjcm9sbFhBZGp1c3RlZCA8IDB4MTAwOyArK3Njcm9sbFhBZGp1c3RlZCkgewoJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVsrK3RleGVsXV07CgkJCX0KCQl9CgkJc2Nyb2xsWEFkanVzdGVkQWxpZ25lZCA9ICgocGl4ZWxQb3NpdGlvbkVuZCAtIHBpeGVsUG9zaXRpb24pID4+IDMpICsgdGlsZVlEb3duOwoJCXdoaWxlICh0aWxlWURvd24gPCBzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkKSB7CgkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbdGlsZVlEb3duKytdOwoJCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJCWNockNvZGUgfD0gMHgxMDA7CgkJCX0KCQkJdGlsZSA9IHRoaXMudGlsZUNhY2hlW2NockNvZGVdOwoJCQl0ZXhlbCA9IHRpbGVZTGluZTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuQkdQYWxldHRlW3RpbGVbdGV4ZWwrK11dOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuQkdQYWxldHRlW3RpbGVbdGV4ZWwrK11dOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuQkdQYWxldHRlW3RpbGVbdGV4ZWxdXTsKCQl9CgkJaWYgKHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kKSB7CgkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbdGlsZVlEb3duXTsKCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQljaHJDb2RlIHw9IDB4MTAwOwoJCQl9CgkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVtjaHJDb2RlXTsKCQkJc3dpdGNoIChwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbikgewoJCQkJY2FzZSA3OgoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDZdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCA2XV07CgkJCQljYXNlIDY6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgNV0gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RpbGVZTGluZSB8IDVdXTsKCQkJCWNhc2UgNToKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyA0XSA9IHRoaXMuQkdQYWxldHRlW3RpbGVbdGlsZVlMaW5lIHwgNF1dOwoJCQkJY2FzZSA0OgoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDNdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCAzXV07CgkJCQljYXNlIDM6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgMl0gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RpbGVZTGluZSB8IDJdXTsKCQkJCWNhc2UgMjoKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyAxXSA9IHRoaXMuQkdQYWxldHRlW3RpbGVbdGlsZVlMaW5lIHwgMV1dOwoJCQkJY2FzZSAxOgoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbl0gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RpbGVZTGluZV1dOwoJCQl9CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5CR0dCQ0xheWVyUmVuZGVyID0gZnVuY3Rpb24gKHNjYW5saW5lVG9SZW5kZXIpIHsKCXZhciBzY3JvbGxZQWRqdXN0ZWQgPSAodGhpcy5iYWNrZ3JvdW5kWSArIHNjYW5saW5lVG9SZW5kZXIpICYgMHhGRjsJCQkJCQkvL1RoZSBsaW5lIG9mIHRoZSBCRyB3ZSdyZSBhdC4KCXZhciB0aWxlWUxpbmUgPSAoc2Nyb2xsWUFkanVzdGVkICYgNykgPDwgMzsKCXZhciB0aWxlWURvd24gPSB0aGlzLmdmeEJhY2tncm91bmRDSFJCYW5rUG9zaXRpb24gfCAoKHNjcm9sbFlBZGp1c3RlZCAmIDB4RjgpIDw8IDIpOwkvL1RoZSByb3cgb2YgY2FjaGVkIHRpbGVzIHdlJ3JlIGZldGNoaW5nIGZyb20uCgl2YXIgc2Nyb2xsWEFkanVzdGVkID0gKHRoaXMuYmFja2dyb3VuZFggKyB0aGlzLmN1cnJlbnRYKSAmIDB4RkY7CQkJCQkJLy9UaGUgc2Nyb2xsIGFtb3VudCBvZiB0aGUgQkcuCgl2YXIgcGl4ZWxQb3NpdGlvbiA9IHRoaXMucGl4ZWxTdGFydCArIHRoaXMuY3VycmVudFg7CQkJCQkJCQkJLy9DdXJyZW50IHBpeGVsIHdlJ3JlIHdvcmtpbmcgb24uCgl2YXIgcGl4ZWxQb3NpdGlvbkVuZCA9IHRoaXMucGl4ZWxTdGFydCArICgodGhpcy5nZnhXaW5kb3dEaXNwbGF5ICYmIChzY2FubGluZVRvUmVuZGVyIC0gdGhpcy53aW5kb3dZKSA+PSAwKSA/IE1hdGgubWluKE1hdGgubWF4KHRoaXMud2luZG93WCwgMCkgKyB0aGlzLmN1cnJlbnRYLCB0aGlzLnBpeGVsRW5kKSA6IHRoaXMucGl4ZWxFbmQpOwkvL01ha2Ugc3VyZSB3ZSBkbyBhdCBtb3N0IDE2MCBwaXhlbHMgYSBzY2FubGluZS4KCXZhciB0aWxlTnVtYmVyID0gdGlsZVlEb3duICsgKHNjcm9sbFhBZGp1c3RlZCA+PiAzKTsKCXZhciBjaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxW3RpbGVOdW1iZXJdOwoJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJY2hyQ29kZSB8PSAweDEwMDsKCX0KCXZhciBhdHRyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMlt0aWxlTnVtYmVyXTsKCXZhciB0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07Cgl2YXIgcGFsZXR0ZSA9ICgoYXR0ckNvZGUgJiAweDcpIDw8IDIpIHwgKChhdHRyQ29kZSAmIDB4ODApID4+IDIpOwoJZm9yICh2YXIgdGV4ZWwgPSAoc2Nyb2xsWEFkanVzdGVkICYgMHg3KTsgdGV4ZWwgPCA4ICYmIHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kICYmIHNjcm9sbFhBZGp1c3RlZCA8IDB4MTAwOyArK3Njcm9sbFhBZGp1c3RlZCkgewoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IHRleGVsKytdXTsKCX0KCXZhciBzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkID0gTWF0aC5taW4ocGl4ZWxQb3NpdGlvbkVuZCAtIHBpeGVsUG9zaXRpb24sIDB4MTAwIC0gc2Nyb2xsWEFkanVzdGVkKSA+PiAzOwoJc2Nyb2xsWEFkanVzdGVkICs9IHNjcm9sbFhBZGp1c3RlZEFsaWduZWQgPDwgMzsKCXNjcm9sbFhBZGp1c3RlZEFsaWduZWQgKz0gdGlsZU51bWJlcjsKCXdoaWxlICh0aWxlTnVtYmVyIDwgc2Nyb2xsWEFkanVzdGVkQWxpZ25lZCkgewoJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbKyt0aWxlTnVtYmVyXTsKCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJY2hyQ29kZSB8PSAweDEwMDsKCQl9CgkJYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZU51bWJlcl07CgkJdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDA4KSA8PCA4KSB8ICgoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8IGNockNvZGVdOwoJCXBhbGV0dGUgPSAoKGF0dHJDb2RlICYgMHg3KSA8PCAyKSB8ICgoYXR0ckNvZGUgJiAweDgwKSA+PiAyKTsKCQl0ZXhlbCA9IHRpbGVZTGluZTsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWxdXTsKCX0KCWlmIChwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCkgewoJCWlmIChzY3JvbGxYQWRqdXN0ZWQgPCAweDEwMCkgewoJCQljaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxWysrdGlsZU51bWJlcl07CgkJCWlmIChjaHJDb2RlIDwgdGhpcy5nZnhCYWNrZ3JvdW5kQmFua09mZnNldCkgewoJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJfQoJCQlhdHRyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMlt0aWxlTnVtYmVyXTsKCQkJdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDA4KSA8PCA4KSB8ICgoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8IGNockNvZGVdOwoJCQlwYWxldHRlID0gKChhdHRyQ29kZSAmIDB4NykgPDwgMikgfCAoKGF0dHJDb2RlICYgMHg4MCkgPj4gMik7CgkJCWZvciAodGV4ZWwgPSB0aWxlWUxpbmUgLSAxOyBwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCAmJiBzY3JvbGxYQWRqdXN0ZWQgPCAweDEwMDsgKytzY3JvbGxYQWRqdXN0ZWQpIHsKCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlWysrdGV4ZWxdXTsKCQkJfQoJCX0KCQlzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkID0gKChwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbikgPj4gMykgKyB0aWxlWURvd247CgkJd2hpbGUgKHRpbGVZRG93biA8IHNjcm9sbFhBZGp1c3RlZEFsaWduZWQpIHsKCQkJY2hyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMVt0aWxlWURvd25dOwoJCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJCWNockNvZGUgfD0gMHgxMDA7CgkJCX0KCQkJYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZVlEb3duKytdOwoJCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07CgkJCXBhbGV0dGUgPSAoKGF0dHJDb2RlICYgMHg3KSA8PCAyKSB8ICgoYXR0ckNvZGUgJiAweDgwKSA+PiAyKTsKCQkJdGV4ZWwgPSB0aWxlWUxpbmU7CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWxdXTsKCQl9CgkJaWYgKHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kKSB7CgkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbdGlsZVlEb3duXTsKCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQljaHJDb2RlIHw9IDB4MTAwOwoJCQl9CgkJCWF0dHJDb2RlID0gdGhpcy5CR0NIUkJhbmsyW3RpbGVZRG93bl07CgkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVsoKGF0dHJDb2RlICYgMHgwOCkgPDwgOCkgfCAoKGF0dHJDb2RlICYgMHg2MCkgPDwgNCkgfCBjaHJDb2RlXTsKCQkJcGFsZXR0ZSA9ICgoYXR0ckNvZGUgJiAweDcpIDw8IDIpIHwgKChhdHRyQ29kZSAmIDB4ODApID4+IDIpOwoJCQlzd2l0Y2ggKHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uKSB7CgkJCQljYXNlIDc6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgNl0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCA2XV07CgkJCQljYXNlIDY6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgNV0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCA1XV07CgkJCQljYXNlIDU6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgNF0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCA0XV07CgkJCQljYXNlIDQ6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgM10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCAzXV07CgkJCQljYXNlIDM6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgMl0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCAyXV07CgkJCQljYXNlIDI6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgMV0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCAxXV07CgkJCQljYXNlIDE6CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZV1dOwoJCQl9CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5CR0dCQ0xheWVyUmVuZGVyTm9Qcmlvcml0eUZsYWdnaW5nID0gZnVuY3Rpb24gKHNjYW5saW5lVG9SZW5kZXIpIHsKCXZhciBzY3JvbGxZQWRqdXN0ZWQgPSAodGhpcy5iYWNrZ3JvdW5kWSArIHNjYW5saW5lVG9SZW5kZXIpICYgMHhGRjsJCQkJCQkvL1RoZSBsaW5lIG9mIHRoZSBCRyB3ZSdyZSBhdC4KCXZhciB0aWxlWUxpbmUgPSAoc2Nyb2xsWUFkanVzdGVkICYgNykgPDwgMzsKCXZhciB0aWxlWURvd24gPSB0aGlzLmdmeEJhY2tncm91bmRDSFJCYW5rUG9zaXRpb24gfCAoKHNjcm9sbFlBZGp1c3RlZCAmIDB4RjgpIDw8IDIpOwkvL1RoZSByb3cgb2YgY2FjaGVkIHRpbGVzIHdlJ3JlIGZldGNoaW5nIGZyb20uCgl2YXIgc2Nyb2xsWEFkanVzdGVkID0gKHRoaXMuYmFja2dyb3VuZFggKyB0aGlzLmN1cnJlbnRYKSAmIDB4RkY7CQkJCQkJLy9UaGUgc2Nyb2xsIGFtb3VudCBvZiB0aGUgQkcuCgl2YXIgcGl4ZWxQb3NpdGlvbiA9IHRoaXMucGl4ZWxTdGFydCArIHRoaXMuY3VycmVudFg7CQkJCQkJCQkJLy9DdXJyZW50IHBpeGVsIHdlJ3JlIHdvcmtpbmcgb24uCgl2YXIgcGl4ZWxQb3NpdGlvbkVuZCA9IHRoaXMucGl4ZWxTdGFydCArICgodGhpcy5nZnhXaW5kb3dEaXNwbGF5ICYmIChzY2FubGluZVRvUmVuZGVyIC0gdGhpcy53aW5kb3dZKSA+PSAwKSA/IE1hdGgubWluKE1hdGgubWF4KHRoaXMud2luZG93WCwgMCkgKyB0aGlzLmN1cnJlbnRYLCB0aGlzLnBpeGVsRW5kKSA6IHRoaXMucGl4ZWxFbmQpOwkvL01ha2Ugc3VyZSB3ZSBkbyBhdCBtb3N0IDE2MCBwaXhlbHMgYSBzY2FubGluZS4KCXZhciB0aWxlTnVtYmVyID0gdGlsZVlEb3duICsgKHNjcm9sbFhBZGp1c3RlZCA+PiAzKTsKCXZhciBjaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxW3RpbGVOdW1iZXJdOwoJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJY2hyQ29kZSB8PSAweDEwMDsKCX0KCXZhciBhdHRyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMlt0aWxlTnVtYmVyXTsKCXZhciB0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07Cgl2YXIgcGFsZXR0ZSA9IChhdHRyQ29kZSAmIDB4NykgPDwgMjsKCWZvciAodmFyIHRleGVsID0gKHNjcm9sbFhBZGp1c3RlZCAmIDB4Nyk7IHRleGVsIDwgOCAmJiBwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCAmJiBzY3JvbGxYQWRqdXN0ZWQgPCAweDEwMDsgKytzY3JvbGxYQWRqdXN0ZWQpIHsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCB0ZXhlbCsrXV07Cgl9Cgl2YXIgc2Nyb2xsWEFkanVzdGVkQWxpZ25lZCA9IE1hdGgubWluKHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uLCAweDEwMCAtIHNjcm9sbFhBZGp1c3RlZCkgPj4gMzsKCXNjcm9sbFhBZGp1c3RlZCArPSBzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkIDw8IDM7CglzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkICs9IHRpbGVOdW1iZXI7Cgl3aGlsZSAodGlsZU51bWJlciA8IHNjcm9sbFhBZGp1c3RlZEFsaWduZWQpIHsKCQljaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxWysrdGlsZU51bWJlcl07CgkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCWNockNvZGUgfD0gMHgxMDA7CgkJfQoJCWF0dHJDb2RlID0gdGhpcy5CR0NIUkJhbmsyW3RpbGVOdW1iZXJdOwoJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVsoKGF0dHJDb2RlICYgMHgwOCkgPDwgOCkgfCAoKGF0dHJDb2RlICYgMHg2MCkgPDwgNCkgfCBjaHJDb2RlXTsKCQlwYWxldHRlID0gKGF0dHJDb2RlICYgMHg3KSA8PCAyOwoJCXRleGVsID0gdGlsZVlMaW5lOwoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbF1dOwoJfQoJaWYgKHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kKSB7CgkJaWYgKHNjcm9sbFhBZGp1c3RlZCA8IDB4MTAwKSB7CgkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbKyt0aWxlTnVtYmVyXTsKCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQljaHJDb2RlIHw9IDB4MTAwOwoJCQl9CgkJCWF0dHJDb2RlID0gdGhpcy5CR0NIUkJhbmsyW3RpbGVOdW1iZXJdOwoJCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07CgkJCXBhbGV0dGUgPSAoYXR0ckNvZGUgJiAweDcpIDw8IDI7CgkJCWZvciAodGV4ZWwgPSB0aWxlWUxpbmUgLSAxOyBwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCAmJiBzY3JvbGxYQWRqdXN0ZWQgPCAweDEwMDsgKytzY3JvbGxYQWRqdXN0ZWQpIHsKCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlWysrdGV4ZWxdXTsKCQkJfQoJCX0KCQlzY3JvbGxYQWRqdXN0ZWRBbGlnbmVkID0gKChwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbikgPj4gMykgKyB0aWxlWURvd247CgkJd2hpbGUgKHRpbGVZRG93biA8IHNjcm9sbFhBZGp1c3RlZEFsaWduZWQpIHsKCQkJY2hyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMVt0aWxlWURvd25dOwoJCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJCWNockNvZGUgfD0gMHgxMDA7CgkJCX0KCQkJYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZVlEb3duKytdOwoJCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07CgkJCXBhbGV0dGUgPSAoYXR0ckNvZGUgJiAweDcpIDw8IDI7CgkJCXRleGVsID0gdGlsZVlMaW5lOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsXV07CgkJfQoJCWlmIChwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCkgewoJCQljaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxW3RpbGVZRG93bl07CgkJCWlmIChjaHJDb2RlIDwgdGhpcy5nZnhCYWNrZ3JvdW5kQmFua09mZnNldCkgewoJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJfQoJCQlhdHRyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMlt0aWxlWURvd25dOwoJCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07CgkJCXBhbGV0dGUgPSAoYXR0ckNvZGUgJiAweDcpIDw8IDI7CgkJCXN3aXRjaCAocGl4ZWxQb3NpdGlvbkVuZCAtIHBpeGVsUG9zaXRpb24pIHsKCQkJCWNhc2UgNzoKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyA2XSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDZdXTsKCQkJCWNhc2UgNjoKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyA1XSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDVdXTsKCQkJCWNhc2UgNToKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyA0XSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDRdXTsKCQkJCWNhc2UgNDoKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyAzXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDNdXTsKCQkJCWNhc2UgMzoKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyAyXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDJdXTsKCQkJCWNhc2UgMjoKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyAxXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDFdXTsKCQkJCWNhc2UgMToKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb25dID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lXV07CgkJCX0KCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLldpbmRvd0dCTGF5ZXJSZW5kZXIgPSBmdW5jdGlvbiAoc2NhbmxpbmVUb1JlbmRlcikgewoJaWYgKHRoaXMuZ2Z4V2luZG93RGlzcGxheSkgewkJCQkJCQkJCS8vSXMgdGhlIHdpbmRvdyBlbmFibGVkPwoJCXZhciBzY3JvbGxZQWRqdXN0ZWQgPSBzY2FubGluZVRvUmVuZGVyIC0gdGhpcy53aW5kb3dZOwkJLy9UaGUgbGluZSBvZiB0aGUgQkcgd2UncmUgYXQuCgkJaWYgKHNjcm9sbFlBZGp1c3RlZCA+PSAwKSB7CgkJCXZhciBzY3JvbGxYUmFuZ2VBZGp1c3RlZCA9ICh0aGlzLndpbmRvd1ggPiAwKSA/ICh0aGlzLndpbmRvd1ggKyB0aGlzLmN1cnJlbnRYKSA6IHRoaXMuY3VycmVudFg7CgkJCXZhciBwaXhlbFBvc2l0aW9uID0gdGhpcy5waXhlbFN0YXJ0ICsgc2Nyb2xsWFJhbmdlQWRqdXN0ZWQ7CgkJCXZhciBwaXhlbFBvc2l0aW9uRW5kID0gdGhpcy5waXhlbFN0YXJ0ICsgdGhpcy5waXhlbEVuZDsKCQkJaWYgKHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kKSB7CgkJCQl2YXIgdGlsZVlMaW5lID0gKHNjcm9sbFlBZGp1c3RlZCAmIDB4NykgPDwgMzsKCQkJCXZhciB0aWxlTnVtYmVyID0gKHRoaXMuZ2Z4V2luZG93Q0hSQmFua1Bvc2l0aW9uIHwgKChzY3JvbGxZQWRqdXN0ZWQgJiAweEY4KSA8PCAyKSkgKyAodGhpcy5jdXJyZW50WCA+PiAzKTsKCQkJCXZhciBjaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxW3RpbGVOdW1iZXJdOwoJCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJCX0KCQkJCXZhciB0aWxlID0gdGhpcy50aWxlQ2FjaGVbY2hyQ29kZV07CgkJCQl2YXIgdGV4ZWwgPSAoc2Nyb2xsWFJhbmdlQWRqdXN0ZWQgLSB0aGlzLndpbmRvd1gpICYgMHg3OwoJCQkJc2Nyb2xsWFJhbmdlQWRqdXN0ZWQgPSBNYXRoLm1pbig4LCB0ZXhlbCArIHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uKTsKCQkJCXdoaWxlICh0ZXhlbCA8IHNjcm9sbFhSYW5nZUFkanVzdGVkKSB7CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCB0ZXhlbCsrXV07CgkJCQl9CgkJCQlzY3JvbGxYUmFuZ2VBZGp1c3RlZCA9IHRpbGVOdW1iZXIgKyAoKHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uKSA+PiAzKTsKCQkJCXdoaWxlICh0aWxlTnVtYmVyIDwgc2Nyb2xsWFJhbmdlQWRqdXN0ZWQpIHsKCQkJCQljaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxWysrdGlsZU51bWJlcl07CgkJCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQkJCWNockNvZGUgfD0gMHgxMDA7CgkJCQkJfQoJCQkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVtjaHJDb2RlXTsKCQkJCQl0ZXhlbCA9IHRpbGVZTGluZTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RleGVsXV07CgkJCQl9CgkJCQlpZiAocGl4ZWxQb3NpdGlvbiA8IHBpeGVsUG9zaXRpb25FbmQpIHsKCQkJCQljaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxWysrdGlsZU51bWJlcl07CgkJCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQkJCWNockNvZGUgfD0gMHgxMDA7CgkJCQkJfQoJCQkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVtjaHJDb2RlXTsKCQkJCQlzd2l0Y2ggKHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uKSB7CgkJCQkJCWNhc2UgNzoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDZdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCA2XV07CgkJCQkJCWNhc2UgNjoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDVdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCA1XV07CgkJCQkJCWNhc2UgNToKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDRdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCA0XV07CgkJCQkJCWNhc2UgNDoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDNdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCAzXV07CgkJCQkJCWNhc2UgMzoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDJdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCAyXV07CgkJCQkJCWNhc2UgMjoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDFdID0gdGhpcy5CR1BhbGV0dGVbdGlsZVt0aWxlWUxpbmUgfCAxXV07CgkJCQkJCWNhc2UgMToKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbl0gPSB0aGlzLkJHUGFsZXR0ZVt0aWxlW3RpbGVZTGluZV1dOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuV2luZG93R0JDTGF5ZXJSZW5kZXIgPSBmdW5jdGlvbiAoc2NhbmxpbmVUb1JlbmRlcikgewoJaWYgKHRoaXMuZ2Z4V2luZG93RGlzcGxheSkgewkJCQkJCQkJCS8vSXMgdGhlIHdpbmRvdyBlbmFibGVkPwoJCXZhciBzY3JvbGxZQWRqdXN0ZWQgPSBzY2FubGluZVRvUmVuZGVyIC0gdGhpcy53aW5kb3dZOwkJLy9UaGUgbGluZSBvZiB0aGUgQkcgd2UncmUgYXQuCgkJaWYgKHNjcm9sbFlBZGp1c3RlZCA+PSAwKSB7CgkJCXZhciBzY3JvbGxYUmFuZ2VBZGp1c3RlZCA9ICh0aGlzLndpbmRvd1ggPiAwKSA/ICh0aGlzLndpbmRvd1ggKyB0aGlzLmN1cnJlbnRYKSA6IHRoaXMuY3VycmVudFg7CgkJCXZhciBwaXhlbFBvc2l0aW9uID0gdGhpcy5waXhlbFN0YXJ0ICsgc2Nyb2xsWFJhbmdlQWRqdXN0ZWQ7CgkJCXZhciBwaXhlbFBvc2l0aW9uRW5kID0gdGhpcy5waXhlbFN0YXJ0ICsgdGhpcy5waXhlbEVuZDsKCQkJaWYgKHBpeGVsUG9zaXRpb24gPCBwaXhlbFBvc2l0aW9uRW5kKSB7CgkJCQl2YXIgdGlsZVlMaW5lID0gKHNjcm9sbFlBZGp1c3RlZCAmIDB4NykgPDwgMzsKCQkJCXZhciB0aWxlTnVtYmVyID0gKHRoaXMuZ2Z4V2luZG93Q0hSQmFua1Bvc2l0aW9uIHwgKChzY3JvbGxZQWRqdXN0ZWQgJiAweEY4KSA8PCAyKSkgKyAodGhpcy5jdXJyZW50WCA+PiAzKTsKCQkJCXZhciBjaHJDb2RlID0gdGhpcy5CR0NIUkJhbmsxW3RpbGVOdW1iZXJdOwoJCQkJaWYgKGNockNvZGUgPCB0aGlzLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0KSB7CgkJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJCX0KCQkJCXZhciBhdHRyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMlt0aWxlTnVtYmVyXTsKCQkJCXZhciB0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07CgkJCQl2YXIgcGFsZXR0ZSA9ICgoYXR0ckNvZGUgJiAweDcpIDw8IDIpIHwgKChhdHRyQ29kZSAmIDB4ODApID4+IDIpOwoJCQkJdmFyIHRleGVsID0gKHNjcm9sbFhSYW5nZUFkanVzdGVkIC0gdGhpcy53aW5kb3dYKSAmIDB4NzsKCQkJCXNjcm9sbFhSYW5nZUFkanVzdGVkID0gTWF0aC5taW4oOCwgdGV4ZWwgKyBwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbik7CgkJCQl3aGlsZSAodGV4ZWwgPCBzY3JvbGxYUmFuZ2VBZGp1c3RlZCkgewoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IHRleGVsKytdXTsKCQkJCX0KCQkJCXNjcm9sbFhSYW5nZUFkanVzdGVkID0gdGlsZU51bWJlciArICgocGl4ZWxQb3NpdGlvbkVuZCAtIHBpeGVsUG9zaXRpb24pID4+IDMpOwoJCQkJd2hpbGUgKHRpbGVOdW1iZXIgPCBzY3JvbGxYUmFuZ2VBZGp1c3RlZCkgewoJCQkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbKyt0aWxlTnVtYmVyXTsKCQkJCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJCQl9CgkJCQkJYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZU51bWJlcl07CgkJCQkJdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDA4KSA8PCA4KSB8ICgoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8IGNockNvZGVdOwoJCQkJCXBhbGV0dGUgPSAoKGF0dHJDb2RlICYgMHg3KSA8PCAyKSB8ICgoYXR0ckNvZGUgJiAweDgwKSA+PiAyKTsKCQkJCQl0ZXhlbCA9IHRpbGVZTGluZTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWxdXTsKCQkJCX0KCQkJCWlmIChwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCkgewoJCQkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbKyt0aWxlTnVtYmVyXTsKCQkJCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJCQl9CgkJCQkJYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZU51bWJlcl07CgkJCQkJdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDA4KSA8PCA4KSB8ICgoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8IGNockNvZGVdOwoJCQkJCXBhbGV0dGUgPSAoKGF0dHJDb2RlICYgMHg3KSA8PCAyKSB8ICgoYXR0ckNvZGUgJiAweDgwKSA+PiAyKTsKCQkJCQlzd2l0Y2ggKHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uKSB7CgkJCQkJCWNhc2UgNzoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDZdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lIHwgNl1dOwoJCQkJCQljYXNlIDY6CgkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyA1XSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDVdXTsKCQkJCQkJY2FzZSA1OgoJCQkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgNF0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCA0XV07CgkJCQkJCWNhc2UgNDoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDNdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lIHwgM11dOwoJCQkJCQljYXNlIDM6CgkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyAyXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDJdXTsKCQkJCQkJY2FzZSAyOgoJCQkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgMV0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCAxXV07CgkJCQkJCWNhc2UgMToKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbl0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmVdXTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLldpbmRvd0dCQ0xheWVyUmVuZGVyTm9Qcmlvcml0eUZsYWdnaW5nID0gZnVuY3Rpb24gKHNjYW5saW5lVG9SZW5kZXIpIHsKCWlmICh0aGlzLmdmeFdpbmRvd0Rpc3BsYXkpIHsJCQkJCQkJCQkvL0lzIHRoZSB3aW5kb3cgZW5hYmxlZD8KCQl2YXIgc2Nyb2xsWUFkanVzdGVkID0gc2NhbmxpbmVUb1JlbmRlciAtIHRoaXMud2luZG93WTsJCS8vVGhlIGxpbmUgb2YgdGhlIEJHIHdlJ3JlIGF0LgoJCWlmIChzY3JvbGxZQWRqdXN0ZWQgPj0gMCkgewoJCQl2YXIgc2Nyb2xsWFJhbmdlQWRqdXN0ZWQgPSAodGhpcy53aW5kb3dYID4gMCkgPyAodGhpcy53aW5kb3dYICsgdGhpcy5jdXJyZW50WCkgOiB0aGlzLmN1cnJlbnRYOwoJCQl2YXIgcGl4ZWxQb3NpdGlvbiA9IHRoaXMucGl4ZWxTdGFydCArIHNjcm9sbFhSYW5nZUFkanVzdGVkOwoJCQl2YXIgcGl4ZWxQb3NpdGlvbkVuZCA9IHRoaXMucGl4ZWxTdGFydCArIHRoaXMucGl4ZWxFbmQ7CgkJCWlmIChwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCkgewoJCQkJdmFyIHRpbGVZTGluZSA9IChzY3JvbGxZQWRqdXN0ZWQgJiAweDcpIDw8IDM7CgkJCQl2YXIgdGlsZU51bWJlciA9ICh0aGlzLmdmeFdpbmRvd0NIUkJhbmtQb3NpdGlvbiB8ICgoc2Nyb2xsWUFkanVzdGVkICYgMHhGOCkgPDwgMikpICsgKHRoaXMuY3VycmVudFggPj4gMyk7CgkJCQl2YXIgY2hyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMVt0aWxlTnVtYmVyXTsKCQkJCWlmIChjaHJDb2RlIDwgdGhpcy5nZnhCYWNrZ3JvdW5kQmFua09mZnNldCkgewoJCQkJCWNockNvZGUgfD0gMHgxMDA7CgkJCQl9CgkJCQl2YXIgYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZU51bWJlcl07CgkJCQl2YXIgdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDA4KSA8PCA4KSB8ICgoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8IGNockNvZGVdOwoJCQkJdmFyIHBhbGV0dGUgPSAoYXR0ckNvZGUgJiAweDcpIDw8IDI7CgkJCQl2YXIgdGV4ZWwgPSAoc2Nyb2xsWFJhbmdlQWRqdXN0ZWQgLSB0aGlzLndpbmRvd1gpICYgMHg3OwoJCQkJc2Nyb2xsWFJhbmdlQWRqdXN0ZWQgPSBNYXRoLm1pbig4LCB0ZXhlbCArIHBpeGVsUG9zaXRpb25FbmQgLSBwaXhlbFBvc2l0aW9uKTsKCQkJCXdoaWxlICh0ZXhlbCA8IHNjcm9sbFhSYW5nZUFkanVzdGVkKSB7CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lIHwgdGV4ZWwrK11dOwoJCQkJfQoJCQkJc2Nyb2xsWFJhbmdlQWRqdXN0ZWQgPSB0aWxlTnVtYmVyICsgKChwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbikgPj4gMyk7CgkJCQl3aGlsZSAodGlsZU51bWJlciA8IHNjcm9sbFhSYW5nZUFkanVzdGVkKSB7CgkJCQkJY2hyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMVsrK3RpbGVOdW1iZXJdOwoJCQkJCWlmIChjaHJDb2RlIDwgdGhpcy5nZnhCYWNrZ3JvdW5kQmFua09mZnNldCkgewoJCQkJCQljaHJDb2RlIHw9IDB4MTAwOwoJCQkJCX0KCQkJCQlhdHRyQ29kZSA9IHRoaXMuQkdDSFJCYW5rMlt0aWxlTnVtYmVyXTsKCQkJCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgY2hyQ29kZV07CgkJCQkJcGFsZXR0ZSA9IChhdHRyQ29kZSAmIDB4NykgPDwgMjsKCQkJCQl0ZXhlbCA9IHRpbGVZTGluZTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWwrK11dOwoJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbisrXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RleGVsKytdXTsKCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24rK10gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0ZXhlbCsrXV07CgkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uKytdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGV4ZWxdXTsKCQkJCX0KCQkJCWlmIChwaXhlbFBvc2l0aW9uIDwgcGl4ZWxQb3NpdGlvbkVuZCkgewoJCQkJCWNockNvZGUgPSB0aGlzLkJHQ0hSQmFuazFbKyt0aWxlTnVtYmVyXTsKCQkJCQlpZiAoY2hyQ29kZSA8IHRoaXMuZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQpIHsKCQkJCQkJY2hyQ29kZSB8PSAweDEwMDsKCQkJCQl9CgkJCQkJYXR0ckNvZGUgPSB0aGlzLkJHQ0hSQmFuazJbdGlsZU51bWJlcl07CgkJCQkJdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDA4KSA8PCA4KSB8ICgoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8IGNockNvZGVdOwoJCQkJCXBhbGV0dGUgPSAoYXR0ckNvZGUgJiAweDcpIDw8IDI7CgkJCQkJc3dpdGNoIChwaXhlbFBvc2l0aW9uRW5kIC0gcGl4ZWxQb3NpdGlvbikgewoJCQkJCQljYXNlIDc6CgkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyA2XSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDZdXTsKCQkJCQkJY2FzZSA2OgoJCQkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgNV0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCA1XV07CgkJCQkJCWNhc2UgNToKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDRdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lIHwgNF1dOwoJCQkJCQljYXNlIDQ6CgkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb24gKyAzXSA9IHRoaXMuZ2JjQkdQYWxldHRlW3BhbGV0dGUgfCB0aWxlW3RpbGVZTGluZSB8IDNdXTsKCQkJCQkJY2FzZSAzOgoJCQkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltwaXhlbFBvc2l0aW9uICsgMl0gPSB0aGlzLmdiY0JHUGFsZXR0ZVtwYWxldHRlIHwgdGlsZVt0aWxlWUxpbmUgfCAyXV07CgkJCQkJCWNhc2UgMjoKCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbcGl4ZWxQb3NpdGlvbiArIDFdID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lIHwgMV1dOwoJCQkJCQljYXNlIDE6CgkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW3BpeGVsUG9zaXRpb25dID0gdGhpcy5nYmNCR1BhbGV0dGVbcGFsZXR0ZSB8IHRpbGVbdGlsZVlMaW5lXV07CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5TcHJpdGVHQkxheWVyUmVuZGVyID0gZnVuY3Rpb24gKHNjYW5saW5lVG9SZW5kZXIpIHsKCWlmICh0aGlzLmdmeFNwcml0ZVNob3cpIHsJCQkJCQkJCQkJLy9BcmUgc3ByaXRlcyBlbmFibGVkPwoJCXZhciBsaW5lQWRqdXN0ZWQgPSBzY2FubGluZVRvUmVuZGVyICsgMHgxMDsKCQl2YXIgT0FNQWRkcmVzcyA9IDB4RkUwMDsKCQl2YXIgeW9mZnNldCA9IDA7CgkJdmFyIHhjb29yZCA9IDE7CgkJdmFyIHhDb29yZFN0YXJ0ID0gMDsKCQl2YXIgeENvb3JkRW5kID0gMDsKCQl2YXIgYXR0ckNvZGUgPSAwOwoJCXZhciBwYWxldHRlID0gMDsKCQl2YXIgdGlsZSA9IG51bGw7CgkJdmFyIGRhdGEgPSAwOwoJCXZhciBzcHJpdGVDb3VudCA9IDA7CgkJdmFyIGxlbmd0aCA9IDA7CgkJdmFyIGN1cnJlbnRQaXhlbCA9IDA7CgkJdmFyIGxpbmVQaXhlbCA9IDA7CgkJLy9DbGVhciBvdXIgeC1jb29yZCBzb3J0IGJ1ZmZlcjoKCQl3aGlsZSAoeGNvb3JkIDwgMTY4KSB7CgkJCXRoaXMuc29ydEJ1ZmZlclt4Y29vcmQrK10gPSAweEZGOwoJCX0KCQlpZiAodGhpcy5nZnhTcHJpdGVOb3JtYWxIZWlnaHQpIHsKCQkJLy9EcmF3IHRoZSB2aXNpYmxlIHNwcml0ZXM6CgkJCWZvciAodmFyIGxlbmd0aCA9IHRoaXMuZmluZExvd2VzdFNwcml0ZURyYXdhYmxlKGxpbmVBZGp1c3RlZCwgMHg3KTsgc3ByaXRlQ291bnQgPCBsZW5ndGg7ICsrc3ByaXRlQ291bnQpIHsKCQkJCU9BTUFkZHJlc3MgPSB0aGlzLk9BTUFkZHJlc3NDYWNoZVtzcHJpdGVDb3VudF07CgkJCQl5b2Zmc2V0ID0gKGxpbmVBZGp1c3RlZCAtIHRoaXMubWVtb3J5W09BTUFkZHJlc3NdKSA8PCAzOwoJCQkJYXR0ckNvZGUgPSB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgM107CgkJCQlwYWxldHRlID0gKGF0dHJDb2RlICYgMHgxMCkgPj4gMjsKCQkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVsoKGF0dHJDb2RlICYgMHg2MCkgPDwgNCkgfCB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgMHgyXV07CgkJCQlsaW5lUGl4ZWwgPSB4Q29vcmRTdGFydCA9IHRoaXMubWVtb3J5W09BTUFkZHJlc3MgfCAxXTsKCQkJCXhDb29yZEVuZCA9IE1hdGgubWluKDE2OCAtIGxpbmVQaXhlbCwgOCk7CgkJCQl4Y29vcmQgPSAobGluZVBpeGVsID4gNykgPyAwIDogKDggLSBsaW5lUGl4ZWwpOwoJCQkJZm9yIChjdXJyZW50UGl4ZWwgPSB0aGlzLnBpeGVsU3RhcnQgKyAoKGxpbmVQaXhlbCA+IDgpID8gKGxpbmVQaXhlbCAtIDgpIDogMCk7IHhjb29yZCA8IHhDb29yZEVuZDsgKyt4Y29vcmQsICsrY3VycmVudFBpeGVsLCArK2xpbmVQaXhlbCkgewoJCQkJCWlmICh0aGlzLnNvcnRCdWZmZXJbbGluZVBpeGVsXSA+IHhDb29yZFN0YXJ0KSB7CgkJCQkJCWlmICh0aGlzLmZyYW1lQnVmZmVyW2N1cnJlbnRQaXhlbF0gPj0gMHgyMDAwMDAwKSB7CgkJCQkJCQlkYXRhID0gdGlsZVt5b2Zmc2V0IHwgeGNvb3JkXTsKCQkJCQkJCWlmIChkYXRhID4gMCkgewoJCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbY3VycmVudFBpeGVsXSA9IHRoaXMuT0JKUGFsZXR0ZVtwYWxldHRlIHwgZGF0YV07CgkJCQkJCQkJdGhpcy5zb3J0QnVmZmVyW2xpbmVQaXhlbF0gPSB4Q29vcmRTdGFydDsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQllbHNlIGlmICh0aGlzLmZyYW1lQnVmZmVyW2N1cnJlbnRQaXhlbF0gPCAweDEwMDAwMDApIHsKCQkJCQkJCWRhdGEgPSB0aWxlW3lvZmZzZXQgfCB4Y29vcmRdOwoJCQkJCQkJaWYgKGRhdGEgPiAwICYmIGF0dHJDb2RlIDwgMHg4MCkgewoJCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbY3VycmVudFBpeGVsXSA9IHRoaXMuT0JKUGFsZXR0ZVtwYWxldHRlIHwgZGF0YV07CgkJCQkJCQkJdGhpcy5zb3J0QnVmZmVyW2xpbmVQaXhlbF0gPSB4Q29vcmRTdGFydDsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCQllbHNlIHsKCQkJLy9EcmF3IHRoZSB2aXNpYmxlIHNwcml0ZXM6CgkJCWZvciAodmFyIGxlbmd0aCA9IHRoaXMuZmluZExvd2VzdFNwcml0ZURyYXdhYmxlKGxpbmVBZGp1c3RlZCwgMHhGKTsgc3ByaXRlQ291bnQgPCBsZW5ndGg7ICsrc3ByaXRlQ291bnQpIHsKCQkJCU9BTUFkZHJlc3MgPSB0aGlzLk9BTUFkZHJlc3NDYWNoZVtzcHJpdGVDb3VudF07CgkJCQl5b2Zmc2V0ID0gKGxpbmVBZGp1c3RlZCAtIHRoaXMubWVtb3J5W09BTUFkZHJlc3NdKSA8PCAzOwoJCQkJYXR0ckNvZGUgPSB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgM107CgkJCQlwYWxldHRlID0gKGF0dHJDb2RlICYgMHgxMCkgPj4gMjsKCQkJCWlmICgoYXR0ckNvZGUgJiAweDQwKSA9PSAoMHg0MCAmIHlvZmZzZXQpKSB7CgkJCQkJdGlsZSA9IHRoaXMudGlsZUNhY2hlWygoYXR0ckNvZGUgJiAweDYwKSA8PCA0KSB8ICh0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgMHgyXSAmIDB4RkUpXTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVsoKGF0dHJDb2RlICYgMHg2MCkgPDwgNCkgfCB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgMHgyXSB8IDFdOwoJCQkJfQoJCQkJeW9mZnNldCAmPSAweDNGOwoJCQkJbGluZVBpeGVsID0geENvb3JkU3RhcnQgPSB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgMV07CgkJCQl4Q29vcmRFbmQgPSBNYXRoLm1pbigxNjggLSBsaW5lUGl4ZWwsIDgpOwoJCQkJeGNvb3JkID0gKGxpbmVQaXhlbCA+IDcpID8gMCA6ICg4IC0gbGluZVBpeGVsKTsKCQkJCWZvciAoY3VycmVudFBpeGVsID0gdGhpcy5waXhlbFN0YXJ0ICsgKChsaW5lUGl4ZWwgPiA4KSA/IChsaW5lUGl4ZWwgLSA4KSA6IDApOyB4Y29vcmQgPCB4Q29vcmRFbmQ7ICsreGNvb3JkLCArK2N1cnJlbnRQaXhlbCwgKytsaW5lUGl4ZWwpIHsKCQkJCQlpZiAodGhpcy5zb3J0QnVmZmVyW2xpbmVQaXhlbF0gPiB4Q29vcmRTdGFydCkgewoJCQkJCQlpZiAodGhpcy5mcmFtZUJ1ZmZlcltjdXJyZW50UGl4ZWxdID49IDB4MjAwMDAwMCkgewoJCQkJCQkJZGF0YSA9IHRpbGVbeW9mZnNldCB8IHhjb29yZF07CgkJCQkJCQlpZiAoZGF0YSA+IDApIHsKCQkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW2N1cnJlbnRQaXhlbF0gPSB0aGlzLk9CSlBhbGV0dGVbcGFsZXR0ZSB8IGRhdGFdOwoJCQkJCQkJCXRoaXMuc29ydEJ1ZmZlcltsaW5lUGl4ZWxdID0geENvb3JkU3RhcnQ7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAodGhpcy5mcmFtZUJ1ZmZlcltjdXJyZW50UGl4ZWxdIDwgMHgxMDAwMDAwKSB7CgkJCQkJCQlkYXRhID0gdGlsZVt5b2Zmc2V0IHwgeGNvb3JkXTsKCQkJCQkJCWlmIChkYXRhID4gMCAmJiBhdHRyQ29kZSA8IDB4ODApIHsKCQkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW2N1cnJlbnRQaXhlbF0gPSB0aGlzLk9CSlBhbGV0dGVbcGFsZXR0ZSB8IGRhdGFdOwoJCQkJCQkJCXRoaXMuc29ydEJ1ZmZlcltsaW5lUGl4ZWxdID0geENvb3JkU3RhcnQ7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmZpbmRMb3dlc3RTcHJpdGVEcmF3YWJsZSA9IGZ1bmN0aW9uIChzY2FubGluZVRvUmVuZGVyLCBkcmF3YWJsZVJhbmdlKSB7Cgl2YXIgYWRkcmVzcyA9IDB4RkUwMDsKCXZhciBzcHJpdGVDb3VudCA9IDA7Cgl2YXIgZGlmZiA9IDA7Cgl3aGlsZSAoYWRkcmVzcyA8IDB4RkVBMCAmJiBzcHJpdGVDb3VudCA8IDEwKSB7CgkJZGlmZiA9IHNjYW5saW5lVG9SZW5kZXIgLSB0aGlzLm1lbW9yeVthZGRyZXNzXTsKCQlpZiAoKGRpZmYgJiBkcmF3YWJsZVJhbmdlKSA9PSBkaWZmKSB7CgkJCXRoaXMuT0FNQWRkcmVzc0NhY2hlW3Nwcml0ZUNvdW50KytdID0gYWRkcmVzczsKCQl9CgkJYWRkcmVzcyArPSA0OwoJfQoJcmV0dXJuIHNwcml0ZUNvdW50Owp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5TcHJpdGVHQkNMYXllclJlbmRlciA9IGZ1bmN0aW9uIChzY2FubGluZVRvUmVuZGVyKSB7CglpZiAodGhpcy5nZnhTcHJpdGVTaG93KSB7CQkJCQkJCQkJCS8vQXJlIHNwcml0ZXMgZW5hYmxlZD8KCQl2YXIgT0FNQWRkcmVzcyA9IDB4RkUwMDsKCQl2YXIgbGluZUFkanVzdGVkID0gc2NhbmxpbmVUb1JlbmRlciArIDB4MTA7CgkJdmFyIHlvZmZzZXQgPSAwOwoJCXZhciB4Y29vcmQgPSAwOwoJCXZhciBlbmRYID0gMDsKCQl2YXIgeENvdW50ZXIgPSAwOwoJCXZhciBhdHRyQ29kZSA9IDA7CgkJdmFyIHBhbGV0dGUgPSAwOwoJCXZhciB0aWxlID0gbnVsbDsKCQl2YXIgZGF0YSA9IDA7CgkJdmFyIGN1cnJlbnRQaXhlbCA9IDA7CgkJdmFyIHNwcml0ZUNvdW50ID0gMDsKCQlpZiAodGhpcy5nZnhTcHJpdGVOb3JtYWxIZWlnaHQpIHsKCQkJZm9yICg7IE9BTUFkZHJlc3MgPCAweEZFQTAgJiYgc3ByaXRlQ291bnQgPCAxMDsgT0FNQWRkcmVzcyArPSA0KSB7CgkJCQl5b2Zmc2V0ID0gbGluZUFkanVzdGVkIC0gdGhpcy5tZW1vcnlbT0FNQWRkcmVzc107CgkJCQlpZiAoKHlvZmZzZXQgJiAweDcpID09IHlvZmZzZXQpIHsKCQkJCQl4Y29vcmQgPSB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgMV0gLSA4OwoJCQkJCWVuZFggPSBNYXRoLm1pbigxNjAsIHhjb29yZCArIDgpOwoJCQkJCWF0dHJDb2RlID0gdGhpcy5tZW1vcnlbT0FNQWRkcmVzcyB8IDNdOwoJCQkJCXBhbGV0dGUgPSAoYXR0ckNvZGUgJiA3KSA8PCAyOwoJCQkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVsoKGF0dHJDb2RlICYgMHgwOCkgPDwgOCkgfCAoKGF0dHJDb2RlICYgMHg2MCkgPDwgNCkgfCB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgMl1dOwoJCQkJCXhDb3VudGVyID0gKHhjb29yZCA+IDApID8geGNvb3JkIDogMDsKCQkJCQl4Y29vcmQgLT0geW9mZnNldCA8PCAzOwoJCQkJCWZvciAoY3VycmVudFBpeGVsID0gdGhpcy5waXhlbFN0YXJ0ICsgeENvdW50ZXI7IHhDb3VudGVyIDwgZW5kWDsgKyt4Q291bnRlciwgKytjdXJyZW50UGl4ZWwpIHsKCQkJCQkJaWYgKHRoaXMuZnJhbWVCdWZmZXJbY3VycmVudFBpeGVsXSA+PSAweDIwMDAwMDApIHsKCQkJCQkJCWRhdGEgPSB0aWxlW3hDb3VudGVyIC0geGNvb3JkXTsKCQkJCQkJCWlmIChkYXRhID4gMCkgewoJCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbY3VycmVudFBpeGVsXSA9IHRoaXMuZ2JjT0JKUGFsZXR0ZVtwYWxldHRlIHwgZGF0YV07CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAodGhpcy5mcmFtZUJ1ZmZlcltjdXJyZW50UGl4ZWxdIDwgMHgxMDAwMDAwKSB7CgkJCQkJCQlkYXRhID0gdGlsZVt4Q291bnRlciAtIHhjb29yZF07CgkJCQkJCQlpZiAoZGF0YSA+IDAgJiYgYXR0ckNvZGUgPCAweDgwKSB7CQkvL0Rvbid0IG9wdGltaXplIGZvciBhdHRyQ29kZSwgYXMgTElDTS1jYXBhYmxlIEpJVHMgc2hvdWxkIG9wdGltaXplIGl0cyBjaGVja3MuCgkJCQkJCQkJdGhpcy5mcmFtZUJ1ZmZlcltjdXJyZW50UGl4ZWxdID0gdGhpcy5nYmNPQkpQYWxldHRlW3BhbGV0dGUgfCBkYXRhXTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCQkrK3Nwcml0ZUNvdW50OwoJCQkJfQoJCQl9CgkJfQoJCWVsc2UgewoJCQlmb3IgKDsgT0FNQWRkcmVzcyA8IDB4RkVBMCAmJiBzcHJpdGVDb3VudCA8IDEwOyBPQU1BZGRyZXNzICs9IDQpIHsKCQkJCXlvZmZzZXQgPSBsaW5lQWRqdXN0ZWQgLSB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzXTsKCQkJCWlmICgoeW9mZnNldCAmIDB4RikgPT0geW9mZnNldCkgewoJCQkJCXhjb29yZCA9IHRoaXMubWVtb3J5W09BTUFkZHJlc3MgfCAxXSAtIDg7CgkJCQkJZW5kWCA9IE1hdGgubWluKDE2MCwgeGNvb3JkICsgOCk7CgkJCQkJYXR0ckNvZGUgPSB0aGlzLm1lbW9yeVtPQU1BZGRyZXNzIHwgM107CgkJCQkJcGFsZXR0ZSA9IChhdHRyQ29kZSAmIDcpIDw8IDI7CgkJCQkJaWYgKChhdHRyQ29kZSAmIDB4NDApID09ICgweDQwICYgKHlvZmZzZXQgPDwgMykpKSB7CgkJCQkJCXRpbGUgPSB0aGlzLnRpbGVDYWNoZVsoKGF0dHJDb2RlICYgMHgwOCkgPDwgOCkgfCAoKGF0dHJDb2RlICYgMHg2MCkgPDwgNCkgfCAodGhpcy5tZW1vcnlbT0FNQWRkcmVzcyB8IDB4Ml0gJiAweEZFKV07CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQl0aWxlID0gdGhpcy50aWxlQ2FjaGVbKChhdHRyQ29kZSAmIDB4MDgpIDw8IDgpIHwgKChhdHRyQ29kZSAmIDB4NjApIDw8IDQpIHwgdGhpcy5tZW1vcnlbT0FNQWRkcmVzcyB8IDB4Ml0gfCAxXTsKCQkJCQl9CgkJCQkJeENvdW50ZXIgPSAoeGNvb3JkID4gMCkgPyB4Y29vcmQgOiAwOwoJCQkJCXhjb29yZCAtPSAoeW9mZnNldCAmIDB4NykgPDwgMzsKCQkJCQlmb3IgKGN1cnJlbnRQaXhlbCA9IHRoaXMucGl4ZWxTdGFydCArIHhDb3VudGVyOyB4Q291bnRlciA8IGVuZFg7ICsreENvdW50ZXIsICsrY3VycmVudFBpeGVsKSB7CgkJCQkJCWlmICh0aGlzLmZyYW1lQnVmZmVyW2N1cnJlbnRQaXhlbF0gPj0gMHgyMDAwMDAwKSB7CgkJCQkJCQlkYXRhID0gdGlsZVt4Q291bnRlciAtIHhjb29yZF07CgkJCQkJCQlpZiAoZGF0YSA+IDApIHsKCQkJCQkJCQl0aGlzLmZyYW1lQnVmZmVyW2N1cnJlbnRQaXhlbF0gPSB0aGlzLmdiY09CSlBhbGV0dGVbcGFsZXR0ZSB8IGRhdGFdOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWVsc2UgaWYgKHRoaXMuZnJhbWVCdWZmZXJbY3VycmVudFBpeGVsXSA8IDB4MTAwMDAwMCkgewoJCQkJCQkJZGF0YSA9IHRpbGVbeENvdW50ZXIgLSB4Y29vcmRdOwoJCQkJCQkJaWYgKGRhdGEgPiAwICYmIGF0dHJDb2RlIDwgMHg4MCkgewkJLy9Eb24ndCBvcHRpbWl6ZSBmb3IgYXR0ckNvZGUsIGFzIExJQ00tY2FwYWJsZSBKSVRzIHNob3VsZCBvcHRpbWl6ZSBpdHMgY2hlY2tzLgoJCQkJCQkJCXRoaXMuZnJhbWVCdWZmZXJbY3VycmVudFBpeGVsXSA9IHRoaXMuZ2JjT0JKUGFsZXR0ZVtwYWxldHRlIHwgZGF0YV07CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQkJKytzcHJpdGVDb3VudDsKCQkJCX0KCQkJfQoJCX0KCX0KfQovL0dlbmVyYXRlIG9ubHkgYSBzaW5nbGUgdGlsZSBsaW5lIGZvciB0aGUgR0IgdGlsZSBjYWNoZSBtb2RlOgpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ2VuZXJhdGVHQlRpbGVMaW5lID0gZnVuY3Rpb24gKGFkZHJlc3MpIHsKCXZhciBsaW5lQ29weSA9ICh0aGlzLm1lbW9yeVsweDEgfCBhZGRyZXNzXSA8PCA4KSB8IHRoaXMubWVtb3J5WzB4OUZGRSAmIGFkZHJlc3NdOwoJdmFyIHRpbGVCbG9jayA9IHRoaXMudGlsZUNhY2hlWyhhZGRyZXNzICYgMHgxRkYwKSA+PiA0XTsKCWFkZHJlc3MgPSAoYWRkcmVzcyAmIDB4RSkgPDwgMjsKCXRpbGVCbG9ja1thZGRyZXNzIHwgN10gPSAoKGxpbmVDb3B5ICYgMHgxMDApID4+IDcpIHwgKGxpbmVDb3B5ICYgMHgxKTsKCXRpbGVCbG9ja1thZGRyZXNzIHwgNl0gPSAoKGxpbmVDb3B5ICYgMHgyMDApID4+IDgpIHwgKChsaW5lQ29weSAmIDB4MikgPj4gMSk7Cgl0aWxlQmxvY2tbYWRkcmVzcyB8IDVdID0gKChsaW5lQ29weSAmIDB4NDAwKSA+PiA5KSB8ICgobGluZUNvcHkgJiAweDQpID4+IDIpOwoJdGlsZUJsb2NrW2FkZHJlc3MgfCA0XSA9ICgobGluZUNvcHkgJiAweDgwMCkgPj4gMTApIHwgKChsaW5lQ29weSAmIDB4OCkgPj4gMyk7Cgl0aWxlQmxvY2tbYWRkcmVzcyB8IDNdID0gKChsaW5lQ29weSAmIDB4MTAwMCkgPj4gMTEpIHwgKChsaW5lQ29weSAmIDB4MTApID4+IDQpOwoJdGlsZUJsb2NrW2FkZHJlc3MgfCAyXSA9ICgobGluZUNvcHkgJiAweDIwMDApID4+IDEyKSB8ICgobGluZUNvcHkgJiAweDIwKSA+PiA1KTsKCXRpbGVCbG9ja1thZGRyZXNzIHwgMV0gPSAoKGxpbmVDb3B5ICYgMHg0MDAwKSA+PiAxMykgfCAoKGxpbmVDb3B5ICYgMHg0MCkgPj4gNik7Cgl0aWxlQmxvY2tbYWRkcmVzc10gPSAoKGxpbmVDb3B5ICYgMHg4MDAwKSA+PiAxNCkgfCAoKGxpbmVDb3B5ICYgMHg4MCkgPj4gNyk7Cn0KLy9HZW5lcmF0ZSBvbmx5IGEgc2luZ2xlIHRpbGUgbGluZSBmb3IgdGhlIEdCQyB0aWxlIGNhY2hlIG1vZGUgKEJhbmsgMSk6CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5nZW5lcmF0ZUdCQ1RpbGVMaW5lQmFuazEgPSBmdW5jdGlvbiAoYWRkcmVzcykgewoJdmFyIGxpbmVDb3B5ID0gKHRoaXMubWVtb3J5WzB4MSB8IGFkZHJlc3NdIDw8IDgpIHwgdGhpcy5tZW1vcnlbMHg5RkZFICYgYWRkcmVzc107CglhZGRyZXNzICY9IDB4MUZGRTsKCXZhciB0aWxlQmxvY2sxID0gdGhpcy50aWxlQ2FjaGVbYWRkcmVzcyA+PiA0XTsKCXZhciB0aWxlQmxvY2syID0gdGhpcy50aWxlQ2FjaGVbMHgyMDAgfCAoYWRkcmVzcyA+PiA0KV07Cgl2YXIgdGlsZUJsb2NrMyA9IHRoaXMudGlsZUNhY2hlWzB4NDAwIHwgKGFkZHJlc3MgPj4gNCldOwoJdmFyIHRpbGVCbG9jazQgPSB0aGlzLnRpbGVDYWNoZVsweDYwMCB8IChhZGRyZXNzID4+IDQpXTsKCWFkZHJlc3MgPSAoYWRkcmVzcyAmIDB4RSkgPDwgMjsKCXZhciBhZGRyZXNzRmxpcHBlZCA9IDB4MzggLSBhZGRyZXNzOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZF0gPSB0aWxlQmxvY2syW2FkZHJlc3NdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDddID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgN10gPSAoKGxpbmVDb3B5ICYgMHgxMDApID4+IDcpIHwgKGxpbmVDb3B5ICYgMHgxKTsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCAxXSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDFdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDZdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgNl0gPSAoKGxpbmVDb3B5ICYgMHgyMDApID4+IDgpIHwgKChsaW5lQ29weSAmIDB4MikgPj4gMSk7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgMl0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCAyXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA1XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDVdID0gKChsaW5lQ29weSAmIDB4NDAwKSA+PiA5KSB8ICgobGluZUNvcHkgJiAweDQpID4+IDIpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDNdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgM10gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgNF0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCA0XSA9ICgobGluZUNvcHkgJiAweDgwMCkgPj4gMTApIHwgKChsaW5lQ29weSAmIDB4OCkgPj4gMyk7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgNF0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA0XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCAzXSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDNdID0gKChsaW5lQ29weSAmIDB4MTAwMCkgPj4gMTEpIHwgKChsaW5lQ29weSAmIDB4MTApID4+IDQpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDVdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgNV0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgMl0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCAyXSA9ICgobGluZUNvcHkgJiAweDIwMDApID4+IDEyKSB8ICgobGluZUNvcHkgJiAweDIwKSA+PiA1KTsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCA2XSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDZdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDFdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgMV0gPSAoKGxpbmVDb3B5ICYgMHg0MDAwKSA+PiAxMykgfCAoKGxpbmVDb3B5ICYgMHg0MCkgPj4gNik7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgN10gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA3XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWRdID0gdGlsZUJsb2NrMVthZGRyZXNzXSA9ICgobGluZUNvcHkgJiAweDgwMDApID4+IDE0KSB8ICgobGluZUNvcHkgJiAweDgwKSA+PiA3KTsKfQovL0dlbmVyYXRlIGFsbCB0aGUgZmxpcCBjb21iaW5hdGlvbnMgZm9yIGEgZnVsbCBHQkMgVlJBTSBiYW5rIDEgdGlsZToKR2FtZUJveUNvcmUucHJvdG90eXBlLmdlbmVyYXRlR0JDVGlsZUJhbmsxID0gZnVuY3Rpb24gKHZyYW1BZGRyZXNzKSB7Cgl2YXIgYWRkcmVzcyA9IHZyYW1BZGRyZXNzID4+IDQ7Cgl2YXIgdGlsZUJsb2NrMSA9IHRoaXMudGlsZUNhY2hlW2FkZHJlc3NdOwoJdmFyIHRpbGVCbG9jazIgPSB0aGlzLnRpbGVDYWNoZVsweDIwMCB8IGFkZHJlc3NdOwoJdmFyIHRpbGVCbG9jazMgPSB0aGlzLnRpbGVDYWNoZVsweDQwMCB8IGFkZHJlc3NdOwoJdmFyIHRpbGVCbG9jazQgPSB0aGlzLnRpbGVDYWNoZVsweDYwMCB8IGFkZHJlc3NdOwoJdmFyIGxpbmVDb3B5ID0gMDsKCXZyYW1BZGRyZXNzIHw9IDB4ODAwMDsKCWFkZHJlc3MgPSAwOwoJdmFyIGFkZHJlc3NGbGlwcGVkID0gNTY7CglkbyB7CgkJbGluZUNvcHkgPSAodGhpcy5tZW1vcnlbMHgxIHwgdnJhbUFkZHJlc3NdIDw8IDgpIHwgdGhpcy5tZW1vcnlbdnJhbUFkZHJlc3NdOwoJCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWRdID0gdGlsZUJsb2NrMlthZGRyZXNzXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA3XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDddID0gKChsaW5lQ29weSAmIDB4MTAwKSA+PiA3KSB8IChsaW5lQ29weSAmIDB4MSk7CgkJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDFdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgMV0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgNl0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCA2XSA9ICgobGluZUNvcHkgJiAweDIwMCkgPj4gOCkgfCAoKGxpbmVDb3B5ICYgMHgyKSA+PiAxKTsKCQl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgMl0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCAyXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA1XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDVdID0gKChsaW5lQ29weSAmIDB4NDAwKSA+PiA5KSB8ICgobGluZUNvcHkgJiAweDQpID4+IDIpOwoJCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCAzXSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDNdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDRdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgNF0gPSAoKGxpbmVDb3B5ICYgMHg4MDApID4+IDEwKSB8ICgobGluZUNvcHkgJiAweDgpID4+IDMpOwoJCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCA0XSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDRdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDNdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgM10gPSAoKGxpbmVDb3B5ICYgMHgxMDAwKSA+PiAxMSkgfCAoKGxpbmVDb3B5ICYgMHgxMCkgPj4gNCk7CgkJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDVdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgNV0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgMl0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCAyXSA9ICgobGluZUNvcHkgJiAweDIwMDApID4+IDEyKSB8ICgobGluZUNvcHkgJiAweDIwKSA+PiA1KTsKCQl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgNl0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA2XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCAxXSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDFdID0gKChsaW5lQ29weSAmIDB4NDAwMCkgPj4gMTMpIHwgKChsaW5lQ29weSAmIDB4NDApID4+IDYpOwoJCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCA3XSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDddID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZF0gPSB0aWxlQmxvY2sxW2FkZHJlc3NdID0gKChsaW5lQ29weSAmIDB4ODAwMCkgPj4gMTQpIHwgKChsaW5lQ29weSAmIDB4ODApID4+IDcpOwoJCWFkZHJlc3MgKz0gODsKCQlhZGRyZXNzRmxpcHBlZCAtPSA4OwoJCXZyYW1BZGRyZXNzICs9IDI7Cgl9IHdoaWxlIChhZGRyZXNzRmxpcHBlZCA+IC0xKTsKfQovL0dlbmVyYXRlIG9ubHkgYSBzaW5nbGUgdGlsZSBsaW5lIGZvciB0aGUgR0JDIHRpbGUgY2FjaGUgbW9kZSAoQmFuayAyKToKR2FtZUJveUNvcmUucHJvdG90eXBlLmdlbmVyYXRlR0JDVGlsZUxpbmVCYW5rMiA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7Cgl2YXIgbGluZUNvcHkgPSAodGhpcy5WUkFNWzB4MSB8IGFkZHJlc3NdIDw8IDgpIHwgdGhpcy5WUkFNWzB4MUZGRSAmIGFkZHJlc3NdOwoJdmFyIHRpbGVCbG9jazEgPSB0aGlzLnRpbGVDYWNoZVsweDgwMCB8IChhZGRyZXNzID4+IDQpXTsKCXZhciB0aWxlQmxvY2syID0gdGhpcy50aWxlQ2FjaGVbMHhBMDAgfCAoYWRkcmVzcyA+PiA0KV07Cgl2YXIgdGlsZUJsb2NrMyA9IHRoaXMudGlsZUNhY2hlWzB4QzAwIHwgKGFkZHJlc3MgPj4gNCldOwoJdmFyIHRpbGVCbG9jazQgPSB0aGlzLnRpbGVDYWNoZVsweEUwMCB8IChhZGRyZXNzID4+IDQpXTsKCWFkZHJlc3MgPSAoYWRkcmVzcyAmIDB4RSkgPDwgMjsKCXZhciBhZGRyZXNzRmxpcHBlZCA9IDB4MzggLSBhZGRyZXNzOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZF0gPSB0aWxlQmxvY2syW2FkZHJlc3NdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDddID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgN10gPSAoKGxpbmVDb3B5ICYgMHgxMDApID4+IDcpIHwgKGxpbmVDb3B5ICYgMHgxKTsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCAxXSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDFdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDZdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgNl0gPSAoKGxpbmVDb3B5ICYgMHgyMDApID4+IDgpIHwgKChsaW5lQ29weSAmIDB4MikgPj4gMSk7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgMl0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCAyXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA1XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDVdID0gKChsaW5lQ29weSAmIDB4NDAwKSA+PiA5KSB8ICgobGluZUNvcHkgJiAweDQpID4+IDIpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDNdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgM10gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgNF0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCA0XSA9ICgobGluZUNvcHkgJiAweDgwMCkgPj4gMTApIHwgKChsaW5lQ29weSAmIDB4OCkgPj4gMyk7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgNF0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA0XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCAzXSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDNdID0gKChsaW5lQ29weSAmIDB4MTAwMCkgPj4gMTEpIHwgKChsaW5lQ29weSAmIDB4MTApID4+IDQpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDVdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgNV0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgMl0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCAyXSA9ICgobGluZUNvcHkgJiAweDIwMDApID4+IDEyKSB8ICgobGluZUNvcHkgJiAweDIwKSA+PiA1KTsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCA2XSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDZdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDFdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgMV0gPSAoKGxpbmVDb3B5ICYgMHg0MDAwKSA+PiAxMykgfCAoKGxpbmVDb3B5ICYgMHg0MCkgPj4gNik7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgN10gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA3XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWRdID0gdGlsZUJsb2NrMVthZGRyZXNzXSA9ICgobGluZUNvcHkgJiAweDgwMDApID4+IDE0KSB8ICgobGluZUNvcHkgJiAweDgwKSA+PiA3KTsKfQovL0dlbmVyYXRlIGFsbCB0aGUgZmxpcCBjb21iaW5hdGlvbnMgZm9yIGEgZnVsbCBHQkMgVlJBTSBiYW5rIDIgdGlsZToKR2FtZUJveUNvcmUucHJvdG90eXBlLmdlbmVyYXRlR0JDVGlsZUJhbmsyID0gZnVuY3Rpb24gKHZyYW1BZGRyZXNzKSB7Cgl2YXIgYWRkcmVzcyA9IHZyYW1BZGRyZXNzID4+IDQ7Cgl2YXIgdGlsZUJsb2NrMSA9IHRoaXMudGlsZUNhY2hlWzB4ODAwIHwgYWRkcmVzc107Cgl2YXIgdGlsZUJsb2NrMiA9IHRoaXMudGlsZUNhY2hlWzB4QTAwIHwgYWRkcmVzc107Cgl2YXIgdGlsZUJsb2NrMyA9IHRoaXMudGlsZUNhY2hlWzB4QzAwIHwgYWRkcmVzc107Cgl2YXIgdGlsZUJsb2NrNCA9IHRoaXMudGlsZUNhY2hlWzB4RTAwIHwgYWRkcmVzc107Cgl2YXIgbGluZUNvcHkgPSAwOwoJYWRkcmVzcyA9IDA7Cgl2YXIgYWRkcmVzc0ZsaXBwZWQgPSA1NjsKCWRvIHsKCQlsaW5lQ29weSA9ICh0aGlzLlZSQU1bMHgxIHwgdnJhbUFkZHJlc3NdIDw8IDgpIHwgdGhpcy5WUkFNW3ZyYW1BZGRyZXNzXTsKCQl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkXSA9IHRpbGVCbG9jazJbYWRkcmVzc10gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgN10gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCA3XSA9ICgobGluZUNvcHkgJiAweDEwMCkgPj4gNykgfCAobGluZUNvcHkgJiAweDEpOwoJCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCAxXSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDFdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDZdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgNl0gPSAoKGxpbmVDb3B5ICYgMHgyMDApID4+IDgpIHwgKChsaW5lQ29weSAmIDB4MikgPj4gMSk7CgkJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDJdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgMl0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgNV0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCA1XSA9ICgobGluZUNvcHkgJiAweDQwMCkgPj4gOSkgfCAoKGxpbmVDb3B5ICYgMHg0KSA+PiAyKTsKCQl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgM10gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCAzXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA0XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDRdID0gKChsaW5lQ29weSAmIDB4ODAwKSA+PiAxMCkgfCAoKGxpbmVDb3B5ICYgMHg4KSA+PiAzKTsKCQl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgNF0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA0XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCAzXSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDNdID0gKChsaW5lQ29weSAmIDB4MTAwMCkgPj4gMTEpIHwgKChsaW5lQ29weSAmIDB4MTApID4+IDQpOwoJCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCA1XSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDVdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDJdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgMl0gPSAoKGxpbmVDb3B5ICYgMHgyMDAwKSA+PiAxMikgfCAoKGxpbmVDb3B5ICYgMHgyMCkgPj4gNSk7CgkJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDZdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgNl0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgMV0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCAxXSA9ICgobGluZUNvcHkgJiAweDQwMDApID4+IDEzKSB8ICgobGluZUNvcHkgJiAweDQwKSA+PiA2KTsKCQl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgN10gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA3XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWRdID0gdGlsZUJsb2NrMVthZGRyZXNzXSA9ICgobGluZUNvcHkgJiAweDgwMDApID4+IDE0KSB8ICgobGluZUNvcHkgJiAweDgwKSA+PiA3KTsKCQlhZGRyZXNzICs9IDg7CgkJYWRkcmVzc0ZsaXBwZWQgLT0gODsKCQl2cmFtQWRkcmVzcyArPSAyOwoJfSB3aGlsZSAoYWRkcmVzc0ZsaXBwZWQgPiAtMSk7Cn0KLy9HZW5lcmF0ZSBvbmx5IGEgc2luZ2xlIHRpbGUgbGluZSBmb3IgdGhlIEdCIHRpbGUgY2FjaGUgbW9kZSAoT0FNIGFjY2Vzc2libGUgcmFuZ2UpOgpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ2VuZXJhdGVHQk9BTVRpbGVMaW5lID0gZnVuY3Rpb24gKGFkZHJlc3MpIHsKCXZhciBsaW5lQ29weSA9ICh0aGlzLm1lbW9yeVsweDEgfCBhZGRyZXNzXSA8PCA4KSB8IHRoaXMubWVtb3J5WzB4OUZGRSAmIGFkZHJlc3NdOwoJYWRkcmVzcyAmPSAweDFGRkU7Cgl2YXIgdGlsZUJsb2NrMSA9IHRoaXMudGlsZUNhY2hlW2FkZHJlc3MgPj4gNF07Cgl2YXIgdGlsZUJsb2NrMiA9IHRoaXMudGlsZUNhY2hlWzB4MjAwIHwgKGFkZHJlc3MgPj4gNCldOwoJdmFyIHRpbGVCbG9jazMgPSB0aGlzLnRpbGVDYWNoZVsweDQwMCB8IChhZGRyZXNzID4+IDQpXTsKCXZhciB0aWxlQmxvY2s0ID0gdGhpcy50aWxlQ2FjaGVbMHg2MDAgfCAoYWRkcmVzcyA+PiA0KV07CglhZGRyZXNzID0gKGFkZHJlc3MgJiAweEUpIDw8IDI7Cgl2YXIgYWRkcmVzc0ZsaXBwZWQgPSAweDM4IC0gYWRkcmVzczsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWRdID0gdGlsZUJsb2NrMlthZGRyZXNzXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA3XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDddID0gKChsaW5lQ29weSAmIDB4MTAwKSA+PiA3KSB8IChsaW5lQ29weSAmIDB4MSk7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgMV0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCAxXSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCA2XSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDZdID0gKChsaW5lQ29weSAmIDB4MjAwKSA+PiA4KSB8ICgobGluZUNvcHkgJiAweDIpID4+IDEpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDJdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgMl0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgNV0gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCA1XSA9ICgobGluZUNvcHkgJiAweDQwMCkgPj4gOSkgfCAoKGxpbmVDb3B5ICYgMHg0KSA+PiAyKTsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCAzXSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDNdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDRdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgNF0gPSAoKGxpbmVDb3B5ICYgMHg4MDApID4+IDEwKSB8ICgobGluZUNvcHkgJiAweDgpID4+IDMpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDRdID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgNF0gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkIHwgM10gPSB0aWxlQmxvY2sxW2FkZHJlc3MgfCAzXSA9ICgobGluZUNvcHkgJiAweDEwMDApID4+IDExKSB8ICgobGluZUNvcHkgJiAweDEwKSA+PiA0KTsKCXRpbGVCbG9jazRbYWRkcmVzc0ZsaXBwZWQgfCA1XSA9IHRpbGVCbG9jazJbYWRkcmVzcyB8IDVdID0gdGlsZUJsb2NrM1thZGRyZXNzRmxpcHBlZCB8IDJdID0gdGlsZUJsb2NrMVthZGRyZXNzIHwgMl0gPSAoKGxpbmVDb3B5ICYgMHgyMDAwKSA+PiAxMikgfCAoKGxpbmVDb3B5ICYgMHgyMCkgPj4gNSk7Cgl0aWxlQmxvY2s0W2FkZHJlc3NGbGlwcGVkIHwgNl0gPSB0aWxlQmxvY2syW2FkZHJlc3MgfCA2XSA9IHRpbGVCbG9jazNbYWRkcmVzc0ZsaXBwZWQgfCAxXSA9IHRpbGVCbG9jazFbYWRkcmVzcyB8IDFdID0gKChsaW5lQ29weSAmIDB4NDAwMCkgPj4gMTMpIHwgKChsaW5lQ29weSAmIDB4NDApID4+IDYpOwoJdGlsZUJsb2NrNFthZGRyZXNzRmxpcHBlZCB8IDddID0gdGlsZUJsb2NrMlthZGRyZXNzIHwgN10gPSB0aWxlQmxvY2szW2FkZHJlc3NGbGlwcGVkXSA9IHRpbGVCbG9jazFbYWRkcmVzc10gPSAoKGxpbmVDb3B5ICYgMHg4MDAwKSA+PiAxNCkgfCAoKGxpbmVDb3B5ICYgMHg4MCkgPj4gNyk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLmdyYXBoaWNzSklUID0gZnVuY3Rpb24gKCkgewoJaWYgKHRoaXMuTENEaXNPbikgewoJCXRoaXMudG90YWxMaW5lc1Bhc3NlZCA9IDA7CQkJLy9NYXJrIGZyYW1lIGZvciBlbnN1cmluZyBhIEpJVCBwYXNzIGZvciB0aGUgbmV4dCBmcmFtZWJ1ZmZlciBvdXRwdXQuCgkJdGhpcy5ncmFwaGljc0pJVFNjYW5saW5lR3JvdXAoKTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ3JhcGhpY3NKSVRWQmxhbmsgPSBmdW5jdGlvbiAoKSB7CgkvL0pJVCB0aGUgZ3JhcGhpY3MgdG8gdi1ibGFuayBmcmFtaW5nOgoJdGhpcy50b3RhbExpbmVzUGFzc2VkICs9IHRoaXMucXVldWVkU2NhbkxpbmVzOwoJdGhpcy5ncmFwaGljc0pJVFNjYW5saW5lR3JvdXAoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuZ3JhcGhpY3NKSVRTY2FubGluZUdyb3VwID0gZnVuY3Rpb24gKCkgewoJLy9Ob3JtYWwgcmVuZGVyaW5nIEpJVCwgd2hlcmUgd2UgdHJ5IHRvIGRvIGdyb3VwcyBvZiBzY2FubGluZXMgYXQgb25jZToKCXdoaWxlICh0aGlzLnF1ZXVlZFNjYW5MaW5lcyA+IDApIHsKCQl0aGlzLnJlbmRlclNjYW5MaW5lKHRoaXMubGFzdFVucmVuZGVyZWRMaW5lKTsKCQlpZiAodGhpcy5sYXN0VW5yZW5kZXJlZExpbmUgPCAxNDMpIHsKCQkJKyt0aGlzLmxhc3RVbnJlbmRlcmVkTGluZTsKCQl9CgkJZWxzZSB7CgkJCXRoaXMubGFzdFVucmVuZGVyZWRMaW5lID0gMDsKCQl9CgkJLS10aGlzLnF1ZXVlZFNjYW5MaW5lczsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuaW5jcmVtZW50U2NhbkxpbmVRdWV1ZSA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLnF1ZXVlZFNjYW5MaW5lcyA8IDE0NCkgewoJCSsrdGhpcy5xdWV1ZWRTY2FuTGluZXM7Cgl9CgllbHNlIHsKCQl0aGlzLmN1cnJlbnRYID0gMDsKCQl0aGlzLm1pZFNjYW5saW5lT2Zmc2V0ID0gLTE7CgkJaWYgKHRoaXMubGFzdFVucmVuZGVyZWRMaW5lIDwgMTQzKSB7CgkJCSsrdGhpcy5sYXN0VW5yZW5kZXJlZExpbmU7CgkJfQoJCWVsc2UgewoJCQl0aGlzLmxhc3RVbnJlbmRlcmVkTGluZSA9IDA7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5taWRTY2FuTGluZUpJVCA9IGZ1bmN0aW9uICgpIHsKCXRoaXMuZ3JhcGhpY3NKSVQoKTsKCXRoaXMucmVuZGVyTWlkU2NhbkxpbmUoKTsKfQovL0NoZWNrIGZvciB0aGUgaGlnaGVzdCBwcmlvcml0eSBJUlEgdG8gZmlyZToKR2FtZUJveUNvcmUucHJvdG90eXBlLmxhdW5jaElSUSA9IGZ1bmN0aW9uICgpIHsKCXZhciBiaXRTaGlmdCA9IDA7Cgl2YXIgdGVzdGJpdCA9IDE7CglkbyB7CgkJLy9DaGVjayB0byBzZWUgaWYgYW4gaW50ZXJydXB0IGlzIGVuYWJsZWQgQU5EIHJlcXVlc3RlZC4KCQlpZiAoKHRlc3RiaXQgJiB0aGlzLklSUUxpbmVNYXRjaGVkKSA9PSB0ZXN0Yml0KSB7CgkJCXRoaXMuSU1FID0gZmFsc2U7CQkJCQkJLy9SZXNldCB0aGUgaW50ZXJydXB0IGVuYWJsaW5nLgoJCQl0aGlzLmludGVycnVwdHNSZXF1ZXN0ZWQgLT0gdGVzdGJpdDsJLy9SZXNldCB0aGUgaW50ZXJydXB0IHJlcXVlc3QuCgkJCXRoaXMuSVJRTGluZU1hdGNoZWQgPSAwOwkJCQkvL1Jlc2V0IHRoZSBJUlEgYXNzZXJ0aW9uLgoJCQkvL0ludGVycnVwdHMgaGF2ZSBhIGNlcnRhaW4gY2xvY2sgY3ljbGUgbGVuZ3RoOgoJCQl0aGlzLkNQVVRpY2tzID0gMjA7CgkJCS8vU2V0IHRoZSBzdGFjayBwb2ludGVyIHRvIHRoZSBjdXJyZW50IHByb2dyYW0gY291bnRlciB2YWx1ZToKCQkJdGhpcy5zdGFja1BvaW50ZXIgPSAodGhpcy5zdGFja1BvaW50ZXIgLSAxKSAmIDB4RkZGRjsKCQkJdGhpcy5tZW1vcnlXcml0ZXJbdGhpcy5zdGFja1BvaW50ZXJdKHRoaXMsIHRoaXMuc3RhY2tQb2ludGVyLCB0aGlzLnByb2dyYW1Db3VudGVyID4+IDgpOwoJCQl0aGlzLnN0YWNrUG9pbnRlciA9ICh0aGlzLnN0YWNrUG9pbnRlciAtIDEpICYgMHhGRkZGOwoJCQl0aGlzLm1lbW9yeVdyaXRlclt0aGlzLnN0YWNrUG9pbnRlcl0odGhpcywgdGhpcy5zdGFja1BvaW50ZXIsIHRoaXMucHJvZ3JhbUNvdW50ZXIgJiAweEZGKTsKCQkJLy9TZXQgdGhlIHByb2dyYW0gY291bnRlciB0byB0aGUgaW50ZXJydXB0J3MgYWRkcmVzczoKCQkJdGhpcy5wcm9ncmFtQ291bnRlciA9IDB4NDAgfCAoYml0U2hpZnQgPDwgMyk7CgkJCS8vQ2xvY2sgdGhlIGNvcmUgZm9yIG1pZC1pbnN0cnVjdGlvbiB1cGRhdGVzOgoJCQl0aGlzLnVwZGF0ZUNvcmUoKTsKCQkJcmV0dXJuOwkJCQkJCQkJCS8vV2Ugb25seSB3YW50IHRoZSBoaWdoZXN0IHByaW9yaXR5IGludGVycnVwdC4KCQl9CgkJdGVzdGJpdCA9IDEgPDwgKytiaXRTaGlmdDsKCX0gd2hpbGUgKGJpdFNoaWZ0IDwgNSk7Cn0KLyoKCUNoZWNrIGZvciBJUlFzIHRvIGJlIGZpcmVkIHdoaWxlIG5vdCBpbiBIQUxUOgoqLwpHYW1lQm95Q29yZS5wcm90b3R5cGUuY2hlY2tJUlFNYXRjaGluZyA9IGZ1bmN0aW9uICgpIHsKCWlmICh0aGlzLklNRSkgewoJCXRoaXMuSVJRTGluZU1hdGNoZWQgPSB0aGlzLmludGVycnVwdHNFbmFibGVkICYgdGhpcy5pbnRlcnJ1cHRzUmVxdWVzdGVkICYgMHgxRjsKCX0KfQovKgoJSGFuZGxlIHRoZSBIQUxUIG9wY29kZSBieSBwcmVkaWN0aW5nIGFsbCBJUlEgY2FzZXMgY29ycmVjdGx5LAoJdGhlbiBzZWxlY3RpbmcgdGhlIG5leHQgY2xvc2VzdCBJUlEgZmlyaW5nIGZyb20gdGhlIHByZWRpY3Rpb24gdG8KCWNsb2NrIHVwIHRvLiBUaGlzIHByZXZlbnRzIGhhY2t5IGxvb3BpbmcgdGhhdCBkb2Vzbid0IHByZWRpY3QsIGJ1dAoJaW5zdGVhZCBqdXN0IGNsb2NrcyB0aHJvdWdoIHRoZSBjb3JlIHVwZGF0ZSBwcm9jZWR1cmUgYnkgb25lIHdoaWNoCglpcyB2ZXJ5IHNsb3cuIE5vdCBtYW55IGVtdWxhdG9ycyBkbyB0aGlzIGJlY2F1c2UgdGhleSBoYXZlIHRvIGNvdmVyCglhbGwgdGhlIElSUSBwcmVkaWN0aW9uIGNhc2VzIGFuZCB0aGV5IHVzdWFsbHkgZ2V0IHRoZW0gd3JvbmcuCiovCkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jYWxjdWxhdGVIQUxUUGVyaW9kID0gZnVuY3Rpb24gKCkgewoJLy9Jbml0aWFsaXplIG91ciB2YXJpYWJsZXMgYW5kIHN0YXJ0IG91ciBwcmVkaWN0aW9uOgoJaWYgKCF0aGlzLmhhbHQpIHsKCQl0aGlzLmhhbHQgPSB0cnVlOwoJCXZhciBjdXJyZW50Q2xvY2tzID0gLTE7CgkJdmFyIHRlbXBfdmFyID0gMDsKCQlpZiAodGhpcy5MQ0Rpc09uKSB7CgkJCS8vSWYgdGhlIExDRCBpcyBlbmFibGVkLCB0aGVuIHByZWRpY3QgdGhlIExDRCBJUlFzIGVuYWJsZWQ6CgkJCWlmICgodGhpcy5pbnRlcnJ1cHRzRW5hYmxlZCAmIDB4MSkgPT0gMHgxKSB7CgkJCQljdXJyZW50Q2xvY2tzID0gKCg0NTYgKiAoKCh0aGlzLm1vZGVTVEFUID09IDEpID8gMjk4IDogMTQ0KSAtIHRoaXMuYWN0dWFsU2NhbkxpbmUpKSAtIHRoaXMuTENEVGlja3MpIDw8IHRoaXMuZG91YmxlU3BlZWRTaGlmdGVyOwoJCQl9CgkJCWlmICgodGhpcy5pbnRlcnJ1cHRzRW5hYmxlZCAmIDB4MikgPT0gMHgyKSB7CgkJCQlpZiAodGhpcy5tb2RlMFRyaWdnZXJTVEFUKSB7CgkJCQkJdGVtcF92YXIgPSAodGhpcy5jbG9ja3NVbnRpbE1vZGUwKCkgLSB0aGlzLkxDRFRpY2tzKSA8PCB0aGlzLmRvdWJsZVNwZWVkU2hpZnRlcjsKCQkJCQlpZiAodGVtcF92YXIgPD0gY3VycmVudENsb2NrcyB8fCBjdXJyZW50Q2xvY2tzID09IC0xKSB7CgkJCQkJCWN1cnJlbnRDbG9ja3MgPSB0ZW1wX3ZhcjsKCQkJCQl9CgkJCQl9CgkJCQlpZiAodGhpcy5tb2RlMVRyaWdnZXJTVEFUICYmICh0aGlzLmludGVycnVwdHNFbmFibGVkICYgMHgxKSA9PSAwKSB7CgkJCQkJdGVtcF92YXIgPSAoKDQ1NiAqICgoKHRoaXMubW9kZVNUQVQgPT0gMSkgPyAyOTggOiAxNDQpIC0gdGhpcy5hY3R1YWxTY2FuTGluZSkpIC0gdGhpcy5MQ0RUaWNrcykgPDwgdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXI7CgkJCQkJaWYgKHRlbXBfdmFyIDw9IGN1cnJlbnRDbG9ja3MgfHwgY3VycmVudENsb2NrcyA9PSAtMSkgewoJCQkJCQljdXJyZW50Q2xvY2tzID0gdGVtcF92YXI7CgkJCQkJfQoJCQkJfQoJCQkJaWYgKHRoaXMubW9kZTJUcmlnZ2VyU1RBVCkgewoJCQkJCXRlbXBfdmFyID0gKCgodGhpcy5hY3R1YWxTY2FuTGluZSA+PSAxNDMpID8gKDQ1NiAqICgxNTQgLSB0aGlzLmFjdHVhbFNjYW5MaW5lKSkgOiA0NTYpIC0gdGhpcy5MQ0RUaWNrcykgPDwgdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXI7CgkJCQkJaWYgKHRlbXBfdmFyIDw9IGN1cnJlbnRDbG9ja3MgfHwgY3VycmVudENsb2NrcyA9PSAtMSkgewoJCQkJCQljdXJyZW50Q2xvY2tzID0gdGVtcF92YXI7CgkJCQkJfQoJCQkJfQoJCQkJaWYgKHRoaXMuTFlDTWF0Y2hUcmlnZ2VyU1RBVCAmJiB0aGlzLm1lbW9yeVsweEZGNDVdIDw9IDE1MykgewoJCQkJCXRlbXBfdmFyID0gKHRoaXMuY2xvY2tzVW50aWxMWUNNYXRjaCgpIC0gdGhpcy5MQ0RUaWNrcykgPDwgdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXI7CgkJCQkJaWYgKHRlbXBfdmFyIDw9IGN1cnJlbnRDbG9ja3MgfHwgY3VycmVudENsb2NrcyA9PSAtMSkgewoJCQkJCQljdXJyZW50Q2xvY2tzID0gdGVtcF92YXI7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCWlmICh0aGlzLlRJTUFFbmFibGVkICYmICh0aGlzLmludGVycnVwdHNFbmFibGVkICYgMHg0KSA9PSAweDQpIHsKCQkJLy9DUFUgdGltZXIgSVJRIHByZWRpY3Rpb246CgkJCXRlbXBfdmFyID0gKCgweDEwMCAtIHRoaXMubWVtb3J5WzB4RkYwNV0pICogdGhpcy5UQUNDbG9ja2VyKSAtIHRoaXMudGltZXJUaWNrczsKCQkJaWYgKHRlbXBfdmFyIDw9IGN1cnJlbnRDbG9ja3MgfHwgY3VycmVudENsb2NrcyA9PSAtMSkgewoJCQkJY3VycmVudENsb2NrcyA9IHRlbXBfdmFyOwoJCQl9CgkJfQoJCWlmICh0aGlzLnNlcmlhbFRpbWVyID4gMCAmJiAodGhpcy5pbnRlcnJ1cHRzRW5hYmxlZCAmIDB4OCkgPT0gMHg4KSB7CgkJCS8vU2VyaWFsIElSUSBwcmVkaWN0aW9uOgoJCQlpZiAodGhpcy5zZXJpYWxUaW1lciA8PSBjdXJyZW50Q2xvY2tzIHx8IGN1cnJlbnRDbG9ja3MgPT0gLTEpIHsKCQkJCWN1cnJlbnRDbG9ja3MgPSB0aGlzLnNlcmlhbFRpbWVyOwoJCQl9CgkJfQoJfQoJZWxzZSB7CgkJdmFyIGN1cnJlbnRDbG9ja3MgPSB0aGlzLnJlbWFpbmluZ0Nsb2NrczsKCX0KCXZhciBtYXhDbG9ja3MgPSAodGhpcy5DUFVDeWNsZXNUb3RhbCAtIHRoaXMuZW11bGF0b3JUaWNrcykgPDwgdGhpcy5kb3VibGVTcGVlZFNoaWZ0ZXI7CglpZiAoY3VycmVudENsb2NrcyA+PSAwKSB7CgkJaWYgKGN1cnJlbnRDbG9ja3MgPD0gbWF4Q2xvY2tzKSB7CgkJCS8vRXhpdCBvdXQgb2YgSEFMVCBub3JtYWxseToKCQkJdGhpcy5DUFVUaWNrcyA9IE1hdGgubWF4KGN1cnJlbnRDbG9ja3MsIHRoaXMuQ1BVVGlja3MpOwoJCQl0aGlzLnVwZGF0ZUNvcmVGdWxsKCk7CgkJCXRoaXMuaGFsdCA9IGZhbHNlOwoJCQl0aGlzLkNQVVRpY2tzID0gMDsKCQl9CgkJZWxzZSB7CgkJCS8vU3RpbGwgaW4gSEFMVCwgY2xvY2sgb25seSB1cCB0byB0aGUgY2xvY2tzIHNwZWNpZmllZCBwZXIgaXRlcmF0aW9uOgoJCQl0aGlzLkNQVVRpY2tzID0gTWF0aC5tYXgobWF4Q2xvY2tzLCB0aGlzLkNQVVRpY2tzKTsKCQkJdGhpcy5yZW1haW5pbmdDbG9ja3MgPSBjdXJyZW50Q2xvY2tzIC0gdGhpcy5DUFVUaWNrczsKCQl9Cgl9CgllbHNlIHsKCQkvL1N0aWxsIGluIEhBTFQsIGNsb2NrIG9ubHkgdXAgdG8gdGhlIGNsb2NrcyBzcGVjaWZpZWQgcGVyIGl0ZXJhdGlvbjoKCQkvL1dpbGwgc3RheSBpbiBIQUxUIGZvcmV2ZXIgKFN0dWNrIGluIEhBTFQgZm9yZXZlciksIGJ1dCB0aGUgQVBVIGFuZCBMQ0QgYXJlIHN0aWxsIGNsb2NrZWQsIHNvIGRvbid0IHBhdXNlOgoJCXRoaXMuQ1BVVGlja3MgKz0gbWF4Q2xvY2tzOwoJfQp9Ci8vTWVtb3J5IFJlYWRpbmc6CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5tZW1vcnlSZWFkID0gZnVuY3Rpb24gKGFkZHJlc3MpIHsKCS8vQWN0IGFzIGEgd3JhcHBlciBmb3IgcmVhZGluZyB0aGUgcmV0dXJucyBmcm9tIHRoZSBjb21waWxlZCBqdW1wcyB0byBtZW1vcnkuCglyZXR1cm4gdGhpcy5tZW1vcnlSZWFkZXJbYWRkcmVzc10odGhpcywgYWRkcmVzcyk7CS8vVGhpcyBzZWVtcyB0byBiZSBmYXN0ZXIgdGhhbiB0aGUgdXN1YWwgaWYvZWxzZS4KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5SGlnaFJlYWQgPSBmdW5jdGlvbiAoYWRkcmVzcykgewoJLy9BY3QgYXMgYSB3cmFwcGVyIGZvciByZWFkaW5nIHRoZSByZXR1cm5zIGZyb20gdGhlIGNvbXBpbGVkIGp1bXBzIHRvIG1lbW9yeS4KCXJldHVybiB0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbYWRkcmVzc10odGhpcywgYWRkcmVzcyk7CS8vVGhpcyBzZWVtcyB0byBiZSBmYXN0ZXIgdGhhbiB0aGUgdXN1YWwgaWYvZWxzZS4KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5UmVhZEp1bXBDb21waWxlID0gZnVuY3Rpb24gKCkgewoJLy9GYXN0ZXIgaW4gc29tZSBicm93c2Vycywgc2luY2Ugd2UgYXJlIGRvaW5nIGxlc3MgY29uZGl0aW9uYWxzIG92ZXJhbGwgYnkgaW1wbGVtZW50aW5nIHRoZW0gaW4gYWR2YW5jZS4KCWZvciAodmFyIGluZGV4ID0gMHgwMDAwOyBpbmRleCA8PSAweEZGRkY7IGluZGV4KyspIHsKCQlpZiAoaW5kZXggPCAweDQwMDApIHsKCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkTm9ybWFsOwoJCX0KCQllbHNlIGlmIChpbmRleCA8IDB4ODAwMCkgewoJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRST007CgkJfQoJCWVsc2UgaWYgKGluZGV4IDwgMHg5ODAwKSB7CgkJCXRoaXMubWVtb3J5UmVhZGVyW2luZGV4XSA9ICh0aGlzLmNHQkMpID8gdGhpcy5WUkFNREFUQVJlYWRDR0JDUFUgOiB0aGlzLlZSQU1EQVRBUmVhZERNR0NQVTsKCQl9CgkJZWxzZSBpZiAoaW5kZXggPCAweEEwMDApIHsKCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gKHRoaXMuY0dCQykgPyB0aGlzLlZSQU1DSFJSZWFkQ0dCQ1BVIDogdGhpcy5WUkFNQ0hSUmVhZERNR0NQVTsKCQl9CgkJZWxzZSBpZiAoaW5kZXggPj0gMHhBMDAwICYmIGluZGV4IDwgMHhDMDAwKSB7CgkJCWlmICgodGhpcy5udW1SQU1CYW5rcyA9PSAxIC8gMTYgJiYgaW5kZXggPCAweEEyMDApIHx8IHRoaXMubnVtUkFNQmFua3MgPj0gMSkgewoJCQkJaWYgKHRoaXMuY01CQzcpIHsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRNQkM3OwoJCQkJfQoJCQkJZWxzZSBpZiAoIXRoaXMuY01CQzMpIHsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRNQkM7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkvL01CQzMgUlRDICsgUkFNOgoJCQkJCXRoaXMubWVtb3J5UmVhZGVyW2luZGV4XSA9IHRoaXMubWVtb3J5UmVhZE1CQzM7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCX0KCQl9CgkJZWxzZSBpZiAoaW5kZXggPj0gMHhDMDAwICYmIGluZGV4IDwgMHhFMDAwKSB7CgkJCWlmICghdGhpcy5jR0JDIHx8IGluZGV4IDwgMHhEMDAwKSB7CgkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRHQkNNZW1vcnk7CgkJCX0KCQl9CgkJZWxzZSBpZiAoaW5kZXggPj0gMHhFMDAwICYmIGluZGV4IDwgMHhGRTAwKSB7CgkJCWlmICghdGhpcy5jR0JDIHx8IGluZGV4IDwgMHhGMDAwKSB7CgkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRFQ0hPTm9ybWFsOwoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkRUNIT0dCQ01lbW9yeTsKCQkJfQoJCX0KCQllbHNlIGlmIChpbmRleCA8IDB4RkVBMCkgewoJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRPQU07CgkJfQoJCWVsc2UgaWYgKHRoaXMuY0dCQyAmJiBpbmRleCA+PSAweEZFQTAgJiYgaW5kZXggPCAweEZGMDApIHsKCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkTm9ybWFsOwoJCX0KCQllbHNlIGlmIChpbmRleCA+PSAweEZGMDApIHsKCQkJc3dpdGNoIChpbmRleCkgewoJCQkJY2FzZSAweEZGMDA6CgkJCQkJLy9KT1lQQUQ6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzBdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjAwXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJcmV0dXJuIDB4QzAgfCBwYXJlbnRPYmoubWVtb3J5WzB4RkYwMF07CS8vVG9wIG5pYmJsZSByZXR1cm5zIGFzIHNldC4KCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYwMToKCQkJCQkvL1NCCgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4MDFdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjAxXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJcmV0dXJuIChwYXJlbnRPYmoubWVtb3J5WzB4RkYwMl0gPCAweDgwKSA/IHBhcmVudE9iai5tZW1vcnlbMHhGRjAxXSA6IDB4RkY7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGMDI6CgkJCQkJLy9TQwoJCQkJCWlmICh0aGlzLmNHQkMpIHsKCQkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4MDJdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjAyXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJCXJldHVybiAoKHBhcmVudE9iai5zZXJpYWxUaW1lciA8PSAwKSA/IDB4N0MgOiAweEZDKSB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjAyXTsKCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4MDJdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjAyXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJCXJldHVybiAoKHBhcmVudE9iai5zZXJpYWxUaW1lciA8PSAwKSA/IDB4N0UgOiAweEZFKSB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjAyXTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjAzOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDAzXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYwM10gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYwNDoKCQkJCQkvL0RJVgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDA0XSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYwNF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjA0XSA9IChwYXJlbnRPYmoubWVtb3J5WzB4RkYwNF0gKyAocGFyZW50T2JqLkRJVlRpY2tzID4+IDgpKSAmIDB4RkY7CgkJCQkJCXBhcmVudE9iai5ESVZUaWNrcyAmPSAweEZGOwoJCQkJCQlyZXR1cm4gcGFyZW50T2JqLm1lbW9yeVsweEZGMDRdOwoKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYwNToKCQkJCWNhc2UgMHhGRjA2OgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlcltpbmRleCAmIDB4RkZdID0gdGhpcy5tZW1vcnlIaWdoUmVhZE5vcm1hbDsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYwNzoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgwN10gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMDddID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHhGOCB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjA3XTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYwODoKCQkJCWNhc2UgMHhGRjA5OgoJCQkJY2FzZSAweEZGMEE6CgkJCQljYXNlIDB4RkYwQjoKCQkJCWNhc2UgMHhGRjBDOgoJCQkJY2FzZSAweEZGMEQ6CgkJCQljYXNlIDB4RkYwRToKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbaW5kZXggJiAweEZGXSA9IHRoaXMubWVtb3J5UmVhZGVyW2luZGV4XSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjBGOgoJCQkJCS8vSUYKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgwRl0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMEZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHhFMCB8IHBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjEwOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDEwXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYxMF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiAweDgwIHwgcGFyZW50T2JqLm1lbW9yeVsweEZGMTBdOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjExOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDExXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYxMV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiAweDNGIHwgcGFyZW50T2JqLm1lbW9yeVsweEZGMTFdOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjEyOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDEyXSA9IHRoaXMubWVtb3J5SGlnaFJlYWROb3JtYWw7CgkJCQkJdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjEyXSA9IHRoaXMubWVtb3J5UmVhZE5vcm1hbDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjEzOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDEzXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYxM10gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYxNDoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgxNF0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMTRdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHhCRiB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjE0XTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYxNToKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgxNV0gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjE1XSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjE2OgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDE2XSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYxNl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiAweDNGIHwgcGFyZW50T2JqLm1lbW9yeVsweEZGMTZdOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjE3OgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDE3XSA9IHRoaXMubWVtb3J5SGlnaFJlYWROb3JtYWw7CgkJCQkJdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjE3XSA9IHRoaXMubWVtb3J5UmVhZE5vcm1hbDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjE4OgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDE4XSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYxOF0gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYxOToKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgxOV0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMTldID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHhCRiB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjE5XTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYxQToKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgxQV0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMUFdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHg3RiB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjFBXTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYxQjoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgxQl0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMUJdID0gdGhpcy5tZW1vcnlSZWFkQkFEOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGMUM6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4MUNdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjFDXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJcmV0dXJuIDB4OUYgfCBwYXJlbnRPYmoubWVtb3J5WzB4RkYxQ107CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGMUQ6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4MURdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjFEXSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjFFOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDFFXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkYxRV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiAweEJGIHwgcGFyZW50T2JqLm1lbW9yeVsweEZGMUVdOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjFGOgoJCQkJY2FzZSAweEZGMjA6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyW2luZGV4ICYgMHhGRl0gPSB0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYyMToKCQkJCWNhc2UgMHhGRjIyOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlcltpbmRleCAmIDB4RkZdID0gdGhpcy5tZW1vcnlIaWdoUmVhZE5vcm1hbDsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYyMzoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgyM10gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMjNdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHhCRiB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjIzXTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYyNDoKCQkJCWNhc2UgMHhGRjI1OgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlcltpbmRleCAmIDB4RkZdID0gdGhpcy5tZW1vcnlIaWdoUmVhZE5vcm1hbDsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkYyNjoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHgyNl0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGMjZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJCQkJcmV0dXJuIDB4NzAgfCBwYXJlbnRPYmoubWVtb3J5WzB4RkYyNl07CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGMjc6CgkJCQljYXNlIDB4RkYyODoKCQkJCWNhc2UgMHhGRjI5OgoJCQkJY2FzZSAweEZGMkE6CgkJCQljYXNlIDB4RkYyQjoKCQkJCWNhc2UgMHhGRjJDOgoJCQkJY2FzZSAweEZGMkQ6CgkJCQljYXNlIDB4RkYyRToKCQkJCWNhc2UgMHhGRjJGOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlcltpbmRleCAmIDB4RkZdID0gdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkQkFEOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGMzA6CgkJCQljYXNlIDB4RkYzMToKCQkJCWNhc2UgMHhGRjMyOgoJCQkJY2FzZSAweEZGMzM6CgkJCQljYXNlIDB4RkYzNDoKCQkJCWNhc2UgMHhGRjM1OgoJCQkJY2FzZSAweEZGMzY6CgkJCQljYXNlIDB4RkYzNzoKCQkJCWNhc2UgMHhGRjM4OgoJCQkJY2FzZSAweEZGMzk6CgkJCQljYXNlIDB4RkYzQToKCQkJCWNhc2UgMHhGRjNCOgoJCQkJY2FzZSAweEZGM0M6CgkJCQljYXNlIDB4RkYzRDoKCQkJCWNhc2UgMHhGRjNFOgoJCQkJY2FzZSAweEZGM0Y6CgkJCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gKHBhcmVudE9iai5jaGFubmVsM2NhblBsYXkpID8gcGFyZW50T2JqLm1lbW9yeVsweEZGMDAgfCAocGFyZW50T2JqLmNoYW5uZWwzbGFzdFNhbXBsZUxvb2t1cCA+PiAxKV0gOiBwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdOwoJCQkJCX0KCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbaW5kZXggJiAweEZGXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJcmV0dXJuIChwYXJlbnRPYmouY2hhbm5lbDNjYW5QbGF5KSA/IHBhcmVudE9iai5tZW1vcnlbMHhGRjAwIHwgKHBhcmVudE9iai5jaGFubmVsM2xhc3RTYW1wbGVMb29rdXAgPj4gMSldIDogcGFyZW50T2JqLm1lbW9yeVsweEZGMDAgfCBhZGRyZXNzXTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY0MDoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg0MF0gPSB0aGlzLm1lbW9yeUhpZ2hSZWFkTm9ybWFsOwoJCQkJCXRoaXMubWVtb3J5UmVhZGVyWzB4RkY0MF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY0MToKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg0MV0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGNDFdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gMHg4MCB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjQxXSB8IHBhcmVudE9iai5tb2RlU1RBVDsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY0MjoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg0Ml0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGNDJdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gcGFyZW50T2JqLmJhY2tncm91bmRZOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjQzOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDQzXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY0M10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiBwYXJlbnRPYmouYmFja2dyb3VuZFg7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNDQ6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NDRdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjQ0XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJcmV0dXJuICgocGFyZW50T2JqLkxDRGlzT24pID8gcGFyZW50T2JqLm1lbW9yeVsweEZGNDRdIDogMCk7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNDU6CgkJCQljYXNlIDB4RkY0NjoKCQkJCWNhc2UgMHhGRjQ3OgoJCQkJY2FzZSAweEZGNDg6CgkJCQljYXNlIDB4RkY0OToKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbaW5kZXggJiAweEZGXSA9IHRoaXMubWVtb3J5SGlnaFJlYWROb3JtYWw7CgkJCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkTm9ybWFsOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNEE6CgkJCQkJLy9XWQoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDRBXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY0QV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiBwYXJlbnRPYmoud2luZG93WTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY0QjoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg0Ql0gPSB0aGlzLm1lbW9yeUhpZ2hSZWFkTm9ybWFsOwoJCQkJCXRoaXMubWVtb3J5UmVhZGVyWzB4RkY0Ql0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY0QzoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg0Q10gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGNENdID0gdGhpcy5tZW1vcnlSZWFkQkFEOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNEQ6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NERdID0gdGhpcy5tZW1vcnlIaWdoUmVhZE5vcm1hbDsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlclsweEZGNERdID0gdGhpcy5tZW1vcnlSZWFkTm9ybWFsOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNEU6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NEVdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjRFXSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjRGOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDRGXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY0Rl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiBwYXJlbnRPYmouY3VyclZSQU1CYW5rOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjUwOgoJCQkJY2FzZSAweEZGNTE6CgkJCQljYXNlIDB4RkY1MjoKCQkJCWNhc2UgMHhGRjUzOgoJCQkJY2FzZSAweEZGNTQ6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyW2luZGV4ICYgMHhGRl0gPSB0aGlzLm1lbW9yeUhpZ2hSZWFkTm9ybWFsOwoJCQkJCXRoaXMubWVtb3J5UmVhZGVyW2luZGV4XSA9IHRoaXMubWVtb3J5UmVhZE5vcm1hbDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjU1OgoJCQkJCWlmICh0aGlzLmNHQkMpIHsKCQkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NTVdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjU1XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCQkJCQkJCWlmICghcGFyZW50T2JqLkxDRGlzT24gJiYgcGFyZW50T2JqLmhkbWFSdW5uaW5nKSB7CS8vVW5kb2N1bWVudGVkIGJlaGF2aW9yIGFsZXJ0OiBIRE1BIGJlY29tZXMgR0RNQSB3aGVuIExDRCBpcyBvZmYgKFdvcm1zIEFybWFnZWRkb24gRml4KS4KCQkJCQkJCQkvL0RNQQoJCQkJCQkJCXBhcmVudE9iai5ETUFXcml0ZSgocGFyZW50T2JqLm1lbW9yeVsweEZGNTVdICYgMHg3RikgKyAxKTsKCQkJCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY1NV0gPSAweEZGOwkvL1RyYW5zZmVyIGNvbXBsZXRlZC4KCQkJCQkJCQlwYXJlbnRPYmouaGRtYVJ1bm5pbmcgPSBmYWxzZTsKCQkJCQkJCX0KCQkJCQkJCXJldHVybiBwYXJlbnRPYmoubWVtb3J5WzB4RkY1NV07CgkJCQkJCX0KCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXRoaXMubWVtb3J5UmVhZGVyWzB4RkY1NV0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDU1XSA9IHRoaXMubWVtb3J5SGlnaFJlYWROb3JtYWw7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNTY6CgkJCQkJaWYgKHRoaXMuY0dCQykgewoJCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg1Nl0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGNTZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQkJLy9SZXR1cm4gSVIgIm5vdCBjb25uZWN0ZWQiIHN0YXR1czoKCQkJCQkJCXJldHVybiAweDNDIHwgKChwYXJlbnRPYmoubWVtb3J5WzB4RkY1Nl0gPj0gMHhDMCkgPyAoMHgyIHwgKHBhcmVudE9iai5tZW1vcnlbMHhGRjU2XSAmIDB4QzEpKSA6IChwYXJlbnRPYmoubWVtb3J5WzB4RkY1Nl0gJiAweEMzKSk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXRoaXMubWVtb3J5UmVhZGVyWzB4RkY1Nl0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDU2XSA9IHRoaXMubWVtb3J5SGlnaFJlYWROb3JtYWw7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNTc6CgkJCQljYXNlIDB4RkY1ODoKCQkJCWNhc2UgMHhGRjU5OgoJCQkJY2FzZSAweEZGNUE6CgkJCQljYXNlIDB4RkY1QjoKCQkJCWNhc2UgMHhGRjVDOgoJCQkJY2FzZSAweEZGNUQ6CgkJCQljYXNlIDB4RkY1RToKCQkJCWNhc2UgMHhGRjVGOgoJCQkJY2FzZSAweEZGNjA6CgkJCQljYXNlIDB4RkY2MToKCQkJCWNhc2UgMHhGRjYyOgoJCQkJY2FzZSAweEZGNjM6CgkJCQljYXNlIDB4RkY2NDoKCQkJCWNhc2UgMHhGRjY1OgoJCQkJY2FzZSAweEZGNjY6CgkJCQljYXNlIDB4RkY2NzoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbaW5kZXggJiAweEZGXSA9IHRoaXMubWVtb3J5UmVhZGVyW2luZGV4XSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjY4OgoJCQkJY2FzZSAweEZGNjk6CgkJCQljYXNlIDB4RkY2QToKCQkJCWNhc2UgMHhGRjZCOgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlcltpbmRleCAmIDB4RkZdID0gdGhpcy5tZW1vcnlIaWdoUmVhZE5vcm1hbDsKCQkJCQl0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY2QzoKCQkJCQlpZiAodGhpcy5jR0JDKSB7CgkJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDZDXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY2Q10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCQlyZXR1cm4gMHhGRSB8IHBhcmVudE9iai5tZW1vcnlbMHhGRjZDXTsKCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NkNdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjZDXSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY2RDoKCQkJCWNhc2UgMHhGRjZFOgoJCQkJY2FzZSAweEZGNkY6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyW2luZGV4ICYgMHhGRl0gPSB0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY3MDoKCQkJCQlpZiAodGhpcy5jR0JDKSB7CgkJCQkJCS8vU1ZCSwoJCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg3MF0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGNzBdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQkJcmV0dXJuIDB4NDAgfCBwYXJlbnRPYmoubWVtb3J5WzB4RkY3MF07CgkJCQkJCX0KCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDcwXSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY3MF0gPSB0aGlzLm1lbW9yeVJlYWRCQUQ7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweEZGNzE6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NzFdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjcxXSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjcyOgoJCQkJY2FzZSAweEZGNzM6CgkJCQkJdGhpcy5tZW1vcnlIaWdoUmVhZGVyW2luZGV4ICYgMHhGRl0gPSB0aGlzLm1lbW9yeVJlYWRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4RkY3NDoKCQkJCQlpZiAodGhpcy5jR0JDKSB7CgkJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDc0XSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY3NF0gPSB0aGlzLm1lbW9yeVJlYWROb3JtYWw7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHg3NF0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGNzRdID0gdGhpcy5tZW1vcnlSZWFkQkFEOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRjc1OgoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlclsweDc1XSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY3NV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkJCQkJCXJldHVybiAweDhGIHwgcGFyZW50T2JqLm1lbW9yeVsweEZGNzVdOwoJCQkJCX0KCQkJCQlicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMHhGRjc2OgogICAgICAgICAgICAgICAgICAgIC8vVW5kb2N1bWVudGVkIHJlYWx0aW1lIFBDTSBhbXBsaXR1ZGUgcmVhZGJhY2s6CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vcnlIaWdoUmVhZGVyWzB4NzZdID0gdGhpcy5tZW1vcnlSZWFkZXJbMHhGRjc2XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50T2JqLmF1ZGlvSklUKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAocGFyZW50T2JqLmNoYW5uZWwyZW52ZWxvcGVWb2x1bWUgPDwgNCkgfCBwYXJlbnRPYmouY2hhbm5lbDFlbnZlbG9wZVZvbHVtZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDB4RkY3NzoKICAgICAgICAgICAgICAgICAgICAvL1VuZG9jdW1lbnRlZCByZWFsdGltZSBQQ00gYW1wbGl0dWRlIHJlYWRiYWNrOgogICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb3J5SGlnaFJlYWRlclsweDc3XSA9IHRoaXMubWVtb3J5UmVhZGVyWzB4RkY3N10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE9iai5hdWRpb0pJVCgpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHBhcmVudE9iai5jaGFubmVsNGVudmVsb3BlVm9sdW1lIDw8IDQpIHwgcGFyZW50T2JqLmNoYW5uZWwzZW52ZWxvcGVWb2x1bWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJCQkJY2FzZSAweEZGNzg6CgkJCQljYXNlIDB4RkY3OToKCQkJCWNhc2UgMHhGRjdBOgoJCQkJY2FzZSAweEZGN0I6CgkJCQljYXNlIDB4RkY3QzoKCQkJCWNhc2UgMHhGRjdEOgoJCQkJY2FzZSAweEZGN0U6CgkJCQljYXNlIDB4RkY3RjoKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbaW5kZXggJiAweEZGXSA9IHRoaXMubWVtb3J5UmVhZGVyW2luZGV4XSA9IHRoaXMubWVtb3J5UmVhZEJBRDsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHhGRkZGOgoJCQkJCS8vSUUKCQkJCQl0aGlzLm1lbW9yeUhpZ2hSZWFkZXJbMHhGRl0gPSB0aGlzLm1lbW9yeVJlYWRlclsweEZGRkZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJCQkJCQlyZXR1cm4gcGFyZW50T2JqLmludGVycnVwdHNFbmFibGVkOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWRlZmF1bHQ6CgkJCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkTm9ybWFsOwoJCQkJCXRoaXMubWVtb3J5SGlnaFJlYWRlcltpbmRleCAmIDB4RkZdID0gdGhpcy5tZW1vcnlIaWdoUmVhZE5vcm1hbDsKCQkJfQoJCX0KCQllbHNlIHsKCQkJdGhpcy5tZW1vcnlSZWFkZXJbaW5kZXhdID0gdGhpcy5tZW1vcnlSZWFkQkFEOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5UmVhZE5vcm1hbCA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCXJldHVybiBwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5tZW1vcnlIaWdoUmVhZE5vcm1hbCA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCXJldHVybiBwYXJlbnRPYmoubWVtb3J5WzB4RkYwMCB8IGFkZHJlc3NdOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5tZW1vcnlSZWFkUk9NID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJcmV0dXJuIHBhcmVudE9iai5ST01bcGFyZW50T2JqLmN1cnJlbnRST01CYW5rICsgYWRkcmVzc107Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRNQkMgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CgkvL1N3aXRjaGFibGUgUkFNCglpZiAocGFyZW50T2JqLk1CQ1JBTUJhbmtzRW5hYmxlZCB8fCBzZXR0aW5nc1sxMF0pIHsKCQlyZXR1cm4gcGFyZW50T2JqLk1CQ1JhbVthZGRyZXNzICsgcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rUG9zaXRpb25dOwoJfQoJLy9jb3V0KCJSZWFkaW5nIGZyb20gZGlzYWJsZWQgUkFNLiIsIDEpOwoJcmV0dXJuIDB4RkY7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRNQkM3ID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJLy9Td2l0Y2hhYmxlIFJBTQoJaWYgKHBhcmVudE9iai5NQkNSQU1CYW5rc0VuYWJsZWQgfHwgc2V0dGluZ3NbMTBdKSB7CgkJc3dpdGNoIChhZGRyZXNzKSB7CgkJCWNhc2UgMHhBMDAwOgoJCQljYXNlIDB4QTA2MDoKCQkJY2FzZSAweEEwNzA6CgkJCQlyZXR1cm4gMDsKCQkJY2FzZSAweEEwODA6CgkJCQkvL1RPRE86IEd5cm8gQ29udHJvbCBSZWdpc3RlcgoJCQkJcmV0dXJuIDA7CgkJCWNhc2UgMHhBMDUwOgoJCQkJLy9ZIEhpZ2ggQnl0ZQoJCQkJcmV0dXJuIHBhcmVudE9iai5oaWdoWTsKCQkJY2FzZSAweEEwNDA6CgkJCQkvL1kgTG93IEJ5dGUKCQkJCXJldHVybiBwYXJlbnRPYmoubG93WTsKCQkJY2FzZSAweEEwMzA6CgkJCQkvL1ggSGlnaCBCeXRlCgkJCQlyZXR1cm4gcGFyZW50T2JqLmhpZ2hYOwoJCQljYXNlIDB4QTAyMDoKCQkJCS8vWCBMb3cgQnl0ZToKCQkJCXJldHVybiBwYXJlbnRPYmoubG93WDsKCQkJZGVmYXVsdDoKCQkJCXJldHVybiBwYXJlbnRPYmouTUJDUmFtW2FkZHJlc3MgKyBwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmtQb3NpdGlvbl07CgkJfQoJfQoJLy9jb3V0KCJSZWFkaW5nIGZyb20gZGlzYWJsZWQgUkFNLiIsIDEpOwoJcmV0dXJuIDB4RkY7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRNQkMzID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJLy9Td2l0Y2hhYmxlIFJBTQoJaWYgKHBhcmVudE9iai5NQkNSQU1CYW5rc0VuYWJsZWQgfHwgc2V0dGluZ3NbMTBdKSB7CgkJc3dpdGNoIChwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmspIHsKCQkJY2FzZSAweDAwOgoJCQljYXNlIDB4MDE6CgkJCWNhc2UgMHgwMjoKCQkJY2FzZSAweDAzOgoJCQkJcmV0dXJuIHBhcmVudE9iai5NQkNSYW1bYWRkcmVzcyArIHBhcmVudE9iai5jdXJyTUJDUkFNQmFua1Bvc2l0aW9uXTsKCQkJCWJyZWFrOwoJCQljYXNlIDB4MDg6CgkJCQlyZXR1cm4gcGFyZW50T2JqLmxhdGNoZWRTZWNvbmRzOwoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwOToKCQkJCXJldHVybiBwYXJlbnRPYmoubGF0Y2hlZE1pbnV0ZXM7CgkJCQlicmVhazsKCQkJY2FzZSAweDBBOgoJCQkJcmV0dXJuIHBhcmVudE9iai5sYXRjaGVkSG91cnM7CgkJCQlicmVhazsKCQkJY2FzZSAweDBCOgoJCQkJcmV0dXJuIHBhcmVudE9iai5sYXRjaGVkTERheXM7CgkJCQlicmVhazsKCQkJY2FzZSAweDBDOgoJCQkJcmV0dXJuICgoKHBhcmVudE9iai5SVENEYXlPdmVyRmxvdykgPyAweDgwIDogMCkgKyAoKHBhcmVudE9iai5SVENIQUxUKSA/IDB4NDAgOiAwKSkgKyBwYXJlbnRPYmoubGF0Y2hlZEhEYXlzOwoJCX0KCX0KCS8vY291dCgiUmVhZGluZyBmcm9tIGludmFsaWQgb3IgZGlzYWJsZWQgUkFNLiIsIDEpOwoJcmV0dXJuIDB4RkY7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRHQkNNZW1vcnkgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CglyZXR1cm4gcGFyZW50T2JqLkdCQ01lbW9yeVthZGRyZXNzICsgcGFyZW50T2JqLmdiY1JhbUJhbmtQb3NpdGlvbl07Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRPQU0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CglyZXR1cm4gKHBhcmVudE9iai5tb2RlU1RBVCA+IDEpID8gIDB4RkYgOiBwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5tZW1vcnlSZWFkRUNIT0dCQ01lbW9yeSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCXJldHVybiBwYXJlbnRPYmouR0JDTWVtb3J5W2FkZHJlc3MgKyBwYXJlbnRPYmouZ2JjUmFtQmFua1Bvc2l0aW9uRUNIT107Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRFQ0hPTm9ybWFsID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJcmV0dXJuIHBhcmVudE9iai5tZW1vcnlbYWRkcmVzcyAtIDB4MjAwMF07Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVJlYWRCQUQgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzKSB7CglyZXR1cm4gMHhGRjsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuVlJBTURBVEFSZWFkQ0dCQ1BVID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJLy9DUFUgU2lkZSBSZWFkaW5nIFRoZSBWUkFNIChPcHRpbWl6ZWQgZm9yIEdhbWVCb3kgQ29sb3IpCglyZXR1cm4gKHBhcmVudE9iai5tb2RlU1RBVCA+IDIpID8gMHhGRiA6ICgocGFyZW50T2JqLmN1cnJWUkFNQmFuayA9PSAwKSA/IHBhcmVudE9iai5tZW1vcnlbYWRkcmVzc10gOiBwYXJlbnRPYmouVlJBTVthZGRyZXNzICYgMHgxRkZGXSk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLlZSQU1EQVRBUmVhZERNR0NQVSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MpIHsKCS8vQ1BVIFNpZGUgUmVhZGluZyBUaGUgVlJBTSAoT3B0aW1pemVkIGZvciBjbGFzc2ljIEdhbWVCb3kpCglyZXR1cm4gKHBhcmVudE9iai5tb2RlU1RBVCA+IDIpID8gMHhGRiA6IHBhcmVudE9iai5tZW1vcnlbYWRkcmVzc107Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLlZSQU1DSFJSZWFkQ0dCQ1BVID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJLy9DUFUgU2lkZSBSZWFkaW5nIHRoZSBDaGFyYWN0ZXIgRGF0YSBNYXA6CglyZXR1cm4gKHBhcmVudE9iai5tb2RlU1RBVCA+IDIpID8gMHhGRiA6IHBhcmVudE9iai5CR0NIUkN1cnJlbnRCYW5rW2FkZHJlc3MgJiAweDdGRl07Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLlZSQU1DSFJSZWFkRE1HQ1BVID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcykgewoJLy9DUFUgU2lkZSBSZWFkaW5nIHRoZSBDaGFyYWN0ZXIgRGF0YSBNYXA6CglyZXR1cm4gKHBhcmVudE9iai5tb2RlU1RBVCA+IDIpID8gMHhGRiA6IHBhcmVudE9iai5CR0NIUkJhbmsxW2FkZHJlc3MgJiAweDdGRl07Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnNldEN1cnJlbnRNQkMxUk9NQmFuayA9IGZ1bmN0aW9uICgpIHsKCS8vUmVhZCB0aGUgY2FydHJpZGdlIFJPTSBkYXRhIGZyb20gUkFNIG1lbW9yeToKCXN3aXRjaCAodGhpcy5ST01CYW5rMW9mZnMpIHsKCQljYXNlIDB4MDA6CgkJY2FzZSAweDIwOgoJCWNhc2UgMHg0MDoKCQljYXNlIDB4NjA6CgkJCS8vQmFuayBjYWxscyBmb3IgMHgwMCwgMHgyMCwgMHg0MCwgYW5kIDB4NjAgYXJlIHJlYWxseSBmb3IgMHgwMSwgMHgyMSwgMHg0MSwgYW5kIDB4NjEuCgkJCXRoaXMuY3VycmVudFJPTUJhbmsgPSAodGhpcy5ST01CYW5rMW9mZnMgJSB0aGlzLlJPTUJhbmtFZGdlKSA8PCAxNDsKCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJdGhpcy5jdXJyZW50Uk9NQmFuayA9ICgodGhpcy5ST01CYW5rMW9mZnMgJSB0aGlzLlJPTUJhbmtFZGdlKSAtIDEpIDw8IDE0OwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5zZXRDdXJyZW50TUJDMkFORDNST01CYW5rID0gZnVuY3Rpb24gKCkgewoJLy9SZWFkIHRoZSBjYXJ0cmlkZ2UgUk9NIGRhdGEgZnJvbSBSQU0gbWVtb3J5OgoJLy9Pbmx5IG1hcCBiYW5rIDAgdG8gYmFuayAxIGhlcmUgKE1CQzIgaXMgbGlrZSBNQkMxLCBidXQgY2FuIG9ubHkgZG8gMTYgYmFua3MsIHNvIG9ubHkgdGhlIGJhbmsgMCBxdWlyayBhcHBlYXJzIGZvciBNQkMyKToKCXRoaXMuY3VycmVudFJPTUJhbmsgPSBNYXRoLm1heCgodGhpcy5ST01CYW5rMW9mZnMgJSB0aGlzLlJPTUJhbmtFZGdlKSAtIDEsIDApIDw8IDE0Owp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5zZXRDdXJyZW50TUJDNVJPTUJhbmsgPSBmdW5jdGlvbiAoKSB7CgkvL1JlYWQgdGhlIGNhcnRyaWRnZSBST00gZGF0YSBmcm9tIFJBTSBtZW1vcnk6Cgl0aGlzLmN1cnJlbnRST01CYW5rID0gKCh0aGlzLlJPTUJhbmsxb2ZmcyAlIHRoaXMuUk9NQmFua0VkZ2UpIC0gMSkgPDwgMTQ7Cn0KLy9NZW1vcnkgV3JpdGluZzoKR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVdyaXRlID0gZnVuY3Rpb24gKGFkZHJlc3MsIGRhdGEpIHsKCS8vQWN0IGFzIGEgd3JhcHBlciBmb3Igd3JpdGluZyBieSBjb21waWxlZCBqdW1wcyB0byBzcGVjaWZpYyBtZW1vcnkgd3JpdGluZyBmdW5jdGlvbnMuCgl0aGlzLm1lbW9yeVdyaXRlclthZGRyZXNzXSh0aGlzLCBhZGRyZXNzLCBkYXRhKTsKfQovLzB4RkZYWCBmYXN0IHBhdGg6CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5tZW1vcnlIaWdoV3JpdGUgPSBmdW5jdGlvbiAoYWRkcmVzcywgZGF0YSkgewoJLy9BY3QgYXMgYSB3cmFwcGVyIGZvciB3cml0aW5nIGJ5IGNvbXBpbGVkIGp1bXBzIHRvIHNwZWNpZmljIG1lbW9yeSB3cml0aW5nIGZ1bmN0aW9ucy4KCXRoaXMubWVtb3J5SGlnaFdyaXRlclthZGRyZXNzXSh0aGlzLCBhZGRyZXNzLCBkYXRhKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5V3JpdGVKdW1wQ29tcGlsZSA9IGZ1bmN0aW9uICgpIHsKCS8vRmFzdGVyIGluIHNvbWUgYnJvd3NlcnMsIHNpbmNlIHdlIGFyZSBkb2luZyBsZXNzIGNvbmRpdGlvbmFscyBvdmVyYWxsIGJ5IGltcGxlbWVudGluZyB0aGVtIGluIGFkdmFuY2UuCglmb3IgKHZhciBpbmRleCA9IDB4MDAwMDsgaW5kZXggPD0gMHhGRkZGOyBpbmRleCsrKSB7CgkJaWYgKGluZGV4IDwgMHg4MDAwKSB7CgkJCWlmICh0aGlzLmNNQkMxKSB7CgkJCQlpZiAoaW5kZXggPCAweDIwMDApIHsKCQkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLk1CQ1dyaXRlRW5hYmxlOwoJCQkJfQoJCQkJZWxzZSBpZiAoaW5kZXggPCAweDQwMDApIHsKCQkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLk1CQzFXcml0ZVJPTUJhbms7CgkJCQl9CgkJCQllbHNlIGlmIChpbmRleCA8IDB4NjAwMCkgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuTUJDMVdyaXRlUkFNQmFuazsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuTUJDMVdyaXRlVHlwZTsKCQkJCX0KCQkJfQoJCQllbHNlIGlmICh0aGlzLmNNQkMyKSB7CgkJCQlpZiAoaW5kZXggPCAweDEwMDApIHsKCQkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLk1CQ1dyaXRlRW5hYmxlOwoJCQkJfQoJCQkJZWxzZSBpZiAoaW5kZXggPj0gMHgyMTAwICYmIGluZGV4IDwgMHgyMjAwKSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5NQkMyV3JpdGVST01CYW5rOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAodGhpcy5jTUJDMykgewoJCQkJaWYgKGluZGV4IDwgMHgyMDAwKSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5NQkNXcml0ZUVuYWJsZTsKCQkJCX0KCQkJCWVsc2UgaWYgKGluZGV4IDwgMHg0MDAwKSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5NQkMzV3JpdGVST01CYW5rOwoJCQkJfQoJCQkJZWxzZSBpZiAoaW5kZXggPCAweDYwMDApIHsKCQkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLk1CQzNXcml0ZVJBTUJhbms7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLk1CQzNXcml0ZVJUQ0xhdGNoOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKHRoaXMuY01CQzUgfHwgdGhpcy5jUlVNQkxFIHx8IHRoaXMuY01CQzcpIHsKCQkJCWlmIChpbmRleCA8IDB4MjAwMCkgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuTUJDV3JpdGVFbmFibGU7CgkJCQl9CgkJCQllbHNlIGlmIChpbmRleCA8IDB4MzAwMCkgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuTUJDNVdyaXRlUk9NQmFua0xvdzsKCQkJCX0KCQkJCWVsc2UgaWYgKGluZGV4IDwgMHg0MDAwKSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5NQkM1V3JpdGVST01CYW5rSGlnaDsKCQkJCX0KCQkJCWVsc2UgaWYgKGluZGV4IDwgMHg2MDAwKSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gKHRoaXMuY1JVTUJMRSkgPyB0aGlzLlJVTUJMRVdyaXRlUkFNQmFuayA6IHRoaXMuTUJDNVdyaXRlUkFNQmFuazsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKHRoaXMuY0h1QzMpIHsKCQkJCWlmIChpbmRleCA8IDB4MjAwMCkgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuTUJDV3JpdGVFbmFibGU7CgkJCQl9CgkJCQllbHNlIGlmIChpbmRleCA8IDB4NDAwMCkgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMuTUJDM1dyaXRlUk9NQmFuazsKCQkJCX0KCQkJCWVsc2UgaWYgKGluZGV4IDwgMHg2MDAwKSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5IdUMzV3JpdGVSQU1CYW5rOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCQkJfQoJCX0KCQllbHNlIGlmIChpbmRleCA8IDB4OTAwMCkgewoJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSAodGhpcy5jR0JDKSA/IHRoaXMuVlJBTUdCQ0RBVEFXcml0ZSA6IHRoaXMuVlJBTUdCREFUQVdyaXRlOwoJCX0KCQllbHNlIGlmIChpbmRleCA8IDB4OTgwMCkgewoJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSAodGhpcy5jR0JDKSA/IHRoaXMuVlJBTUdCQ0RBVEFXcml0ZSA6IHRoaXMuVlJBTUdCREFUQVVwcGVyV3JpdGU7CgkJfQoJCWVsc2UgaWYgKGluZGV4IDwgMHhBMDAwKSB7CgkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9ICh0aGlzLmNHQkMpID8gdGhpcy5WUkFNR0JDQ0hSTUFQV3JpdGUgOiB0aGlzLlZSQU1HQkNIUk1BUFdyaXRlOwoJCX0KCQllbHNlIGlmIChpbmRleCA8IDB4QzAwMCkgewoJCQlpZiAoKHRoaXMubnVtUkFNQmFua3MgPT0gMSAvIDE2ICYmIGluZGV4IDwgMHhBMjAwKSB8fCB0aGlzLm51bVJBTUJhbmtzID49IDEpIHsKCQkJCWlmICghdGhpcy5jTUJDMykgewoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMubWVtb3J5V3JpdGVNQkNSQU07CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkvL01CQzMgUlRDICsgUkFNOgoJCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMubWVtb3J5V3JpdGVNQkMzUkFNOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJCX0KCQl9CgkJZWxzZSBpZiAoaW5kZXggPCAweEUwMDApIHsKCQkJaWYgKHRoaXMuY0dCQyAmJiBpbmRleCA+PSAweEQwMDApIHsKCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMubWVtb3J5V3JpdGVHQkNSQU07CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVdyaXRlTm9ybWFsOwoJCQl9CgkJfQoJCWVsc2UgaWYgKGluZGV4IDwgMHhGRTAwKSB7CgkJCWlmICh0aGlzLmNHQkMgJiYgaW5kZXggPj0gMHhGMDAwKSB7CgkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVdyaXRlRUNIT0dCQ1JBTTsKCQkJfQoJCQllbHNlIHsKCQkJCXRoaXMubWVtb3J5V3JpdGVyW2luZGV4XSA9IHRoaXMubWVtb3J5V3JpdGVFQ0hPTm9ybWFsOwoJCQl9CgkJfQoJCWVsc2UgaWYgKGluZGV4IDw9IDB4RkVBMCkgewoJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVdyaXRlT0FNUkFNOwoJCX0KCQllbHNlIGlmIChpbmRleCA8IDB4RkYwMCkgewoJCQlpZiAodGhpcy5jR0JDKSB7CQkJCQkJCQkJCQkvL09ubHkgR0JDIGhhcyBhY2Nlc3MgdG8gdGhpcyBSQU0uCgkJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVdyaXRlTm9ybWFsOwoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5tZW1vcnlXcml0ZXJbaW5kZXhdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCS8vU3RhcnQgdGhlIEkvTyBpbml0aWFsaXphdGlvbiBieSBmaWxsaW5nIGluIHRoZSBzbG90cyBhcyBub3JtYWwgbWVtb3J5OgoJCQl0aGlzLm1lbW9yeVdyaXRlcltpbmRleF0gPSB0aGlzLm1lbW9yeVdyaXRlTm9ybWFsOwoJCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbaW5kZXggJiAweEZGXSA9IHRoaXMubWVtb3J5SGlnaFdyaXRlTm9ybWFsOwoJCX0KCX0KCXRoaXMucmVnaXN0ZXJXcml0ZUp1bXBDb21waWxlKCk7CQkJCS8vQ29tcGlsZSB0aGUgSS9PIHdyaXRlIGZ1bmN0aW9ucyBzZXBhcmF0ZWx5Li4uCn0KR2FtZUJveUNvcmUucHJvdG90eXBlLk1CQ1dyaXRlRW5hYmxlID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJLy9NQkMgUkFNIEJhbmsgRW5hYmxlL0Rpc2FibGU6CglwYXJlbnRPYmouTUJDUkFNQmFua3NFbmFibGVkID0gKChkYXRhICYgMHgwRikgPT0gMHgwQSk7CS8vSWYgbG93ZXIgbmliYmxlIGlzIDB4MEEsIHRoZW4gZW5hYmxlLCBvdGhlcndpc2UgZGlzYWJsZS4KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuTUJDMVdyaXRlUk9NQmFuayA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCS8vTUJDMSBST00gYmFuayBzd2l0Y2hpbmc6CglwYXJlbnRPYmouUk9NQmFuazFvZmZzID0gKHBhcmVudE9iai5ST01CYW5rMW9mZnMgJiAweDYwKSB8IChkYXRhICYgMHgxRik7CglwYXJlbnRPYmouc2V0Q3VycmVudE1CQzFST01CYW5rKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLk1CQzFXcml0ZVJBTUJhbmsgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkvL01CQzEgUkFNIGJhbmsgc3dpdGNoaW5nCglpZiAocGFyZW50T2JqLk1CQzFNb2RlKSB7CgkJLy80LzMyIE1vZGUKCQlwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgPSBkYXRhICYgMHgwMzsKCQlwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmtQb3NpdGlvbiA9IChwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgPDwgMTMpIC0gMHhBMDAwOwoJfQoJZWxzZSB7CgkJLy8xNi84IE1vZGUKCQlwYXJlbnRPYmouUk9NQmFuazFvZmZzID0gKChkYXRhICYgMHgwMykgPDwgNSkgfCAocGFyZW50T2JqLlJPTUJhbmsxb2ZmcyAmIDB4MUYpOwoJCXBhcmVudE9iai5zZXRDdXJyZW50TUJDMVJPTUJhbmsoKTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuTUJDMVdyaXRlVHlwZSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCS8vTUJDMSBtb2RlIHNldHRpbmc6CglwYXJlbnRPYmouTUJDMU1vZGUgPSAoKGRhdGEgJiAweDEpID09IDB4MSk7CglpZiAocGFyZW50T2JqLk1CQzFNb2RlKSB7CgkJcGFyZW50T2JqLlJPTUJhbmsxb2ZmcyAmPSAweDFGOwoJCXBhcmVudE9iai5zZXRDdXJyZW50TUJDMVJPTUJhbmsoKTsKCX0KCWVsc2UgewoJCXBhcmVudE9iai5jdXJyTUJDUkFNQmFuayA9IDA7CgkJcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rUG9zaXRpb24gPSAtMHhBMDAwOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5NQkMyV3JpdGVST01CYW5rID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJLy9NQkMyIFJPTSBiYW5rIHN3aXRjaGluZzoKCXBhcmVudE9iai5ST01CYW5rMW9mZnMgPSBkYXRhICYgMHgwRjsKCXBhcmVudE9iai5zZXRDdXJyZW50TUJDMkFORDNST01CYW5rKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLk1CQzNXcml0ZVJPTUJhbmsgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkvL01CQzMgUk9NIGJhbmsgc3dpdGNoaW5nOgoJcGFyZW50T2JqLlJPTUJhbmsxb2ZmcyA9IGRhdGEgJiAweDdGOwoJcGFyZW50T2JqLnNldEN1cnJlbnRNQkMyQU5EM1JPTUJhbmsoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuTUJDM1dyaXRlUkFNQmFuayA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCXBhcmVudE9iai5jdXJyTUJDUkFNQmFuayA9IGRhdGE7CglpZiAoZGF0YSA8IDQpIHsKCQkvL01CQzMgUkFNIGJhbmsgc3dpdGNoaW5nCgkJcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rUG9zaXRpb24gPSAocGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rIDw8IDEzKSAtIDB4QTAwMDsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuTUJDM1dyaXRlUlRDTGF0Y2ggPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CglpZiAoZGF0YSA9PSAwKSB7CgkJcGFyZW50T2JqLlJUQ2lzTGF0Y2hlZCA9IGZhbHNlOwoJfQoJZWxzZSBpZiAoIXBhcmVudE9iai5SVENpc0xhdGNoZWQpIHsKCQkvL0NvcHkgb3ZlciB0aGUgY3VycmVudCBSVEMgdGltZSBmb3IgcmVhZGluZy4KCQlwYXJlbnRPYmouUlRDaXNMYXRjaGVkID0gdHJ1ZTsKCQlwYXJlbnRPYmoubGF0Y2hlZFNlY29uZHMgPSBwYXJlbnRPYmouUlRDU2Vjb25kcyB8IDA7CgkJcGFyZW50T2JqLmxhdGNoZWRNaW51dGVzID0gcGFyZW50T2JqLlJUQ01pbnV0ZXM7CgkJcGFyZW50T2JqLmxhdGNoZWRIb3VycyA9IHBhcmVudE9iai5SVENIb3VyczsKCQlwYXJlbnRPYmoubGF0Y2hlZExEYXlzID0gKHBhcmVudE9iai5SVENEYXlzICYgMHhGRik7CgkJcGFyZW50T2JqLmxhdGNoZWRIRGF5cyA9IHBhcmVudE9iai5SVENEYXlzID4+IDg7Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLk1CQzVXcml0ZVJPTUJhbmtMb3cgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkvL01CQzUgUk9NIGJhbmsgc3dpdGNoaW5nOgoJcGFyZW50T2JqLlJPTUJhbmsxb2ZmcyA9IChwYXJlbnRPYmouUk9NQmFuazFvZmZzICYgMHgxMDApIHwgZGF0YTsKCXBhcmVudE9iai5zZXRDdXJyZW50TUJDNVJPTUJhbmsoKTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuTUJDNVdyaXRlUk9NQmFua0hpZ2ggPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkvL01CQzUgUk9NIGJhbmsgc3dpdGNoaW5nIChieSBsZWFzdCBzaWduaWZpY2FudCBiaXQpOgoJcGFyZW50T2JqLlJPTUJhbmsxb2ZmcyAgPSAoKGRhdGEgJiAweDAxKSA8PCA4KSB8IChwYXJlbnRPYmouUk9NQmFuazFvZmZzICYgMHhGRik7CglwYXJlbnRPYmouc2V0Q3VycmVudE1CQzVST01CYW5rKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLk1CQzVXcml0ZVJBTUJhbmsgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkvL01CQzUgUkFNIGJhbmsgc3dpdGNoaW5nCglwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgPSBkYXRhICYgMHhGOwoJcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rUG9zaXRpb24gPSAocGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rIDw8IDEzKSAtIDB4QTAwMDsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuUlVNQkxFV3JpdGVSQU1CYW5rID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJLy9NQkM1IFJBTSBiYW5rIHN3aXRjaGluZwoJLy9MaWtlIE1CQzUsIGJ1dCBiaXQgMyBvZiB0aGUgbG93ZXIgbmliYmxlIGlzIHVzZWQgZm9yIHJ1bWJsaW5nIGFuZCBiaXQgMiBpcyBpZ25vcmVkLgoJcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rID0gZGF0YSAmIDB4MDM7CglwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmtQb3NpdGlvbiA9IChwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgPDwgMTMpIC0gMHhBMDAwOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5IdUMzV3JpdGVSQU1CYW5rID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJLy9IdUMzIFJBTSBiYW5rIHN3aXRjaGluZwoJcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rID0gZGF0YSAmIDB4MDM7CglwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmtQb3NpdGlvbiA9IChwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgPDwgMTMpIC0gMHhBMDAwOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5jYXJ0SWdub3JlV3JpdGUgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkvL1dlIG1pZ2h0IGhhdmUgZW5jb3VudGVyZWQgaWxsZWdhbCBSQU0gd3JpdGluZyBvciBzdWNoLCBzbyBqdXN0IGRvIG5vdGhpbmcuLi4KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5V3JpdGVOb3JtYWwgPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CglwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdID0gZGF0YTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5SGlnaFdyaXRlTm9ybWFsID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJcGFyZW50T2JqLm1lbW9yeVsweEZGMDAgfCBhZGRyZXNzXSA9IGRhdGE7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVdyaXRlTUJDUkFNID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJaWYgKHBhcmVudE9iai5NQkNSQU1CYW5rc0VuYWJsZWQgfHwgc2V0dGluZ3NbMTBdKSB7CgkJcGFyZW50T2JqLk1CQ1JhbVthZGRyZXNzICsgcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rUG9zaXRpb25dID0gZGF0YTsKCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5V3JpdGVNQkMzUkFNID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJaWYgKHBhcmVudE9iai5NQkNSQU1CYW5rc0VuYWJsZWQgfHwgc2V0dGluZ3NbMTBdKSB7CgkJc3dpdGNoIChwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmspIHsKCQkJY2FzZSAweDAwOgoJCQljYXNlIDB4MDE6CgkJCWNhc2UgMHgwMjoKCQkJY2FzZSAweDAzOgoJCQkJcGFyZW50T2JqLk1CQ1JhbVthZGRyZXNzICsgcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rUG9zaXRpb25dID0gZGF0YTsKCQkJCWJyZWFrOwoJCQljYXNlIDB4MDg6CgkJCQlpZiAoZGF0YSA8IDYwKSB7CgkJCQkJcGFyZW50T2JqLlJUQ1NlY29uZHMgPSBkYXRhOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJY291dCgiKEJhbmsgIyIgKyBwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgKyAiKSBSVEMgd3JpdGUgb3V0IG9mIHJhbmdlOiAiICsgZGF0YSwgMSk7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAweDA5OgoJCQkJaWYgKGRhdGEgPCA2MCkgewoJCQkJCXBhcmVudE9iai5SVENNaW51dGVzID0gZGF0YTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWNvdXQoIihCYW5rICMiICsgcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rICsgIikgUlRDIHdyaXRlIG91dCBvZiByYW5nZTogIiArIGRhdGEsIDEpOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwQToKCQkJCWlmIChkYXRhIDwgMjQpIHsKCQkJCQlwYXJlbnRPYmouUlRDSG91cnMgPSBkYXRhOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJY291dCgiKEJhbmsgIyIgKyBwYXJlbnRPYmouY3Vyck1CQ1JBTUJhbmsgKyAiKSBSVEMgd3JpdGUgb3V0IG9mIHJhbmdlOiAiICsgZGF0YSwgMSk7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAweDBCOgoJCQkJcGFyZW50T2JqLlJUQ0RheXMgPSAoZGF0YSAmIDB4RkYpIHwgKHBhcmVudE9iai5SVENEYXlzICYgMHgxMDApOwoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwQzoKCQkJCXBhcmVudE9iai5SVENEYXlPdmVyRmxvdyA9IChkYXRhID4gMHg3Rik7CgkJCQlwYXJlbnRPYmouUlRDSGFsdCA9IChkYXRhICYgMHg0MCkgPT0gMHg0MDsKCQkJCXBhcmVudE9iai5SVENEYXlzID0gKChkYXRhICYgMHgxKSA8PCA4KSB8IChwYXJlbnRPYmouUlRDRGF5cyAmIDB4RkYpOwoJCQkJYnJlYWs7CgkJCWRlZmF1bHQ6CgkJCQljb3V0KCJJbnZhbGlkIE1CQzMgYmFuayBhZGRyZXNzIHNlbGVjdGVkOiAiICsgcGFyZW50T2JqLmN1cnJNQkNSQU1CYW5rLCAwKTsKCQl9Cgl9Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLm1lbW9yeVdyaXRlR0JDUkFNID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJcGFyZW50T2JqLkdCQ01lbW9yeVthZGRyZXNzICsgcGFyZW50T2JqLmdiY1JhbUJhbmtQb3NpdGlvbl0gPSBkYXRhOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5tZW1vcnlXcml0ZU9BTVJBTSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCWlmIChwYXJlbnRPYmoubW9kZVNUQVQgPCAyKSB7CQkvL09BTSBSQU0gY2Fubm90IGJlIHdyaXR0ZW4gdG8gaW4gbW9kZSAyICYgMwoJCWlmIChwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdICE9IGRhdGEpIHsKCQkJcGFyZW50T2JqLmdyYXBoaWNzSklUKCk7CgkJCXBhcmVudE9iai5tZW1vcnlbYWRkcmVzc10gPSBkYXRhOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5V3JpdGVFQ0hPR0JDUkFNID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJcGFyZW50T2JqLkdCQ01lbW9yeVthZGRyZXNzICsgcGFyZW50T2JqLmdiY1JhbUJhbmtQb3NpdGlvbkVDSE9dID0gZGF0YTsKfQpHYW1lQm95Q29yZS5wcm90b3R5cGUubWVtb3J5V3JpdGVFQ0hPTm9ybWFsID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJcGFyZW50T2JqLm1lbW9yeVthZGRyZXNzIC0gMHgyMDAwXSA9IGRhdGE7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLlZSQU1HQkRBVEFXcml0ZSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCWlmIChwYXJlbnRPYmoubW9kZVNUQVQgPCAzKSB7CS8vVlJBTSBjYW5ub3QgYmUgd3JpdHRlbiB0byBkdXJpbmcgbW9kZSAzCgkJaWYgKHBhcmVudE9iai5tZW1vcnlbYWRkcmVzc10gIT0gZGF0YSkgewoJCQkvL0pJVCB0aGUgZ3JhcGhpY3MgcmVuZGVyIHF1ZXVlOgoJCQlwYXJlbnRPYmouZ3JhcGhpY3NKSVQoKTsKCQkJcGFyZW50T2JqLm1lbW9yeVthZGRyZXNzXSA9IGRhdGE7CgkJCXBhcmVudE9iai5nZW5lcmF0ZUdCT0FNVGlsZUxpbmUoYWRkcmVzcyk7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5WUkFNR0JEQVRBVXBwZXJXcml0ZSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCWlmIChwYXJlbnRPYmoubW9kZVNUQVQgPCAzKSB7CS8vVlJBTSBjYW5ub3QgYmUgd3JpdHRlbiB0byBkdXJpbmcgbW9kZSAzCgkJaWYgKHBhcmVudE9iai5tZW1vcnlbYWRkcmVzc10gIT0gZGF0YSkgewoJCQkvL0pJVCB0aGUgZ3JhcGhpY3MgcmVuZGVyIHF1ZXVlOgoJCQlwYXJlbnRPYmouZ3JhcGhpY3NKSVQoKTsKCQkJcGFyZW50T2JqLm1lbW9yeVthZGRyZXNzXSA9IGRhdGE7CgkJCXBhcmVudE9iai5nZW5lcmF0ZUdCVGlsZUxpbmUoYWRkcmVzcyk7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5WUkFNR0JDREFUQVdyaXRlID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJaWYgKHBhcmVudE9iai5tb2RlU1RBVCA8IDMpIHsJLy9WUkFNIGNhbm5vdCBiZSB3cml0dGVuIHRvIGR1cmluZyBtb2RlIDMKCQlpZiAocGFyZW50T2JqLmN1cnJWUkFNQmFuayA9PSAwKSB7CgkJCWlmIChwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdICE9IGRhdGEpIHsKCQkJCS8vSklUIHRoZSBncmFwaGljcyByZW5kZXIgcXVldWU6CgkJCQlwYXJlbnRPYmouZ3JhcGhpY3NKSVQoKTsKCQkJCXBhcmVudE9iai5tZW1vcnlbYWRkcmVzc10gPSBkYXRhOwoJCQkJcGFyZW50T2JqLmdlbmVyYXRlR0JDVGlsZUxpbmVCYW5rMShhZGRyZXNzKTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJYWRkcmVzcyAmPSAweDFGRkY7CgkJCWlmIChwYXJlbnRPYmouVlJBTVthZGRyZXNzXSAhPSBkYXRhKSB7CgkJCQkvL0pJVCB0aGUgZ3JhcGhpY3MgcmVuZGVyIHF1ZXVlOgoJCQkJcGFyZW50T2JqLmdyYXBoaWNzSklUKCk7CgkJCQlwYXJlbnRPYmouVlJBTVthZGRyZXNzXSA9IGRhdGE7CgkJCQlwYXJlbnRPYmouZ2VuZXJhdGVHQkNUaWxlTGluZUJhbmsyKGFkZHJlc3MpOwoJCQl9CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5WUkFNR0JDSFJNQVBXcml0ZSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCWlmIChwYXJlbnRPYmoubW9kZVNUQVQgPCAzKSB7CS8vVlJBTSBjYW5ub3QgYmUgd3JpdHRlbiB0byBkdXJpbmcgbW9kZSAzCgkJYWRkcmVzcyAmPSAweDdGRjsKCQlpZiAocGFyZW50T2JqLkJHQ0hSQmFuazFbYWRkcmVzc10gIT0gZGF0YSkgewoJCQkvL0pJVCB0aGUgZ3JhcGhpY3MgcmVuZGVyIHF1ZXVlOgoJCQlwYXJlbnRPYmouZ3JhcGhpY3NKSVQoKTsKCQkJcGFyZW50T2JqLkJHQ0hSQmFuazFbYWRkcmVzc10gPSBkYXRhOwoJCX0KCX0KfQpHYW1lQm95Q29yZS5wcm90b3R5cGUuVlJBTUdCQ0NIUk1BUFdyaXRlID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJaWYgKHBhcmVudE9iai5tb2RlU1RBVCA8IDMpIHsJLy9WUkFNIGNhbm5vdCBiZSB3cml0dGVuIHRvIGR1cmluZyBtb2RlIDMKCQlhZGRyZXNzICY9IDB4N0ZGOwoJCWlmIChwYXJlbnRPYmouQkdDSFJDdXJyZW50QmFua1thZGRyZXNzXSAhPSBkYXRhKSB7CgkJCS8vSklUIHRoZSBncmFwaGljcyByZW5kZXIgcXVldWU6CgkJCXBhcmVudE9iai5ncmFwaGljc0pJVCgpOwoJCQlwYXJlbnRPYmouQkdDSFJDdXJyZW50QmFua1thZGRyZXNzXSA9IGRhdGE7CgkJfQoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5ETUFXcml0ZSA9IGZ1bmN0aW9uICh0aWxlc1RvVHJhbnNmZXIpIHsKCWlmICghdGhpcy5oYWx0KSB7CgkJLy9DbG9jayB0aGUgQ1BVIGZvciB0aGUgRE1BIHRyYW5zZmVyIChDUFUgaXMgaGFsdGVkIGR1cmluZyB0aGUgdHJhbnNmZXIpOgoJCXRoaXMuQ1BVVGlja3MgKz0gNCB8ICgodGlsZXNUb1RyYW5zZmVyIDw8IDUpIDw8IHRoaXMuZG91YmxlU3BlZWRTaGlmdGVyKTsKCX0KCS8vU291cmNlIGFkZHJlc3Mgb2YgdGhlIHRyYW5zZmVyOgoJdmFyIHNvdXJjZSA9ICh0aGlzLm1lbW9yeVsweEZGNTFdIDw8IDgpIHwgdGhpcy5tZW1vcnlbMHhGRjUyXTsKCS8vRGVzdGluYXRpb24gYWRkcmVzcyBpbiB0aGUgVlJBTSBtZW1vcnkgcmFuZ2U6Cgl2YXIgZGVzdGluYXRpb24gPSAodGhpcy5tZW1vcnlbMHhGRjUzXSA8PCA4KSB8IHRoaXMubWVtb3J5WzB4RkY1NF07CgkvL0NyZWF0aW5nIHNvbWUgcmVmZXJlbmNlczoKCXZhciBtZW1vcnlSZWFkZXIgPSB0aGlzLm1lbW9yeVJlYWRlcjsKCS8vSklUIHRoZSBncmFwaGljcyByZW5kZXIgcXVldWU6Cgl0aGlzLmdyYXBoaWNzSklUKCk7Cgl2YXIgbWVtb3J5ID0gdGhpcy5tZW1vcnk7CgkvL0RldGVybWluaW5nIHdoaWNoIGJhbmsgd2UncmUgd29ya2luZyBvbiBzbyB3ZSBjYW4gb3B0aW1pemU6CglpZiAodGhpcy5jdXJyVlJBTUJhbmsgPT0gMCkgewoJCS8vRE1BIHRyYW5zZmVyIGZvciBWUkFNIGJhbmsgMDoKCQlkbyB7CgkJCWlmIChkZXN0aW5hdGlvbiA8IDB4MTgwMCkgewoJCQkJbWVtb3J5WzB4ODAwMCB8IGRlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCW1lbW9yeVsweDgwMDEgfCBkZXN0aW5hdGlvbl0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQltZW1vcnlbMHg4MDAyIHwgZGVzdGluYXRpb25dID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJbWVtb3J5WzB4ODAwMyB8IGRlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCW1lbW9yeVsweDgwMDQgfCBkZXN0aW5hdGlvbl0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQltZW1vcnlbMHg4MDA1IHwgZGVzdGluYXRpb25dID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJbWVtb3J5WzB4ODAwNiB8IGRlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCW1lbW9yeVsweDgwMDcgfCBkZXN0aW5hdGlvbl0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQltZW1vcnlbMHg4MDA4IHwgZGVzdGluYXRpb25dID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJbWVtb3J5WzB4ODAwOSB8IGRlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCW1lbW9yeVsweDgwMEEgfCBkZXN0aW5hdGlvbl0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQltZW1vcnlbMHg4MDBCIHwgZGVzdGluYXRpb25dID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJbWVtb3J5WzB4ODAwQyB8IGRlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCW1lbW9yeVsweDgwMEQgfCBkZXN0aW5hdGlvbl0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQltZW1vcnlbMHg4MDBFIHwgZGVzdGluYXRpb25dID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJbWVtb3J5WzB4ODAwRiB8IGRlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCXRoaXMuZ2VuZXJhdGVHQkNUaWxlQmFuazEoZGVzdGluYXRpb24pOwoJCQkJZGVzdGluYXRpb24gKz0gMHgxMDsKCQkJfQoJCQllbHNlIHsKCQkJCWRlc3RpbmF0aW9uICY9IDB4N0YwOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsxW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJZGVzdGluYXRpb24gPSAoZGVzdGluYXRpb24gKyAweDE4MDApICYgMHgxRkYwOwoJCQl9CgkJCXNvdXJjZSAmPSAweEZGRjA7CgkJCS0tdGlsZXNUb1RyYW5zZmVyOwoJCX0gd2hpbGUgKHRpbGVzVG9UcmFuc2ZlciA+IDApOwoJfQoJZWxzZSB7CgkJdmFyIFZSQU0gPSB0aGlzLlZSQU07CgkJLy9ETUEgdHJhbnNmZXIgZm9yIFZSQU0gYmFuayAxOgoJCWRvIHsKCQkJaWYgKGRlc3RpbmF0aW9uIDwgMHgxODAwKSB7CgkJCQlWUkFNW2Rlc3RpbmF0aW9uXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCVZSQU1bZGVzdGluYXRpb24gfCAweDFdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJVlJBTVtkZXN0aW5hdGlvbiB8IDB4Ml0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQlWUkFNW2Rlc3RpbmF0aW9uIHwgMHgzXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCVZSQU1bZGVzdGluYXRpb24gfCAweDRdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJVlJBTVtkZXN0aW5hdGlvbiB8IDB4NV0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQlWUkFNW2Rlc3RpbmF0aW9uIHwgMHg2XSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCVZSQU1bZGVzdGluYXRpb24gfCAweDddID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJVlJBTVtkZXN0aW5hdGlvbiB8IDB4OF0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQlWUkFNW2Rlc3RpbmF0aW9uIHwgMHg5XSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCVZSQU1bZGVzdGluYXRpb24gfCAweEFdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJVlJBTVtkZXN0aW5hdGlvbiB8IDB4Ql0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQlWUkFNW2Rlc3RpbmF0aW9uIHwgMHhDXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCVZSQU1bZGVzdGluYXRpb24gfCAweERdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJVlJBTVtkZXN0aW5hdGlvbiB8IDB4RV0gPSBtZW1vcnlSZWFkZXJbc291cmNlXSh0aGlzLCBzb3VyY2UrKyk7CgkJCQlWUkFNW2Rlc3RpbmF0aW9uIHwgMHhGXSA9IG1lbW9yeVJlYWRlcltzb3VyY2VdKHRoaXMsIHNvdXJjZSsrKTsKCQkJCXRoaXMuZ2VuZXJhdGVHQkNUaWxlQmFuazIoZGVzdGluYXRpb24pOwoJCQkJZGVzdGluYXRpb24gKz0gMHgxMDsKCQkJfQoJCQllbHNlIHsKCQkJCWRlc3RpbmF0aW9uICY9IDB4N0YwOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJdGhpcy5CR0NIUkJhbmsyW2Rlc3RpbmF0aW9uKytdID0gbWVtb3J5UmVhZGVyW3NvdXJjZV0odGhpcywgc291cmNlKyspOwoJCQkJZGVzdGluYXRpb24gPSAoZGVzdGluYXRpb24gKyAweDE4MDApICYgMHgxRkYwOwoJCQl9CgkJCXNvdXJjZSAmPSAweEZGRjA7CgkJCS0tdGlsZXNUb1RyYW5zZmVyOwoJCX0gd2hpbGUgKHRpbGVzVG9UcmFuc2ZlciA+IDApOwoJfQoJLy9VcGRhdGUgdGhlIEhETUEgcmVnaXN0ZXJzIHRvIHRoZWlyIG5leHQgYWRkcmVzc2VzOgoJbWVtb3J5WzB4RkY1MV0gPSBzb3VyY2UgPj4gODsKCW1lbW9yeVsweEZGNTJdID0gc291cmNlICYgMHhGMDsKCW1lbW9yeVsweEZGNTNdID0gZGVzdGluYXRpb24gPj4gODsKCW1lbW9yeVsweEZGNTRdID0gZGVzdGluYXRpb24gJiAweEYwOwp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5yZWdpc3RlcldyaXRlSnVtcENvbXBpbGUgPSBmdW5jdGlvbiAoKSB7CgkvL0kvTyBSZWdpc3RlcnMgKEdCICsgR0JDKToKCS8vSm95UGFkCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMDBdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCXBhcmVudE9iai5tZW1vcnlbMHhGRjAwXSA9IChkYXRhICYgMHgzMCkgfCAoKCgoZGF0YSAmIDB4MjApID09IDApID8gKHBhcmVudE9iai5Kb3lQYWQgPj4gNCkgOiAweEYpICYgKCgoZGF0YSAmIDB4MTApID09IDApID8gKHBhcmVudE9iai5Kb3lQYWQgJiAweEYpIDogMHhGKSk7Cgl9CgkvL1NCIChTZXJpYWwgVHJhbnNmZXIgRGF0YSkKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDFdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjAxXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLm1lbW9yeVsweEZGMDJdIDwgMHg4MCkgewkvL0Nhbm5vdCB3cml0ZSB3aGlsZSBhIHNlcmlhbCB0cmFuc2ZlciBpcyBhY3RpdmUuCgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjAxXSA9IGRhdGE7CgkJfQoJfQoJLy9TQyAoU2VyaWFsIFRyYW5zZmVyIENvbnRyb2wpOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4Ml0gPSB0aGlzLm1lbW9yeUhpZ2hXcml0ZU5vcm1hbDsKCXRoaXMubWVtb3J5V3JpdGVyWzB4RkYwMl0gPSB0aGlzLm1lbW9yeVdyaXRlTm9ybWFsOwoJLy9Vbm1hcHBlZCBJL086Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgzXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYwM10gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCS8vRElWCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYwNF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJcGFyZW50T2JqLkRJVlRpY2tzICY9IDB4RkY7CS8vVXBkYXRlIERJViBmb3IgcmVhbGlnbm1lbnQuCgkJcGFyZW50T2JqLm1lbW9yeVsweEZGMDRdID0gMDsKCX0KCS8vVElNQQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMDVdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCXBhcmVudE9iai5tZW1vcnlbMHhGRjA1XSA9IGRhdGE7Cgl9CgkvL1RNQQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4Nl0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMDZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCXBhcmVudE9iai5tZW1vcnlbMHhGRjA2XSA9IGRhdGE7Cgl9CgkvL1RBQwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4N10gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMDddID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCXBhcmVudE9iai5tZW1vcnlbMHhGRjA3XSA9IGRhdGEgJiAweDA3OwoJCXBhcmVudE9iai5USU1BRW5hYmxlZCA9IChkYXRhICYgMHgwNCkgPT0gMHgwNDsKCQlwYXJlbnRPYmouVEFDQ2xvY2tlciA9IE1hdGgucG93KDQsICgoZGF0YSAmIDB4MykgIT0gMCkgPyAoZGF0YSAmIDB4MykgOiA0KSA8PCAyOwkvL1RPRE86IEZpbmQgYSB3YXkgdG8gbm90IG1ha2UgYSBjb25kaXRpb25hbCBpbiBoZXJlLi4uCgl9CgkvL1VubWFwcGVkIEkvTzoKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDhdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjA4XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4OV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMDldID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHhBXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYwQV0gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweEJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjBCXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4Q10gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMENdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHhEXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYwRF0gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweEVdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjBFXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJLy9JRiAoSW50ZXJydXB0IFJlcXVlc3QpCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHhGXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYwRl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJcGFyZW50T2JqLmludGVycnVwdHNSZXF1ZXN0ZWQgPSBkYXRhOwoJCXBhcmVudE9iai5jaGVja0lSUU1hdGNoaW5nKCk7Cgl9CgkvL05SMTA6Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgxMF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMTBdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkKSB7CgkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQlpZiAocGFyZW50T2JqLmNoYW5uZWwxZGVjcmVhc2VTd2VlcCAmJiAoZGF0YSAmIDB4MDgpID09IDApIHsKCQkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDFTd2VwdCkgewoJCQkJCXBhcmVudE9iai5jaGFubmVsMVN3ZWVwRmF1bHQgPSB0cnVlOwoJCQkJfQoJCQl9CgkJCXBhcmVudE9iai5jaGFubmVsMWxhc3RUaW1lU3dlZXAgPSAoZGF0YSAmIDB4NzApID4+IDQ7CgkJCXBhcmVudE9iai5jaGFubmVsMWZyZXF1ZW5jeVN3ZWVwRGl2aWRlciA9IGRhdGEgJiAweDA3OwoJCQlwYXJlbnRPYmouY2hhbm5lbDFkZWNyZWFzZVN3ZWVwID0gKChkYXRhICYgMHgwOCkgPT0gMHgwOCk7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjEwXSA9IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsMUVuYWJsZUNoZWNrKCk7CgkJfQoJfQoJLy9OUjExOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MTFdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjExXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCB8fCAhcGFyZW50T2JqLmNHQkMpIHsKCQkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQpIHsKCQkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQl9CgkJCWVsc2UgewoJCQkJZGF0YSAmPSAweDNGOwoJCQl9CgkJCXBhcmVudE9iai5jaGFubmVsMUNhY2hlZER1dHkgPSBwYXJlbnRPYmouZHV0eUxvb2t1cFtkYXRhID4+IDZdOwoJCQlwYXJlbnRPYmouY2hhbm5lbDF0b3RhbExlbmd0aCA9IDB4NDAgLSAoZGF0YSAmIDB4M0YpOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYxMV0gPSBkYXRhOwoJCQlwYXJlbnRPYmouY2hhbm5lbDFFbmFibGVDaGVjaygpOwoJCX0KCX0KCS8vTlIxMjoKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDEyXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYxMl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQpIHsKCQkJcGFyZW50T2JqLmF1ZGlvSklUKCk7CgkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDFFbmFibGVkICYmIHBhcmVudE9iai5jaGFubmVsMWVudmVsb3BlU3dlZXBzID09IDApIHsKCQkJCS8vWm9tYmllIFZvbHVtZSBQQVBVIEJ1ZzoKCQkJCWlmICgoKHBhcmVudE9iai5tZW1vcnlbMHhGRjEyXSBeIGRhdGEpICYgMHg4KSA9PSAweDgpIHsKCQkJCQlpZiAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjEyXSAmIDB4OCkgPT0gMCkgewoJCQkJCQlpZiAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjEyXSAmIDB4NykgPT0gMHg3KSB7CgkJCQkJCQlwYXJlbnRPYmouY2hhbm5lbDFlbnZlbG9wZVZvbHVtZSArPSAyOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJKytwYXJlbnRPYmouY2hhbm5lbDFlbnZlbG9wZVZvbHVtZTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlwYXJlbnRPYmouY2hhbm5lbDFlbnZlbG9wZVZvbHVtZSA9ICgxNiAtIHBhcmVudE9iai5jaGFubmVsMWVudmVsb3BlVm9sdW1lKSAmIDB4RjsKCQkJCX0KCQkJCWVsc2UgaWYgKChwYXJlbnRPYmoubWVtb3J5WzB4RkYxMl0gJiAweEYpID09IDB4OCkgewoJCQkJCXBhcmVudE9iai5jaGFubmVsMWVudmVsb3BlVm9sdW1lID0gKDEgKyBwYXJlbnRPYmouY2hhbm5lbDFlbnZlbG9wZVZvbHVtZSkgJiAweEY7CgkJCQl9CgkJCQlwYXJlbnRPYmouY2hhbm5lbDFPdXRwdXRMZXZlbENhY2hlKCk7CgkJCX0KCQkJcGFyZW50T2JqLmNoYW5uZWwxZW52ZWxvcGVUeXBlID0gKChkYXRhICYgMHgwOCkgPT0gMHgwOCk7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjEyXSA9IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsMVZvbHVtZUVuYWJsZUNoZWNrKCk7CgkJfQoJfQoJLy9OUjEzOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MTNdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjEzXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJcGFyZW50T2JqLmNoYW5uZWwxZnJlcXVlbmN5ID0gKHBhcmVudE9iai5jaGFubmVsMWZyZXF1ZW5jeSAmIDB4NzAwKSB8IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsMUZyZXF1ZW5jeVRyYWNrZXIgPSAoMHg4MDAgLSBwYXJlbnRPYmouY2hhbm5lbDFmcmVxdWVuY3kpIDw8IDI7CgkJfQoJfQoJLy9OUjE0OgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MTRdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjE0XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJcGFyZW50T2JqLmNoYW5uZWwxY29uc2VjdXRpdmUgPSAoKGRhdGEgJiAweDQwKSA9PSAweDApOwoJCQlwYXJlbnRPYmouY2hhbm5lbDFmcmVxdWVuY3kgPSAoKGRhdGEgJiAweDcpIDw8IDgpIHwgKHBhcmVudE9iai5jaGFubmVsMWZyZXF1ZW5jeSAmIDB4RkYpOwoJCQlwYXJlbnRPYmouY2hhbm5lbDFGcmVxdWVuY3lUcmFja2VyID0gKDB4ODAwIC0gcGFyZW50T2JqLmNoYW5uZWwxZnJlcXVlbmN5KSA8PCAyOwoJCQlpZiAoZGF0YSA+IDB4N0YpIHsKCQkJCS8vUmVsb2FkIDB4RkYxMDoKCQkJCXBhcmVudE9iai5jaGFubmVsMXRpbWVTd2VlcCA9IHBhcmVudE9iai5jaGFubmVsMWxhc3RUaW1lU3dlZXA7CgkJCQlwYXJlbnRPYmouY2hhbm5lbDFTd2VwdCA9IGZhbHNlOwoJCQkJLy9SZWxvYWQgMHhGRjEyOgoJCQkJdmFyIG5yMTIgPSBwYXJlbnRPYmoubWVtb3J5WzB4RkYxMl07CgkJCQlwYXJlbnRPYmouY2hhbm5lbDFlbnZlbG9wZVZvbHVtZSA9IG5yMTIgPj4gNDsKCQkJCXBhcmVudE9iai5jaGFubmVsMU91dHB1dExldmVsQ2FjaGUoKTsKCQkJCXBhcmVudE9iai5jaGFubmVsMWVudmVsb3BlU3dlZXBzTGFzdCA9IChucjEyICYgMHg3KSAtIDE7CgkJCQlpZiAocGFyZW50T2JqLmNoYW5uZWwxdG90YWxMZW5ndGggPT0gMCkgewoJCQkJCXBhcmVudE9iai5jaGFubmVsMXRvdGFsTGVuZ3RoID0gMHg0MDsKCQkJCX0KCQkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDFsYXN0VGltZVN3ZWVwID4gMCB8fCBwYXJlbnRPYmouY2hhbm5lbDFmcmVxdWVuY3lTd2VlcERpdmlkZXIgPiAwKSB7CgkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGMjZdIHw9IDB4MTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSAmPSAweEZFOwoJCQkJfQoJCQkJaWYgKChkYXRhICYgMHg0MCkgPT0gMHg0MCkgewoJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSB8PSAweDE7CgkJCQl9CgkJCQlwYXJlbnRPYmouY2hhbm5lbDFTaGFkb3dGcmVxdWVuY3kgPSBwYXJlbnRPYmouY2hhbm5lbDFmcmVxdWVuY3k7CgkJCQkvL1Jlc2V0IGZyZXF1ZW5jeSBvdmVyZmxvdyBjaGVjayArIGZyZXF1ZW5jeSBzd2VlcCB0eXBlIGNoZWNrOgoJCQkJcGFyZW50T2JqLmNoYW5uZWwxU3dlZXBGYXVsdCA9IGZhbHNlOwoJCQkJLy9TdXBwb3NlZCB0byBydW4gaW1tZWRpYXRlbHk6CgkJCQlwYXJlbnRPYmouY2hhbm5lbDFBdWRpb1N3ZWVwUGVyZm9ybUR1bW15KCk7CgkJCX0KCQkJcGFyZW50T2JqLmNoYW5uZWwxRW5hYmxlQ2hlY2soKTsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGMTRdID0gZGF0YTsKCQl9Cgl9CgkvL05SMjAgKFVudXNlZCBJL08pOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MTVdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjE1XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJLy9OUjIxOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MTZdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjE2XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCB8fCAhcGFyZW50T2JqLmNHQkMpIHsKCQkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQpIHsKCQkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQl9CgkJCWVsc2UgewoJCQkJZGF0YSAmPSAweDNGOwoJCQl9CgkJCXBhcmVudE9iai5jaGFubmVsMkNhY2hlZER1dHkgPSBwYXJlbnRPYmouZHV0eUxvb2t1cFtkYXRhID4+IDZdOwoJCQlwYXJlbnRPYmouY2hhbm5lbDJ0b3RhbExlbmd0aCA9IDB4NDAgLSAoZGF0YSAmIDB4M0YpOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYxNl0gPSBkYXRhOwoJCQlwYXJlbnRPYmouY2hhbm5lbDJFbmFibGVDaGVjaygpOwoJCX0KCX0KCS8vTlIyMjoKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDE3XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYxN10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQpIHsKCQkJcGFyZW50T2JqLmF1ZGlvSklUKCk7CgkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDJFbmFibGVkICYmIHBhcmVudE9iai5jaGFubmVsMmVudmVsb3BlU3dlZXBzID09IDApIHsKCQkJCS8vWm9tYmllIFZvbHVtZSBQQVBVIEJ1ZzoKCQkJCWlmICgoKHBhcmVudE9iai5tZW1vcnlbMHhGRjE3XSBeIGRhdGEpICYgMHg4KSA9PSAweDgpIHsKCQkJCQlpZiAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjE3XSAmIDB4OCkgPT0gMCkgewoJCQkJCQlpZiAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjE3XSAmIDB4NykgPT0gMHg3KSB7CgkJCQkJCQlwYXJlbnRPYmouY2hhbm5lbDJlbnZlbG9wZVZvbHVtZSArPSAyOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJKytwYXJlbnRPYmouY2hhbm5lbDJlbnZlbG9wZVZvbHVtZTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlwYXJlbnRPYmouY2hhbm5lbDJlbnZlbG9wZVZvbHVtZSA9ICgxNiAtIHBhcmVudE9iai5jaGFubmVsMmVudmVsb3BlVm9sdW1lKSAmIDB4RjsKCQkJCX0KCQkJCWVsc2UgaWYgKChwYXJlbnRPYmoubWVtb3J5WzB4RkYxN10gJiAweEYpID09IDB4OCkgewoJCQkJCXBhcmVudE9iai5jaGFubmVsMmVudmVsb3BlVm9sdW1lID0gKDEgKyBwYXJlbnRPYmouY2hhbm5lbDJlbnZlbG9wZVZvbHVtZSkgJiAweEY7CgkJCQl9CgkJCQlwYXJlbnRPYmouY2hhbm5lbDJPdXRwdXRMZXZlbENhY2hlKCk7CgkJCX0KCQkJcGFyZW50T2JqLmNoYW5uZWwyZW52ZWxvcGVUeXBlID0gKChkYXRhICYgMHgwOCkgPT0gMHgwOCk7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjE3XSA9IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsMlZvbHVtZUVuYWJsZUNoZWNrKCk7CgkJfQoJfQoJLy9OUjIzOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MThdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjE4XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJcGFyZW50T2JqLmNoYW5uZWwyZnJlcXVlbmN5ID0gKHBhcmVudE9iai5jaGFubmVsMmZyZXF1ZW5jeSAmIDB4NzAwKSB8IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsMkZyZXF1ZW5jeVRyYWNrZXIgPSAoMHg4MDAgLSBwYXJlbnRPYmouY2hhbm5lbDJmcmVxdWVuY3kpIDw8IDI7CgkJfQoJfQoJLy9OUjI0OgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MTldID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjE5XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJaWYgKGRhdGEgPiAweDdGKSB7CgkJCQkvL1JlbG9hZCAweEZGMTc6CgkJCQl2YXIgbnIyMiA9IHBhcmVudE9iai5tZW1vcnlbMHhGRjE3XTsKCQkJCXBhcmVudE9iai5jaGFubmVsMmVudmVsb3BlVm9sdW1lID0gbnIyMiA+PiA0OwoJCQkJcGFyZW50T2JqLmNoYW5uZWwyT3V0cHV0TGV2ZWxDYWNoZSgpOwoJCQkJcGFyZW50T2JqLmNoYW5uZWwyZW52ZWxvcGVTd2VlcHNMYXN0ID0gKG5yMjIgJiAweDcpIC0gMTsKCQkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDJ0b3RhbExlbmd0aCA9PSAwKSB7CgkJCQkJcGFyZW50T2JqLmNoYW5uZWwydG90YWxMZW5ndGggPSAweDQwOwoJCQkJfQoJCQkJaWYgKChkYXRhICYgMHg0MCkgPT0gMHg0MCkgewoJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSB8PSAweDI7CgkJCQl9CgkJCX0KCQkJcGFyZW50T2JqLmNoYW5uZWwyY29uc2VjdXRpdmUgPSAoKGRhdGEgJiAweDQwKSA9PSAweDApOwoJCQlwYXJlbnRPYmouY2hhbm5lbDJmcmVxdWVuY3kgPSAoKGRhdGEgJiAweDcpIDw8IDgpIHwgKHBhcmVudE9iai5jaGFubmVsMmZyZXF1ZW5jeSAmIDB4RkYpOwoJCQlwYXJlbnRPYmouY2hhbm5lbDJGcmVxdWVuY3lUcmFja2VyID0gKDB4ODAwIC0gcGFyZW50T2JqLmNoYW5uZWwyZnJlcXVlbmN5KSA8PCAyOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYxOV0gPSBkYXRhOwoJCQlwYXJlbnRPYmouY2hhbm5lbDJFbmFibGVDaGVjaygpOwoJCX0KCX0KCS8vTlIzMDoKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDFBXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYxQV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQpIHsKCQkJcGFyZW50T2JqLmF1ZGlvSklUKCk7CgkJCWlmICghcGFyZW50T2JqLmNoYW5uZWwzY2FuUGxheSAmJiBkYXRhID49IDB4ODApIHsKCQkJCXBhcmVudE9iai5jaGFubmVsM2xhc3RTYW1wbGVMb29rdXAgPSAwOwoJCQkJcGFyZW50T2JqLmNoYW5uZWwzVXBkYXRlQ2FjaGUoKTsKCQkJfQoJCQlwYXJlbnRPYmouY2hhbm5lbDNjYW5QbGF5ID0gKGRhdGEgPiAweDdGKTsKCQkJaWYgKHBhcmVudE9iai5jaGFubmVsM2NhblBsYXkgJiYgcGFyZW50T2JqLm1lbW9yeVsweEZGMUFdID4gMHg3RiAmJiAhcGFyZW50T2JqLmNoYW5uZWwzY29uc2VjdXRpdmUpIHsKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSB8PSAweDQ7CgkJCX0KCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGMUFdID0gZGF0YTsKCQkJLy9wYXJlbnRPYmouY2hhbm5lbDNFbmFibGVDaGVjaygpOwoJCX0KCX0KCS8vTlIzMToKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDFCXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYxQl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQgfHwgIXBhcmVudE9iai5jR0JDKSB7CgkJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkKSB7CgkJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJfQoJCQlwYXJlbnRPYmouY2hhbm5lbDN0b3RhbExlbmd0aCA9IDB4MTAwIC0gZGF0YTsKCQkJcGFyZW50T2JqLmNoYW5uZWwzRW5hYmxlQ2hlY2soKTsKCQl9Cgl9CgkvL05SMzI6Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgxQ10gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMUNdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkKSB7CgkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQlkYXRhICY9IDB4NjA7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjFDXSA9IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsM3BhdHRlcm5UeXBlID0gKGRhdGEgPT0gMCkgPyA0IDogKChkYXRhID4+IDUpIC0gMSk7CgkJfQoJfQoJLy9OUjMzOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MURdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjFEXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJcGFyZW50T2JqLmNoYW5uZWwzZnJlcXVlbmN5ID0gKHBhcmVudE9iai5jaGFubmVsM2ZyZXF1ZW5jeSAmIDB4NzAwKSB8IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsM0ZyZXF1ZW5jeVBlcmlvZCA9ICgweDgwMCAtIHBhcmVudE9iai5jaGFubmVsM2ZyZXF1ZW5jeSkgPDwgMTsKCQl9Cgl9CgkvL05SMzQ6Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgxRV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMUVdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkKSB7CgkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQlpZiAoZGF0YSA+IDB4N0YpIHsKCQkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDN0b3RhbExlbmd0aCA9PSAwKSB7CgkJCQkJcGFyZW50T2JqLmNoYW5uZWwzdG90YWxMZW5ndGggPSAweDEwMDsKCQkJCX0KCQkJCXBhcmVudE9iai5jaGFubmVsM2xhc3RTYW1wbGVMb29rdXAgPSAwOwoJCQkJaWYgKChkYXRhICYgMHg0MCkgPT0gMHg0MCkgewoJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSB8PSAweDQ7CgkJCQl9CgkJCX0KCQkJcGFyZW50T2JqLmNoYW5uZWwzY29uc2VjdXRpdmUgPSAoKGRhdGEgJiAweDQwKSA9PSAweDApOwoJCQlwYXJlbnRPYmouY2hhbm5lbDNmcmVxdWVuY3kgPSAoKGRhdGEgJiAweDcpIDw8IDgpIHwgKHBhcmVudE9iai5jaGFubmVsM2ZyZXF1ZW5jeSAmIDB4RkYpOwoJCQlwYXJlbnRPYmouY2hhbm5lbDNGcmVxdWVuY3lQZXJpb2QgPSAoMHg4MDAgLSBwYXJlbnRPYmouY2hhbm5lbDNmcmVxdWVuY3kpIDw8IDE7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjFFXSA9IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsM0VuYWJsZUNoZWNrKCk7CgkJfQoJfQoJLy9OUjQwIChVbnVzZWQgSS9PKToKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDFGXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYxRl0gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCS8vTlI0MToKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDIwXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYyMF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQgfHwgIXBhcmVudE9iai5jR0JDKSB7CgkJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkKSB7CgkJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJfQoJCQlwYXJlbnRPYmouY2hhbm5lbDR0b3RhbExlbmd0aCA9IDB4NDAgLSAoZGF0YSAmIDB4M0YpOwoJCQlwYXJlbnRPYmouY2hhbm5lbDRFbmFibGVDaGVjaygpOwoJCX0KCX0KCS8vTlI0MjoKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDIxXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYyMV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQpIHsKCQkJcGFyZW50T2JqLmF1ZGlvSklUKCk7CgkJCWlmIChwYXJlbnRPYmouY2hhbm5lbDRFbmFibGVkICYmIHBhcmVudE9iai5jaGFubmVsNGVudmVsb3BlU3dlZXBzID09IDApIHsKCQkJCS8vWm9tYmllIFZvbHVtZSBQQVBVIEJ1ZzoKCQkJCWlmICgoKHBhcmVudE9iai5tZW1vcnlbMHhGRjIxXSBeIGRhdGEpICYgMHg4KSA9PSAweDgpIHsKCQkJCQlpZiAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjIxXSAmIDB4OCkgPT0gMCkgewoJCQkJCQlpZiAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjIxXSAmIDB4NykgPT0gMHg3KSB7CgkJCQkJCQlwYXJlbnRPYmouY2hhbm5lbDRlbnZlbG9wZVZvbHVtZSArPSAyOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJKytwYXJlbnRPYmouY2hhbm5lbDRlbnZlbG9wZVZvbHVtZTsKCQkJCQkJfQoJCQkJCX0KCQkJCQlwYXJlbnRPYmouY2hhbm5lbDRlbnZlbG9wZVZvbHVtZSA9ICgxNiAtIHBhcmVudE9iai5jaGFubmVsNGVudmVsb3BlVm9sdW1lKSAmIDB4RjsKCQkJCX0KCQkJCWVsc2UgaWYgKChwYXJlbnRPYmoubWVtb3J5WzB4RkYyMV0gJiAweEYpID09IDB4OCkgewoJCQkJCXBhcmVudE9iai5jaGFubmVsNGVudmVsb3BlVm9sdW1lID0gKDEgKyBwYXJlbnRPYmouY2hhbm5lbDRlbnZlbG9wZVZvbHVtZSkgJiAweEY7CgkJCQl9CgkJCQlwYXJlbnRPYmouY2hhbm5lbDRjdXJyZW50Vm9sdW1lID0gcGFyZW50T2JqLmNoYW5uZWw0ZW52ZWxvcGVWb2x1bWUgPDwgcGFyZW50T2JqLmNoYW5uZWw0Vm9sdW1lU2hpZnRlcjsKCQkJfQoJCQlwYXJlbnRPYmouY2hhbm5lbDRlbnZlbG9wZVR5cGUgPSAoKGRhdGEgJiAweDA4KSA9PSAweDA4KTsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGMjFdID0gZGF0YTsKCQkJcGFyZW50T2JqLmNoYW5uZWw0VXBkYXRlQ2FjaGUoKTsKCQkJcGFyZW50T2JqLmNoYW5uZWw0Vm9sdW1lRW5hYmxlQ2hlY2soKTsKCQl9Cgl9CgkvL05SNDM6Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgyMl0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMjJdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkKSB7CgkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQlwYXJlbnRPYmouY2hhbm5lbDRGcmVxdWVuY3lQZXJpb2QgPSBNYXRoLm1heCgoZGF0YSAmIDB4NykgPDwgNCwgOCkgPDwgKGRhdGEgPj4gNCk7CgkJCXZhciBiaXRXaWR0aCA9IChkYXRhICYgMHg4KTsKCQkJaWYgKChiaXRXaWR0aCA9PSAweDggJiYgcGFyZW50T2JqLmNoYW5uZWw0Qml0UmFuZ2UgPT0gMHg3RkZGKSB8fCAoYml0V2lkdGggPT0gMCAmJiBwYXJlbnRPYmouY2hhbm5lbDRCaXRSYW5nZSA9PSAweDdGKSkgewoJCQkJcGFyZW50T2JqLmNoYW5uZWw0bGFzdFNhbXBsZUxvb2t1cCA9IDA7CgkJCQlwYXJlbnRPYmouY2hhbm5lbDRCaXRSYW5nZSA9IChiaXRXaWR0aCA9PSAweDgpID8gMHg3RiA6IDB4N0ZGRjsKCQkJCXBhcmVudE9iai5jaGFubmVsNFZvbHVtZVNoaWZ0ZXIgPSAoYml0V2lkdGggPT0gMHg4KSA/IDcgOiAxNTsKCQkJCXBhcmVudE9iai5jaGFubmVsNGN1cnJlbnRWb2x1bWUgPSBwYXJlbnRPYmouY2hhbm5lbDRlbnZlbG9wZVZvbHVtZSA8PCBwYXJlbnRPYmouY2hhbm5lbDRWb2x1bWVTaGlmdGVyOwoJCQkJcGFyZW50T2JqLm5vaXNlU2FtcGxlVGFibGUgPSAoYml0V2lkdGggPT0gMHg4KSA/IHBhcmVudE9iai5MU0ZSN1RhYmxlIDogcGFyZW50T2JqLkxTRlIxNVRhYmxlOwoJCQl9CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjIyXSA9IGRhdGE7CgkJCXBhcmVudE9iai5jaGFubmVsNFVwZGF0ZUNhY2hlKCk7CgkJfQoJfQoJLy9OUjQ0OgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MjNdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjIzXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGMjNdID0gZGF0YTsKCQkJcGFyZW50T2JqLmNoYW5uZWw0Y29uc2VjdXRpdmUgPSAoKGRhdGEgJiAweDQwKSA9PSAweDApOwoJCQlpZiAoZGF0YSA+IDB4N0YpIHsKCQkJCXZhciBucjQyID0gcGFyZW50T2JqLm1lbW9yeVsweEZGMjFdOwoJCQkJcGFyZW50T2JqLmNoYW5uZWw0ZW52ZWxvcGVWb2x1bWUgPSBucjQyID4+IDQ7CgkJCQlwYXJlbnRPYmouY2hhbm5lbDRjdXJyZW50Vm9sdW1lID0gcGFyZW50T2JqLmNoYW5uZWw0ZW52ZWxvcGVWb2x1bWUgPDwgcGFyZW50T2JqLmNoYW5uZWw0Vm9sdW1lU2hpZnRlcjsKCQkJCXBhcmVudE9iai5jaGFubmVsNGVudmVsb3BlU3dlZXBzTGFzdCA9IChucjQyICYgMHg3KSAtIDE7CgkJCQlpZiAocGFyZW50T2JqLmNoYW5uZWw0dG90YWxMZW5ndGggPT0gMCkgewoJCQkJCXBhcmVudE9iai5jaGFubmVsNHRvdGFsTGVuZ3RoID0gMHg0MDsKCQkJCX0KCQkJCWlmICgoZGF0YSAmIDB4NDApID09IDB4NDApIHsKCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYyNl0gfD0gMHg4OwoJCQkJfQoJCQl9CgkJCXBhcmVudE9iai5jaGFubmVsNEVuYWJsZUNoZWNrKCk7CgkJfQoJfQoJLy9OUjUwOgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MjRdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjI0XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLnNvdW5kTWFzdGVyRW5hYmxlZCAmJiBwYXJlbnRPYmoubWVtb3J5WzB4RkYyNF0gIT0gZGF0YSkgewoJCQlwYXJlbnRPYmouYXVkaW9KSVQoKTsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGMjRdID0gZGF0YTsKCQkJcGFyZW50T2JqLlZpbkxlZnRDaGFubmVsTWFzdGVyVm9sdW1lID0gKChkYXRhID4+IDQpICYgMHgwNykgKyAxOwoJCQlwYXJlbnRPYmouVmluUmlnaHRDaGFubmVsTWFzdGVyVm9sdW1lID0gKGRhdGEgJiAweDA3KSArIDE7CgkJCXBhcmVudE9iai5taXhlck91dHB1dExldmVsQ2FjaGUoKTsKCQl9Cgl9CgkvL05SNTE6Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgyNV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMjVdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkICYmIHBhcmVudE9iai5tZW1vcnlbMHhGRjI1XSAhPSBkYXRhKSB7CgkJCXBhcmVudE9iai5hdWRpb0pJVCgpOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYyNV0gPSBkYXRhOwoJCQlwYXJlbnRPYmoucmlnaHRDaGFubmVsMSA9ICgoZGF0YSAmIDB4MDEpID09IDB4MDEpOwoJCQlwYXJlbnRPYmoucmlnaHRDaGFubmVsMiA9ICgoZGF0YSAmIDB4MDIpID09IDB4MDIpOwoJCQlwYXJlbnRPYmoucmlnaHRDaGFubmVsMyA9ICgoZGF0YSAmIDB4MDQpID09IDB4MDQpOwoJCQlwYXJlbnRPYmoucmlnaHRDaGFubmVsNCA9ICgoZGF0YSAmIDB4MDgpID09IDB4MDgpOwoJCQlwYXJlbnRPYmoubGVmdENoYW5uZWwxID0gKChkYXRhICYgMHgxMCkgPT0gMHgxMCk7CgkJCXBhcmVudE9iai5sZWZ0Q2hhbm5lbDIgPSAoKGRhdGEgJiAweDIwKSA9PSAweDIwKTsKCQkJcGFyZW50T2JqLmxlZnRDaGFubmVsMyA9ICgoZGF0YSAmIDB4NDApID09IDB4NDApOwoJCQlwYXJlbnRPYmoubGVmdENoYW5uZWw0ID0gKGRhdGEgPiAweDdGKTsKCQkJcGFyZW50T2JqLmNoYW5uZWwxT3V0cHV0TGV2ZWxDYWNoZSgpOwoJCQlwYXJlbnRPYmouY2hhbm5lbDJPdXRwdXRMZXZlbENhY2hlKCk7CgkJCXBhcmVudE9iai5jaGFubmVsM091dHB1dExldmVsQ2FjaGUoKTsKCQkJcGFyZW50T2JqLmNoYW5uZWw0T3V0cHV0TGV2ZWxDYWNoZSgpOwoJCX0KCX0KCS8vTlI1MjoKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDI2XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYyNl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJcGFyZW50T2JqLmF1ZGlvSklUKCk7CgkJaWYgKCFwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkICYmIGRhdGEgPiAweDdGKSB7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSA9IDB4ODA7CgkJCXBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQgPSB0cnVlOwoJCQlwYXJlbnRPYmouaW5pdGlhbGl6ZUF1ZGlvU3RhcnRTdGF0ZSgpOwoJCX0KCQllbHNlIGlmIChwYXJlbnRPYmouc291bmRNYXN0ZXJFbmFibGVkICYmIGRhdGEgPCAweDgwKSB7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjI2XSA9IDA7CgkJCXBhcmVudE9iai5zb3VuZE1hc3RlckVuYWJsZWQgPSBmYWxzZTsKCQkJLy9HQkRldiB3aWtpIHNheXMgdGhlIHJlZ2lzdGVycyBhcmUgd3JpdHRlbiB3aXRoIHplcm9zIG9uIHBvd2VyIG9mZjoKCQkJZm9yICh2YXIgaW5kZXggPSAweEZGMTA7IGluZGV4IDwgMHhGRjI2OyBpbmRleCsrKSB7CgkJCQlwYXJlbnRPYmoubWVtb3J5V3JpdGVyW2luZGV4XShwYXJlbnRPYmosIGluZGV4LCAwKTsKCQkJfQoJCX0KCX0KCS8vMHhGRjI3IHRvIDB4RkYyRiBkb24ndCBkbyBhbnl0aGluZy4uLgoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MjddID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjI3XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MjhdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjI4XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MjldID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjI5XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MkFdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjJBXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MkJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjJCXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MkNdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjJDXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MkRdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjJEXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MkVdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjJFXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MkZdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjJGXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJLy9XQVZFIFBDTSBSQU06Cgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgzMF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGMzBdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCXBhcmVudE9iai5jaGFubmVsM1dyaXRlUkFNKDAsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzFdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjMxXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDEsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjMyXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDIsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzNdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjMzXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDMsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzRdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjM0XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDQsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzVdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjM1XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDUsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzZdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjM2XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDYsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzddID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjM3XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDcsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzhdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjM4XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDgsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4MzldID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjM5XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweDksIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4M0FdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjNBXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweEEsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4M0JdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjNCXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweEIsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4M0NdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjNDXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweEMsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4M0RdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjNEXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweEQsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4M0VdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjNFXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweEUsIGRhdGEpOwoJfQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4M0ZdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjNGXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlwYXJlbnRPYmouY2hhbm5lbDNXcml0ZVJBTSgweEYsIGRhdGEpOwoJfQoJLy9TQ1kKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDQyXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY0Ml0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5iYWNrZ3JvdW5kWSAhPSBkYXRhKSB7CgkJCXBhcmVudE9iai5taWRTY2FuTGluZUpJVCgpOwoJCQlwYXJlbnRPYmouYmFja2dyb3VuZFkgPSBkYXRhOwoJCX0KCX0KCS8vU0NYCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0M10gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDNdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmouYmFja2dyb3VuZFggIT0gZGF0YSkgewoJCQlwYXJlbnRPYmoubWlkU2NhbkxpbmVKSVQoKTsKCQkJcGFyZW50T2JqLmJhY2tncm91bmRYID0gZGF0YTsKCQl9Cgl9CgkvL0xZCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0NF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDRdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCS8vUmVhZCBPbmx5OgoJCWlmIChwYXJlbnRPYmouTENEaXNPbikgewoJCQkvL0dhbWJhdHRlIHNheXMgdG8gZG8gdGhpczoKCQkJcGFyZW50T2JqLm1vZGVTVEFUID0gMjsKCQkJcGFyZW50T2JqLm1pZFNjYW5saW5lT2Zmc2V0ID0gLTE7CgkJCXBhcmVudE9iai50b3RhbExpbmVzUGFzc2VkID0gcGFyZW50T2JqLmN1cnJlbnRYID0gcGFyZW50T2JqLnF1ZXVlZFNjYW5MaW5lcyA9IHBhcmVudE9iai5sYXN0VW5yZW5kZXJlZExpbmUgPSBwYXJlbnRPYmouTENEVGlja3MgPSBwYXJlbnRPYmouU1RBVFRyYWNrZXIgPSBwYXJlbnRPYmouYWN0dWFsU2NhbkxpbmUgPSBwYXJlbnRPYmoubWVtb3J5WzB4RkY0NF0gPSAwOwoJCX0KCX0KCS8vTFlDCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0NV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDVdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCWlmIChwYXJlbnRPYmoubWVtb3J5WzB4RkY0NV0gIT0gZGF0YSkgewoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0NV0gPSBkYXRhOwoJCQlpZiAocGFyZW50T2JqLkxDRGlzT24pIHsKCQkJCXBhcmVudE9iai5tYXRjaExZQygpOwkvL0dldCB0aGUgY29tcGFyZSBvZiB0aGUgZmlyc3Qgc2NhbiBsaW5lLgoJCQl9CgkJfQoJfQoJLy9XWQoJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NEFdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjRBXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQlpZiAocGFyZW50T2JqLndpbmRvd1kgIT0gZGF0YSkgewoJCQlwYXJlbnRPYmoubWlkU2NhbkxpbmVKSVQoKTsKCQkJcGFyZW50T2JqLndpbmRvd1kgPSBkYXRhOwoJCX0KCX0KCS8vV1gKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDRCXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY0Ql0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJaWYgKHBhcmVudE9iai5tZW1vcnlbMHhGRjRCXSAhPSBkYXRhKSB7CgkJCXBhcmVudE9iai5taWRTY2FuTGluZUpJVCgpOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0Ql0gPSBkYXRhOwoJCQlwYXJlbnRPYmoud2luZG93WCA9IGRhdGEgLSA3OwoJCX0KCX0KCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDcyXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3Ml0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJcGFyZW50T2JqLm1lbW9yeVsweEZGNzJdID0gZGF0YTsKCX0KCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDczXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3M10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJcGFyZW50T2JqLm1lbW9yeVsweEZGNzNdID0gZGF0YTsKCX0KCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDc1XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3NV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJcGFyZW50T2JqLm1lbW9yeVsweEZGNzVdID0gZGF0YTsKCX0KCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDc2XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3Nl0gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDc3XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3N10gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCS8vSUUgKEludGVycnVwdCBFbmFibGUpCgl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHhGRl0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGRkZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCXBhcmVudE9iai5pbnRlcnJ1cHRzRW5hYmxlZCA9IGRhdGE7CgkJcGFyZW50T2JqLmNoZWNrSVJRTWF0Y2hpbmcoKTsKCX0KCXRoaXMucmVjb21waWxlTW9kZWxTcGVjaWZpY0lPV3JpdGVIYW5kbGluZygpOwoJdGhpcy5yZWNvbXBpbGVCb290SU9Xcml0ZUhhbmRsaW5nKCk7Cn0KR2FtZUJveUNvcmUucHJvdG90eXBlLnJlY29tcGlsZU1vZGVsU3BlY2lmaWNJT1dyaXRlSGFuZGxpbmcgPSBmdW5jdGlvbiAoKSB7CglpZiAodGhpcy5jR0JDKSB7CgkJLy9HYW1lQm95IENvbG9yIFNwZWNpZmljIEkvTzoKCQkvL1NDIChTZXJpYWwgVHJhbnNmZXIgQ29udHJvbCBSZWdpc3RlcikKCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHgyXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkYwMl0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCWlmICgoKGRhdGEgJiAweDEpID09IDB4MSkpIHsKCQkJCS8vSW50ZXJuYWwgY2xvY2s6CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYwMl0gPSAoZGF0YSAmIDB4N0YpOwoJCQkJcGFyZW50T2JqLnNlcmlhbFRpbWVyID0gKChkYXRhICYgMHgyKSA9PSAwKSA/IDQwOTYgOiAxMjg7CS8vU2V0IHRoZSBTZXJpYWwgSVJRIGNvdW50ZXIuCgkJCQlwYXJlbnRPYmouc2VyaWFsU2hpZnRUaW1lciA9IHBhcmVudE9iai5zZXJpYWxTaGlmdFRpbWVyQWxsb2NhdGVkID0gKChkYXRhICYgMHgyKSA9PSAwKSA/IDUxMiA6IDE2OwkvL1NldCB0aGUgdHJhbnNmZXIgZGF0YSBzaGlmdCBjb3VudGVyLgoJCQl9CgkJCWVsc2UgewoJCQkJLy9FeHRlcm5hbCBjbG9jazoKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjAyXSA9IGRhdGE7CgkJCQlwYXJlbnRPYmouc2VyaWFsU2hpZnRUaW1lciA9IHBhcmVudE9iai5zZXJpYWxTaGlmdFRpbWVyQWxsb2NhdGVkID0gcGFyZW50T2JqLnNlcmlhbFRpbWVyID0gMDsJLy9aZXJvIHRoZSB0aW1lcnMsIHNpbmNlIHdlJ3JlIGVtdWxhdGluZyBhcyBpZiBub3RoaW5nIGlzIGNvbm5lY3RlZC4KCQkJfQoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0MF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDBdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlpZiAocGFyZW50T2JqLm1lbW9yeVsweEZGNDBdICE9IGRhdGEpIHsKCQkJCXBhcmVudE9iai5taWRTY2FuTGluZUpJVCgpOwoJCQkJdmFyIHRlbXBfdmFyID0gKGRhdGEgPiAweDdGKTsKCQkJCWlmICh0ZW1wX3ZhciAhPSBwYXJlbnRPYmouTENEaXNPbikgewoJCQkJCS8vV2hlbiB0aGUgZGlzcGxheSBtb2RlIGNoYW5nZXMuLi4KCQkJCQlwYXJlbnRPYmouTENEaXNPbiA9IHRlbXBfdmFyOwoJCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjQxXSAmPSAweDc4OwoJCQkJCXBhcmVudE9iai5taWRTY2FubGluZU9mZnNldCA9IC0xOwoJCQkJCXBhcmVudE9iai50b3RhbExpbmVzUGFzc2VkID0gcGFyZW50T2JqLmN1cnJlbnRYID0gcGFyZW50T2JqLnF1ZXVlZFNjYW5MaW5lcyA9IHBhcmVudE9iai5sYXN0VW5yZW5kZXJlZExpbmUgPSBwYXJlbnRPYmouU1RBVFRyYWNrZXIgPSBwYXJlbnRPYmouTENEVGlja3MgPSBwYXJlbnRPYmouYWN0dWFsU2NhbkxpbmUgPSBwYXJlbnRPYmoubWVtb3J5WzB4RkY0NF0gPSAwOwoJCQkJCWlmIChwYXJlbnRPYmouTENEaXNPbikgewoJCQkJCQlwYXJlbnRPYmoubW9kZVNUQVQgPSAyOwoJCQkJCQlwYXJlbnRPYmoubWF0Y2hMWUMoKTsJLy9HZXQgdGhlIGNvbXBhcmUgb2YgdGhlIGZpcnN0IHNjYW4gbGluZS4KCQkJCQkJcGFyZW50T2JqLkxDRENPTlRST0wgPSBwYXJlbnRPYmouTElORUNPTlRST0w7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlwYXJlbnRPYmoubW9kZVNUQVQgPSAwOwoJCQkJCQlwYXJlbnRPYmouTENEQ09OVFJPTCA9IHBhcmVudE9iai5ESVNQTEFZT0ZGQ09OVFJPTDsKCQkJCQkJcGFyZW50T2JqLkRpc3BsYXlTaG93T2ZmKCk7CgkJCQkJfQoJCQkJCXBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkICY9IDB4RkQ7CgkJCQl9CgkJCQlwYXJlbnRPYmouZ2Z4V2luZG93Q0hSQmFua1Bvc2l0aW9uID0gKChkYXRhICYgMHg0MCkgPT0gMHg0MCkgPyAweDQwMCA6IDA7CgkJCQlwYXJlbnRPYmouZ2Z4V2luZG93RGlzcGxheSA9ICgoZGF0YSAmIDB4MjApID09IDB4MjApOwoJCQkJcGFyZW50T2JqLmdmeEJhY2tncm91bmRCYW5rT2Zmc2V0ID0gKChkYXRhICYgMHgxMCkgPT0gMHgxMCkgPyAwIDogMHg4MDsKCQkJCXBhcmVudE9iai5nZnhCYWNrZ3JvdW5kQ0hSQmFua1Bvc2l0aW9uID0gKChkYXRhICYgMHgwOCkgPT0gMHgwOCkgPyAweDQwMCA6IDA7CgkJCQlwYXJlbnRPYmouZ2Z4U3ByaXRlTm9ybWFsSGVpZ2h0ID0gKChkYXRhICYgMHgwNCkgPT0gMCk7CgkJCQlwYXJlbnRPYmouZ2Z4U3ByaXRlU2hvdyA9ICgoZGF0YSAmIDB4MDIpID09IDB4MDIpOwoJCQkJcGFyZW50T2JqLkJHUHJpb3JpdHlFbmFibGVkID0gKChkYXRhICYgMHgwMSkgPT0gMHgwMSk7CgkJCQlwYXJlbnRPYmoucHJpb3JpdHlGbGFnZ2luZ1BhdGhSZWJ1aWxkKCk7CS8vU3BlY2lhbCBjYXNlIHRoZSBwcmlvcml0eSBmbGFnZ2luZyBhcyBhbiBvcHRpbWl6YXRpb24uCgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MF0gPSBkYXRhOwoJCQl9CgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDQxXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY0MV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCXBhcmVudE9iai5MWUNNYXRjaFRyaWdnZXJTVEFUID0gKChkYXRhICYgMHg0MCkgPT0gMHg0MCk7CgkJCXBhcmVudE9iai5tb2RlMlRyaWdnZXJTVEFUID0gKChkYXRhICYgMHgyMCkgPT0gMHgyMCk7CgkJCXBhcmVudE9iai5tb2RlMVRyaWdnZXJTVEFUID0gKChkYXRhICYgMHgxMCkgPT0gMHgxMCk7CgkJCXBhcmVudE9iai5tb2RlMFRyaWdnZXJTVEFUID0gKChkYXRhICYgMHgwOCkgPT0gMHgwOCk7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjQxXSA9IGRhdGEgJiAweDc4OwoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0Nl0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0Nl0gPSBkYXRhOwoJCQlpZiAoZGF0YSA8IDB4RTApIHsKCQkJCWRhdGEgPDw9IDg7CgkJCQlhZGRyZXNzID0gMHhGRTAwOwoJCQkJdmFyIHN0YXQgPSBwYXJlbnRPYmoubW9kZVNUQVQ7CgkJCQlwYXJlbnRPYmoubW9kZVNUQVQgPSAwOwoJCQkJdmFyIG5ld0RhdGEgPSAwOwoJCQkJZG8gewoJCQkJCW5ld0RhdGEgPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW2RhdGFdKHBhcmVudE9iaiwgZGF0YSsrKTsKCQkJCQlpZiAobmV3RGF0YSAhPSBwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3NdKSB7CgkJCQkJCS8vSklUIHRoZSBncmFwaGljcyByZW5kZXIgcXVldWU6CgkJCQkJCXBhcmVudE9iai5tb2RlU1RBVCA9IHN0YXQ7CgkJCQkJCXBhcmVudE9iai5ncmFwaGljc0pJVCgpOwoJCQkJCQlwYXJlbnRPYmoubW9kZVNUQVQgPSAwOwoJCQkJCQlwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3MrK10gPSBuZXdEYXRhOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQl9IHdoaWxlICgrK2FkZHJlc3MgPCAweEZFQTApOwoJCQkJaWYgKGFkZHJlc3MgPCAweEZFQTApIHsKCQkJCQlkbyB7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbYWRkcmVzcysrXSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbZGF0YV0ocGFyZW50T2JqLCBkYXRhKyspOwoJCQkJCQlwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3MrK10gPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW2RhdGFdKHBhcmVudE9iaiwgZGF0YSsrKTsKCQkJCQkJcGFyZW50T2JqLm1lbW9yeVthZGRyZXNzKytdID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltkYXRhXShwYXJlbnRPYmosIGRhdGErKyk7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbYWRkcmVzcysrXSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbZGF0YV0ocGFyZW50T2JqLCBkYXRhKyspOwoJCQkJCX0gd2hpbGUgKGFkZHJlc3MgPCAweEZFQTApOwoJCQkJfQoJCQkJcGFyZW50T2JqLm1vZGVTVEFUID0gc3RhdDsKCQkJfQoJCX0KCQkvL0tFWTEKCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0RF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNERdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0RF0gPSAoZGF0YSAmIDB4N0YpIHwgKHBhcmVudE9iai5tZW1vcnlbMHhGRjREXSAmIDB4ODApOwoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0Rl0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNEZdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlwYXJlbnRPYmouY3VyclZSQU1CYW5rID0gZGF0YSAmIDB4MDE7CgkJCWlmIChwYXJlbnRPYmouY3VyclZSQU1CYW5rID4gMCkgewoJCQkJcGFyZW50T2JqLkJHQ0hSQ3VycmVudEJhbmsgPSBwYXJlbnRPYmouQkdDSFJCYW5rMjsKCQkJfQoJCQllbHNlIHsKCQkJCXBhcmVudE9iai5CR0NIUkN1cnJlbnRCYW5rID0gcGFyZW50T2JqLkJHQ0hSQmFuazE7CgkJCX0KCQkJLy9Pbmx5IHdyaXRhYmxlIGJ5IEdCQy4KCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NTFdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjUxXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJaWYgKCFwYXJlbnRPYmouaGRtYVJ1bm5pbmcpIHsKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjUxXSA9IGRhdGE7CgkJCX0KCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NTJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjUyXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJaWYgKCFwYXJlbnRPYmouaGRtYVJ1bm5pbmcpIHsKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjUyXSA9IGRhdGEgJiAweEYwOwoJCQl9CgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDUzXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY1M10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCWlmICghcGFyZW50T2JqLmhkbWFSdW5uaW5nKSB7CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY1M10gPSBkYXRhICYgMHgxRjsKCQkJfQoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg1NF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNTRdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlpZiAoIXBhcmVudE9iai5oZG1hUnVubmluZykgewoJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNTRdID0gZGF0YSAmIDB4RjA7CgkJCX0KCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NTVdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjU1XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJaWYgKCFwYXJlbnRPYmouaGRtYVJ1bm5pbmcpIHsKCQkJCWlmICgoZGF0YSAmIDB4ODApID09IDApIHsKCQkJCQkvL0RNQQoJCQkJCXBhcmVudE9iai5ETUFXcml0ZSgoZGF0YSAmIDB4N0YpICsgMSk7CgkJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNTVdID0gMHhGRjsJLy9UcmFuc2ZlciBjb21wbGV0ZWQuCgkJCQl9CgkJCQllbHNlIHsKCQkJCQkvL0gtQmxhbmsgRE1BCgkJCQkJcGFyZW50T2JqLmhkbWFSdW5uaW5nID0gdHJ1ZTsKCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY1NV0gPSBkYXRhICYgMHg3RjsKCQkJCX0KCQkJfQoJCQllbHNlIGlmICgoZGF0YSAmIDB4ODApID09IDApIHsKCQkJCS8vU3RvcCBILUJsYW5rIERNQQoJCQkJcGFyZW50T2JqLmhkbWFSdW5uaW5nID0gZmFsc2U7CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY1NV0gfD0gMHg4MDsKCQkJfQoJCQllbHNlIHsKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjU1XSA9IGRhdGEgJiAweDdGOwoJCQl9CgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDY4XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY2OF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjY5XSA9IHBhcmVudE9iai5nYmNCR1Jhd1BhbGV0dGVbZGF0YSAmIDB4M0ZdOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY2OF0gPSBkYXRhOwoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg2OV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNjldID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlwYXJlbnRPYmoudXBkYXRlR0JDQkdQYWxldHRlKHBhcmVudE9iai5tZW1vcnlbMHhGRjY4XSAmIDB4M0YsIGRhdGEpOwoJCQlpZiAocGFyZW50T2JqLm1lbW9yeVsweEZGNjhdID4gMHg3RikgeyAvLyBoaWdoIGJpdCA9IGF1dG9pbmNyZW1lbnQKCQkJCXZhciBuZXh0ID0gKChwYXJlbnRPYmoubWVtb3J5WzB4RkY2OF0gKyAxKSAmIDB4M0YpOwoJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNjhdID0gKG5leHQgfCAweDgwKTsKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjY5XSA9IHBhcmVudE9iai5nYmNCR1Jhd1BhbGV0dGVbbmV4dF07CgkJCX0KCQkJZWxzZSB7CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY2OV0gPSBkYXRhOwoJCQl9CgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDZBXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY2QV0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjZCXSA9IHBhcmVudE9iai5nYmNPQkpSYXdQYWxldHRlW2RhdGEgJiAweDNGXTsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNkFdID0gZGF0YTsKCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NkJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjZCXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJcGFyZW50T2JqLnVwZGF0ZUdCQ09CSlBhbGV0dGUocGFyZW50T2JqLm1lbW9yeVsweEZGNkFdICYgMHgzRiwgZGF0YSk7CgkJCWlmIChwYXJlbnRPYmoubWVtb3J5WzB4RkY2QV0gPiAweDdGKSB7IC8vIGhpZ2ggYml0ID0gYXV0b2luY3JlbWVudAoJCQkJdmFyIG5leHQgPSAoKHBhcmVudE9iai5tZW1vcnlbMHhGRjZBXSArIDEpICYgMHgzRik7CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY2QV0gPSAobmV4dCB8IDB4ODApOwoJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNkJdID0gcGFyZW50T2JqLmdiY09CSlJhd1BhbGV0dGVbbmV4dF07CgkJCX0KCQkJZWxzZSB7CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY2Ql0gPSBkYXRhOwoJCQl9CgkJfQoJCS8vU1ZCSwoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDcwXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3MF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCXZhciBhZGRyZXNzQ2hlY2sgPSAocGFyZW50T2JqLm1lbW9yeVsweEZGNTFdIDw8IDgpIHwgcGFyZW50T2JqLm1lbW9yeVsweEZGNTJdOwkvL0Nhbm5vdCBjaGFuZ2UgdGhlIFJBTSBiYW5rIHdoaWxlIFdSQU0gaXMgdGhlIHNvdXJjZSBvZiBhIHJ1bm5pbmcgSERNQS4KCQkJaWYgKCFwYXJlbnRPYmouaGRtYVJ1bm5pbmcgfHwgYWRkcmVzc0NoZWNrIDwgMHhEMDAwIHx8IGFkZHJlc3NDaGVjayA+PSAweEUwMDApIHsKCQkJCXBhcmVudE9iai5nYmNSYW1CYW5rID0gTWF0aC5tYXgoZGF0YSAmIDB4MDcsIDEpOwkvL0JhbmsgcmFuZ2UgaXMgZnJvbSAxLTcKCQkJCXBhcmVudE9iai5nYmNSYW1CYW5rUG9zaXRpb24gPSAoKHBhcmVudE9iai5nYmNSYW1CYW5rIC0gMSkgPDwgMTIpIC0gMHhEMDAwOwoJCQkJcGFyZW50T2JqLmdiY1JhbUJhbmtQb3NpdGlvbkVDSE8gPSBwYXJlbnRPYmouZ2JjUmFtQmFua1Bvc2l0aW9uIC0gMHgyMDAwOwoJCQl9CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjcwXSA9IGRhdGE7CS8vQml0IDYgY2Fubm90IGJlIHdyaXR0ZW4gdG8uCgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDc0XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY3NF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjc0XSA9IGRhdGE7CgkJfQoJfQoJZWxzZSB7CgkJLy9GaWxsIGluIHRoZSBHYW1lQm95IENvbG9yIEkvTyByZWdpc3RlcnMgYXMgbm9ybWFsIFJBTSBmb3IgR2FtZUJveSBjb21wYXRpYmlsaXR5OgoJCS8vU0MgKFNlcmlhbCBUcmFuc2ZlciBDb250cm9sIFJlZ2lzdGVyKQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjAyXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJaWYgKCgoZGF0YSAmIDB4MSkgPT0gMHgxKSkgewoJCQkJLy9JbnRlcm5hbCBjbG9jazoKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjAyXSA9IChkYXRhICYgMHg3Rik7CgkJCQlwYXJlbnRPYmouc2VyaWFsVGltZXIgPSA0MDk2OwkvL1NldCB0aGUgU2VyaWFsIElSUSBjb3VudGVyLgoJCQkJcGFyZW50T2JqLnNlcmlhbFNoaWZ0VGltZXIgPSBwYXJlbnRPYmouc2VyaWFsU2hpZnRUaW1lckFsbG9jYXRlZCA9IDUxMjsJLy9TZXQgdGhlIHRyYW5zZmVyIGRhdGEgc2hpZnQgY291bnRlci4KCQkJfQoJCQllbHNlIHsKCQkJCS8vRXh0ZXJuYWwgY2xvY2s6CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkYwMl0gPSBkYXRhOwoJCQkJcGFyZW50T2JqLnNlcmlhbFNoaWZ0VGltZXIgPSBwYXJlbnRPYmouc2VyaWFsU2hpZnRUaW1lckFsbG9jYXRlZCA9IHBhcmVudE9iai5zZXJpYWxUaW1lciA9IDA7CS8vWmVybyB0aGUgdGltZXJzLCBzaW5jZSB3ZSdyZSBlbXVsYXRpbmcgYXMgaWYgbm90aGluZyBpcyBjb25uZWN0ZWQuCgkJCX0KCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NDBdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjQwXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJaWYgKHBhcmVudE9iai5tZW1vcnlbMHhGRjQwXSAhPSBkYXRhKSB7CgkJCQlwYXJlbnRPYmoubWlkU2NhbkxpbmVKSVQoKTsKCQkJCXZhciB0ZW1wX3ZhciA9IChkYXRhID4gMHg3Rik7CgkJCQlpZiAodGVtcF92YXIgIT0gcGFyZW50T2JqLkxDRGlzT24pIHsKCQkJCQkvL1doZW4gdGhlIGRpc3BsYXkgbW9kZSBjaGFuZ2VzLi4uCgkJCQkJcGFyZW50T2JqLkxDRGlzT24gPSB0ZW1wX3ZhcjsKCQkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MV0gJj0gMHg3ODsKCQkJCQlwYXJlbnRPYmoubWlkU2NhbmxpbmVPZmZzZXQgPSAtMTsKCQkJCQlwYXJlbnRPYmoudG90YWxMaW5lc1Bhc3NlZCA9IHBhcmVudE9iai5jdXJyZW50WCA9IHBhcmVudE9iai5xdWV1ZWRTY2FuTGluZXMgPSBwYXJlbnRPYmoubGFzdFVucmVuZGVyZWRMaW5lID0gcGFyZW50T2JqLlNUQVRUcmFja2VyID0gcGFyZW50T2JqLkxDRFRpY2tzID0gcGFyZW50T2JqLmFjdHVhbFNjYW5MaW5lID0gcGFyZW50T2JqLm1lbW9yeVsweEZGNDRdID0gMDsKCQkJCQlpZiAocGFyZW50T2JqLkxDRGlzT24pIHsKCQkJCQkJcGFyZW50T2JqLm1vZGVTVEFUID0gMjsKCQkJCQkJcGFyZW50T2JqLm1hdGNoTFlDKCk7CS8vR2V0IHRoZSBjb21wYXJlIG9mIHRoZSBmaXJzdCBzY2FuIGxpbmUuCgkJCQkJCXBhcmVudE9iai5MQ0RDT05UUk9MID0gcGFyZW50T2JqLkxJTkVDT05UUk9MOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJcGFyZW50T2JqLm1vZGVTVEFUID0gMDsKCQkJCQkJcGFyZW50T2JqLkxDRENPTlRST0wgPSBwYXJlbnRPYmouRElTUExBWU9GRkNPTlRST0w7CgkJCQkJCXBhcmVudE9iai5EaXNwbGF5U2hvd09mZigpOwoJCQkJCX0KCQkJCQlwYXJlbnRPYmouaW50ZXJydXB0c1JlcXVlc3RlZCAmPSAweEZEOwoJCQkJfQoJCQkJcGFyZW50T2JqLmdmeFdpbmRvd0NIUkJhbmtQb3NpdGlvbiA9ICgoZGF0YSAmIDB4NDApID09IDB4NDApID8gMHg0MDAgOiAwOwoJCQkJcGFyZW50T2JqLmdmeFdpbmRvd0Rpc3BsYXkgPSAoZGF0YSAmIDB4MjApID09IDB4MjA7CgkJCQlwYXJlbnRPYmouZ2Z4QmFja2dyb3VuZEJhbmtPZmZzZXQgPSAoKGRhdGEgJiAweDEwKSA9PSAweDEwKSA/IDAgOiAweDgwOwoJCQkJcGFyZW50T2JqLmdmeEJhY2tncm91bmRDSFJCYW5rUG9zaXRpb24gPSAoKGRhdGEgJiAweDA4KSA9PSAweDA4KSA/IDB4NDAwIDogMDsKCQkJCXBhcmVudE9iai5nZnhTcHJpdGVOb3JtYWxIZWlnaHQgPSAoKGRhdGEgJiAweDA0KSA9PSAwKTsKCQkJCXBhcmVudE9iai5nZnhTcHJpdGVTaG93ID0gKGRhdGEgJiAweDAyKSA9PSAweDAyOwoJCQkJcGFyZW50T2JqLmJnRW5hYmxlZCA9ICgoZGF0YSAmIDB4MDEpID09IDB4MDEpOwoJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNDBdID0gZGF0YTsKCQkJfQoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0MV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDFdID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlwYXJlbnRPYmouTFlDTWF0Y2hUcmlnZ2VyU1RBVCA9ICgoZGF0YSAmIDB4NDApID09IDB4NDApOwoJCQlwYXJlbnRPYmoubW9kZTJUcmlnZ2VyU1RBVCA9ICgoZGF0YSAmIDB4MjApID09IDB4MjApOwoJCQlwYXJlbnRPYmoubW9kZTFUcmlnZ2VyU1RBVCA9ICgoZGF0YSAmIDB4MTApID09IDB4MTApOwoJCQlwYXJlbnRPYmoubW9kZTBUcmlnZ2VyU1RBVCA9ICgoZGF0YSAmIDB4MDgpID09IDB4MDgpOwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0MV0gPSBkYXRhICYgMHg3ODsKCQkJaWYgKCghcGFyZW50T2JqLnVzZWRCb290Uk9NIHx8ICFwYXJlbnRPYmoudXNlZEdCQ0Jvb3RST00pICYmIHBhcmVudE9iai5MQ0Rpc09uICYmIHBhcmVudE9iai5tb2RlU1RBVCA8IDIpIHsKCQkJCXBhcmVudE9iai5pbnRlcnJ1cHRzUmVxdWVzdGVkIHw9IDB4MjsKCQkJCXBhcmVudE9iai5jaGVja0lSUU1hdGNoaW5nKCk7CgkJCX0KCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NDZdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjQ2XSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNDZdID0gZGF0YTsKCQkJaWYgKGRhdGEgPiAweDdGICYmIGRhdGEgPCAweEUwKSB7CS8vRE1HIGNhbm5vdCBETUEgZnJvbSB0aGUgUk9NIGJhbmtzLgoJCQkJZGF0YSA8PD0gODsKCQkJCWFkZHJlc3MgPSAweEZFMDA7CgkJCQl2YXIgc3RhdCA9IHBhcmVudE9iai5tb2RlU1RBVDsKCQkJCXBhcmVudE9iai5tb2RlU1RBVCA9IDA7CgkJCQl2YXIgbmV3RGF0YSA9IDA7CgkJCQlkbyB7CgkJCQkJbmV3RGF0YSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbZGF0YV0ocGFyZW50T2JqLCBkYXRhKyspOwoJCQkJCWlmIChuZXdEYXRhICE9IHBhcmVudE9iai5tZW1vcnlbYWRkcmVzc10pIHsKCQkJCQkJLy9KSVQgdGhlIGdyYXBoaWNzIHJlbmRlciBxdWV1ZToKCQkJCQkJcGFyZW50T2JqLm1vZGVTVEFUID0gc3RhdDsKCQkJCQkJcGFyZW50T2JqLmdyYXBoaWNzSklUKCk7CgkJCQkJCXBhcmVudE9iai5tb2RlU1RBVCA9IDA7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbYWRkcmVzcysrXSA9IG5ld0RhdGE7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0gd2hpbGUgKCsrYWRkcmVzcyA8IDB4RkVBMCk7CgkJCQlpZiAoYWRkcmVzcyA8IDB4RkVBMCkgewoJCQkJCWRvIHsKCQkJCQkJcGFyZW50T2JqLm1lbW9yeVthZGRyZXNzKytdID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltkYXRhXShwYXJlbnRPYmosIGRhdGErKyk7CgkJCQkJCXBhcmVudE9iai5tZW1vcnlbYWRkcmVzcysrXSA9IHBhcmVudE9iai5tZW1vcnlSZWFkZXJbZGF0YV0ocGFyZW50T2JqLCBkYXRhKyspOwoJCQkJCQlwYXJlbnRPYmoubWVtb3J5W2FkZHJlc3MrK10gPSBwYXJlbnRPYmoubWVtb3J5UmVhZGVyW2RhdGFdKHBhcmVudE9iaiwgZGF0YSsrKTsKCQkJCQkJcGFyZW50T2JqLm1lbW9yeVthZGRyZXNzKytdID0gcGFyZW50T2JqLm1lbW9yeVJlYWRlcltkYXRhXShwYXJlbnRPYmosIGRhdGErKyk7CgkJCQkJfSB3aGlsZSAoYWRkcmVzcyA8IDB4RkVBMCk7CgkJCQl9CgkJCQlwYXJlbnRPYmoubW9kZVNUQVQgPSBzdGF0OwoJCQl9CgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDQ3XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY0N10gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCWlmIChwYXJlbnRPYmoubWVtb3J5WzB4RkY0N10gIT0gZGF0YSkgewoJCQkJcGFyZW50T2JqLm1pZFNjYW5MaW5lSklUKCk7CgkJCQlwYXJlbnRPYmoudXBkYXRlR0JCR1BhbGV0dGUoZGF0YSk7CgkJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY0N10gPSBkYXRhOwoJCQl9CgkJfQoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDQ4XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY0OF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCWlmIChwYXJlbnRPYmoubWVtb3J5WzB4RkY0OF0gIT0gZGF0YSkgewoJCQkJcGFyZW50T2JqLm1pZFNjYW5MaW5lSklUKCk7CgkJCQlwYXJlbnRPYmoudXBkYXRlR0JPQkpQYWxldHRlKDAsIGRhdGEpOwoJCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNDhdID0gZGF0YTsKCQkJfQoJCX0KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg0OV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNDldID0gZnVuY3Rpb24gKHBhcmVudE9iaiwgYWRkcmVzcywgZGF0YSkgewoJCQlpZiAocGFyZW50T2JqLm1lbW9yeVsweEZGNDldICE9IGRhdGEpIHsKCQkJCXBhcmVudE9iai5taWRTY2FuTGluZUpJVCgpOwoJCQkJcGFyZW50T2JqLnVwZGF0ZUdCT0JKUGFsZXR0ZSg0LCBkYXRhKTsKCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjQ5XSA9IGRhdGE7CgkJCX0KCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NERdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjREXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJcGFyZW50T2JqLm1lbW9yeVsweEZGNERdID0gZGF0YTsKCQl9CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NEZdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjRGXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwkvL05vdCB3cml0YWJsZSBpbiBETUcgbW9kZS4KCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg1NV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNTVdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NjhdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjY4XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDY5XSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY2OV0gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg2QV0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNkFdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NkJdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjZCXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDZDXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY2Q10gPSB0aGlzLmNhcnRJZ25vcmVXcml0ZTsKCQl0aGlzLm1lbW9yeUhpZ2hXcml0ZXJbMHg3MF0gPSB0aGlzLm1lbW9yeVdyaXRlclsweEZGNzBdID0gdGhpcy5jYXJ0SWdub3JlV3JpdGU7CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NzRdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjc0XSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5yZWNvbXBpbGVCb290SU9Xcml0ZUhhbmRsaW5nID0gZnVuY3Rpb24gKCkgewoJLy9Cb290IEkvTyBSZWdpc3RlcnM6CglpZiAodGhpcy5pbkJvb3RzdHJhcCkgewoJCXRoaXMubWVtb3J5SGlnaFdyaXRlclsweDUwXSA9IHRoaXMubWVtb3J5V3JpdGVyWzB4RkY1MF0gPSBmdW5jdGlvbiAocGFyZW50T2JqLCBhZGRyZXNzLCBkYXRhKSB7CgkJCWNvdXQoIkJvb3QgUk9NIHJlYWRzIGJsb2NrZWQ6IEJvb3RzdHJhcCBwcm9jZXNzIGhhcyBlbmRlZC4iLCAwKTsKCQkJcGFyZW50T2JqLmluQm9vdHN0cmFwID0gZmFsc2U7CgkJCXBhcmVudE9iai5kaXNhYmxlQm9vdFJPTSgpOwkJCS8vRmlsbCBpbiB0aGUgYm9vdCBST00gcmFuZ2VzIHdpdGggUk9NICBiYW5rIDAgUk9NIHJhbmdlcwoJCQlwYXJlbnRPYmoubWVtb3J5WzB4RkY1MF0gPSBkYXRhOwkvL0JpdHMgYXJlIHN1c3RhaW5lZCBpbiBtZW1vcnk/CgkJfQoJCWlmICh0aGlzLmNHQkMpIHsKCQkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NkNdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjZDXSA9IGZ1bmN0aW9uIChwYXJlbnRPYmosIGFkZHJlc3MsIGRhdGEpIHsKCQkJCWlmIChwYXJlbnRPYmouaW5Cb290c3RyYXApIHsKCQkJCQlwYXJlbnRPYmouY0dCQyA9ICgoZGF0YSAmIDB4MSkgPT0gMCk7CgkJCQkJLy9FeGNlcHRpb24gdG8gdGhlIEdCQyBpZGVudGlmeWluZyBjb2RlOgoJCQkJCWlmIChwYXJlbnRPYmoubmFtZSArIHBhcmVudE9iai5nYW1lQ29kZSArIHBhcmVudE9iai5ST01bMHgxNDNdID09ICJHYW1lIGFuZCBXYXRjaCA1MCIpIHsKCQkJCQkJcGFyZW50T2JqLmNHQkMgPSB0cnVlOwoJCQkJCQljb3V0KCJDcmVhdGVkIGEgYm9vdCBleGNlcHRpb24gZm9yIEdhbWUgYW5kIFdhdGNoIEdhbGxlcnkgMiAoR0JDIElEIGJ5dGUgaXMgd3Jvbmcgb24gdGhlIGNhcnRyaWRnZSkuIiwgMSk7CgkJCQkJfQoJCQkJCWNvdXQoIkJvb3RlZCB0byBHQkMgTW9kZTogIiArIHBhcmVudE9iai5jR0JDLCAwKTsKCQkJCX0KCQkJCXBhcmVudE9iai5tZW1vcnlbMHhGRjZDXSA9IGRhdGE7CgkJCX0KCQl9Cgl9CgllbHNlIHsKCQkvL0xvY2tvdXQgdGhlIFJPTXMgZnJvbSBhY2Nlc3NpbmcgdGhlIEJPT1QgUk9NIGNvbnRyb2wgcmVnaXN0ZXI6CgkJdGhpcy5tZW1vcnlIaWdoV3JpdGVyWzB4NTBdID0gdGhpcy5tZW1vcnlXcml0ZXJbMHhGRjUwXSA9IHRoaXMuY2FydElnbm9yZVdyaXRlOwoJfQp9Ci8vSGVscGVyIEZ1bmN0aW9ucwpHYW1lQm95Q29yZS5wcm90b3R5cGUudG9UeXBlZEFycmF5ID0gZnVuY3Rpb24gKGJhc2VBcnJheSwgbWVtdHlwZSkgewoJdHJ5IHsKCQlpZiAoc2V0dGluZ3NbNV0pIHsKCQkJcmV0dXJuIGJhc2VBcnJheTsKCQl9CgkJaWYgKCFiYXNlQXJyYXkgfHwgIWJhc2VBcnJheS5sZW5ndGgpIHsKCQkJcmV0dXJuIFtdOwoJCX0KCQl2YXIgbGVuZ3RoID0gYmFzZUFycmF5Lmxlbmd0aDsKCQlzd2l0Y2ggKG1lbXR5cGUpIHsKCQkJY2FzZSAidWludDgiOgoJCQkJdmFyIHR5cGVkQXJyYXlUZW1wID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKCQkJCWJyZWFrOwoJCQljYXNlICJpbnQ4IjoKCQkJCXZhciB0eXBlZEFycmF5VGVtcCA9IG5ldyBJbnQ4QXJyYXkobGVuZ3RoKTsKCQkJCWJyZWFrOwoJCQljYXNlICJpbnQzMiI6CgkJCQl2YXIgdHlwZWRBcnJheVRlbXAgPSBuZXcgSW50MzJBcnJheShsZW5ndGgpOwoJCQkJYnJlYWs7CgkJCWNhc2UgImZsb2F0MzIiOgoJCQkJdmFyIHR5cGVkQXJyYXlUZW1wID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpOwoJCX0KCQlmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrKSB7CgkJCXR5cGVkQXJyYXlUZW1wW2luZGV4XSA9IGJhc2VBcnJheVtpbmRleF07CgkJfQoJCXJldHVybiB0eXBlZEFycmF5VGVtcDsKCX0KCWNhdGNoIChlcnJvcikgewoJCWNvdXQoIkNvdWxkIG5vdCBjb252ZXJ0IGFuIGFycmF5IHRvIGEgdHlwZWQgYXJyYXk6ICIgKyBlcnJvci5tZXNzYWdlLCAxKTsKCQlyZXR1cm4gYmFzZUFycmF5OwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5mcm9tVHlwZWRBcnJheSA9IGZ1bmN0aW9uIChiYXNlQXJyYXkpIHsKCXRyeSB7CgkJaWYgKCFiYXNlQXJyYXkgfHwgIWJhc2VBcnJheS5sZW5ndGgpIHsKCQkJcmV0dXJuIFtdOwoJCX0KCQl2YXIgYXJyYXlUZW1wID0gW107CgkJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGJhc2VBcnJheS5sZW5ndGg7ICsraW5kZXgpIHsKCQkJYXJyYXlUZW1wW2luZGV4XSA9IGJhc2VBcnJheVtpbmRleF07CgkJfQoJCXJldHVybiBhcnJheVRlbXA7Cgl9CgljYXRjaCAoZXJyb3IpIHsKCQljb3V0KCJDb252ZXJzaW9uIGZyb20gYSB0eXBlZCBhcnJheSBmYWlsZWQ6ICIgKyBlcnJvci5tZXNzYWdlLCAxKTsKCQlyZXR1cm4gYmFzZUFycmF5OwoJfQp9CkdhbWVCb3lDb3JlLnByb3RvdHlwZS5nZXRUeXBlZEFycmF5ID0gZnVuY3Rpb24gKGxlbmd0aCwgZGVmYXVsdFZhbHVlLCBudW1iZXJUeXBlKSB7Cgl0cnkgewoJCWlmIChzZXR0aW5nc1s1XSkgewoJCQl0aHJvdyhuZXcgRXJyb3IoIlNldHRpbmdzIGZvcmNlZCB0eXBlZCBhcnJheXMgdG8gYmUgZGlzYWJsZWQuIikpOwoJCX0KCQlzd2l0Y2ggKG51bWJlclR5cGUpIHsKCQkJY2FzZSAiaW50OCI6CgkJCQl2YXIgYXJyYXlIYW5kbGUgPSBuZXcgSW50OEFycmF5KGxlbmd0aCk7CgkJCQlicmVhazsKCQkJY2FzZSAidWludDgiOgoJCQkJdmFyIGFycmF5SGFuZGxlID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTsKCQkJCWJyZWFrOwoJCQljYXNlICJpbnQzMiI6CgkJCQl2YXIgYXJyYXlIYW5kbGUgPSBuZXcgSW50MzJBcnJheShsZW5ndGgpOwoJCQkJYnJlYWs7CgkJCWNhc2UgImZsb2F0MzIiOgoJCQkJdmFyIGFycmF5SGFuZGxlID0gbmV3IEZsb2F0MzJBcnJheShsZW5ndGgpOwoJCX0KCQlpZiAoZGVmYXVsdFZhbHVlICE9IDApIHsKCQkJdmFyIGluZGV4ID0gMDsKCQkJd2hpbGUgKGluZGV4IDwgbGVuZ3RoKSB7CgkJCQlhcnJheUhhbmRsZVtpbmRleCsrXSA9IGRlZmF1bHRWYWx1ZTsKCQkJfQoJCX0KCX0KCWNhdGNoIChlcnJvcikgewoJCWNvdXQoIkNvdWxkIG5vdCBjb252ZXJ0IGFuIGFycmF5IHRvIGEgdHlwZWQgYXJyYXk6ICIgKyBlcnJvci5tZXNzYWdlLCAxKTsKCQl2YXIgYXJyYXlIYW5kbGUgPSBbXTsKCQl2YXIgaW5kZXggPSAwOwoJCXdoaWxlIChpbmRleCA8IGxlbmd0aCkgewoJCQlhcnJheUhhbmRsZVtpbmRleCsrXSA9IGRlZmF1bHRWYWx1ZTsKCQl9Cgl9CglyZXR1cm4gYXJyYXlIYW5kbGU7Cn0K";
const GB_GameBoyIO_js = "InVzZSBzdHJpY3QiOwp2YXIgZ2FtZWJveSA9IG51bGw7CQkJCQkJLy9HYW1lQm95Q29yZSBvYmplY3QuCnZhciBnYlJ1bkludGVydmFsID0gbnVsbDsJCQkJLy9HYW1lQm95Q29yZSBUaW1lcgp2YXIgc2V0dGluZ3MgPSBbCQkJCQkJLy9Tb21lIHNldHRpbmdzLgoJd2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZigiYXVkaW89dHJ1ZSIpID4gLTEsIC8vVHVybiBvbiBzb3VuZC4KCXRydWUsCQkJCQkJCQkvL0Jvb3Qgd2l0aCBib290IFJPTSBmaXJzdD8KCWZhbHNlLAkJCQkJCQkJLy9HaXZlIHByaW9yaXR5IHRvIEdhbWVCb3kgbW9kZQoJMSwJCQkJCQkJCQkvL1ZvbHVtZSBsZXZlbCBzZXQuCgl0cnVlLAkJCQkJCQkJLy9Db2xvcml6ZSBHQiBtb2RlPwoJZmFsc2UsCQkJCQkJCQkvL0Rpc2FsbG93IHR5cGVkIGFycmF5cz8KCTgsCQkJCQkJCQkJLy9JbnRlcnZhbCBmb3IgdGhlIGVtdWxhdG9yIGxvb3AuCgkxMCwJCQkJCQkJCQkvL0F1ZGlvIGJ1ZmZlciBtaW5pbXVtIHNwYW4gYW1vdW50IG92ZXIgeCBpbnRlcnByZXRlciBpdGVyYXRpb25zLgoJMjAsCQkJCQkJCQkJLy9BdWRpbyBidWZmZXIgbWF4aW11bSBzcGFuIGFtb3VudCBvdmVyIHggaW50ZXJwcmV0ZXIgaXRlcmF0aW9ucy4KCWZhbHNlLAkJCQkJCQkJLy9PdmVycmlkZSB0byBhbGxvdyBmb3IgTUJDMSBpbnN0ZWFkIG9mIFJPTSBvbmx5IChjb21wYXRpYmlsaXR5IGZvciBicm9rZW4gM3JkLXBhcnR5IGNhcnRyaWRnZXMpLgoJZmFsc2UsCQkJCQkJCQkvL092ZXJyaWRlIE1CQyBSQU0gZGlzYWJsaW5nIGFuZCBhbHdheXMgYWxsb3cgcmVhZGluZyBhbmQgd3JpdGluZyB0byB0aGUgYmFua3MuCglmYWxzZSwJCQkJCQkJCS8vVXNlIHRoZSBHYW1lQm95IGJvb3QgUk9NIGluc3RlYWQgb2YgdGhlIEdhbWVCb3kgQ29sb3IgYm9vdCBST00uCglmYWxzZSwJCQkJCQkJCS8vU2NhbGUgdGhlIGNhbnZhcyBpbiBKUywgb3IgbGV0IHRoZSBicm93c2VyIHNjYWxlIHRoZSBjYW52YXM/Cgl0cnVlLAkJCQkJCQkJLy9Vc2UgaW1hZ2Ugc21vb3RoaW5nIGJhc2VkIHNjYWxpbmc/CiAgICBbdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZV0gICAgICAgICAgICAvL1VzZXIgY29udHJvbGxlZCBjaGFubmVsIGVuYWJsZXMuCl07CmZ1bmN0aW9uIHN0YXJ0KGNhbnZhcywgUk9NKSB7CgljbGVhckxhc3RFbXVsYXRpb24oKTsKCWF1dG9TYXZlKCk7CS8vSWYgd2UgYXJlIGFib3V0IHRvIGxvYWQgYSBuZXcgZ2FtZSwgdGhlbiBzYXZlIHRoZSBsYXN0IG9uZS4uLgoJZ2FtZWJveSA9IG5ldyBHYW1lQm95Q29yZShjYW52YXMsIFJPTSk7CglnYW1lYm95Lm9wZW5NQkMgPSBvcGVuU1JBTTsKCWdhbWVib3kub3BlblJUQyA9IG9wZW5SVEM7CglnYW1lYm95LnN0YXJ0KCk7CglydW4oKTsKfQpmdW5jdGlvbiBydW4oKSB7CglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSkgewoJCWlmICghR2FtZUJveUVtdWxhdG9yUGxheWluZygpKSB7CgkJCWdhbWVib3kuc3RvcEVtdWxhdG9yICY9IDE7CgkJCWNvdXQoIlN0YXJ0aW5nIHRoZSBpdGVyYXRvci4iLCAwKTsKCQkJdmFyIGRhdGVPYmogPSBuZXcgRGF0ZSgpOwoJCQlnYW1lYm95LmZpcnN0SXRlcmF0aW9uID0gZGF0ZU9iai5nZXRUaW1lKCk7CgkJCWdhbWVib3kuaXRlcmF0aW9ucyA9IDA7CgkJCWdiUnVuSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CgkJCQlpZiAoIWRvY3VtZW50LmhpZGRlbiAmJiAhZG9jdW1lbnQubXNIaWRkZW4gJiYgIWRvY3VtZW50Lm1vekhpZGRlbiAmJiAhZG9jdW1lbnQud2Via2l0SGlkZGVuKSB7CgkJCQkJZ2FtZWJveS5ydW4oKTsKCQkJCX0KCQkJfSwgc2V0dGluZ3NbNl0pOwoJCX0KCQllbHNlIHsKCQkJY291dCgiVGhlIEdhbWVCb3kgY29yZSBpcyBhbHJlYWR5IHJ1bm5pbmcuIiwgMSk7CgkJfQoJfQoJZWxzZSB7CgkJY291dCgiR2FtZUJveSBjb3JlIGNhbm5vdCBydW4gd2hpbGUgaXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLiIsIDEpOwoJfQp9CmZ1bmN0aW9uIHBhdXNlKCkgewoJaWYgKEdhbWVCb3lFbXVsYXRvckluaXRpYWxpemVkKCkpIHsKCQlpZiAoR2FtZUJveUVtdWxhdG9yUGxheWluZygpKSB7CgkJCWF1dG9TYXZlKCk7CgkJCWNsZWFyTGFzdEVtdWxhdGlvbigpOwoJCX0KCQllbHNlIHsKCQkJY291dCgiR2FtZUJveSBjb3JlIGhhcyBhbHJlYWR5IGJlZW4gcGF1c2VkLiIsIDEpOwoJCX0KCX0KCWVsc2UgewoJCWNvdXQoIkdhbWVCb3kgY29yZSBjYW5ub3QgYmUgcGF1c2VkIHdoaWxlIGl0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC4iLCAxKTsKCX0KfQpmdW5jdGlvbiBjbGVhckxhc3RFbXVsYXRpb24oKSB7CglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSAmJiBHYW1lQm95RW11bGF0b3JQbGF5aW5nKCkpIHsKCQljbGVhckludGVydmFsKGdiUnVuSW50ZXJ2YWwpOwoJCWdhbWVib3kuc3RvcEVtdWxhdG9yIHw9IDI7CgkJY291dCgiVGhlIHByZXZpb3VzIGVtdWxhdGlvbiBoYXMgYmVlbiBjbGVhcmVkLiIsIDApOwoJfQoJZWxzZSB7CgkJY291dCgiTm8gcHJldmlvdXMgZW11bGF0aW9uIHdhcyBmb3VuZCB0byBiZSBjbGVhcmVkLiIsIDApOwoJfQp9CmZ1bmN0aW9uIHNhdmUoKSB7CglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSkgewoJCXZhciBzdGF0ZV9zdWZmaXggPSAwOwoJCXdoaWxlIChmaW5kVmFsdWUoIkZSRUVaRV8iICsgZ2FtZWJveS5uYW1lICsgIl8iICsgc3RhdGVfc3VmZml4KSAhPSBudWxsKSB7CgkJCXN0YXRlX3N1ZmZpeCsrOwoJCX0KCQlzYXZlU3RhdGUoIkZSRUVaRV8iICsgZ2FtZWJveS5uYW1lICsgIl8iICsgc3RhdGVfc3VmZml4KTsKCX0KCWVsc2UgewoJCWNvdXQoIkdhbWVCb3kgY29yZSBjYW5ub3QgYmUgc2F2ZWQgd2hpbGUgaXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLiIsIDEpOwoJfQp9CmZ1bmN0aW9uIHNhdmVTUkFNKCkgewoJaWYgKEdhbWVCb3lFbXVsYXRvckluaXRpYWxpemVkKCkpIHsKCQlpZiAoZ2FtZWJveS5jQkFUVCkgewoJCQl0cnkgewoJCQkJdmFyIHNyYW0gPSBnYW1lYm95LnNhdmVTUkFNU3RhdGUoKTsKCQkJCWlmIChzcmFtLmxlbmd0aCA+IDApIHsKCQkJCQljb3V0KCJTYXZpbmcgdGhlIFNSQU0uLi4iLCAwKTsKCQkJCQlpZiAoZmluZFZhbHVlKCJTUkFNXyIgKyBnYW1lYm95Lm5hbWUpICE9IG51bGwpIHsKCQkJCQkJLy9SZW1vdmUgdGhlIG91dGRhdGVkIHN0b3JhZ2UgZm9ybWF0IHNhdmU6CgkJCQkJCWNvdXQoIkRlbGV0aW5nIHRoZSBvbGQgU1JBTSBzYXZlIGR1ZSB0byBvdXRkYXRlZCBmb3JtYXQuIiwgMCk7CgkJCQkJCWRlbGV0ZVZhbHVlKCJTUkFNXyIgKyBnYW1lYm95Lm5hbWUpOwoJCQkJCX0KCQkJCQlzZXRWYWx1ZSgiQjY0X1NSQU1fIiArIGdhbWVib3kubmFtZSwgYXJyYXlUb0Jhc2U2NChzcmFtKSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQljb3V0KCJTUkFNIGNvdWxkIG5vdCBiZSBzYXZlZCBiZWNhdXNlIGl0IHdhcyBlbXB0eS4iLCAxKTsKCQkJCX0KCQkJfQoJCQljYXRjaCAoZXJyb3IpIHsKCQkJCWNvdXQoIkNvdWxkIG5vdCBzYXZlIHRoZSBjdXJyZW50IGVtdWxhdGlvbiBzdGF0ZShcIiIgKyBlcnJvci5tZXNzYWdlICsgIlwiKS4iLCAyKTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJY291dCgiQ2Fubm90IHNhdmUgYSBnYW1lIHRoYXQgZG9lcyBub3QgaGF2ZSBiYXR0ZXJ5IGJhY2tlZCBTUkFNIHNwZWNpZmllZC4iLCAxKTsKCQl9CgkJc2F2ZVJUQygpOwoJfQoJZWxzZSB7CgkJY291dCgiR2FtZUJveSBjb3JlIGNhbm5vdCBiZSBzYXZlZCB3aGlsZSBpdCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuIiwgMSk7Cgl9Cn0KZnVuY3Rpb24gc2F2ZVJUQygpIHsJLy9FeGVjdXRlIHRoaXMgd2hlbiBTUkFNIGlzIGJlaW5nIHNhdmVkIGFzIHdlbGwuCglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSkgewoJCWlmIChnYW1lYm95LmNUSU1FUikgewoJCQl0cnkgewoJCQkJY291dCgiU2F2aW5nIHRoZSBSVEMuLi4iLCAwKTsKCQkJCXNldFZhbHVlKCJSVENfIiArIGdhbWVib3kubmFtZSwgZ2FtZWJveS5zYXZlUlRDU3RhdGUoKSk7CgkJCX0KCQkJY2F0Y2ggKGVycm9yKSB7CgkJCQljb3V0KCJDb3VsZCBub3Qgc2F2ZSB0aGUgUlRDIG9mIHRoZSBjdXJyZW50IGVtdWxhdGlvbiBzdGF0ZShcIiIgKyBlcnJvci5tZXNzYWdlICsgIlwiKS4iLCAyKTsKCQkJfQoJCX0KCX0KCWVsc2UgewoJCWNvdXQoIkdhbWVCb3kgY29yZSBjYW5ub3QgYmUgc2F2ZWQgd2hpbGUgaXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLiIsIDEpOwoJfQp9CmZ1bmN0aW9uIGF1dG9TYXZlKCkgewoJaWYgKEdhbWVCb3lFbXVsYXRvckluaXRpYWxpemVkKCkpIHsKCQljb3V0KCJBdXRvbWF0aWNhbGx5IHNhdmluZyB0aGUgU1JBTS4iLCAwKTsKCQlzYXZlU1JBTSgpOwoJCXNhdmVSVEMoKTsKCX0KfQpmdW5jdGlvbiBvcGVuU1JBTShmaWxlbmFtZSkgewoJdHJ5IHsKCQlpZiAoZmluZFZhbHVlKCJCNjRfU1JBTV8iICsgZmlsZW5hbWUpICE9IG51bGwpIHsKCQkJY291dCgiRm91bmQgYSBwcmV2aW91cyBTUkFNIHN0YXRlIChXaWxsIGF0dGVtcHQgdG8gbG9hZCkuIiwgMCk7CgkJCXJldHVybiBiYXNlNjRUb0FycmF5KGZpbmRWYWx1ZSgiQjY0X1NSQU1fIiArIGZpbGVuYW1lKSk7CgkJfQoJCWVsc2UgaWYgKGZpbmRWYWx1ZSgiU1JBTV8iICsgZmlsZW5hbWUpICE9IG51bGwpIHsKCQkJY291dCgiRm91bmQgYSBwcmV2aW91cyBTUkFNIHN0YXRlIChXaWxsIGF0dGVtcHQgdG8gbG9hZCkuIiwgMCk7CgkJCXJldHVybiBmaW5kVmFsdWUoIlNSQU1fIiArIGZpbGVuYW1lKTsKCQl9CgkJZWxzZSB7CgkJCWNvdXQoIkNvdWxkIG5vdCBmaW5kIGFueSBwcmV2aW91cyBTUkFNIGNvcHkgZm9yIHRoZSBjdXJyZW50IFJPTS4iLCAwKTsKCQl9Cgl9CgljYXRjaCAoZXJyb3IpIHsKCQljb3V0KCJDb3VsZCBub3Qgb3BlbiB0aGUgIFNSQU0gb2YgdGhlIHNhdmVkIGVtdWxhdGlvbiBzdGF0ZS4iLCAyKTsKCX0KCXJldHVybiBbXTsKfQpmdW5jdGlvbiBvcGVuUlRDKGZpbGVuYW1lKSB7Cgl0cnkgewoJCWlmIChmaW5kVmFsdWUoIlJUQ18iICsgZmlsZW5hbWUpICE9IG51bGwpIHsKCQkJY291dCgiRm91bmQgYSBwcmV2aW91cyBSVEMgc3RhdGUgKFdpbGwgYXR0ZW1wdCB0byBsb2FkKS4iLCAwKTsKCQkJcmV0dXJuIGZpbmRWYWx1ZSgiUlRDXyIgKyBmaWxlbmFtZSk7CgkJfQoJCWVsc2UgewoJCQljb3V0KCJDb3VsZCBub3QgZmluZCBhbnkgcHJldmlvdXMgUlRDIGNvcHkgZm9yIHRoZSBjdXJyZW50IFJPTS4iLCAwKTsKCQl9Cgl9CgljYXRjaCAoZXJyb3IpIHsKCQljb3V0KCJDb3VsZCBub3Qgb3BlbiB0aGUgUlRDIGRhdGEgb2YgdGhlIHNhdmVkIGVtdWxhdGlvbiBzdGF0ZS4iLCAyKTsKCX0KCXJldHVybiBbXTsKfQpmdW5jdGlvbiBzYXZlU3RhdGUoZmlsZW5hbWUpIHsKCWlmIChHYW1lQm95RW11bGF0b3JJbml0aWFsaXplZCgpKSB7CgkJdHJ5IHsKCQkJc2V0VmFsdWUoZmlsZW5hbWUsIGdhbWVib3kuc2F2ZVN0YXRlKCkpOwoJCQljb3V0KCJTYXZlZCB0aGUgY3VycmVudCBzdGF0ZSBhczogIiArIGZpbGVuYW1lLCAwKTsKCQl9CgkJY2F0Y2ggKGVycm9yKSB7CgkJCWNvdXQoIkNvdWxkIG5vdCBzYXZlIHRoZSBjdXJyZW50IGVtdWxhdGlvbiBzdGF0ZShcIiIgKyBlcnJvci5tZXNzYWdlICsgIlwiKS4iLCAyKTsKCQl9Cgl9CgllbHNlIHsKCQljb3V0KCJHYW1lQm95IGNvcmUgY2Fubm90IGJlIHNhdmVkIHdoaWxlIGl0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC4iLCAxKTsKCX0KfQpmdW5jdGlvbiBvcGVuU3RhdGUoZmlsZW5hbWUsIGNhbnZhcykgewoJdHJ5IHsKCQlpZiAoZmluZFZhbHVlKGZpbGVuYW1lKSAhPSBudWxsKSB7CgkJCXRyeSB7CgkJCQljbGVhckxhc3RFbXVsYXRpb24oKTsKCQkJCWNvdXQoIkF0dGVtcHRpbmcgdG8gcnVuIGEgc2F2ZWQgZW11bGF0aW9uIHN0YXRlLiIsIDApOwoJCQkJZ2FtZWJveSA9IG5ldyBHYW1lQm95Q29yZShjYW52YXMsICIiKTsKCQkJCWdhbWVib3kuc2F2ZWRTdGF0ZUZpbGVOYW1lID0gZmlsZW5hbWU7CgkJCQlnYW1lYm95LnJldHVybkZyb21TdGF0ZShmaW5kVmFsdWUoZmlsZW5hbWUpKTsKCQkJCXJ1bigpOwoJCQl9CgkJCWNhdGNoIChlcnJvcikgewoJCQkJYWxlcnQoZXJyb3IubWVzc2FnZSArICIgZmlsZTogIiArIGVycm9yLmZpbGVOYW1lICsgIiBsaW5lOiAiICsgZXJyb3IubGluZU51bWJlcik7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCWNvdXQoIkNvdWxkIG5vdCBmaW5kIHRoZSBzYXZlIHN0YXRlICIgKyBmaWxlbmFtZSArICJcIi4iLCAyKTsKCQl9Cgl9CgljYXRjaCAoZXJyb3IpIHsKCQljb3V0KCJDb3VsZCBub3Qgb3BlbiB0aGUgc2F2ZWQgZW11bGF0aW9uIHN0YXRlLiIsIDIpOwoJfQp9CmZ1bmN0aW9uIGltcG9ydF9zYXZlKGJsb2JEYXRhKSB7CglibG9iRGF0YSA9IGRlY29kZUJsb2IoYmxvYkRhdGEpOwoJaWYgKGJsb2JEYXRhICYmIGJsb2JEYXRhLmJsb2JzKSB7CgkJaWYgKGJsb2JEYXRhLmJsb2JzLmxlbmd0aCA+IDApIHsKCQkJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGJsb2JEYXRhLmJsb2JzLmxlbmd0aDsgKytpbmRleCkgewoJCQkJY291dCgiSW1wb3J0aW5nIGJsb2IgXCIiICsgYmxvYkRhdGEuYmxvYnNbaW5kZXhdLmJsb2JJRCArICJcIiIsIDApOwoJCQkJaWYgKGJsb2JEYXRhLmJsb2JzW2luZGV4XS5ibG9iQ29udGVudCkgewoJCQkJCWlmIChibG9iRGF0YS5ibG9ic1tpbmRleF0uYmxvYklELnN1YnN0cmluZygwLCA1KSA9PSAiU1JBTV8iKSB7CgkJCQkJCXNldFZhbHVlKCJCNjRfIiArIGJsb2JEYXRhLmJsb2JzW2luZGV4XS5ibG9iSUQsIGJhc2U2NChibG9iRGF0YS5ibG9ic1tpbmRleF0uYmxvYkNvbnRlbnQpKTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXNldFZhbHVlKGJsb2JEYXRhLmJsb2JzW2luZGV4XS5ibG9iSUQsIEpTT04ucGFyc2UoYmxvYkRhdGEuYmxvYnNbaW5kZXhdLmJsb2JDb250ZW50KSk7CgkJCQkJfQoJCQkJfQoJCQkJZWxzZSBpZiAoYmxvYkRhdGEuYmxvYnNbaW5kZXhdLmJsb2JJRCkgewoJCQkJCWNvdXQoIlNhdmUgZmlsZSBpbXBvcnRlZCBoYWQgYmxvYiBcIiIgKyBibG9iRGF0YS5ibG9ic1tpbmRleF0uYmxvYklEICsgIlwiIHdpdGggbm8gYmxvYiBkYXRhIGludGVycHJldGFibGUuIiwgMik7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQljb3V0KCJCbG9iIGNodW5rIGluZm9ybWF0aW9uIG1pc3NpbmcgY29tcGxldGVseS4iLCAyKTsKCQkJCX0KCQkJfQoJCX0KCQllbHNlIHsKCQkJY291dCgiQ291bGQgbm90IGRlY29kZSB0aGUgaW1wb3J0ZWQgZmlsZS4iLCAyKTsKCQl9Cgl9CgllbHNlIHsKCQljb3V0KCJDb3VsZCBub3QgZGVjb2RlIHRoZSBpbXBvcnRlZCBmaWxlLiIsIDIpOwoJfQp9CmZ1bmN0aW9uIGdlbmVyYXRlQmxvYihrZXlOYW1lLCBlbmNvZGVkRGF0YSkgewoJLy9BcHBlbmQgdGhlIGZpbGUgZm9ybWF0IHByZWZpeDoKCXZhciBzYXZlU3RyaW5nID0gIkVNVUxBVE9SX0RBVEEiOwoJdmFyIGNvbnNvbGVJRCA9ICJHYW1lQm95IjsKCS8vRmlndXJlIG91dCB0aGUgbGVuZ3RoOgoJdmFyIHRvdGFsTGVuZ3RoID0gKHNhdmVTdHJpbmcubGVuZ3RoICsgNCArICgxICsgY29uc29sZUlELmxlbmd0aCkpICsgKCgxICsga2V5TmFtZS5sZW5ndGgpICsgKDQgKyBlbmNvZGVkRGF0YS5sZW5ndGgpKTsKCS8vQXBwZW5kIHRoZSB0b3RhbCBsZW5ndGggaW4gYnl0ZXM6CglzYXZlU3RyaW5nICs9IHRvX2xpdHRsZV9lbmRpYW5fZHdvcmQodG90YWxMZW5ndGgpOwoJLy9BcHBlbmQgdGhlIGNvbnNvbGUgSUQgdGV4dCdzIGxlbmd0aDoKCXNhdmVTdHJpbmcgKz0gdG9fYnl0ZShjb25zb2xlSUQubGVuZ3RoKTsKCS8vQXBwZW5kIHRoZSBjb25zb2xlIElEIHRleHQ6CglzYXZlU3RyaW5nICs9IGNvbnNvbGVJRDsKCS8vQXBwZW5kIHRoZSBibG9iIElEOgoJc2F2ZVN0cmluZyArPSB0b19ieXRlKGtleU5hbWUubGVuZ3RoKTsKCXNhdmVTdHJpbmcgKz0ga2V5TmFtZTsKCS8vTm93IGFwcGVuZCB0aGUgc2F2ZSBkYXRhOgoJc2F2ZVN0cmluZyArPSB0b19saXR0bGVfZW5kaWFuX2R3b3JkKGVuY29kZWREYXRhLmxlbmd0aCk7CglzYXZlU3RyaW5nICs9IGVuY29kZWREYXRhOwoJcmV0dXJuIHNhdmVTdHJpbmc7Cn0KZnVuY3Rpb24gZ2VuZXJhdGVNdWx0aUJsb2IoYmxvYlBhaXJzKSB7Cgl2YXIgY29uc29sZUlEID0gIkdhbWVCb3kiOwoJLy9GaWd1cmUgb3V0IHRoZSBpbml0aWFsIGxlbmd0aDoKCXZhciB0b3RhbExlbmd0aCA9IDEzICsgNCArIDEgKyBjb25zb2xlSUQubGVuZ3RoOwoJLy9BcHBlbmQgdGhlIGNvbnNvbGUgSUQgdGV4dCdzIGxlbmd0aDoKCXZhciBzYXZlU3RyaW5nID0gdG9fYnl0ZShjb25zb2xlSUQubGVuZ3RoKTsKCS8vQXBwZW5kIHRoZSBjb25zb2xlIElEIHRleHQ6CglzYXZlU3RyaW5nICs9IGNvbnNvbGVJRDsKCXZhciBrZXlOYW1lID0gIiI7Cgl2YXIgZW5jb2RlZERhdGEgPSAiIjsKCS8vTm93IGFwcGVuZCBhbGwgdGhlIGJsb2JzOgoJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGJsb2JQYWlycy5sZW5ndGg7ICsraW5kZXgpIHsKCQlrZXlOYW1lID0gYmxvYlBhaXJzW2luZGV4XVswXTsKCQllbmNvZGVkRGF0YSA9IGJsb2JQYWlyc1tpbmRleF1bMV07CgkJLy9BcHBlbmQgdGhlIGJsb2IgSUQ6CgkJc2F2ZVN0cmluZyArPSB0b19ieXRlKGtleU5hbWUubGVuZ3RoKTsKCQlzYXZlU3RyaW5nICs9IGtleU5hbWU7CgkJLy9Ob3cgYXBwZW5kIHRoZSBzYXZlIGRhdGE6CgkJc2F2ZVN0cmluZyArPSB0b19saXR0bGVfZW5kaWFuX2R3b3JkKGVuY29kZWREYXRhLmxlbmd0aCk7CgkJc2F2ZVN0cmluZyArPSBlbmNvZGVkRGF0YTsKCQkvL1VwZGF0ZSB0aGUgdG90YWwgbGVuZ3RoOgoJCXRvdGFsTGVuZ3RoICs9IDEgKyBrZXlOYW1lLmxlbmd0aCArIDQgKyBlbmNvZGVkRGF0YS5sZW5ndGg7Cgl9CgkvL05vdyBhZGQgdGhlIHByZWZpeDoKCXNhdmVTdHJpbmcgPSAiRU1VTEFUT1JfREFUQSIgKyB0b19saXR0bGVfZW5kaWFuX2R3b3JkKHRvdGFsTGVuZ3RoKSArIHNhdmVTdHJpbmc7CglyZXR1cm4gc2F2ZVN0cmluZzsKfQpmdW5jdGlvbiBkZWNvZGVCbG9iKGJsb2JEYXRhKSB7CgkvKkZvcm1hdCBpcyBhcyBmb2xsb3dzOgoJCS0gMTMgYnl0ZSBzdHJpbmcgIkVNVUxBVE9SX0RBVEEiCgkJLSA0IGJ5dGUgdG90YWwgc2l6ZSAoaW5jbHVkaW5nIHRoZXNlIDQgYnl0ZXMpLgoJCS0gMSBieXRlIENvbnNvbGUgdHlwZSBJRCBsZW5ndGgKCQktIENvbnNvbGUgdHlwZSBJRCB0ZXh0IG9mIDggYml0IHNpemUKCQlibG9icyB7CgkJCS0gMSBieXRlIGJsb2IgSUQgbGVuZ3RoCgkJCS0gYmxvYiBJRCB0ZXh0IChVc2VkIHRvIHNheSB3aGF0IHRoZSBkYXRhIGlzIChTUkFNL2ZyZWV6ZSBzdGF0ZS9ldGMuLi4pKQoJCQktIDQgYnl0ZSBibG9iIGxlbmd0aAoJCQktIGJsb2IgbGVuZ3RoIG9mIDMyIGJpdCBzaXplCgkJfQoJKi8KCXZhciBsZW5ndGggPSBibG9iRGF0YS5sZW5ndGg7Cgl2YXIgYmxvYlByb3BlcnRpZXMgPSB7fTsKCWJsb2JQcm9wZXJ0aWVzLmNvbnNvbGVJRCA9IG51bGw7Cgl2YXIgYmxvYnNDb3VudCA9IC0xOwoJYmxvYlByb3BlcnRpZXMuYmxvYnMgPSBbXTsKCWlmIChsZW5ndGggPiAxNykgewoJCWlmIChibG9iRGF0YS5zdWJzdHJpbmcoMCwgMTMpID09ICJFTVVMQVRPUl9EQVRBIikgewoJCQl2YXIgbGVuZ3RoID0gTWF0aC5taW4oKChibG9iRGF0YS5jaGFyQ29kZUF0KDE2KSAmIDB4RkYpIDw8IDI0KSB8ICgoYmxvYkRhdGEuY2hhckNvZGVBdCgxNSkgJiAweEZGKSA8PCAxNikgfCAoKGJsb2JEYXRhLmNoYXJDb2RlQXQoMTQpICYgMHhGRikgPDwgOCkgfCAoYmxvYkRhdGEuY2hhckNvZGVBdCgxMykgJiAweEZGKSwgbGVuZ3RoKTsKCQkJdmFyIGNvbnNvbGVJRExlbmd0aCA9IGJsb2JEYXRhLmNoYXJDb2RlQXQoMTcpICYgMHhGRjsKCQkJaWYgKGxlbmd0aCA+IDE3ICsgY29uc29sZUlETGVuZ3RoKSB7CgkJCQlibG9iUHJvcGVydGllcy5jb25zb2xlSUQgPSBibG9iRGF0YS5zdWJzdHJpbmcoMTgsIDE4ICsgY29uc29sZUlETGVuZ3RoKTsKCQkJCXZhciBibG9iSURMZW5ndGggPSAwOwoJCQkJdmFyIGJsb2JMZW5ndGggPSAwOwoJCQkJZm9yICh2YXIgaW5kZXggPSAxOCArIGNvbnNvbGVJRExlbmd0aDsgaW5kZXggPCBsZW5ndGg7KSB7CgkJCQkJYmxvYklETGVuZ3RoID0gYmxvYkRhdGEuY2hhckNvZGVBdChpbmRleCsrKSAmIDB4RkY7CgkJCQkJaWYgKGluZGV4ICsgYmxvYklETGVuZ3RoIDwgbGVuZ3RoKSB7CgkJCQkJCWJsb2JQcm9wZXJ0aWVzLmJsb2JzWysrYmxvYnNDb3VudF0gPSB7fTsKCQkJCQkJYmxvYlByb3BlcnRpZXMuYmxvYnNbYmxvYnNDb3VudF0uYmxvYklEID0gYmxvYkRhdGEuc3Vic3RyaW5nKGluZGV4LCBpbmRleCArIGJsb2JJRExlbmd0aCk7CgkJCQkJCWluZGV4ICs9IGJsb2JJRExlbmd0aDsKCQkJCQkJaWYgKGluZGV4ICsgNCA8IGxlbmd0aCkgewoJCQkJCQkJYmxvYkxlbmd0aCA9ICgoYmxvYkRhdGEuY2hhckNvZGVBdChpbmRleCArIDMpICYgMHhGRikgPDwgMjQpIHwgKChibG9iRGF0YS5jaGFyQ29kZUF0KGluZGV4ICsgMikgJiAweEZGKSA8PCAxNikgfCAoKGJsb2JEYXRhLmNoYXJDb2RlQXQoaW5kZXggKyAxKSAmIDB4RkYpIDw8IDgpIHwgKGJsb2JEYXRhLmNoYXJDb2RlQXQoaW5kZXgpICYgMHhGRik7CgkJCQkJCQlpbmRleCArPSA0OwoJCQkJCQkJaWYgKGluZGV4ICsgYmxvYkxlbmd0aCA8PSBsZW5ndGgpIHsKCQkJCQkJCQlibG9iUHJvcGVydGllcy5ibG9ic1tibG9ic0NvdW50XS5ibG9iQ29udGVudCA9ICBibG9iRGF0YS5zdWJzdHJpbmcoaW5kZXgsIGluZGV4ICsgYmxvYkxlbmd0aCk7CgkJCQkJCQkJaW5kZXggKz0gYmxvYkxlbmd0aDsKCQkJCQkJCX0KCQkJCQkJCWVsc2UgewoJCQkJCQkJCWNvdXQoIkJsb2IgbGVuZ3RoIGNoZWNrIGZhaWxlZCwgYmxvYiBkZXRlcm1pbmVkIHRvIGJlIGluY29tcGxldGUuIiwgMik7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQkJZWxzZSB7CgkJCQkJCQljb3V0KCJCbG9iIHdhcyBpbmNvbXBsZXRlLCBiYWlsaW5nIG91dC4iLCAyKTsKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQljb3V0KCJCbG9iIHdhcyBpbmNvbXBsZXRlLCBiYWlsaW5nIG91dC4iLCAyKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQoJcmV0dXJuIGJsb2JQcm9wZXJ0aWVzOwp9CmZ1bmN0aW9uIG1hdGNoS2V5KGtleSkgewkvL01hcHMgYSBrZXlib2FyZCBrZXkgdG8gYSBnYW1lYm95IGtleS4KCS8vT3JkZXI6IFJpZ2h0LCBMZWZ0LCBVcCwgRG93biwgQSwgQiwgU2VsZWN0LCBTdGFydAoJdmFyIGtleW1hcCA9IFsicmlnaHQiLCAibGVmdCIsICJ1cCIsICJkb3duIiwgImEiLCAiYiIsICJzZWxlY3QiLCAic3RhcnQiXTsJLy9LZXlib2FyZCBidXR0b24gbWFwLgoJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGtleW1hcC5sZW5ndGg7IGluZGV4KyspIHsKCQlpZiAoa2V5bWFwW2luZGV4XSA9PSBrZXkpIHsKCQkJcmV0dXJuIGluZGV4OwoJCX0KCX0KCXJldHVybiAtMTsKfQpmdW5jdGlvbiBHYW1lQm95RW11bGF0b3JJbml0aWFsaXplZCgpIHsKCXJldHVybiAodHlwZW9mIGdhbWVib3kgPT0gIm9iamVjdCIgJiYgZ2FtZWJveSAhPSBudWxsKTsKfQpmdW5jdGlvbiBHYW1lQm95RW11bGF0b3JQbGF5aW5nKCkgewoJcmV0dXJuICgoZ2FtZWJveS5zdG9wRW11bGF0b3IgJiAyKSA9PSAwKTsKfQpmdW5jdGlvbiBHYW1lQm95S2V5RG93bihrZXkpIHsKCWlmIChHYW1lQm95RW11bGF0b3JJbml0aWFsaXplZCgpICYmIEdhbWVCb3lFbXVsYXRvclBsYXlpbmcoKSkgewoJCUdhbWVCb3lKb3lQYWRFdmVudChtYXRjaEtleShrZXkpLCB0cnVlKTsKCX0KfQpmdW5jdGlvbiBHYW1lQm95Sm95UGFkRXZlbnQoa2V5Y29kZSwgZG93bikgewoJaWYgKEdhbWVCb3lFbXVsYXRvckluaXRpYWxpemVkKCkgJiYgR2FtZUJveUVtdWxhdG9yUGxheWluZygpKSB7CgkJaWYgKGtleWNvZGUgPj0gMCAmJiBrZXljb2RlIDwgOCkgewoJCQlnYW1lYm95LkpveVBhZEV2ZW50KGtleWNvZGUsIGRvd24pOwoJCX0KCX0KfQpmdW5jdGlvbiBHYW1lQm95S2V5VXAoa2V5KSB7CglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSAmJiBHYW1lQm95RW11bGF0b3JQbGF5aW5nKCkpIHsKCQlHYW1lQm95Sm95UGFkRXZlbnQobWF0Y2hLZXkoa2V5KSwgZmFsc2UpOwoJfQp9CmZ1bmN0aW9uIEdhbWVCb3lHeXJvU2lnbmFsSGFuZGxlcihlKSB7CglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSAmJiBHYW1lQm95RW11bGF0b3JQbGF5aW5nKCkpIHsKCQlpZiAoZS5nYW1tYSB8fCBlLmJldGEpIHsKCQkJZ2FtZWJveS5HeXJvRXZlbnQoZS5nYW1tYSAqIE1hdGguUEkgLyAxODAsIGUuYmV0YSAqIE1hdGguUEkgLyAxODApOwoJCX0KCQllbHNlIHsKCQkJZ2FtZWJveS5HeXJvRXZlbnQoZS54LCBlLnkpOwoJCX0KCQl0cnkgewoJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJfQoJCWNhdGNoIChlcnJvcikgeyB9Cgl9Cn0KLy9UaGUgZW11bGF0b3Igd2lsbCBjYWxsIHRoaXMgdG8gc29ydCBvdXQgdGhlIGNhbnZhcyBwcm9wZXJ0aWVzIGZvciAocmUpaW5pdGlhbGl6YXRpb24uCmZ1bmN0aW9uIGluaXROZXdDYW52YXMoKSB7CglpZiAoR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSkgewoJCWdhbWVib3kuY2FudmFzLndpZHRoID0gMTYwOwoJCWdhbWVib3kuY2FudmFzLmhlaWdodCA9IDE0NDsKCX0KfQovL0NhbGwgdGhpcyB3aGVuIHJlc2l6aW5nIHRoZSBjYW52YXM6CmZ1bmN0aW9uIGluaXROZXdDYW52YXNTaXplKCkgewoJaWYgKEdhbWVCb3lFbXVsYXRvckluaXRpYWxpemVkKCkpIHsKCQlpZiAoIXNldHRpbmdzWzEyXSkgewoJCQlpZiAoZ2FtZWJveS5vbnNjcmVlbldpZHRoICE9IDE2MCB8fCBnYW1lYm95Lm9uc2NyZWVuSGVpZ2h0ICE9IDE0NCkgewoJCQkJZ2FtZWJveS5pbml0TENEKCk7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCWlmIChnYW1lYm95Lm9uc2NyZWVuV2lkdGggIT0gZ2FtZWJveS5jYW52YXMuY2xpZW50V2lkdGggfHwgZ2FtZWJveS5vbnNjcmVlbkhlaWdodCAhPSBnYW1lYm95LmNhbnZhcy5jbGllbnRIZWlnaHQpIHsKCQkJCWdhbWVib3kuaW5pdExDRCgpOwoJCQl9CgkJfQoJfQp9Cg==";
const GB_index_html = "PCFET0NUWVBFIGh0bWw+CjwhLS0gRWRpdGVkIGZyb20gR0IgU3R1ZGlvIGh0bWwgb3B0aW9uLCB0aG91Z2ggdGhpcyBpcyAocHJvYmFibHkpIG5vdCBhIEdCU3R1ZGlvIGdhbWUgLS0+CjxodG1sPjxoZWFkPjxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04Ij4KICAgIAogICAgCiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEiPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuL3N0eWxlLmNzcyI+CiAgICA8dGl0bGU+R0IgRW11bGF0b3I8L3RpdGxlPiAgICAKICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+IGJvZHkgeyBiYWNrZ3JvdW5kLWNvbG9yOiN1bmRlZmluZWQ7IH08L3N0eWxlPgogICAgCiAgPC9oZWFkPgogIDxib2R5PgogICAgPGRpdiBpZD0iZ2FtZWJveV9zaGVsbCI+CiAgICAgIDxkaXYgaWQ9ImdhbWUiPgogICAgICAgIDxjYW52YXMgaWQ9Im1haW5DYW52YXMiIHdpZHRoPSIxNjAiIGhlaWdodD0iMTQ0IiBzdHlsZT0iaGVpZ2h0OiA1NzhweDsgd2lkdGg6IGF1dG87Ij5ObyBDYW52YXMgU3VwcG9ydDwvY2FudmFzPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBpZD0iY29udHJvbGxlciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KICAgICAgICA8ZGl2IGlkPSJjb250cm9sbGVyX2RwYWQiPgogICAgICAgICAgPGRpdiBpZD0iY29udHJvbGxlcl9sZWZ0Ij48L2Rpdj4KICAgICAgICAgIDxkaXYgaWQ9ImNvbnRyb2xsZXJfcmlnaHQiPjwvZGl2PgogICAgICAgICAgPGRpdiBpZD0iY29udHJvbGxlcl91cCI+PC9kaXY+CiAgICAgICAgICA8ZGl2IGlkPSJjb250cm9sbGVyX2Rvd24iPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgaWQ9ImNvbnRyb2xsZXJfc2VsZWN0IiBjbGFzcz0iY2Fwc3VsZUJ0biI+U2VsZWN0PC9kaXY+CiAgICAgICAgPGRpdiBpZD0iY29udHJvbGxlcl9zdGFydCIgY2xhc3M9ImNhcHN1bGVCdG4iPlN0YXJ0PC9kaXY+CiAgICAgICAgPGRpdiBpZD0iY29udHJvbGxlcl9iIiBjbGFzcz0icm91bmRCdG4iPkI8L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJjb250cm9sbGVyX2EiIGNsYXNzPSJyb3VuZEJ0biI+QTwvZGl2PgogICAgICA8L2Rpdj4gICAgICAKICAgIDwvZGl2PgogICAgPHNjcmlwdD4KICAgICAgY29uc3QgY3VzdG9tQ29udHJvbHMgPSB7ImEiOlsieiIsIloiLCJrIiwiSyJdLCJiIjpbIngiLCJYIiwiaiIsIkoiXSwgInN0YXJ0IjpbIkVudGVyIiwibSIsIk0iXSwgInNlbGVjdCI6WyJTaGlmdCIsIm4iLCJOIl19OwogICAgPC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iLi9tb2JpbGUuanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Ii4vYmFzZTY0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSIuL3N3Zm9iamVjdC5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iLi9yZXNhbXBsZXIuanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Ii4vWEF1ZGlvU2VydmVyLmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSIuL2NvbnRyb2xzLmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSIuL3Jlc2l6ZS5qcyI+PC9zY3JpcHQ+ICAgIAogICAgPHNjcmlwdCBzcmM9Ii4vR2FtZUJveUNvcmUuanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Ii4vR2FtZUJveUlPLmpzIj48L3NjcmlwdD4KICAKCjwvYm9keT48L2h0bWw+";
const GB_mobile_js = "dmFyIHJvbVBhdGggPSAicm9tL2dhbWUuZ2IiOwp2YXIgbWFpbkNhbnZhcyA9IG51bGw7CnZhciBzb3VuZFJlYWR5ID0gZmFsc2U7Cgp2YXIgY291dCA9IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7CmZ1bmN0aW9uIHN0YXJ0R2FtZShibG9iKSB7CiAgdmFyIGJpbmFyeUhhbmRsZSA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgYmluYXJ5SGFuZGxlLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gMikgewogICAgICB0cnkgewogICAgICAgIHN0YXJ0KG1haW5DYW52YXMsIHRoaXMucmVzdWx0KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGFsZXJ0KGUubWVzc2FnZSk7CiAgICAgIH0KICAgIH0KICB9OwogIGJpbmFyeUhhbmRsZS5yZWFkQXNCaW5hcnlTdHJpbmcoYmxvYik7Cn0KCmdhbWVfNjQgPSJAKHJvbV9iNjQpIjsKCmZ1bmN0aW9uIGxvYWRWaWFYSFIoKSB7ICAKICBidWZmPVVpbnQ4QXJyYXkuZnJvbShhdG9iKGdhbWVfNjQpLCBjID0+IGMuY2hhckNvZGVBdCgwKSkuYnVmZmVyOwogIHN0YXJ0R2FtZShuZXcgQmxvYihbYnVmZl0sIHsgdHlwZTogInRleHQvcGxhaW4iIH0pKTsKfQoKZnVuY3Rpb24gd2luZG93aW5nSW5pdGlhbGl6ZSgpIHsKICBjb3V0KCJ3aW5kb3dpbmdJbml0aWFsaXplKCkgY2FsbGVkLiIsIDApOwogIG1haW5DYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFpbkNhbnZhcyIpOwogIHdpbmRvdy5vbnVubG9hZCA9IGF1dG9TYXZlOwogIGxvYWRWaWFYSFIoKTsKfQoKLy9XcmFwcGVyIGZvciBsb2NhbFN0b3JhZ2UgZ2V0SXRlbSwgc28gdGhhdCBkYXRhIGNhbiBiZSByZXRyaWV2ZWQgaW4gdmFyaW91cyB0eXBlcy4KZnVuY3Rpb24gZmluZFZhbHVlKGtleSkgewogIHRyeSB7CiAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkgIT0gbnVsbCkgewogICAgICByZXR1cm4gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSk7CiAgICB9CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIC8vQW4gb2xkZXIgR2Vja28gMS44LjEvMS45LjAgbWV0aG9kIG9mIHN0b3JhZ2UgKERlcHJlY2F0ZWQgZHVlIHRvIHRoZSBvYnZpb3VzIHNlY3VyaXR5IGhvbGUpOgogICAgaWYgKHdpbmRvdy5nbG9iYWxTdG9yYWdlW2xvY2F0aW9uLmhvc3RuYW1lXS5nZXRJdGVtKGtleSkgIT0gbnVsbCkgewogICAgICByZXR1cm4gSlNPTi5wYXJzZSh3aW5kb3cuZ2xvYmFsU3RvcmFnZVtsb2NhdGlvbi5ob3N0bmFtZV0uZ2V0SXRlbShrZXkpKTsKICAgIH0KICB9CiAgcmV0dXJuIG51bGw7Cn0KLy9XcmFwcGVyIGZvciBsb2NhbFN0b3JhZ2Ugc2V0SXRlbSwgc28gdGhhdCBkYXRhIGNhbiBiZSBzZXQgaW4gdmFyaW91cyB0eXBlcy4KZnVuY3Rpb24gc2V0VmFsdWUoa2V5LCB2YWx1ZSkgewogIHRyeSB7CiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAvL0FuIG9sZGVyIEdlY2tvIDEuOC4xLzEuOS4wIG1ldGhvZCBvZiBzdG9yYWdlIChEZXByZWNhdGVkIGR1ZSB0byB0aGUgb2J2aW91cyBzZWN1cml0eSBob2xlKToKICAgIHdpbmRvdy5nbG9iYWxTdG9yYWdlW2xvY2F0aW9uLmhvc3RuYW1lXS5zZXRJdGVtKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTsKICB9Cn0KLy9XcmFwcGVyIGZvciBsb2NhbFN0b3JhZ2UgcmVtb3ZlSXRlbSwgc28gdGhhdCBkYXRhIGNhbiBiZSBzZXQgaW4gdmFyaW91cyB0eXBlcy4KZnVuY3Rpb24gZGVsZXRlVmFsdWUoa2V5KSB7CiAgdHJ5IHsKICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAvL0FuIG9sZGVyIEdlY2tvIDEuOC4xLzEuOS4wIG1ldGhvZCBvZiBzdG9yYWdlIChEZXByZWNhdGVkIGR1ZSB0byB0aGUgb2J2aW91cyBzZWN1cml0eSBob2xlKToKICAgIHdpbmRvdy5nbG9iYWxTdG9yYWdlW2xvY2F0aW9uLmhvc3RuYW1lXS5yZW1vdmVJdGVtKGtleSk7CiAgfQp9CgovLyBBbGxvdyBBdWRpbyBjb250ZXh0IHRvIGJlIGNyZWF0ZWQgaW4gcGxhY2VzIHdoaWNoIHJlcXVpcmUKLy8gdXNlciBpbnB1dCBmaXJzdC4gSG9vayB0aGlzIHVwIHRvIGtleWJvYXJkIGFuZCB0b3VjaCBpbnB1dHMKZnVuY3Rpb24gaW5pdFNvdW5kKCkgewogIGlmICghc291bmRSZWFkeSAmJiAhc2V0dGluZ3NbMF0gJiYgR2FtZUJveUVtdWxhdG9ySW5pdGlhbGl6ZWQoKSkgewogICAgd2luZG93LkF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDsKICAgIHdpbmRvdy5hdWRpb0NvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7CiAgICBpZiAod2luZG93LmF1ZGlvQ29udGV4dCkgewogICAgICAvLyBDcmVhdGUgZW1wdHkgYnVmZmVyCiAgICAgIHZhciBidWZmZXIgPSB3aW5kb3cuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlcigxLCAxLCAyMjA1MCk7CiAgICAgIHZhciBzb3VyY2UgPSB3aW5kb3cuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpOwogICAgICBzb3VyY2UuYnVmZmVyID0gYnVmZmVyOwogICAgICAvLyBDb25uZWN0IHRvIG91dHB1dCAoc3BlYWtlcnMpCiAgICAgIHNvdXJjZS5jb25uZWN0KHdpbmRvdy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pOwogICAgICAvLyBQbGF5IHNvdW5kCiAgICAgIGlmIChzb3VyY2Uuc3RhcnQpIHsKICAgICAgICBzb3VyY2Uuc3RhcnQoMCk7CiAgICAgIH0gZWxzZSBpZiAoc291cmNlLnBsYXkpIHsKICAgICAgICBzb3VyY2UucGxheSgwKTsKICAgICAgfSBlbHNlIGlmIChzb3VyY2Uubm90ZU9uKSB7CiAgICAgICAgc291cmNlLm5vdGVPbigwKTsKICAgICAgfQogICAgICB3aW5kb3cuYXVkaW9Db250ZXh0LnJlc3VtZSgpLnRoZW4oKCkgPT4gewogICAgICAgIHNldHRpbmdzWzBdID0gdHJ1ZTsKICAgICAgICBnYW1lYm95LmluaXRTb3VuZCgpOwogICAgICAgIHNvdW5kUmVhZHkgPSB0cnVlOwogICAgICB9KTsKICAgIH0KICB9Cn0KCnZhciBzb3VuZEluaXRUaW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgewogIGlmIChHYW1lQm95RW11bGF0b3JJbml0aWFsaXplZCgpKSB7CiAgICBpbml0U291bmQoKTsKICAgIGNsZWFyVGltZW91dChzb3VuZEluaXRUaW1lcik7CiAgfQp9LCAxNik7Cgp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIHdpbmRvd2luZ0luaXRpYWxpemUpOwo=";
const GB_resampler_js = "Ly9KYXZhU2NyaXB0IEF1ZGlvIFJlc2FtcGxlciAoYykgMjAxMSAtIEdyYW50IEdhbGl0egpmdW5jdGlvbiBSZXNhbXBsZXIoZnJvbVNhbXBsZVJhdGUsIHRvU2FtcGxlUmF0ZSwgY2hhbm5lbHMsIG91dHB1dEJ1ZmZlclNpemUsIG5vUmV0dXJuKSB7Cgl0aGlzLmZyb21TYW1wbGVSYXRlID0gZnJvbVNhbXBsZVJhdGU7Cgl0aGlzLnRvU2FtcGxlUmF0ZSA9IHRvU2FtcGxlUmF0ZTsKCXRoaXMuY2hhbm5lbHMgPSBjaGFubmVscyB8IDA7Cgl0aGlzLm91dHB1dEJ1ZmZlclNpemUgPSBvdXRwdXRCdWZmZXJTaXplOwoJdGhpcy5ub1JldHVybiA9ICEhbm9SZXR1cm47Cgl0aGlzLmluaXRpYWxpemUoKTsKfQpSZXNhbXBsZXIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7CgkvL1BlcmZvcm0gc29tZSBjaGVja3M6CglpZiAodGhpcy5mcm9tU2FtcGxlUmF0ZSA+IDAgJiYgdGhpcy50b1NhbXBsZVJhdGUgPiAwICYmIHRoaXMuY2hhbm5lbHMgPiAwKSB7CgkJaWYgKHRoaXMuZnJvbVNhbXBsZVJhdGUgPT0gdGhpcy50b1NhbXBsZVJhdGUpIHsKCQkJLy9TZXR1cCBhIHJlc2FtcGxlciBieXBhc3M6CgkJCXRoaXMucmVzYW1wbGVyID0gdGhpcy5ieXBhc3NSZXNhbXBsZXI7CQkvL1Jlc2FtcGxlciBqdXN0IHJldHVybnMgd2hhdCB3YXMgcGFzc2VkIHRocm91Z2guCiAgICAgICAgICAgIHRoaXMucmF0aW9XZWlnaHQgPSAxOwoJCX0KCQllbHNlIHsKICAgICAgICAgICAgdGhpcy5yYXRpb1dlaWdodCA9IHRoaXMuZnJvbVNhbXBsZVJhdGUgLyB0aGlzLnRvU2FtcGxlUmF0ZTsKCQkJaWYgKHRoaXMuZnJvbVNhbXBsZVJhdGUgPCB0aGlzLnRvU2FtcGxlUmF0ZSkgewoJCQkJLyoKCQkJCQlVc2UgZ2VuZXJpYyBsaW5lYXIgaW50ZXJwb2xhdGlvbiBpZiB1cHNhbXBsaW5nLAoJCQkJCWFzIGxpbmVhciBpbnRlcnBvbGF0aW9uIHByb2R1Y2VzIGEgZ3JhZGllbnQgdGhhdCB3ZSB3YW50CgkJCQkJYW5kIHdvcmtzIGZpbmUgd2l0aCB0d28gaW5wdXQgc2FtcGxlIHBvaW50cyBwZXIgb3V0cHV0IGluIHRoaXMgY2FzZS4KCQkJCSovCgkJCQl0aGlzLmNvbXBpbGVMaW5lYXJJbnRlcnBvbGF0aW9uRnVuY3Rpb24oKTsKCQkJCXRoaXMubGFzdFdlaWdodCA9IDE7CgkJCX0KCQkJZWxzZSB7CgkJCQkvKgoJCQkJCUN1c3RvbSByZXNhbXBsZXIgSSB3cm90ZSB0aGF0IGRvZXNuJ3Qgc2tpcCBzYW1wbGVzCgkJCQkJbGlrZSBzdGFuZGFyZCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBpbiBoaWdoIGRvd25zYW1wbGluZy4KCQkJCQlUaGlzIGlzIG1vcmUgYWNjdXJhdGUgdGhhbiBsaW5lYXIgaW50ZXJwb2xhdGlvbiBvbiBkb3duc2FtcGxpbmcuCgkJCQkqLwoJCQkJdGhpcy5jb21waWxlTXVsdGlUYXBGdW5jdGlvbigpOwoJCQkJdGhpcy50YWlsRXhpc3RzID0gZmFsc2U7CgkJCQl0aGlzLmxhc3RXZWlnaHQgPSAwOwoJCQl9CgkJCXRoaXMuaW5pdGlhbGl6ZUJ1ZmZlcnMoKTsKCQl9Cgl9CgllbHNlIHsKCQl0aHJvdyhuZXcgRXJyb3IoIkludmFsaWQgc2V0dGluZ3Mgc3BlY2lmaWVkIGZvciB0aGUgcmVzYW1wbGVyLiIpKTsKCX0KfQpSZXNhbXBsZXIucHJvdG90eXBlLmNvbXBpbGVMaW5lYXJJbnRlcnBvbGF0aW9uRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7Cgl2YXIgdG9Db21waWxlID0gInZhciBidWZmZXJMZW5ndGggPSBidWZmZXIubGVuZ3RoO1wKCXZhciBvdXRMZW5ndGggPSB0aGlzLm91dHB1dEJ1ZmZlclNpemU7XAoJaWYgKChidWZmZXJMZW5ndGggJSAiICsgdGhpcy5jaGFubmVscyArICIpID09IDApIHtcCgkJaWYgKGJ1ZmZlckxlbmd0aCA+IDApIHtcCgkJCXZhciB3ZWlnaHQgPSB0aGlzLmxhc3RXZWlnaHQ7XAoJCQl2YXIgZmlyc3RXZWlnaHQgPSAwO1wKCQkJdmFyIHNlY29uZFdlaWdodCA9IDA7XAoJCQl2YXIgc291cmNlT2Zmc2V0ID0gMDtcCgkJCXZhciBvdXRwdXRPZmZzZXQgPSAwO1wKCQkJdmFyIG91dHB1dEJ1ZmZlciA9IHRoaXMub3V0cHV0QnVmZmVyO1wKCQkJZm9yICg7IHdlaWdodCA8IDE7IHdlaWdodCArPSAiICsgdGhpcy5yYXRpb1dlaWdodCArICIpIHtcCgkJCQlzZWNvbmRXZWlnaHQgPSB3ZWlnaHQgJSAxO1wKCQkJCWZpcnN0V2VpZ2h0ID0gMSAtIHNlY29uZFdlaWdodDsiOwoJZm9yICh2YXIgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCB0aGlzLmNoYW5uZWxzOyArK2NoYW5uZWwpIHsKCQl0b0NvbXBpbGUgKz0gIm91dHB1dEJ1ZmZlcltvdXRwdXRPZmZzZXQrK10gPSAodGhpcy5sYXN0T3V0cHV0WyIgKyBjaGFubmVsICsgIl0gKiBmaXJzdFdlaWdodCkgKyAoYnVmZmVyWyIgKyBjaGFubmVsICsgIl0gKiBzZWNvbmRXZWlnaHQpOyI7Cgl9Cgl0b0NvbXBpbGUgKz0gIn1cCgkJCXdlaWdodCAtPSAxO1wKCQkJZm9yIChidWZmZXJMZW5ndGggLT0gIiArIHRoaXMuY2hhbm5lbHMgKyAiLCBzb3VyY2VPZmZzZXQgPSBNYXRoLmZsb29yKHdlaWdodCkgKiAiICsgdGhpcy5jaGFubmVscyArICI7IG91dHB1dE9mZnNldCA8IG91dExlbmd0aCAmJiBzb3VyY2VPZmZzZXQgPCBidWZmZXJMZW5ndGg7KSB7XAoJCQkJc2Vjb25kV2VpZ2h0ID0gd2VpZ2h0ICUgMTtcCgkJCQlmaXJzdFdlaWdodCA9IDEgLSBzZWNvbmRXZWlnaHQ7IjsKCWZvciAodmFyIGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgdGhpcy5jaGFubmVsczsgKytjaGFubmVsKSB7CgkJdG9Db21waWxlICs9ICJvdXRwdXRCdWZmZXJbb3V0cHV0T2Zmc2V0KytdID0gKGJ1ZmZlcltzb3VyY2VPZmZzZXQiICsgKChjaGFubmVsID4gMCkgPyAoIiArICIgKyBjaGFubmVsKSA6ICIiKSArICJdICogZmlyc3RXZWlnaHQpICsgKGJ1ZmZlcltzb3VyY2VPZmZzZXQgKyAiICsgKHRoaXMuY2hhbm5lbHMgKyBjaGFubmVsKSArICJdICogc2Vjb25kV2VpZ2h0KTsiOwoJfQoJdG9Db21waWxlICs9ICJ3ZWlnaHQgKz0gIiArIHRoaXMucmF0aW9XZWlnaHQgKyAiO1wKCQkJCXNvdXJjZU9mZnNldCA9IE1hdGguZmxvb3Iod2VpZ2h0KSAqICIgKyB0aGlzLmNoYW5uZWxzICsgIjtcCgkJCX0iOwoJZm9yICh2YXIgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCB0aGlzLmNoYW5uZWxzOyArK2NoYW5uZWwpIHsKCQl0b0NvbXBpbGUgKz0gInRoaXMubGFzdE91dHB1dFsiICsgY2hhbm5lbCArICJdID0gYnVmZmVyW3NvdXJjZU9mZnNldCsrXTsiOwoJfQoJdG9Db21waWxlICs9ICJ0aGlzLmxhc3RXZWlnaHQgPSB3ZWlnaHQgJSAxO1wKCQkJcmV0dXJuIHRoaXMuYnVmZmVyU2xpY2Uob3V0cHV0T2Zmc2V0KTtcCgkJfVwKCQllbHNlIHtcCgkJCXJldHVybiAodGhpcy5ub1JldHVybikgPyAwIDogW107XAoJCX1cCgl9XAoJZWxzZSB7XAoJCXRocm93KG5ldyBFcnJvcihcIkJ1ZmZlciB3YXMgb2YgaW5jb3JyZWN0IHNhbXBsZSBsZW5ndGguXCIpKTtcCgl9IjsKCXRoaXMucmVzYW1wbGVyID0gRnVuY3Rpb24oImJ1ZmZlciIsIHRvQ29tcGlsZSk7Cn0KUmVzYW1wbGVyLnByb3RvdHlwZS5jb21waWxlTXVsdGlUYXBGdW5jdGlvbiA9IGZ1bmN0aW9uICgpIHsKCXZhciB0b0NvbXBpbGUgPSAidmFyIGJ1ZmZlckxlbmd0aCA9IGJ1ZmZlci5sZW5ndGg7XAoJdmFyIG91dExlbmd0aCA9IHRoaXMub3V0cHV0QnVmZmVyU2l6ZTtcCglpZiAoKGJ1ZmZlckxlbmd0aCAlICIgKyB0aGlzLmNoYW5uZWxzICsgIikgPT0gMCkge1wKCQlpZiAoYnVmZmVyTGVuZ3RoID4gMCkge1wKCQkJdmFyIHdlaWdodCA9IDA7IjsKCWZvciAodmFyIGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgdGhpcy5jaGFubmVsczsgKytjaGFubmVsKSB7CgkJdG9Db21waWxlICs9ICJ2YXIgb3V0cHV0IiArIGNoYW5uZWwgKyAiID0gMDsiCgl9Cgl0b0NvbXBpbGUgKz0gInZhciBhY3R1YWxQb3NpdGlvbiA9IDA7XAoJCQl2YXIgYW1vdW50VG9OZXh0ID0gMDtcCgkJCXZhciBhbHJlYWR5UHJvY2Vzc2VkVGFpbCA9ICF0aGlzLnRhaWxFeGlzdHM7XAoJCQl0aGlzLnRhaWxFeGlzdHMgPSBmYWxzZTtcCgkJCXZhciBvdXRwdXRCdWZmZXIgPSB0aGlzLm91dHB1dEJ1ZmZlcjtcCgkJCXZhciBvdXRwdXRPZmZzZXQgPSAwO1wKCQkJdmFyIGN1cnJlbnRQb3NpdGlvbiA9IDA7XAoJCQlkbyB7XAoJCQkJaWYgKGFscmVhZHlQcm9jZXNzZWRUYWlsKSB7XAoJCQkJCXdlaWdodCA9ICIgKyB0aGlzLnJhdGlvV2VpZ2h0ICsgIjsiOwoJZm9yIChjaGFubmVsID0gMDsgY2hhbm5lbCA8IHRoaXMuY2hhbm5lbHM7ICsrY2hhbm5lbCkgewoJCXRvQ29tcGlsZSArPSAib3V0cHV0IiArIGNoYW5uZWwgKyAiID0gMDsiCgl9Cgl0b0NvbXBpbGUgKz0gIn1cCgkJCQllbHNlIHtcCgkJCQkJd2VpZ2h0ID0gdGhpcy5sYXN0V2VpZ2h0OyI7Cglmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgdGhpcy5jaGFubmVsczsgKytjaGFubmVsKSB7CgkJdG9Db21waWxlICs9ICJvdXRwdXQiICsgY2hhbm5lbCArICIgPSB0aGlzLmxhc3RPdXRwdXRbIiArIGNoYW5uZWwgKyAiXTsiCgl9Cgl0b0NvbXBpbGUgKz0gImFscmVhZHlQcm9jZXNzZWRUYWlsID0gdHJ1ZTtcCgkJCQl9XAoJCQkJd2hpbGUgKHdlaWdodCA+IDAgJiYgYWN0dWFsUG9zaXRpb24gPCBidWZmZXJMZW5ndGgpIHtcCgkJCQkJYW1vdW50VG9OZXh0ID0gMSArIGFjdHVhbFBvc2l0aW9uIC0gY3VycmVudFBvc2l0aW9uO1wKCQkJCQlpZiAod2VpZ2h0ID49IGFtb3VudFRvTmV4dCkgeyI7Cglmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgdGhpcy5jaGFubmVsczsgKytjaGFubmVsKSB7CgkJdG9Db21waWxlICs9ICJvdXRwdXQiICsgY2hhbm5lbCArICIgKz0gYnVmZmVyW2FjdHVhbFBvc2l0aW9uKytdICogYW1vdW50VG9OZXh0OyIKCX0KCXRvQ29tcGlsZSArPSAiY3VycmVudFBvc2l0aW9uID0gYWN0dWFsUG9zaXRpb247XAoJCQkJCQl3ZWlnaHQgLT0gYW1vdW50VG9OZXh0O1wKCQkJCQl9XAoJCQkJCWVsc2UgeyI7Cglmb3IgKGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgdGhpcy5jaGFubmVsczsgKytjaGFubmVsKSB7CgkJdG9Db21waWxlICs9ICJvdXRwdXQiICsgY2hhbm5lbCArICIgKz0gYnVmZmVyW2FjdHVhbFBvc2l0aW9uIiArICgoY2hhbm5lbCA+IDApID8gKCIgKyAiICsgY2hhbm5lbCkgOiAiIikgKyAiXSAqIHdlaWdodDsiCgl9Cgl0b0NvbXBpbGUgKz0gImN1cnJlbnRQb3NpdGlvbiArPSB3ZWlnaHQ7XAoJCQkJCQl3ZWlnaHQgPSAwO1wKCQkJCQkJYnJlYWs7XAoJCQkJCX1cCgkJCQl9XAoJCQkJaWYgKHdlaWdodCA8PSAwKSB7IjsKCWZvciAoY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCB0aGlzLmNoYW5uZWxzOyArK2NoYW5uZWwpIHsKCQl0b0NvbXBpbGUgKz0gIm91dHB1dEJ1ZmZlcltvdXRwdXRPZmZzZXQrK10gPSBvdXRwdXQiICsgY2hhbm5lbCArICIgLyAiICsgdGhpcy5yYXRpb1dlaWdodCArICI7IgoJfQoJdG9Db21waWxlICs9ICJ9XAoJCQkJZWxzZSB7XAoJCQkJCXRoaXMubGFzdFdlaWdodCA9IHdlaWdodDsiOwoJZm9yIChjaGFubmVsID0gMDsgY2hhbm5lbCA8IHRoaXMuY2hhbm5lbHM7ICsrY2hhbm5lbCkgewoJCXRvQ29tcGlsZSArPSAidGhpcy5sYXN0T3V0cHV0WyIgKyBjaGFubmVsICsgIl0gPSBvdXRwdXQiICsgY2hhbm5lbCArICI7IgoJfQoJdG9Db21waWxlICs9ICJ0aGlzLnRhaWxFeGlzdHMgPSB0cnVlO1wKCQkJCQlicmVhaztcCgkJCQl9XAoJCQl9IHdoaWxlIChhY3R1YWxQb3NpdGlvbiA8IGJ1ZmZlckxlbmd0aCAmJiBvdXRwdXRPZmZzZXQgPCBvdXRMZW5ndGgpO1wKCQkJcmV0dXJuIHRoaXMuYnVmZmVyU2xpY2Uob3V0cHV0T2Zmc2V0KTtcCgkJfVwKCQllbHNlIHtcCgkJCXJldHVybiAodGhpcy5ub1JldHVybikgPyAwIDogW107XAoJCX1cCgl9XAoJZWxzZSB7XAoJCXRocm93KG5ldyBFcnJvcihcIkJ1ZmZlciB3YXMgb2YgaW5jb3JyZWN0IHNhbXBsZSBsZW5ndGguXCIpKTtcCgl9IjsKCXRoaXMucmVzYW1wbGVyID0gRnVuY3Rpb24oImJ1ZmZlciIsIHRvQ29tcGlsZSk7Cn0KUmVzYW1wbGVyLnByb3RvdHlwZS5ieXBhc3NSZXNhbXBsZXIgPSBmdW5jdGlvbiAoYnVmZmVyKSB7CglpZiAodGhpcy5ub1JldHVybikgewoJCS8vU2V0IHRoZSBidWZmZXIgcGFzc2VkIGFzIG91ciBvd24sIGFzIHdlIGRvbid0IG5lZWQgdG8gcmVzYW1wbGUgaXQ6CgkJdGhpcy5vdXRwdXRCdWZmZXIgPSBidWZmZXI7CgkJcmV0dXJuIGJ1ZmZlci5sZW5ndGg7Cgl9CgllbHNlIHsKCQkvL0p1c3QgcmV0dXJuIHRoZSBidWZmZXIgcGFzc3NlZDoKCQlyZXR1cm4gYnVmZmVyOwoJfQp9ClJlc2FtcGxlci5wcm90b3R5cGUuYnVmZmVyU2xpY2UgPSBmdW5jdGlvbiAoc2xpY2VBbW91bnQpIHsKCWlmICh0aGlzLm5vUmV0dXJuKSB7CgkJLy9JZiB3ZSdyZSBnb2luZyB0byBhY2Nlc3MgdGhlIHByb3BlcnRpZXMgZGlyZWN0bHkgZnJvbSB0aGlzIG9iamVjdDoKCQlyZXR1cm4gc2xpY2VBbW91bnQ7Cgl9CgllbHNlIHsKCQkvL1R5cGVkIGFycmF5IGFuZCBub3JtYWwgYXJyYXkgYnVmZmVyIHNlY3Rpb24gcmVmZXJlbmNpbmc6CgkJdHJ5IHsKCQkJcmV0dXJuIHRoaXMub3V0cHV0QnVmZmVyLnN1YmFycmF5KDAsIHNsaWNlQW1vdW50KTsKCQl9CgkJY2F0Y2ggKGVycm9yKSB7CgkJCXRyeSB7CgkJCQkvL1JlZ3VsYXIgYXJyYXkgcGFzczoKCQkJCXRoaXMub3V0cHV0QnVmZmVyLmxlbmd0aCA9IHNsaWNlQW1vdW50OwoJCQkJcmV0dXJuIHRoaXMub3V0cHV0QnVmZmVyOwoJCQl9CgkJCWNhdGNoIChlcnJvcikgewoJCQkJLy9OaWdodGx5IEZpcmVmb3ggNCB1c2VkIHRvIGhhdmUgdGhlIHN1YmFycmF5IGZ1bmN0aW9uIG5hbWVkIGFzIHNsaWNlOgoJCQkJcmV0dXJuIHRoaXMub3V0cHV0QnVmZmVyLnNsaWNlKDAsIHNsaWNlQW1vdW50KTsKCQkJfQoJCX0KCX0KfQpSZXNhbXBsZXIucHJvdG90eXBlLmluaXRpYWxpemVCdWZmZXJzID0gZnVuY3Rpb24gKCkgewoJLy9Jbml0aWFsaXplIHRoZSBpbnRlcm5hbCBidWZmZXI6Cgl0cnkgewoJCXRoaXMub3V0cHV0QnVmZmVyID0gbmV3IEZsb2F0MzJBcnJheSh0aGlzLm91dHB1dEJ1ZmZlclNpemUpOwoJCXRoaXMubGFzdE91dHB1dCA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5jaGFubmVscyk7Cgl9CgljYXRjaCAoZXJyb3IpIHsKCQl0aGlzLm91dHB1dEJ1ZmZlciA9IFtdOwoJCXRoaXMubGFzdE91dHB1dCA9IFtdOwoJfQp9";
const GB_resize_js = "ZnVuY3Rpb24gYmluZFJlc2l6ZSgpIHsNCiAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYWluQ2FudmFzIik7DQogIHZhciBnYW1lUmF0aW8gPSAxNjAgLyAxNDQ7DQoNCiAgZnVuY3Rpb24gb25SZXNpemUoKSB7DQogICAgdmFyIHdpbmRvd1JhdGlvID0gd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQ7DQogICAgaWYgKHdpbmRvd1JhdGlvIDwgZ2FtZVJhdGlvKSB7DQogICAgICBjYW52YXMuc3R5bGUud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCArICJweCI7DQogICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gImF1dG8iOw0KICAgIH0gZWxzZSB7DQogICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0ICsgInB4IjsNCiAgICAgIGNhbnZhcy5zdHlsZS53aWR0aCA9ICJhdXRvIjsNCiAgICB9DQogIH0NCg0KICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgb25SZXNpemUpOw0KICBvblJlc2l6ZSgpOw0KfQ0KDQpiaW5kUmVzaXplKCk7DQo=";
const GB_style_css = "Ym9keSB7CiAgYmFja2dyb3VuZDogIzAzMTkyMTsKICBjb2xvcjogI2ZmZjsKICBmb250LWZhbWlseTogIkhlbHZldGljYU5ldWUtTGlnaHQiLCAiSGVsdmV0aWNhIE5ldWUgTGlnaHQiLCAiSGVsdmV0aWNhIE5ldWUiLAogICAgSGVsdmV0aWNhLCBBcmlhbCwgIkx1Y2lkYSBHcmFuZGUiLCBzYW5zLXNlcmlmOwogIGZvbnQtd2VpZ2h0OiAzMDA7CiAgbWFyZ2luOiAwcHg7CiAgcGFkZGluZzogMHB4OwogIHRvdWNoLWFjdGlvbjogbm9uZTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgLXdlYmtpdC10b3VjaC1jYWxsb3V0OiBub25lOwogIHVzZXItc2VsZWN0OiBub25lOwogIG92ZXJmbG93OiBoaWRkZW47Cn0KCiNnYW1lIHsKICB3aWR0aDogMTAwJTsKICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgojZ2FtZSBjYW52YXMgewogIGltYWdlLXJlbmRlcmluZzogLW1vei1jcmlzcC1lZGdlczsKICBpbWFnZS1yZW5kZXJpbmc6IC13ZWJraXQtY3Jpc3AtZWRnZXM7CiAgaW1hZ2UtcmVuZGVyaW5nOiBwaXhlbGF0ZWQ7CiAgaW1hZ2UtcmVuZGVyaW5nOiBjcmlzcC1lZGdlczsKfQoKI2NvbnRyb2xsZXIgewogIGRpc3BsYXk6IG5vbmU7CiAgcG9zaXRpb246IGZpeGVkOwogIGJvdHRvbTogMHB4OwogIGhlaWdodDogMjEwcHg7CiAgd2lkdGg6IDEwMCU7CiAgdG91Y2gtYWN0aW9uOiBub25lOwogIG9wYWNpdHk6IDAuODsKfQoKI2NvbnRyb2xsZXJfZHBhZCB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGJvdHRvbTogMjBweDsKICBsZWZ0OiAwcHg7CiAgd2lkdGg6IDE4NHB4OwogIGhlaWdodDogMTg0cHg7Cn0KCiNjb250cm9sbGVyX2RwYWQ6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBibG9jazsKICB3aWR0aDogNDhweDsKICBoZWlnaHQ6IDQ4cHg7CiAgYmFja2dyb3VuZDogIzVjNWM1YzsKICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoCiAgICBlbGxpcHNlIGF0IGNlbnRlciwKICAgICM1YzVjNWMgMCUsCiAgICAjNTU1IDU5JSwKICAgICM1YzVjNWMgNjAlCiAgKTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogNjhweDsKICB0b3A6IDY4cHg7Cn0KCiNjb250cm9sbGVyX2xlZnQgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBsZWZ0OiAyMHB4OwogIHRvcDogNjhweDsKICB3aWR0aDogNDhweDsKICBoZWlnaHQ6IDQ4cHg7CiAgYmFja2dyb3VuZDogIzY2NjsKICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoZWxsaXBzZSBhdCBjZW50ZXIsICM2NjYgMCUsICM1YzVjNWMgODAlKTsKICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiA0cHg7CiAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogNHB4Owp9CgojY29udHJvbGxlcl9yaWdodCB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGxlZnQ6IDExNnB4OwogIHRvcDogNjhweDsKICB3aWR0aDogNDhweDsKICBoZWlnaHQ6IDQ4cHg7CiAgYmFja2dyb3VuZDogIzY2NjsKICBiYWNrZ3JvdW5kOiByYWRpYWwtZ3JhZGllbnQoZWxsaXBzZSBhdCBjZW50ZXIsICM2NjYgMCUsICM1YzVjNWMgODAlKTsKICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogNHB4OwogIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiA0cHg7Cn0KCiNjb250cm9sbGVyX3VwIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogNjhweDsKICB0b3A6IDIwcHg7CiAgd2lkdGg6IDQ4cHg7CiAgaGVpZ2h0OiA0OHB4OwogIGJhY2tncm91bmQ6ICM2NjY7CiAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGVsbGlwc2UgYXQgY2VudGVyLCAjNjY2IDAlLCAjNWM1YzVjIDgwJSk7CiAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogNHB4OwogIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiA0cHg7Cn0KCiNjb250cm9sbGVyX2Rvd24gewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBsZWZ0OiA2OHB4OwogIHRvcDogMTE2cHg7CiAgd2lkdGg6IDQ4cHg7CiAgaGVpZ2h0OiA0OHB4OwogIGJhY2tncm91bmQ6ICM2NjY7CiAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGVsbGlwc2UgYXQgY2VudGVyLCAjNjY2IDAlLCAjNWM1YzVjIDgwJSk7CiAgYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czogNHB4OwogIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiA0cHg7Cn0KCiNjb250cm9sbGVyX2EgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBib3R0b206IDExMHB4OwogIHJpZ2h0OiAyMHB4Owp9CgojY29udHJvbGxlcl9iIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgYm90dG9tOiA4MHB4OwogIHJpZ2h0OiAxMDBweDsKfQoKLnJvdW5kQnRuIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgZm9udC1zaXplOiAzMnB4OwogIGNvbG9yOiAjNDQwZjFmOwogIGxpbmUtaGVpZ2h0OiA2NHB4OwogIHdpZHRoOiA2NHB4OwogIGhlaWdodDogNjRweDsKICBib3JkZXItcmFkaXVzOiA2NHB4OwogIGJhY2tncm91bmQ6ICM4NzBhNGM7CiAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGVsbGlwc2UgYXQgY2VudGVyLCAjYWIxNDY1IDAlLCAjOGIxZTU3IDEwMCUpOwogIGJveC1zaGFkb3c6IDBweCA0cHggNXB4IHJnYmEoMCwgMCwgMCwgMC4yKTsKfQoKLmNhcHN1bGVCdG4gewogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGZvbnQtc2l6ZTogMTBweDsKICBjb2xvcjogIzExMTsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgbGluZS1oZWlnaHQ6IDQwcHg7CiAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsKICB3aWR0aDogNjRweDsKICBoZWlnaHQ6IDMycHg7CiAgYm9yZGVyLXJhZGl1czogNDBweDsKICBiYWNrZ3JvdW5kOiAjMjIyOwogIGJhY2tncm91bmQ6IHJhZGlhbC1ncmFkaWVudChlbGxpcHNlIGF0IGNlbnRlciwgIzY2NiAwJSwgIzU1NSAxMDAlKTsKICBib3gtc2hhZG93OiAwcHggNHB4IDVweCByZ2JhKDAsIDAsIDAsIDAuMik7Cn0KCiNjb250cm9sbGVyX3N0YXJ0IHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgYm90dG9tOiAyMHB4OwogIHJpZ2h0OiAxNXB4Owp9CgojY29udHJvbGxlcl9zZWxlY3QgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBib3R0b206IDIwcHg7CiAgcmlnaHQ6IDEwMHB4Owp9CgouYnRuUHJlc3NlZCB7CiAgb3BhY2l0eTogMC41Owp9Cgouc3Bpbm5lciB7CiAgaGVpZ2h0OiA1MHB4OwogIHdpZHRoOiA1MHB4OwogIG1hcmdpbjogMHB4IGF1dG87CiAgLXdlYmtpdC1hbmltYXRpb246IHJvdGF0aW9uIDAuOHMgbGluZWFyIGluZmluaXRlOwogIC1tb3otYW5pbWF0aW9uOiByb3RhdGlvbiAwLjhzIGxpbmVhciBpbmZpbml0ZTsKICAtby1hbmltYXRpb246IHJvdGF0aW9uIDAuOHMgbGluZWFyIGluZmluaXRlOwogIGFuaW1hdGlvbjogcm90YXRpb24gMC44cyBsaW5lYXIgaW5maW5pdGU7CiAgYm9yZGVyLWxlZnQ6IDEwcHggc29saWQgIzMwNjg1MDsKICBib3JkZXItcmlnaHQ6IDEwcHggc29saWQgIzMwNjg1MDsKICBib3JkZXItYm90dG9tOiAxMHB4IHNvbGlkICMzMDY4NTA7CiAgYm9yZGVyLXRvcDogMTBweCBzb2xpZCAjODhjMDcwOwogIGJvcmRlci1yYWRpdXM6IDEwMCU7CiAgYmFja2dyb3VuZC1jb2xvcjogIzAzMTkyMTsKfQpALXdlYmtpdC1rZXlmcmFtZXMgcm90YXRpb24gewogIGZyb20gewogICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTsKICB9CiAgdG8gewogICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOwogIH0KfQpALW1vei1rZXlmcmFtZXMgcm90YXRpb24gewogIGZyb20gewogICAgLW1vei10cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTsKICB9CiAgdG8gewogICAgLW1vei10cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOwogIH0KfQpALW8ta2V5ZnJhbWVzIHJvdGF0aW9uIHsKICBmcm9tIHsKICAgIC1vLXRyYW5zZm9ybTogcm90YXRlKDBkZWcpOwogIH0KICB0byB7CiAgICAtby10cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOwogIH0KfQpAa2V5ZnJhbWVzIHJvdGF0aW9uIHsKICBmcm9tIHsKICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpOwogIH0KICB0byB7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOwogIH0KfQoKQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA2NDBweCkgewogICNnYW1lIGNhbnZhcyB7CiAgICBtYXJnaW4tdG9wOiAwcHg7CiAgICB3aWR0aDogMTAwJTsKICAgIG1heC13aWR0aDogNDgwcHg7CiAgICBib3JkZXI6IDBweDsKICAgIGJvcmRlci1yYWRpdXM6IDBweDsKICB9Cn0KCkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1heC1kZXZpY2Utd2lkdGg6IDgxMnB4KSBhbmQgKG9yaWVudGF0aW9uOiBwb3J0cmFpdCkgewogIGJvZHkgewogICAgbWFyZ2luOiAwOwogIH0KCiAgI2dhbWUgewogICAgd2lkdGg6IDEwMCU7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgfQoKICAjZ2FtZSBjYW52YXMgewogICAgbWFyZ2luOiAwOwogICAgZGlzcGxheTogYmxvY2s7CiAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7CiAgfQp9CgpAbWVkaWEgb25seSBzY3JlZW4gYW5kIChtYXgtZGV2aWNlLXdpZHRoOiAzMjBweCkgYW5kIChvcmllbnRhdGlvbjogcG9ydHJhaXQpIHsKICAjY29udHJvbGxlcl9kcGFkIHsKICAgIGxlZnQ6IC01cHg7CiAgICBib3R0b206IC01cHg7CiAgfQoKICAjY29udHJvbGxlcl9hIHsKICAgIHJpZ2h0OiA1cHg7CiAgICBib3R0b206IDk1cHg7CiAgfQoKICAjY29udHJvbGxlcl9iIHsKICAgIHJpZ2h0OiA4MHB4OwogIH0KCiAgI2NvbnRyb2xsZXJfc3RhcnQgewogICAgcmlnaHQ6IDVweDsKICB9CgogICNjb250cm9sbGVyX3NlbGVjdCB7CiAgICByaWdodDogODBweDsKICB9Cn0KCkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1heC13aWR0aDogNTAwcHgpIGFuZCAobWF4LWhlaWdodDogNDAwcHgpIHsKICAjY29udHJvbGxlciB7CiAgICBkaXNwbGF5OiBub25lOwogIH0KfQoKLyogU21hbGwgZGV2aWNlcyBpbiBsYW5kc2NhcGUgKi8KQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWF4LWRldmljZS13aWR0aDogMzAwcHgpIGFuZCAob3JpZW50YXRpb246IGxhbmRzY2FwZSkgewogIGh0bWwsCiAgYm9keSB7CiAgICBoZWlnaHQ6IDEwMCU7CiAgfQogIGJvZHkgewogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICB9CgogICNnYW1lOmFmdGVyIHsKICAgIGNvbnRlbnQ6ICJQTEVBU0UgUk9UQVRFIOKGuyI7CiAgICBmb250LXNpemU6IDI0cHg7CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGNvbG9yOiAjZmZmOwogIH0KCiAgI2dhbWUgY2FudmFzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICBtYXgtd2lkdGg6IDQ4MHB4OwogIH0KCiAgI2NvbnRyb2xsZXIgewogICAgZGlzcGxheTogbm9uZTsKICB9Cn0KCi8qIERldmljZXMgbGFyZ2UgZW5vdWdoIGZvciBsYW5kc2NhcGUgKi8KQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAzMDBweCkgYW5kIChvcmllbnRhdGlvbjogbGFuZHNjYXBlKSB7CiAgI2NvbnRyb2xsZXIgewogICAgYm90dG9tOiA1MCU7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoNTAlKTsKICAgIG9wYWNpdHk6IDAuNTsKICB9Cn0KCg==";
const GB_swf_object_js = "LyoJU1dGT2JqZWN0IHYyLjIgPGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9zd2ZvYmplY3QvPiAKCWlzIHJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZSA8aHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHA+IAoqLwp2YXIgc3dmb2JqZWN0PWZ1bmN0aW9uKCl7dmFyIEQ9InVuZGVmaW5lZCIscj0ib2JqZWN0IixTPSJTaG9ja3dhdmUgRmxhc2giLFc9IlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoIixxPSJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaCIsUj0iU1dGT2JqZWN0RXhwckluc3QiLHg9Im9ucmVhZHlzdGF0ZWNoYW5nZSIsTz13aW5kb3csaj1kb2N1bWVudCx0PW5hdmlnYXRvcixUPWZhbHNlLFU9W2hdLG89W10sTj1bXSxJPVtdLGwsUSxFLEIsSj1mYWxzZSxhPWZhbHNlLG4sRyxtPXRydWUsTT1mdW5jdGlvbigpe3ZhciBhYT10eXBlb2Ygai5nZXRFbGVtZW50QnlJZCE9RCYmdHlwZW9mIGouZ2V0RWxlbWVudHNCeVRhZ05hbWUhPUQmJnR5cGVvZiBqLmNyZWF0ZUVsZW1lbnQhPUQsYWg9dC51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSxZPXQucGxhdGZvcm0udG9Mb3dlckNhc2UoKSxhZT1ZPy93aW4vLnRlc3QoWSk6L3dpbi8udGVzdChhaCksYWM9WT8vbWFjLy50ZXN0KFkpOi9tYWMvLnRlc3QoYWgpLGFmPS93ZWJraXQvLnRlc3QoYWgpP3BhcnNlRmxvYXQoYWgucmVwbGFjZSgvXi4qd2Via2l0XC8oXGQrKFwuXGQrKT8pLiokLywiJDEiKSk6ZmFsc2UsWD0hKyJcdjEiLGFnPVswLDAsMF0sYWI9bnVsbDtpZih0eXBlb2YgdC5wbHVnaW5zIT1EJiZ0eXBlb2YgdC5wbHVnaW5zW1NdPT1yKXthYj10LnBsdWdpbnNbU10uZGVzY3JpcHRpb247aWYoYWImJiEodHlwZW9mIHQubWltZVR5cGVzIT1EJiZ0Lm1pbWVUeXBlc1txXSYmIXQubWltZVR5cGVzW3FdLmVuYWJsZWRQbHVnaW4pKXtUPXRydWU7WD1mYWxzZTthYj1hYi5yZXBsYWNlKC9eLipccysoXFMrXHMrXFMrJCkvLCIkMSIpO2FnWzBdPXBhcnNlSW50KGFiLnJlcGxhY2UoL14oLiopXC4uKiQvLCIkMSIpLDEwKTthZ1sxXT1wYXJzZUludChhYi5yZXBsYWNlKC9eLipcLiguKilccy4qJC8sIiQxIiksMTApO2FnWzJdPS9bYS16QS1aXS8udGVzdChhYik/cGFyc2VJbnQoYWIucmVwbGFjZSgvXi4qW2EtekEtWl0rKC4qKSQvLCIkMSIpLDEwKTowfX1lbHNle2lmKHR5cGVvZiBPLkFjdGl2ZVhPYmplY3QhPUQpe3RyeXt2YXIgYWQ9bmV3IEFjdGl2ZVhPYmplY3QoVyk7aWYoYWQpe2FiPWFkLkdldFZhcmlhYmxlKCIkdmVyc2lvbiIpO2lmKGFiKXtYPXRydWU7YWI9YWIuc3BsaXQoIiAiKVsxXS5zcGxpdCgiLCIpO2FnPVtwYXJzZUludChhYlswXSwxMCkscGFyc2VJbnQoYWJbMV0sMTApLHBhcnNlSW50KGFiWzJdLDEwKV19fX1jYXRjaChaKXt9fX1yZXR1cm57dzM6YWEscHY6YWcsd2s6YWYsaWU6WCx3aW46YWUsbWFjOmFjfX0oKSxrPWZ1bmN0aW9uKCl7aWYoIU0udzMpe3JldHVybn1pZigodHlwZW9mIGoucmVhZHlTdGF0ZSE9RCYmai5yZWFkeVN0YXRlPT0iY29tcGxldGUiKXx8KHR5cGVvZiBqLnJlYWR5U3RhdGU9PUQmJihqLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF18fGouYm9keSkpKXtmKCl9aWYoIUope2lmKHR5cGVvZiBqLmFkZEV2ZW50TGlzdGVuZXIhPUQpe2ouYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsZixmYWxzZSl9aWYoTS5pZSYmTS53aW4pe2ouYXR0YWNoRXZlbnQoeCxmdW5jdGlvbigpe2lmKGoucmVhZHlTdGF0ZT09ImNvbXBsZXRlIil7ai5kZXRhY2hFdmVudCh4LGFyZ3VtZW50cy5jYWxsZWUpO2YoKX19KTtpZihPPT10b3ApeyhmdW5jdGlvbigpe2lmKEope3JldHVybn10cnl7ai5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwoImxlZnQiKX1jYXRjaChYKXtzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUsMCk7cmV0dXJufWYoKX0pKCl9fWlmKE0ud2speyhmdW5jdGlvbigpe2lmKEope3JldHVybn1pZighL2xvYWRlZHxjb21wbGV0ZS8udGVzdChqLnJlYWR5U3RhdGUpKXtzZXRUaW1lb3V0KGFyZ3VtZW50cy5jYWxsZWUsMCk7cmV0dXJufWYoKX0pKCl9cyhmKX19KCk7ZnVuY3Rpb24gZigpe2lmKEope3JldHVybn10cnl7dmFyIFo9ai5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdLmFwcGVuZENoaWxkKEMoInNwYW4iKSk7Wi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKFopfWNhdGNoKGFhKXtyZXR1cm59Sj10cnVlO3ZhciBYPVUubGVuZ3RoO2Zvcih2YXIgWT0wO1k8WDtZKyspe1VbWV0oKX19ZnVuY3Rpb24gSyhYKXtpZihKKXtYKCl9ZWxzZXtVW1UubGVuZ3RoXT1YfX1mdW5jdGlvbiBzKFkpe2lmKHR5cGVvZiBPLmFkZEV2ZW50TGlzdGVuZXIhPUQpe08uYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsWSxmYWxzZSl9ZWxzZXtpZih0eXBlb2Ygai5hZGRFdmVudExpc3RlbmVyIT1EKXtqLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLFksZmFsc2UpfWVsc2V7aWYodHlwZW9mIE8uYXR0YWNoRXZlbnQhPUQpe2koTywib25sb2FkIixZKX1lbHNle2lmKHR5cGVvZiBPLm9ubG9hZD09ImZ1bmN0aW9uIil7dmFyIFg9Ty5vbmxvYWQ7Ty5vbmxvYWQ9ZnVuY3Rpb24oKXtYKCk7WSgpfX1lbHNle08ub25sb2FkPVl9fX19fWZ1bmN0aW9uIGgoKXtpZihUKXtWKCl9ZWxzZXtIKCl9fWZ1bmN0aW9uIFYoKXt2YXIgWD1qLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07dmFyIGFhPUMocik7YWEuc2V0QXR0cmlidXRlKCJ0eXBlIixxKTt2YXIgWj1YLmFwcGVuZENoaWxkKGFhKTtpZihaKXt2YXIgWT0wOyhmdW5jdGlvbigpe2lmKHR5cGVvZiBaLkdldFZhcmlhYmxlIT1EKXt2YXIgYWI9Wi5HZXRWYXJpYWJsZSgiJHZlcnNpb24iKTtpZihhYil7YWI9YWIuc3BsaXQoIiAiKVsxXS5zcGxpdCgiLCIpO00ucHY9W3BhcnNlSW50KGFiWzBdLDEwKSxwYXJzZUludChhYlsxXSwxMCkscGFyc2VJbnQoYWJbMl0sMTApXX19ZWxzZXtpZihZPDEwKXtZKys7c2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLDEwKTtyZXR1cm59fVgucmVtb3ZlQ2hpbGQoYWEpO1o9bnVsbDtIKCl9KSgpfWVsc2V7SCgpfX1mdW5jdGlvbiBIKCl7dmFyIGFnPW8ubGVuZ3RoO2lmKGFnPjApe2Zvcih2YXIgYWY9MDthZjxhZzthZisrKXt2YXIgWT1vW2FmXS5pZDt2YXIgYWI9b1thZl0uY2FsbGJhY2tGbjt2YXIgYWE9e3N1Y2Nlc3M6ZmFsc2UsaWQ6WX07aWYoTS5wdlswXT4wKXt2YXIgYWU9YyhZKTtpZihhZSl7aWYoRihvW2FmXS5zd2ZWZXJzaW9uKSYmIShNLndrJiZNLndrPDMxMikpe3coWSx0cnVlKTtpZihhYil7YWEuc3VjY2Vzcz10cnVlO2FhLnJlZj16KFkpO2FiKGFhKX19ZWxzZXtpZihvW2FmXS5leHByZXNzSW5zdGFsbCYmQSgpKXt2YXIgYWk9e307YWkuZGF0YT1vW2FmXS5leHByZXNzSW5zdGFsbDthaS53aWR0aD1hZS5nZXRBdHRyaWJ1dGUoIndpZHRoIil8fCIwIjthaS5oZWlnaHQ9YWUuZ2V0QXR0cmlidXRlKCJoZWlnaHQiKXx8IjAiO2lmKGFlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSl7YWkuc3R5bGVjbGFzcz1hZS5nZXRBdHRyaWJ1dGUoImNsYXNzIil9aWYoYWUuZ2V0QXR0cmlidXRlKCJhbGlnbiIpKXthaS5hbGlnbj1hZS5nZXRBdHRyaWJ1dGUoImFsaWduIil9dmFyIGFoPXt9O3ZhciBYPWFlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJhbSIpO3ZhciBhYz1YLmxlbmd0aDtmb3IodmFyIGFkPTA7YWQ8YWM7YWQrKyl7aWYoWFthZF0uZ2V0QXR0cmlidXRlKCJuYW1lIikudG9Mb3dlckNhc2UoKSE9Im1vdmllIil7YWhbWFthZF0uZ2V0QXR0cmlidXRlKCJuYW1lIildPVhbYWRdLmdldEF0dHJpYnV0ZSgidmFsdWUiKX19UChhaSxhaCxZLGFiKX1lbHNle3AoYWUpO2lmKGFiKXthYihhYSl9fX19fWVsc2V7dyhZLHRydWUpO2lmKGFiKXt2YXIgWj16KFkpO2lmKFomJnR5cGVvZiBaLlNldFZhcmlhYmxlIT1EKXthYS5zdWNjZXNzPXRydWU7YWEucmVmPVp9YWIoYWEpfX19fX1mdW5jdGlvbiB6KGFhKXt2YXIgWD1udWxsO3ZhciBZPWMoYWEpO2lmKFkmJlkubm9kZU5hbWU9PSJPQkpFQ1QiKXtpZih0eXBlb2YgWS5TZXRWYXJpYWJsZSE9RCl7WD1ZfWVsc2V7dmFyIFo9WS5nZXRFbGVtZW50c0J5VGFnTmFtZShyKVswXTtpZihaKXtYPVp9fX1yZXR1cm4gWH1mdW5jdGlvbiBBKCl7cmV0dXJuICFhJiZGKCI2LjAuNjUiKSYmKE0ud2lufHxNLm1hYykmJiEoTS53ayYmTS53azwzMTIpfWZ1bmN0aW9uIFAoYWEsYWIsWCxaKXthPXRydWU7RT1afHxudWxsO0I9e3N1Y2Nlc3M6ZmFsc2UsaWQ6WH07dmFyIGFlPWMoWCk7aWYoYWUpe2lmKGFlLm5vZGVOYW1lPT0iT0JKRUNUIil7bD1nKGFlKTtRPW51bGx9ZWxzZXtsPWFlO1E9WH1hYS5pZD1SO2lmKHR5cGVvZiBhYS53aWR0aD09RHx8KCEvJSQvLnRlc3QoYWEud2lkdGgpJiZwYXJzZUludChhYS53aWR0aCwxMCk8MzEwKSl7YWEud2lkdGg9IjMxMCJ9aWYodHlwZW9mIGFhLmhlaWdodD09RHx8KCEvJSQvLnRlc3QoYWEuaGVpZ2h0KSYmcGFyc2VJbnQoYWEuaGVpZ2h0LDEwKTwxMzcpKXthYS5oZWlnaHQ9IjEzNyJ9ai50aXRsZT1qLnRpdGxlLnNsaWNlKDAsNDcpKyIgLSBGbGFzaCBQbGF5ZXIgSW5zdGFsbGF0aW9uIjt2YXIgYWQ9TS5pZSYmTS53aW4/IkFjdGl2ZVgiOiJQbHVnSW4iLGFjPSJNTXJlZGlyZWN0VVJMPSIrTy5sb2NhdGlvbi50b1N0cmluZygpLnJlcGxhY2UoLyYvZywiJTI2IikrIiZNTXBsYXllclR5cGU9IithZCsiJk1NZG9jdGl0bGU9IitqLnRpdGxlO2lmKHR5cGVvZiBhYi5mbGFzaHZhcnMhPUQpe2FiLmZsYXNodmFycys9IiYiK2FjfWVsc2V7YWIuZmxhc2h2YXJzPWFjfWlmKE0uaWUmJk0ud2luJiZhZS5yZWFkeVN0YXRlIT00KXt2YXIgWT1DKCJkaXYiKTtYKz0iU1dGT2JqZWN0TmV3IjtZLnNldEF0dHJpYnV0ZSgiaWQiLFgpO2FlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKFksYWUpO2FlLnN0eWxlLmRpc3BsYXk9Im5vbmUiOyhmdW5jdGlvbigpe2lmKGFlLnJlYWR5U3RhdGU9PTQpe2FlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYWUpfWVsc2V7c2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLDEwKX19KSgpfXUoYWEsYWIsWCl9fWZ1bmN0aW9uIHAoWSl7aWYoTS5pZSYmTS53aW4mJlkucmVhZHlTdGF0ZSE9NCl7dmFyIFg9QygiZGl2Iik7WS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShYLFkpO1gucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZyhZKSxYKTtZLnN0eWxlLmRpc3BsYXk9Im5vbmUiOyhmdW5jdGlvbigpe2lmKFkucmVhZHlTdGF0ZT09NCl7WS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKFkpfWVsc2V7c2V0VGltZW91dChhcmd1bWVudHMuY2FsbGVlLDEwKX19KSgpfWVsc2V7WS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChnKFkpLFkpfX1mdW5jdGlvbiBnKGFiKXt2YXIgYWE9QygiZGl2Iik7aWYoTS53aW4mJk0uaWUpe2FhLmlubmVySFRNTD1hYi5pbm5lckhUTUx9ZWxzZXt2YXIgWT1hYi5nZXRFbGVtZW50c0J5VGFnTmFtZShyKVswXTtpZihZKXt2YXIgYWQ9WS5jaGlsZE5vZGVzO2lmKGFkKXt2YXIgWD1hZC5sZW5ndGg7Zm9yKHZhciBaPTA7WjxYO1orKyl7aWYoIShhZFtaXS5ub2RlVHlwZT09MSYmYWRbWl0ubm9kZU5hbWU9PSJQQVJBTSIpJiYhKGFkW1pdLm5vZGVUeXBlPT04KSl7YWEuYXBwZW5kQ2hpbGQoYWRbWl0uY2xvbmVOb2RlKHRydWUpKX19fX19cmV0dXJuIGFhfWZ1bmN0aW9uIHUoYWksYWcsWSl7dmFyIFgsYWE9YyhZKTtpZihNLndrJiZNLndrPDMxMil7cmV0dXJuIFh9aWYoYWEpe2lmKHR5cGVvZiBhaS5pZD09RCl7YWkuaWQ9WX1pZihNLmllJiZNLndpbil7dmFyIGFoPSIiO2Zvcih2YXIgYWUgaW4gYWkpe2lmKGFpW2FlXSE9T2JqZWN0LnByb3RvdHlwZVthZV0pe2lmKGFlLnRvTG93ZXJDYXNlKCk9PSJkYXRhIil7YWcubW92aWU9YWlbYWVdfWVsc2V7aWYoYWUudG9Mb3dlckNhc2UoKT09InN0eWxlY2xhc3MiKXthaCs9JyBjbGFzcz0iJythaVthZV0rJyInfWVsc2V7aWYoYWUudG9Mb3dlckNhc2UoKSE9ImNsYXNzaWQiKXthaCs9IiAiK2FlKyc9IicrYWlbYWVdKyciJ319fX19dmFyIGFmPSIiO2Zvcih2YXIgYWQgaW4gYWcpe2lmKGFnW2FkXSE9T2JqZWN0LnByb3RvdHlwZVthZF0pe2FmKz0nPHBhcmFtIG5hbWU9IicrYWQrJyIgdmFsdWU9IicrYWdbYWRdKyciIC8+J319YWEub3V0ZXJIVE1MPSc8b2JqZWN0IGNsYXNzaWQ9ImNsc2lkOkQyN0NEQjZFLUFFNkQtMTFjZi05NkI4LTQ0NDU1MzU0MDAwMCInK2FoKyI+IithZisiPC9vYmplY3Q+IjtOW04ubGVuZ3RoXT1haS5pZDtYPWMoYWkuaWQpfWVsc2V7dmFyIFo9QyhyKTtaLnNldEF0dHJpYnV0ZSgidHlwZSIscSk7Zm9yKHZhciBhYyBpbiBhaSl7aWYoYWlbYWNdIT1PYmplY3QucHJvdG90eXBlW2FjXSl7aWYoYWMudG9Mb3dlckNhc2UoKT09InN0eWxlY2xhc3MiKXtaLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGFpW2FjXSl9ZWxzZXtpZihhYy50b0xvd2VyQ2FzZSgpIT0iY2xhc3NpZCIpe1ouc2V0QXR0cmlidXRlKGFjLGFpW2FjXSl9fX19Zm9yKHZhciBhYiBpbiBhZyl7aWYoYWdbYWJdIT1PYmplY3QucHJvdG90eXBlW2FiXSYmYWIudG9Mb3dlckNhc2UoKSE9Im1vdmllIil7ZShaLGFiLGFnW2FiXSl9fWFhLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKFosYWEpO1g9Wn19cmV0dXJuIFh9ZnVuY3Rpb24gZShaLFgsWSl7dmFyIGFhPUMoInBhcmFtIik7YWEuc2V0QXR0cmlidXRlKCJuYW1lIixYKTthYS5zZXRBdHRyaWJ1dGUoInZhbHVlIixZKTtaLmFwcGVuZENoaWxkKGFhKX1mdW5jdGlvbiB5KFkpe3ZhciBYPWMoWSk7aWYoWCYmWC5ub2RlTmFtZT09Ik9CSkVDVCIpe2lmKE0uaWUmJk0ud2luKXtYLnN0eWxlLmRpc3BsYXk9Im5vbmUiOyhmdW5jdGlvbigpe2lmKFgucmVhZHlTdGF0ZT09NCl7YihZKX1lbHNle3NldFRpbWVvdXQoYXJndW1lbnRzLmNhbGxlZSwxMCl9fSkoKX1lbHNle1gucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChYKX19fWZ1bmN0aW9uIGIoWil7dmFyIFk9YyhaKTtpZihZKXtmb3IodmFyIFggaW4gWSl7aWYodHlwZW9mIFlbWF09PSJmdW5jdGlvbiIpe1lbWF09bnVsbH19WS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKFkpfX1mdW5jdGlvbiBjKFope3ZhciBYPW51bGw7dHJ5e1g9ai5nZXRFbGVtZW50QnlJZChaKX1jYXRjaChZKXt9cmV0dXJuIFh9ZnVuY3Rpb24gQyhYKXtyZXR1cm4gai5jcmVhdGVFbGVtZW50KFgpfWZ1bmN0aW9uIGkoWixYLFkpe1ouYXR0YWNoRXZlbnQoWCxZKTtJW0kubGVuZ3RoXT1bWixYLFldfWZ1bmN0aW9uIEYoWil7dmFyIFk9TS5wdixYPVouc3BsaXQoIi4iKTtYWzBdPXBhcnNlSW50KFhbMF0sMTApO1hbMV09cGFyc2VJbnQoWFsxXSwxMCl8fDA7WFsyXT1wYXJzZUludChYWzJdLDEwKXx8MDtyZXR1cm4oWVswXT5YWzBdfHwoWVswXT09WFswXSYmWVsxXT5YWzFdKXx8KFlbMF09PVhbMF0mJllbMV09PVhbMV0mJllbMl0+PVhbMl0pKT90cnVlOmZhbHNlfWZ1bmN0aW9uIHYoYWMsWSxhZCxhYil7aWYoTS5pZSYmTS5tYWMpe3JldHVybn12YXIgYWE9ai5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdO2lmKCFhYSl7cmV0dXJufXZhciBYPShhZCYmdHlwZW9mIGFkPT0ic3RyaW5nIik/YWQ6InNjcmVlbiI7aWYoYWIpe249bnVsbDtHPW51bGx9aWYoIW58fEchPVgpe3ZhciBaPUMoInN0eWxlIik7Wi5zZXRBdHRyaWJ1dGUoInR5cGUiLCJ0ZXh0L2NzcyIpO1ouc2V0QXR0cmlidXRlKCJtZWRpYSIsWCk7bj1hYS5hcHBlbmRDaGlsZChaKTtpZihNLmllJiZNLndpbiYmdHlwZW9mIGouc3R5bGVTaGVldHMhPUQmJmouc3R5bGVTaGVldHMubGVuZ3RoPjApe249ai5zdHlsZVNoZWV0c1tqLnN0eWxlU2hlZXRzLmxlbmd0aC0xXX1HPVh9aWYoTS5pZSYmTS53aW4pe2lmKG4mJnR5cGVvZiBuLmFkZFJ1bGU9PXIpe24uYWRkUnVsZShhYyxZKX19ZWxzZXtpZihuJiZ0eXBlb2Ygai5jcmVhdGVUZXh0Tm9kZSE9RCl7bi5hcHBlbmRDaGlsZChqLmNyZWF0ZVRleHROb2RlKGFjKyIgeyIrWSsifSIpKX19fWZ1bmN0aW9uIHcoWixYKXtpZighbSl7cmV0dXJufXZhciBZPVg/InZpc2libGUiOiJoaWRkZW4iO2lmKEomJmMoWikpe2MoWikuc3R5bGUudmlzaWJpbGl0eT1ZfWVsc2V7digiIyIrWiwidmlzaWJpbGl0eToiK1kpfX1mdW5jdGlvbiBMKFkpe3ZhciBaPS9bXFxcIjw+XC47XS87dmFyIFg9Wi5leGVjKFkpIT1udWxsO3JldHVybiBYJiZ0eXBlb2YgZW5jb2RlVVJJQ29tcG9uZW50IT1EP2VuY29kZVVSSUNvbXBvbmVudChZKTpZfXZhciBkPWZ1bmN0aW9uKCl7aWYoTS5pZSYmTS53aW4pe3dpbmRvdy5hdHRhY2hFdmVudCgib251bmxvYWQiLGZ1bmN0aW9uKCl7dmFyIGFjPUkubGVuZ3RoO2Zvcih2YXIgYWI9MDthYjxhYzthYisrKXtJW2FiXVswXS5kZXRhY2hFdmVudChJW2FiXVsxXSxJW2FiXVsyXSl9dmFyIFo9Ti5sZW5ndGg7Zm9yKHZhciBhYT0wO2FhPFo7YWErKyl7eShOW2FhXSl9Zm9yKHZhciBZIGluIE0pe01bWV09bnVsbH1NPW51bGw7Zm9yKHZhciBYIGluIHN3Zm9iamVjdCl7c3dmb2JqZWN0W1hdPW51bGx9c3dmb2JqZWN0PW51bGx9KX19KCk7cmV0dXJue3JlZ2lzdGVyT2JqZWN0OmZ1bmN0aW9uKGFiLFgsYWEsWil7aWYoTS53MyYmYWImJlgpe3ZhciBZPXt9O1kuaWQ9YWI7WS5zd2ZWZXJzaW9uPVg7WS5leHByZXNzSW5zdGFsbD1hYTtZLmNhbGxiYWNrRm49WjtvW28ubGVuZ3RoXT1ZO3coYWIsZmFsc2UpfWVsc2V7aWYoWil7Wih7c3VjY2VzczpmYWxzZSxpZDphYn0pfX19LGdldE9iamVjdEJ5SWQ6ZnVuY3Rpb24oWCl7aWYoTS53Myl7cmV0dXJuIHooWCl9fSxlbWJlZFNXRjpmdW5jdGlvbihhYixhaCxhZSxhZyxZLGFhLFosYWQsYWYsYWMpe3ZhciBYPXtzdWNjZXNzOmZhbHNlLGlkOmFofTtpZihNLnczJiYhKE0ud2smJk0ud2s8MzEyKSYmYWImJmFoJiZhZSYmYWcmJlkpe3coYWgsZmFsc2UpO0soZnVuY3Rpb24oKXthZSs9IiI7YWcrPSIiO3ZhciBhaj17fTtpZihhZiYmdHlwZW9mIGFmPT09cil7Zm9yKHZhciBhbCBpbiBhZil7YWpbYWxdPWFmW2FsXX19YWouZGF0YT1hYjthai53aWR0aD1hZTthai5oZWlnaHQ9YWc7dmFyIGFtPXt9O2lmKGFkJiZ0eXBlb2YgYWQ9PT1yKXtmb3IodmFyIGFrIGluIGFkKXthbVtha109YWRbYWtdfX1pZihaJiZ0eXBlb2YgWj09PXIpe2Zvcih2YXIgYWkgaW4gWil7aWYodHlwZW9mIGFtLmZsYXNodmFycyE9RCl7YW0uZmxhc2h2YXJzKz0iJiIrYWkrIj0iK1pbYWldfWVsc2V7YW0uZmxhc2h2YXJzPWFpKyI9IitaW2FpXX19fWlmKEYoWSkpe3ZhciBhbj11KGFqLGFtLGFoKTtpZihhai5pZD09YWgpe3coYWgsdHJ1ZSl9WC5zdWNjZXNzPXRydWU7WC5yZWY9YW59ZWxzZXtpZihhYSYmQSgpKXthai5kYXRhPWFhO1AoYWosYW0sYWgsYWMpO3JldHVybn1lbHNle3coYWgsdHJ1ZSl9fWlmKGFjKXthYyhYKX19KX1lbHNle2lmKGFjKXthYyhYKX19fSxzd2l0Y2hPZmZBdXRvSGlkZVNob3c6ZnVuY3Rpb24oKXttPWZhbHNlfSx1YTpNLGdldEZsYXNoUGxheWVyVmVyc2lvbjpmdW5jdGlvbigpe3JldHVybnttYWpvcjpNLnB2WzBdLG1pbm9yOk0ucHZbMV0scmVsZWFzZTpNLnB2WzJdfX0saGFzRmxhc2hQbGF5ZXJWZXJzaW9uOkYsY3JlYXRlU1dGOmZ1bmN0aW9uKFosWSxYKXtpZihNLnczKXtyZXR1cm4gdShaLFksWCl9ZWxzZXtyZXR1cm4gdW5kZWZpbmVkfX0sc2hvd0V4cHJlc3NJbnN0YWxsOmZ1bmN0aW9uKFosYWEsWCxZKXtpZihNLnczJiZBKCkpe1AoWixhYSxYLFkpfX0scmVtb3ZlU1dGOmZ1bmN0aW9uKFgpe2lmKE0udzMpe3koWCl9fSxjcmVhdGVDU1M6ZnVuY3Rpb24oYWEsWixZLFgpe2lmKE0udzMpe3YoYWEsWixZLFgpfX0sYWRkRG9tTG9hZEV2ZW50OkssYWRkTG9hZEV2ZW50OnMsZ2V0UXVlcnlQYXJhbVZhbHVlOmZ1bmN0aW9uKGFhKXt2YXIgWj1qLmxvY2F0aW9uLnNlYXJjaHx8ai5sb2NhdGlvbi5oYXNoO2lmKFope2lmKC9cPy8udGVzdChaKSl7Wj1aLnNwbGl0KCI/IilbMV19aWYoYWE9PW51bGwpe3JldHVybiBMKFopfXZhciBZPVouc3BsaXQoIiYiKTtmb3IodmFyIFg9MDtYPFkubGVuZ3RoO1grKyl7aWYoWVtYXS5zdWJzdHJpbmcoMCxZW1hdLmluZGV4T2YoIj0iKSk9PWFhKXtyZXR1cm4gTChZW1hdLnN1YnN0cmluZygoWVtYXS5pbmRleE9mKCI9IikrMSkpKX19fXJldHVybiIifSxleHByZXNzSW5zdGFsbENhbGxiYWNrOmZ1bmN0aW9uKCl7aWYoYSl7dmFyIFg9YyhSKTtpZihYJiZsKXtYLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGwsWCk7aWYoUSl7dyhRLHRydWUpO2lmKE0uaWUmJk0ud2luKXtsLnN0eWxlLmRpc3BsYXk9ImJsb2NrIn19aWYoRSl7RShCKX19YT1mYWxzZX19fX0oKTs=";
const GB_XAudioServer_js = "Ly8yMDEwLTIwMTMgR3JhbnQgR2FsaXR6IC0gWEF1ZGlvSlMgcmVhbHRpbWUgYXVkaW8gb3V0cHV0IGNvbXBhdGliaWxpdHkgbGlicmFyeToKdmFyIFhBdWRpb0pTc2NyaXB0c0hhbmRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKTsKdmFyIFhBdWRpb0pTc291cmNlSGFuZGxlID0gWEF1ZGlvSlNzY3JpcHRzSGFuZGxlW1hBdWRpb0pTc2NyaXB0c0hhbmRsZS5sZW5ndGgtMV0uc3JjOwpmdW5jdGlvbiBYQXVkaW9TZXJ2ZXIoY2hhbm5lbHMsIHNhbXBsZVJhdGUsIG1pbkJ1ZmZlclNpemUsIG1heEJ1ZmZlclNpemUsIHVuZGVyUnVuQ2FsbGJhY2ssIHZvbHVtZSwgZmFpbHVyZUNhbGxiYWNrKSB7CglYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkID0gTWF0aC5tYXgoY2hhbm5lbHMsIDEpOwoJdGhpcy5YQXVkaW9KU1NhbXBsZVJhdGUgPSBNYXRoLmFicyhzYW1wbGVSYXRlKTsKCVhBdWRpb0pTTWluQnVmZmVyU2l6ZSA9IChtaW5CdWZmZXJTaXplID49IChYQXVkaW9KU1NhbXBsZXNQZXJDYWxsYmFjayAqIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQpICYmIG1pbkJ1ZmZlclNpemUgPCBtYXhCdWZmZXJTaXplKSA/IChtaW5CdWZmZXJTaXplICYgKC1YQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkKSkgOiAoWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2sgKiBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkKTsKCVhBdWRpb0pTTWF4QnVmZmVyU2l6ZSA9IChNYXRoLmZsb29yKG1heEJ1ZmZlclNpemUpID4gWEF1ZGlvSlNNaW5CdWZmZXJTaXplICsgWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCkgPyAobWF4QnVmZmVyU2l6ZSAmICgtWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCkpIDogKFhBdWRpb0pTTWluQnVmZmVyU2l6ZSAqIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQpOwoJdGhpcy51bmRlclJ1bkNhbGxiYWNrID0gKHR5cGVvZiB1bmRlclJ1bkNhbGxiYWNrID09ICJmdW5jdGlvbiIpID8gdW5kZXJSdW5DYWxsYmFjayA6IGZ1bmN0aW9uICgpIHt9OwoJWEF1ZGlvSlNWb2x1bWUgPSAodm9sdW1lID49IDAgJiYgdm9sdW1lIDw9IDEpID8gdm9sdW1lIDogMTsKCXRoaXMuZmFpbHVyZUNhbGxiYWNrID0gKHR5cGVvZiBmYWlsdXJlQ2FsbGJhY2sgPT0gImZ1bmN0aW9uIikgPyBmYWlsdXJlQ2FsbGJhY2sgOiBmdW5jdGlvbiAoKSB7IHRocm93KG5ldyBFcnJvcigiWEF1ZGlvSlMgaGFzIGVuY291bnRlcmVkIGEgZmF0YWwgZXJyb3IuIikpOyB9OwoJdGhpcy5pbml0aWFsaXplQXVkaW8oKTsKfQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLk1PWldyaXRlQXVkaW9Ob0NhbGxiYWNrID0gZnVuY3Rpb24gKGJ1ZmZlcikgewogICAgLy9SZXNhbXBsZSBiZWZvcmUgcGFzc2luZyB0byB0aGUgbW96IGF1ZGlvIGFwaToKICAgIHZhciBidWZmZXJMZW5ndGggID0gYnVmZmVyLmxlbmd0aDsKICAgIGZvciAodmFyIGJ1ZmZlckluZGV4ID0gMDsgYnVmZmVySW5kZXggPCBidWZmZXJMZW5ndGg7KSB7CiAgICAgICAgdmFyIHNsaWNlTGVuZ3RoID0gTWF0aC5taW4oYnVmZmVyTGVuZ3RoIC0gYnVmZmVySW5kZXgsIFhBdWRpb0pTTWF4QnVmZmVyU2l6ZSk7CiAgICAgICAgZm9yICh2YXIgc2xpY2VJbmRleCA9IDA7IHNsaWNlSW5kZXggPCBzbGljZUxlbmd0aDsgKytzbGljZUluZGV4KSB7CiAgICAgICAgICAgIFhBdWRpb0pTQXVkaW9Db250ZXh0U2FtcGxlQnVmZmVyW3NsaWNlSW5kZXhdID0gYnVmZmVyW2J1ZmZlckluZGV4KytdOwogICAgICAgIH0KICAgICAgICB2YXIgcmVzYW1wbGVMZW5ndGggPSBYQXVkaW9KU1Jlc2FtcGxlQ29udHJvbC5yZXNhbXBsZXIoWEF1ZGlvSlNHZXRBcnJheVNsaWNlKFhBdWRpb0pTQXVkaW9Db250ZXh0U2FtcGxlQnVmZmVyLCBzbGljZUluZGV4KSk7CiAgICAgICAgaWYgKHJlc2FtcGxlTGVuZ3RoID4gMCkgewogICAgICAgICAgICB2YXIgcmVzYW1wbGVkUmVzdWx0ID0gWEF1ZGlvSlNSZXNhbXBsZUNvbnRyb2wub3V0cHV0QnVmZmVyOwogICAgICAgICAgICB2YXIgcmVzYW1wbGVkQnVmZmVyID0gWEF1ZGlvSlNHZXRBcnJheVNsaWNlKHJlc2FtcGxlZFJlc3VsdCwgcmVzYW1wbGVMZW5ndGgpOwogICAgICAgICAgICB0aGlzLnNhbXBsZXNBbHJlYWR5V3JpdHRlbiArPSB0aGlzLmF1ZGlvSGFuZGxlTW96Lm1veldyaXRlQXVkaW8ocmVzYW1wbGVkQnVmZmVyKTsKICAgICAgICB9CiAgICB9Cn0KWEF1ZGlvU2VydmVyLnByb3RvdHlwZS5jYWxsYmFja0Jhc2VkV3JpdGVBdWRpb05vQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYnVmZmVyKSB7CgkvL0NhbGxiYWNrLWNlbnRlcmVkIGF1ZGlvIEFQSXM6Cgl2YXIgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aDsKCWZvciAodmFyIGJ1ZmZlckNvdW50ZXIgPSAwOyBidWZmZXJDb3VudGVyIDwgbGVuZ3RoICYmIFhBdWRpb0pTQXVkaW9CdWZmZXJTaXplIDwgWEF1ZGlvSlNNYXhCdWZmZXJTaXplOykgewoJCVhBdWRpb0pTQXVkaW9Db250ZXh0U2FtcGxlQnVmZmVyW1hBdWRpb0pTQXVkaW9CdWZmZXJTaXplKytdID0gYnVmZmVyW2J1ZmZlckNvdW50ZXIrK107Cgl9Cn0KLypQYXNzIHlvdXIgc2FtcGxlcyBpbnRvIGhlcmUhClBhY2sgeW91ciBzYW1wbGVzIGFzIGEgb25lLWRpbWVuaW9uYWwgYXJyYXkKV2l0aCB0aGUgY2hhbm5lbCBzYW1wbGVzIHBhY2tlZCB1bmlmb3JtbHkuCmV4YW1wbGVzOgogICAgbW9ubyAtIFtsZWZ0LCBsZWZ0LCBsZWZ0LCBsZWZ0XQogICAgc3RlcmVvIC0gW2xlZnQsIHJpZ2h0LCBsZWZ0LCByaWdodCwgbGVmdCwgcmlnaHQsIGxlZnQsIHJpZ2h0XQoqLwpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLndyaXRlQXVkaW8gPSBmdW5jdGlvbiAoYnVmZmVyKSB7Cglzd2l0Y2ggKHRoaXMuYXVkaW9UeXBlKSB7CgkJY2FzZSAwOgoJCQl0aGlzLk1PWldyaXRlQXVkaW9Ob0NhbGxiYWNrKGJ1ZmZlcik7CgkJCXRoaXMuTU9aRXhlY3V0ZUNhbGxiYWNrKCk7CgkJCWJyZWFrOwoJCWNhc2UgMjoKCQkJdGhpcy5jaGVja0ZsYXNoSW5pdCgpOwoJCWNhc2UgMToKCQljYXNlIDM6CgkJCXRoaXMuY2FsbGJhY2tCYXNlZFdyaXRlQXVkaW9Ob0NhbGxiYWNrKGJ1ZmZlcik7CgkJCXRoaXMuY2FsbGJhY2tCYXNlZEV4ZWN1dGVDYWxsYmFjaygpOwoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQl0aGlzLmZhaWx1cmVDYWxsYmFjaygpOwoJfQp9Ci8qUGFzcyB5b3VyIHNhbXBsZXMgaW50byBoZXJlIGlmIHlvdSBkb24ndCB3YW50IGF1dG9tYXRpYyBjYWxsYmFjayBjYWxsaW5nOgpQYWNrIHlvdXIgc2FtcGxlcyBhcyBhIG9uZS1kaW1lbmlvbmFsIGFycmF5CldpdGggdGhlIGNoYW5uZWwgc2FtcGxlcyBwYWNrZWQgdW5pZm9ybWx5LgpleGFtcGxlczoKICAgIG1vbm8gLSBbbGVmdCwgbGVmdCwgbGVmdCwgbGVmdF0KICAgIHN0ZXJlbyAtIFtsZWZ0LCByaWdodCwgbGVmdCwgcmlnaHQsIGxlZnQsIHJpZ2h0LCBsZWZ0LCByaWdodF0KVXNlZnVsIGluIHByZXZlbnRpbmcgaW5maW5pdGUgcmVjdXJzaW9uIGlzc3VlcyB3aXRoIGNhbGxpbmcgd3JpdGVBdWRpbyBpbnNpZGUgeW91ciBjYWxsYmFjay4KKi8KWEF1ZGlvU2VydmVyLnByb3RvdHlwZS53cml0ZUF1ZGlvTm9DYWxsYmFjayA9IGZ1bmN0aW9uIChidWZmZXIpIHsKCXN3aXRjaCAodGhpcy5hdWRpb1R5cGUpIHsKCQljYXNlIDA6CgkJCXRoaXMuTU9aV3JpdGVBdWRpb05vQ2FsbGJhY2soYnVmZmVyKTsKCQkJYnJlYWs7CgkJY2FzZSAyOgoJCQl0aGlzLmNoZWNrRmxhc2hJbml0KCk7CgkJY2FzZSAxOgoJCWNhc2UgMzoKCQkJdGhpcy5jYWxsYmFja0Jhc2VkV3JpdGVBdWRpb05vQ2FsbGJhY2soYnVmZmVyKTsKCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJdGhpcy5mYWlsdXJlQ2FsbGJhY2soKTsKCX0KfQovL0RldmVsb3BlciBjYW4gdXNlIHRoaXMgdG8gc2VlIGhvdyBtYW55IHNhbXBsZXMgdG8gd3JpdGUgKGV4YW1wbGU6IG1pbmltdW0gYnVmZmVyIGFsbG90bWVudCBtaW51cyByZW1haW5pbmcgc2FtcGxlcyBsZWZ0IHJldHVybmVkIGZyb20gdGhpcyBmdW5jdGlvbiB0byBtYWtlIHN1cmUgbWF4aW11bSBidWZmZXJpbmcgaXMgZG9uZS4uLikKLy9JZiBudWxsIGlzIHJldHVybmVkLCB0aGVuIHRoYXQgbWVhbnMgbWV0cmljIGNvdWxkIG5vdCBiZSBkb25lLgpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLnJlbWFpbmluZ0J1ZmZlciA9IGZ1bmN0aW9uICgpIHsKCXN3aXRjaCAodGhpcy5hdWRpb1R5cGUpIHsKCQljYXNlIDA6CgkJCXJldHVybiBNYXRoLmZsb29yKCh0aGlzLnNhbXBsZXNBbHJlYWR5V3JpdHRlbiAtIHRoaXMuYXVkaW9IYW5kbGVNb3oubW96Q3VycmVudFNhbXBsZU9mZnNldCgpKSAqIFhBdWRpb0pTUmVzYW1wbGVDb250cm9sLnJhdGlvV2VpZ2h0IC8gWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCkgKiBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkOwoJCWNhc2UgMjoKCQkJdGhpcy5jaGVja0ZsYXNoSW5pdCgpOwoJCWNhc2UgMToKCQljYXNlIDM6CgkJCXJldHVybiAoTWF0aC5mbG9vcigoWEF1ZGlvSlNSZXNhbXBsZWRTYW1wbGVzTGVmdCgpICogWEF1ZGlvSlNSZXNhbXBsZUNvbnRyb2wucmF0aW9XZWlnaHQpIC8gWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCkgKiBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkKSArIFhBdWRpb0pTQXVkaW9CdWZmZXJTaXplOwoJCWRlZmF1bHQ6CgkJCXRoaXMuZmFpbHVyZUNhbGxiYWNrKCk7CgkJCXJldHVybiBudWxsOwoJfQp9ClhBdWRpb1NlcnZlci5wcm90b3R5cGUuTU9aRXhlY3V0ZUNhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJLy9tb3pBdWRpbzoKCXZhciBzYW1wbGVzUmVxdWVzdGVkID0gWEF1ZGlvSlNNaW5CdWZmZXJTaXplIC0gdGhpcy5yZW1haW5pbmdCdWZmZXIoKTsKCWlmIChzYW1wbGVzUmVxdWVzdGVkID4gMCkgewoJCXRoaXMuTU9aV3JpdGVBdWRpb05vQ2FsbGJhY2sodGhpcy51bmRlclJ1bkNhbGxiYWNrKHNhbXBsZXNSZXF1ZXN0ZWQpKTsKCX0KfQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLmNhbGxiYWNrQmFzZWRFeGVjdXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7CgkvL1dlYktpdCAvRmxhc2ggQXVkaW86Cgl2YXIgc2FtcGxlc1JlcXVlc3RlZCA9IFhBdWRpb0pTTWluQnVmZmVyU2l6ZSAtIHRoaXMucmVtYWluaW5nQnVmZmVyKCk7CglpZiAoc2FtcGxlc1JlcXVlc3RlZCA+IDApIHsKCQl0aGlzLmNhbGxiYWNrQmFzZWRXcml0ZUF1ZGlvTm9DYWxsYmFjayh0aGlzLnVuZGVyUnVuQ2FsbGJhY2soc2FtcGxlc1JlcXVlc3RlZCkpOwoJfQp9Ci8vSWYgeW91IGp1c3Qgd2FudCB5b3VyIGNhbGxiYWNrIGNhbGxlZCBmb3IgYW55IHBvc3NpYmxlIHJlZmlsbCAoRXhlY3V0aW9uIG9mIGNhbGxiYWNrIGlzIHN0aWxsIGNvbmRpdGlvbmFsKToKWEF1ZGlvU2VydmVyLnByb3RvdHlwZS5leGVjdXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7Cglzd2l0Y2ggKHRoaXMuYXVkaW9UeXBlKSB7CgkJY2FzZSAwOgoJCQl0aGlzLk1PWkV4ZWN1dGVDYWxsYmFjaygpOwoJCQlicmVhazsKCQljYXNlIDI6CgkJCXRoaXMuY2hlY2tGbGFzaEluaXQoKTsKCQljYXNlIDE6CgkJY2FzZSAzOgoJCQl0aGlzLmNhbGxiYWNrQmFzZWRFeGVjdXRlQ2FsbGJhY2soKTsKCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJdGhpcy5mYWlsdXJlQ2FsbGJhY2soKTsKCX0KfQovL0RPIE5PVCBDQUxMIFRISVMsIHRoZSBsaWIgY2FsbHMgdGhpcyBpbnRlcm5hbGx5IQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLmluaXRpYWxpemVBdWRpbyA9IGZ1bmN0aW9uICgpIHsKICAgIHRyeSB7CiAgICAgICAgdGhpcy5pbml0aWFsaXplTW96QXVkaW8oKTsKICAgIH0KICAgIGNhdGNoIChlcnJvcikgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZVdlYkF1ZGlvKCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlcnJvcikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplTWVkaWFTdHJlYW0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplRmxhc2hBdWRpbygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdWRpb1R5cGUgPSAtMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZhaWx1cmVDYWxsYmFjaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9ClhBdWRpb1NlcnZlci5wcm90b3R5cGUuaW5pdGlhbGl6ZU1lZGlhU3RyZWFtID0gZnVuY3Rpb24gKCkgewoJdGhpcy5hdWRpb0hhbmRsZU1lZGlhU3RyZWFtID0gbmV3IEF1ZGlvKCk7Cgl0aGlzLnJlc2V0Q2FsbGJhY2tBUElBdWRpb0J1ZmZlcihYQXVkaW9KU01lZGlhU3RyZWFtU2FtcGxlUmF0ZSk7CglpZiAoWEF1ZGlvSlNNZWRpYVN0cmVhbVdvcmtlcikgewoJCS8vV2ViV29ya2VyIGlzIG5vdCBHQydkLCBzbyBtYW51YWxseSBjb2xsZWN0IGl0OgoJCVhBdWRpb0pTTWVkaWFTdHJlYW1Xb3JrZXIudGVybWluYXRlKCk7Cgl9CglYQXVkaW9KU01lZGlhU3RyZWFtV29ya2VyID0gbmV3IFdvcmtlcihYQXVkaW9KU3NvdXJjZUhhbmRsZS5zdWJzdHJpbmcoMCwgWEF1ZGlvSlNzb3VyY2VIYW5kbGUubGVuZ3RoIC0gMykgKyAiTWVkaWFTdHJlYW1Xb3JrZXIuanMiKTsKCXRoaXMuYXVkaW9IYW5kbGVNZWRpYVN0cmVhbVByb2Nlc3NpbmcgPSBuZXcgUHJvY2Vzc2VkTWVkaWFTdHJlYW0oWEF1ZGlvSlNNZWRpYVN0cmVhbVdvcmtlciwgWEF1ZGlvSlNNZWRpYVN0cmVhbVNhbXBsZVJhdGUsIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQpOwoJdGhpcy5hdWRpb0hhbmRsZU1lZGlhU3RyZWFtLnNyYyA9IHRoaXMuYXVkaW9IYW5kbGVNZWRpYVN0cmVhbVByb2Nlc3Npbmc7Cgl0aGlzLmF1ZGlvSGFuZGxlTWVkaWFTdHJlYW0udm9sdW1lID0gWEF1ZGlvSlNWb2x1bWU7CglYQXVkaW9KU01lZGlhU3RyZWFtV29ya2VyLm9ubWVzc2FnZSA9IFhBdWRpb0pTTWVkaWFTdHJlYW1QdXNoQXVkaW87CglYQXVkaW9KU01lZGlhU3RyZWFtV29ya2VyLnBvc3RNZXNzYWdlKFsxLCBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU2l6ZSwgWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZF0pOwoJdGhpcy5hdWRpb0hhbmRsZU1lZGlhU3RyZWFtLnBsYXkoKTsKCXRoaXMuYXVkaW9UeXBlID0gMzsKfQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLmluaXRpYWxpemVNb3pBdWRpbyA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuYXVkaW9IYW5kbGVNb3ogPSBuZXcgQXVkaW8oKTsKCXRoaXMuYXVkaW9IYW5kbGVNb3oubW96U2V0dXAoWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCwgWEF1ZGlvSlNNb3pBdWRpb1NhbXBsZVJhdGUpOwoJdGhpcy5hdWRpb0hhbmRsZU1vei52b2x1bWUgPSBYQXVkaW9KU1ZvbHVtZTsKCXRoaXMuc2FtcGxlc0FscmVhZHlXcml0dGVuID0gMDsKCXRoaXMuYXVkaW9UeXBlID0gMDsKCS8vaWYgKG5hdmlnYXRvci5wbGF0Zm9ybSAhPSAiTWFjSW50ZWwiICYmIG5hdmlnYXRvci5wbGF0Zm9ybSAhPSAiTWFjUFBDIikgewoJCS8vQWRkIHNvbWUgYWRkaXRpb25hbCBidWZmZXJpbmcgc3BhY2UgdG8gd29ya2Fyb3VuZCBhIG1veiBhdWRpbyBhcGkgaXNzdWU6CgkJdmFyIGJ1ZmZlckFtb3VudCA9ICh0aGlzLlhBdWRpb0pTU2FtcGxlUmF0ZSAqIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQgLyAxMCkgfCAwOwoJCWJ1ZmZlckFtb3VudCAtPSBidWZmZXJBbW91bnQgJSBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkOwoJCXRoaXMuc2FtcGxlc0FscmVhZHlXcml0dGVuIC09IGJ1ZmZlckFtb3VudDsKCS8vfQogICAgdGhpcy5pbml0aWFsaXplUmVzYW1wbGVyKFhBdWRpb0pTTW96QXVkaW9TYW1wbGVSYXRlKTsKfQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLmluaXRpYWxpemVXZWJBdWRpbyA9IGZ1bmN0aW9uICgpIHsKCWlmICghWEF1ZGlvSlNXZWJBdWRpb0xhdW5jaGVkQ29udGV4dCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlID0gbmV3IEF1ZGlvQ29udGV4dCgpOwkJCQkJCQkJLy9DcmVhdGUgYSBzeXN0ZW0gYXVkaW8gY29udGV4dC4KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlID0gbmV3IHdlYmtpdEF1ZGlvQ29udGV4dCgpOwkJCQkJCQkvL0NyZWF0ZSBhIHN5c3RlbSBhdWRpbyBjb250ZXh0LgogICAgICAgIH0KICAgICAgICBYQXVkaW9KU1dlYkF1ZGlvTGF1bmNoZWRDb250ZXh0ID0gdHJ1ZTsKICAgIH0KICAgIGlmIChYQXVkaW9KU1dlYkF1ZGlvQXVkaW9Ob2RlKSB7CiAgICAgICAgWEF1ZGlvSlNXZWJBdWRpb0F1ZGlvTm9kZS5kaXNjb25uZWN0KCk7CiAgICAgICAgWEF1ZGlvSlNXZWJBdWRpb0F1ZGlvTm9kZS5vbmF1ZGlvcHJvY2VzcyA9IG51bGw7CiAgICAgICAgWEF1ZGlvSlNXZWJBdWRpb0F1ZGlvTm9kZSA9IG51bGw7CiAgICB9CgkvL0FuZHJvaWQgY2hyb21lIGV4Y2VwdGlvbiBoYXMgc3R1dHRlcnkgYXVkaW8sIGZpcmVmb3ggYW5kcm9pZCBpcyBmaW5lIHdpdGggMjA0OAoJaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5jbHVkZXMoIkFuZHJvaWQiKSAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCJDaHJvbWUiKSkgewoJCVhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrID0gNDA5NjsKCX0KICAgIHRyeSB7CiAgICAgICAgWEF1ZGlvSlNXZWJBdWRpb0F1ZGlvTm9kZSA9IFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlLmNyZWF0ZVNjcmlwdFByb2Nlc3NvcihYQXVkaW9KU1NhbXBsZXNQZXJDYWxsYmFjaywgMCwgWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCk7CS8vQ3JlYXRlIHRoZSBqcyBldmVudCBub2RlLgogICAgfQogICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgWEF1ZGlvSlNXZWJBdWRpb0F1ZGlvTm9kZSA9IFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlLmNyZWF0ZUphdmFTY3JpcHROb2RlKFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrLCAwLCBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkKTsJLy9DcmVhdGUgdGhlIGpzIGV2ZW50IG5vZGUuCiAgICB9CglYQXVkaW9KU1dlYkF1ZGlvQXVkaW9Ob2RlLm9uYXVkaW9wcm9jZXNzID0gWEF1ZGlvSlNXZWJBdWRpb0V2ZW50OwoJdmFyIGdhaW5Ob2RlID0gWEF1ZGlvSlNXZWJBdWRpb0NvbnRleHRIYW5kbGUuY3JlYXRlR2FpbigpOwoJWEF1ZGlvSlNXZWJBdWRpb0F1ZGlvTm9kZS5jb25uZWN0KGdhaW5Ob2RlKTsgLy9Db25uZWN0IHRoZSBhdWRpbyBwcm9jZXNzaW5nIGV2ZW50IHRvIGEgaGFuZGxpbmcgZnVuY3Rpb24gc28gd2UgY2FuIG1hbmlwdWxhdGUgb3V0cHV0CgkvL0Nvbm5lY3QgdGhlIGF1ZGlvIHByb2Nlc3NpbmcgZXZlbnQgdG8gYSBoYW5kbGluZyBmdW5jdGlvbiBzbyB3ZSBjYW4gbWFuaXB1bGF0ZSBvdXRwdXQKCWdhaW5Ob2RlLmNvbm5lY3QoWEF1ZGlvSlNXZWJBdWRpb0NvbnRleHRIYW5kbGUuZGVzdGluYXRpb24pOwoJLy8gUmFtcCB1cCBnYWluIHRvIGF2b2lkIHBvcCB3aGVuIGluaXRpYWxpc2VkLCB0aGVzZSBjYW4gYmUgcmVsYXhlZC9yZW1vdmVkIHdpdGggdGhlIGZpeGVkIGRjIG9mZnNldCBpbiBHYW1lQm95Q29yZS5qcyBubyBsb25nZXIgcG9wcGluZwoJZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IDAuMjsKCWdhaW5Ob2RlLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgKCSAgMSwKCSAgWEF1ZGlvSlNXZWJBdWRpb0NvbnRleHRIYW5kbGUuY3VycmVudFRpbWUgKyAwLjUKCSk7CiAgCglkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJ2aXNpYmlsaXR5Y2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCSAgaWYgKGRvY3VtZW50LmhpZGRlbikgewoJCS8vIFJhbXAgZG93biBnYWluIHRvIGF2b2lkIHBvcCB3aGVuIHN3aXRjaGluZyB0YWIgYXdheQoJCWdhaW5Ob2RlLmdhaW4uZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZSgKCQkgIDAuMDAwMSwKCQkgIFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlLmN1cnJlbnRUaW1lICsgMC41CgkJKTsKCSAgfSBlbHNlIHsKCQkvLyBSYW1wIHVwIGdhaW4gdG8gYXZvaWQgcG9wIHdoZW4gc3dpdGNoaW5nIGJhY2sgdG8gdGFiCgkJZ2Fpbk5vZGUuZ2Fpbi5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKAoJCSAgMSwKCQkgIFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlLmN1cnJlbnRUaW1lICsgMC41CgkJKTsKCSAgfQoJfSk7CgkKICAgIHRoaXMucmVzZXRDYWxsYmFja0FQSUF1ZGlvQnVmZmVyKFhBdWRpb0pTV2ViQXVkaW9Db250ZXh0SGFuZGxlLnNhbXBsZVJhdGUpOwogICAgdGhpcy5hdWRpb1R5cGUgPSAxOwogICAgLyoKICAgICBGaXJlZm94IGhhcyBhIGJ1ZyBpbiBpdHMgd2ViIGF1ZGlvIGltcGxlbWVudGF0aW9uLi4uCiAgICAgVGhlIG5vZGUgbWF5IHJhbmRvbWx5IHN0b3AgcGxheWluZyBvbiBNYWMgT1MgWCBmb3Igbm8KICAgICBnb29kIHJlYXNvbi4gS2VlcCBhIHdhdGNoZG9nIHRpbWVyIHRvIHJlc3RhcnQgdGhlIGZhaWxlZAogICAgIG5vZGUgaWYgaXQgZ2xpdGNoZXMuIEdvb2dsZSBDaHJvbWUgbmV2ZXIgaGFkIHRoaXMgaXNzdWUuCiAgICAgKi8KICAgIFhBdWRpb0pTV2ViQXVkaW9XYXRjaERvZ0xhc3QgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOwogICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignR2Vja28vJykgPiAtMSkgewogICAgICAgIGlmIChYQXVkaW9KU1dlYkF1ZGlvV2F0Y2hEb2dUaW1lcikgewogICAgICAgICAgICBjbGVhckludGVydmFsKFhBdWRpb0pTV2ViQXVkaW9XYXRjaERvZ1RpbWVyKTsKICAgICAgICB9CiAgICAgICAgdmFyIHBhcmVudE9iaiA9IHRoaXM7CiAgICAgICAgWEF1ZGlvSlNXZWJBdWRpb1dhdGNoRG9nVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciB0aW1lRGlmZiA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLSBYQXVkaW9KU1dlYkF1ZGlvV2F0Y2hEb2dMYXN0OwogICAgICAgICAgICBpZiAodGltZURpZmYgPiA1MDApIHsKICAgICAgICAgICAgICAgIHBhcmVudE9iai5pbml0aWFsaXplV2ViQXVkaW8oKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDUwMCk7CiAgICB9Cn0KWEF1ZGlvU2VydmVyLnByb3RvdHlwZS5pbml0aWFsaXplRmxhc2hBdWRpbyA9IGZ1bmN0aW9uICgpIHsKCXZhciBleGlzdGluZ0ZsYXNobG9hZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJYQXVkaW9KUyIpOwoJdGhpcy5mbGFzaEluaXRpYWxpemVkID0gZmFsc2U7Cgl0aGlzLnJlc2V0Q2FsbGJhY2tBUElBdWRpb0J1ZmZlcig0NDEwMCk7Cglzd2l0Y2ggKFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQpIHsKCQljYXNlIDE6CgkJCVhBdWRpb0pTRmxhc2hUcmFuc3BvcnRFbmNvZGVyID0gWEF1ZGlvSlNHZW5lcmF0ZUZsYXNoTW9ub1N0cmluZzsKCQkJYnJlYWs7CgkJY2FzZSAyOgoJCQlYQXVkaW9KU0ZsYXNoVHJhbnNwb3J0RW5jb2RlciA9IFhBdWRpb0pTR2VuZXJhdGVGbGFzaFN0ZXJlb1N0cmluZzsKCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJWEF1ZGlvSlNGbGFzaFRyYW5zcG9ydEVuY29kZXIgPSBYQXVkaW9KU0dlbmVyYXRlRmxhc2hTdXJyb3VuZFN0cmluZzsKCX0KCWlmIChleGlzdGluZ0ZsYXNobG9hZCA9PSBudWxsKSB7CgkJdGhpcy5hdWRpb0hhbmRsZUZsYXNoID0gbnVsbDsKCQl2YXIgdGhpc09iaiA9IHRoaXM7CgkJdmFyIG1haW5Db250YWluZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CgkJbWFpbkNvbnRhaW5lck5vZGUuc2V0QXR0cmlidXRlKCJzdHlsZSIsICJwb3NpdGlvbjogZml4ZWQ7IGJvdHRvbTogMHB4OyByaWdodDogMHB4OyBtYXJnaW46IDBweDsgcGFkZGluZzogMHB4OyBib3JkZXI6IG5vbmU7IHdpZHRoOiA4cHg7IGhlaWdodDogOHB4OyBvdmVyZmxvdzogaGlkZGVuOyB6LWluZGV4OiAtMTAwMDsgIik7CgkJdmFyIGNvbnRhaW5lck5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKCQljb250YWluZXJOb2RlLnNldEF0dHJpYnV0ZSgic3R5bGUiLCAicG9zaXRpb246IHN0YXRpYzsgYm9yZGVyOiBub25lOyB3aWR0aDogMHB4OyBoZWlnaHQ6IDBweDsgdmlzaWJpbGl0eTogaGlkZGVuOyBtYXJnaW46IDhweDsgcGFkZGluZzogMHB4OyIpOwoJCWNvbnRhaW5lck5vZGUuc2V0QXR0cmlidXRlKCJpZCIsICJYQXVkaW9KUyIpOwoJCW1haW5Db250YWluZXJOb2RlLmFwcGVuZENoaWxkKGNvbnRhaW5lck5vZGUpOwoJCWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF0uYXBwZW5kQ2hpbGQobWFpbkNvbnRhaW5lck5vZGUpOwoJCXN3Zm9iamVjdC5lbWJlZFNXRigKCQkJWEF1ZGlvSlNzb3VyY2VIYW5kbGUuc3Vic3RyaW5nKDAsIFhBdWRpb0pTc291cmNlSGFuZGxlLmxlbmd0aCAtIDkpICsgIkpTLnN3ZiIsCgkJCSJYQXVkaW9KUyIsCgkJCSI4IiwKCQkJIjgiLAoJCQkiOS4wLjAiLAoJCQkiIiwKCQkJe30sCgkJCXsiYWxsb3dzY3JpcHRhY2Nlc3MiOiJhbHdheXMifSwKCQkJeyJzdHlsZSI6InBvc2l0aW9uOiBzdGF0aWM7IHZpc2liaWxpdHk6IGhpZGRlbjsgbWFyZ2luOiA4cHg7IHBhZGRpbmc6IDBweDsgYm9yZGVyOiBub25lIn0sCgkJCWZ1bmN0aW9uIChldmVudCkgewoJCQkJaWYgKGV2ZW50LnN1Y2Nlc3MpIHsKCQkJCQl0aGlzT2JqLmF1ZGlvSGFuZGxlRmxhc2ggPSBldmVudC5yZWY7CgkJCQkJdGhpc09iai5jaGVja0ZsYXNoSW5pdCgpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdGhpc09iai5mYWlsdXJlQ2FsbGJhY2soKTsKCQkJCQl0aGlzT2JqLmF1ZGlvVHlwZSA9IC0xOwoJCQkJfQoJCQl9CgkJKTsKCX0KCWVsc2UgewoJCXRoaXMuYXVkaW9IYW5kbGVGbGFzaCA9IGV4aXN0aW5nRmxhc2hsb2FkOwoJCXRoaXMuY2hlY2tGbGFzaEluaXQoKTsKCX0KCXRoaXMuYXVkaW9UeXBlID0gMjsKfQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLmNoYW5nZVZvbHVtZSA9IGZ1bmN0aW9uIChuZXdWb2x1bWUpIHsKCWlmIChuZXdWb2x1bWUgPj0gMCAmJiBuZXdWb2x1bWUgPD0gMSkgewoJCVhBdWRpb0pTVm9sdW1lID0gbmV3Vm9sdW1lOwoJCXN3aXRjaCAodGhpcy5hdWRpb1R5cGUpIHsKCQkJY2FzZSAwOgoJCQkJdGhpcy5hdWRpb0hhbmRsZU1vei52b2x1bWUgPSBYQXVkaW9KU1ZvbHVtZTsKCQkJY2FzZSAxOgoJCQkJYnJlYWs7CgkJCWNhc2UgMjoKCQkJCWlmICh0aGlzLmZsYXNoSW5pdGlhbGl6ZWQpIHsKCQkJCQl0aGlzLmF1ZGlvSGFuZGxlRmxhc2guY2hhbmdlVm9sdW1lKFhBdWRpb0pTVm9sdW1lKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRoaXMuY2hlY2tGbGFzaEluaXQoKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQljYXNlIDM6CgkJCQl0aGlzLmF1ZGlvSGFuZGxlTWVkaWFTdHJlYW0udm9sdW1lID0gWEF1ZGlvSlNWb2x1bWU7CgkJCQlicmVhazsKCQkJZGVmYXVsdDoKCQkJCXRoaXMuZmFpbHVyZUNhbGxiYWNrKCk7CgkJfQoJfQp9Ci8vQ2hlY2tzIHRvIHNlZSBpZiB0aGUgTlBBUEkgQWRvYmUgRmxhc2ggYnJpZGdlIGlzIHJlYWR5IHlldDoKWEF1ZGlvU2VydmVyLnByb3RvdHlwZS5jaGVja0ZsYXNoSW5pdCA9IGZ1bmN0aW9uICgpIHsKCWlmICghdGhpcy5mbGFzaEluaXRpYWxpemVkKSB7CgkJdHJ5IHsKCQkJaWYgKHRoaXMuYXVkaW9IYW5kbGVGbGFzaCAmJiB0aGlzLmF1ZGlvSGFuZGxlRmxhc2guaW5pdGlhbGl6ZSkgewoJCQkJdGhpcy5mbGFzaEluaXRpYWxpemVkID0gdHJ1ZTsKCQkJCXRoaXMuYXVkaW9IYW5kbGVGbGFzaC5pbml0aWFsaXplKFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQsIFhBdWRpb0pTVm9sdW1lKTsKCQkJfQoJCX0KCQljYXRjaCAoZXJyb3IpIHsKCQkJdGhpcy5mbGFzaEluaXRpYWxpemVkID0gZmFsc2U7CgkJfQoJfQp9Ci8vU2V0IHVwIHRoZSByZXNhbXBsaW5nOgpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLnJlc2V0Q2FsbGJhY2tBUElBdWRpb0J1ZmZlciA9IGZ1bmN0aW9uIChBUElTYW1wbGVSYXRlKSB7CglYQXVkaW9KU0F1ZGlvQnVmZmVyU2l6ZSA9IFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJFbmQgPSBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQgPSAwOwogICAgdGhpcy5pbml0aWFsaXplUmVzYW1wbGVyKEFQSVNhbXBsZVJhdGUpOwogICAgWEF1ZGlvSlNSZXNhbXBsZWRCdWZmZXIgPSB0aGlzLmdldEZsb2F0MzIoWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclNpemUpOwp9ClhBdWRpb1NlcnZlci5wcm90b3R5cGUuaW5pdGlhbGl6ZVJlc2FtcGxlciA9IGZ1bmN0aW9uIChzYW1wbGVSYXRlKSB7CiAgICBYQXVkaW9KU0F1ZGlvQ29udGV4dFNhbXBsZUJ1ZmZlciA9IHRoaXMuZ2V0RmxvYXQzMihYQXVkaW9KU01heEJ1ZmZlclNpemUpOwogICAgWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclNpemUgPSBNYXRoLm1heChYQXVkaW9KU01heEJ1ZmZlclNpemUgKiBNYXRoLmNlaWwoc2FtcGxlUmF0ZSAvIHRoaXMuWEF1ZGlvSlNTYW1wbGVSYXRlKSArIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQsIFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrICogWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZCk7CglYQXVkaW9KU1Jlc2FtcGxlQ29udHJvbCA9IG5ldyBSZXNhbXBsZXIodGhpcy5YQXVkaW9KU1NhbXBsZVJhdGUsIHNhbXBsZVJhdGUsIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQsIFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTaXplLCB0cnVlKTsKfQpYQXVkaW9TZXJ2ZXIucHJvdG90eXBlLmdldEZsb2F0MzIgPSBmdW5jdGlvbiAoc2l6ZSkgewoJdHJ5IHsKCQlyZXR1cm4gbmV3IEZsb2F0MzJBcnJheShzaXplKTsKCX0KCWNhdGNoIChlcnJvcikgewoJCXJldHVybiBbXTsKCX0KfQpmdW5jdGlvbiBYQXVkaW9KU0ZsYXNoQXVkaW9FdmVudCgpIHsJCS8vVGhlIGNhbGxiYWNrIHRoYXQgZmxhc2ggY2FsbHMuLi4KCVhBdWRpb0pTUmVzYW1wbGVSZWZpbGwoKTsKCXJldHVybiBYQXVkaW9KU0ZsYXNoVHJhbnNwb3J0RW5jb2RlcigpOwp9CmZ1bmN0aW9uIFhBdWRpb0pTR2VuZXJhdGVGbGFzaFN1cnJvdW5kU3RyaW5nKCkgewkvL0NvbnZlcnQgdGhlIGFycmF5cyB0byBvbmUgbG9uZyBzdHJpbmcgZm9yIHNwZWVkLgoJdmFyIFhBdWRpb0pTVG90YWxTYW1wbGVzID0gWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2sgPDwgMTsKCWlmIChYQXVkaW9KU0JpbmFyeVN0cmluZy5sZW5ndGggPiBYQXVkaW9KU1RvdGFsU2FtcGxlcykgewoJCVhBdWRpb0pTQmluYXJ5U3RyaW5nID0gW107Cgl9CglYQXVkaW9KU1RvdGFsU2FtcGxlcyA9IDA7Cglmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2sgJiYgWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ICE9IFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJFbmQ7ICsraW5kZXgpIHsKCQkvL1Nhbml0aXplIHRoZSBidWZmZXI6CgkJWEF1ZGlvSlNCaW5hcnlTdHJpbmdbWEF1ZGlvSlNUb3RhbFNhbXBsZXMrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoTWF0aC5taW4oTWF0aC5tYXgoWEF1ZGlvSlNSZXNhbXBsZWRCdWZmZXJbWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0KytdICsgMSwgMCksIDIpICogMHgzRkZGKSB8IDApICsgMHgzMDAwKTsKCQlYQXVkaW9KU0JpbmFyeVN0cmluZ1tYQXVkaW9KU1RvdGFsU2FtcGxlcysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChNYXRoLm1pbihNYXRoLm1heChYQXVkaW9KU1Jlc2FtcGxlZEJ1ZmZlcltYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQrK10gKyAxLCAwKSwgMikgKiAweDNGRkYpIHwgMCkgKyAweDMwMDApOwoJCVhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCArPSBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkIC0gMjsKCQlpZiAoWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID09IFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTaXplKSB7CgkJCVhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCA9IDA7CgkJfQoJfQoJcmV0dXJuIFhBdWRpb0pTQmluYXJ5U3RyaW5nLmpvaW4oIiIpOwp9CmZ1bmN0aW9uIFhBdWRpb0pTR2VuZXJhdGVGbGFzaFN0ZXJlb1N0cmluZygpIHsJLy9Db252ZXJ0IHRoZSBhcnJheXMgdG8gb25lIGxvbmcgc3RyaW5nIGZvciBzcGVlZC4KCXZhciBYQXVkaW9KU1RvdGFsU2FtcGxlcyA9IFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrIDw8IDE7CglpZiAoWEF1ZGlvSlNCaW5hcnlTdHJpbmcubGVuZ3RoID4gWEF1ZGlvSlNUb3RhbFNhbXBsZXMpIHsKCQlYQXVkaW9KU0JpbmFyeVN0cmluZyA9IFtdOwoJfQoJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IFhBdWRpb0pTVG90YWxTYW1wbGVzICYmIFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCAhPSBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyRW5kOykgewoJCS8vU2FuaXRpemUgdGhlIGJ1ZmZlcjoKCQlYQXVkaW9KU0JpbmFyeVN0cmluZ1tpbmRleCsrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChNYXRoLm1pbihNYXRoLm1heChYQXVkaW9KU1Jlc2FtcGxlZEJ1ZmZlcltYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQrK10gKyAxLCAwKSwgMikgKiAweDNGRkYpIHwgMCkgKyAweDMwMDApOwoJCVhBdWRpb0pTQmluYXJ5U3RyaW5nW2luZGV4KytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKE1hdGgubWluKE1hdGgubWF4KFhBdWRpb0pTUmVzYW1wbGVkQnVmZmVyW1hBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCsrXSArIDEsIDApLCAyKSAqIDB4M0ZGRikgfCAwKSArIDB4MzAwMCk7CgkJaWYgKFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCA9PSBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU2l6ZSkgewoJCQlYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQgPSAwOwoJCX0KCX0KCXJldHVybiBYQXVkaW9KU0JpbmFyeVN0cmluZy5qb2luKCIiKTsKfQpmdW5jdGlvbiBYQXVkaW9KU0dlbmVyYXRlRmxhc2hNb25vU3RyaW5nKCkgewkvL0NvbnZlcnQgdGhlIGFycmF5IHRvIG9uZSBsb25nIHN0cmluZyBmb3Igc3BlZWQuCglpZiAoWEF1ZGlvSlNCaW5hcnlTdHJpbmcubGVuZ3RoID4gWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2spIHsKCQlYQXVkaW9KU0JpbmFyeVN0cmluZyA9IFtdOwoJfQoJZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrICYmIFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCAhPSBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyRW5kOykgewoJCS8vU2FuaXRpemUgdGhlIGJ1ZmZlcjoKCQlYQXVkaW9KU0JpbmFyeVN0cmluZ1tpbmRleCsrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChNYXRoLm1pbihNYXRoLm1heChYQXVkaW9KU1Jlc2FtcGxlZEJ1ZmZlcltYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQrK10gKyAxLCAwKSwgMikgKiAweDNGRkYpIHwgMCkgKyAweDMwMDApOwoJCWlmIChYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQgPT0gWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclNpemUpIHsKCQkJWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID0gMDsKCQl9Cgl9CglyZXR1cm4gWEF1ZGlvSlNCaW5hcnlTdHJpbmcuam9pbigiIik7Cn0KLy9Tb21lIFJlcXVpcmVkIEdsb2JhbHM6CnZhciBYQXVkaW9KU1dlYkF1ZGlvQ29udGV4dEhhbmRsZSA9IG51bGw7CnZhciBYQXVkaW9KU1dlYkF1ZGlvQXVkaW9Ob2RlID0gbnVsbDsKdmFyIFhBdWRpb0pTV2ViQXVkaW9XYXRjaERvZ1RpbWVyID0gbnVsbDsKdmFyIFhBdWRpb0pTV2ViQXVkaW9XYXRjaERvZ0xhc3QgPSBmYWxzZTsKdmFyIFhBdWRpb0pTV2ViQXVkaW9MYXVuY2hlZENvbnRleHQgPSBmYWxzZTsKdmFyIFhBdWRpb0pTQXVkaW9Db250ZXh0U2FtcGxlQnVmZmVyID0gW107CnZhciBYQXVkaW9KU1Jlc2FtcGxlZEJ1ZmZlciA9IFtdOwp2YXIgWEF1ZGlvSlNNaW5CdWZmZXJTaXplID0gMTUwMDA7CnZhciBYQXVkaW9KU01heEJ1ZmZlclNpemUgPSAyNTAwMDsKdmFyIFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQgPSAxOwp2YXIgWEF1ZGlvSlNWb2x1bWUgPSAxOwp2YXIgWEF1ZGlvSlNSZXNhbXBsZUNvbnRyb2wgPSBudWxsOwp2YXIgWEF1ZGlvSlNBdWRpb0J1ZmZlclNpemUgPSAwOwp2YXIgWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID0gMDsKdmFyIFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJFbmQgPSAwOwp2YXIgWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclNpemUgPSAwOwp2YXIgWEF1ZGlvSlNNZWRpYVN0cmVhbVdvcmtlciA9IG51bGw7CnZhciBYQXVkaW9KU01lZGlhU3RyZWFtQnVmZmVyID0gW107CnZhciBYQXVkaW9KU01lZGlhU3RyZWFtU2FtcGxlUmF0ZSA9IDQ0MTAwOwp2YXIgWEF1ZGlvSlNNb3pBdWRpb1NhbXBsZVJhdGUgPSA0NDEwMDsKdmFyIFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrID0gMjA0ODsJCQkvL0hhcyB0byBiZSBiZXR3ZWVuIDIwNDggYW5kIDQwOTYgKElmIG92ZXIsIHRoZW4gc2FtcGxlcyBhcmUgaWdub3JlZCwgaWYgdW5kZXIgdGhlbiBzaWxlbmNlIGlzIGFkZGVkLCA0MDk2IGZpeGVzIGNocm9tZSBhbmRyb2lkKS4KdmFyIFhBdWRpb0pTRmxhc2hUcmFuc3BvcnRFbmNvZGVyID0gbnVsbDsKdmFyIFhBdWRpb0pTTWVkaWFTdHJlYW1MZW5ndGhBbGlhc0NvdW50ZXIgPSAwOwp2YXIgWEF1ZGlvSlNCaW5hcnlTdHJpbmcgPSBbXTsKZnVuY3Rpb24gWEF1ZGlvSlNXZWJBdWRpb0V2ZW50KGV2ZW50KSB7CQkvL1dlYiBBdWRpbyBBUEkgY2FsbGJhY2suLi4KCWlmIChYQXVkaW9KU1dlYkF1ZGlvV2F0Y2hEb2dUaW1lcikgewoJCVhBdWRpb0pTV2ViQXVkaW9XYXRjaERvZ0xhc3QgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOwoJfQoJLy9GaW5kIGFsbCBvdXRwdXQgY2hhbm5lbHM6Cglmb3IgKHZhciBidWZmZXJDb3VudCA9IDAsIGJ1ZmZlcnMgPSBbXTsgYnVmZmVyQ291bnQgPCBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkOyArK2J1ZmZlckNvdW50KSB7CgkJYnVmZmVyc1tidWZmZXJDb3VudF0gPSBldmVudC5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoYnVmZmVyQ291bnQpOwoJfQoJLy9NYWtlIHN1cmUgd2UgaGF2ZSByZXNhbXBsZWQgc2FtcGxlcyByZWFkeToKCVhBdWRpb0pTUmVzYW1wbGVSZWZpbGwoKTsKCS8vQ29weSBzYW1wbGVzIGZyb20gWEF1ZGlvSlMgdG8gdGhlIFdlYiBBdWRpbyBBUEk6Cglmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2sgJiYgWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ICE9IFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJFbmQ7ICsraW5kZXgpIHsKCQlmb3IgKGJ1ZmZlckNvdW50ID0gMDsgYnVmZmVyQ291bnQgPCBYQXVkaW9KU0NoYW5uZWxzQWxsb2NhdGVkOyArK2J1ZmZlckNvdW50KSB7CgkJCWJ1ZmZlcnNbYnVmZmVyQ291bnRdW2luZGV4XSA9IFhBdWRpb0pTUmVzYW1wbGVkQnVmZmVyW1hBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCsrXSAqIFhBdWRpb0pTVm9sdW1lOwoJCX0KCQlpZiAoWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID09IFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTaXplKSB7CgkJCVhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCA9IDA7CgkJfQoJfQoJLy9QYWQgd2l0aCBzaWxlbmNlIGlmIHdlJ3JlIHVuZGVycnVubmluZzoKCXdoaWxlIChpbmRleCA8IFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrKSB7CgkJZm9yIChidWZmZXJDb3VudCA9IDA7IGJ1ZmZlckNvdW50IDwgWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZDsgKytidWZmZXJDb3VudCkgewoJCQlidWZmZXJzW2J1ZmZlckNvdW50XVtpbmRleF0gPSAwOwoJCX0KCQkrK2luZGV4OwoJfQp9Ci8vTWVkaWFTdHJlYW0gQVBJIGJ1ZmZlciBwdXNoCmZ1bmN0aW9uIFhBdWRpb0pTTWVkaWFTdHJlYW1QdXNoQXVkaW8oZXZlbnQpIHsKCXZhciBpbmRleCA9IDA7Cgl2YXIgYXVkaW9MZW5ndGhSZXF1ZXN0ZWQgPSBldmVudC5kYXRhOwoJdmFyIHNhbXBsZXNQZXJDYWxsYmFja0FsbCA9IFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrICogWEF1ZGlvSlNDaGFubmVsc0FsbG9jYXRlZDsKCXZhciBYQXVkaW9KU01lZGlhU3RyZWFtTGVuZ3RoQWxpYXMgPSBhdWRpb0xlbmd0aFJlcXVlc3RlZCAlIFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrOwoJYXVkaW9MZW5ndGhSZXF1ZXN0ZWQgPSBhdWRpb0xlbmd0aFJlcXVlc3RlZCAtIChYQXVkaW9KU01lZGlhU3RyZWFtTGVuZ3RoQWxpYXNDb3VudGVyIC0gKFhBdWRpb0pTTWVkaWFTdHJlYW1MZW5ndGhBbGlhc0NvdW50ZXIgJSBYQXVkaW9KU1NhbXBsZXNQZXJDYWxsYmFjaykpIC0gWEF1ZGlvSlNNZWRpYVN0cmVhbUxlbmd0aEFsaWFzICsgWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2s7CglYQXVkaW9KU01lZGlhU3RyZWFtTGVuZ3RoQWxpYXNDb3VudGVyIC09IFhBdWRpb0pTTWVkaWFTdHJlYW1MZW5ndGhBbGlhc0NvdW50ZXIgLSAoWEF1ZGlvSlNNZWRpYVN0cmVhbUxlbmd0aEFsaWFzQ291bnRlciAlIFhBdWRpb0pTU2FtcGxlc1BlckNhbGxiYWNrKTsKCVhBdWRpb0pTTWVkaWFTdHJlYW1MZW5ndGhBbGlhc0NvdW50ZXIgKz0gWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2sgLSBYQXVkaW9KU01lZGlhU3RyZWFtTGVuZ3RoQWxpYXM7CglpZiAoWEF1ZGlvSlNNZWRpYVN0cmVhbUJ1ZmZlci5sZW5ndGggIT0gc2FtcGxlc1BlckNhbGxiYWNrQWxsKSB7CgkJWEF1ZGlvSlNNZWRpYVN0cmVhbUJ1ZmZlciA9IG5ldyBGbG9hdDMyQXJyYXkoc2FtcGxlc1BlckNhbGxiYWNrQWxsKTsKCX0KCVhBdWRpb0pTUmVzYW1wbGVSZWZpbGwoKTsKCXdoaWxlIChpbmRleCA8IGF1ZGlvTGVuZ3RoUmVxdWVzdGVkKSB7CgkJdmFyIGluZGV4MiA9IDA7CgkJd2hpbGUgKGluZGV4MiA8IHNhbXBsZXNQZXJDYWxsYmFja0FsbCAmJiBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQgIT0gWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlckVuZCkgewoJCQlYQXVkaW9KU01lZGlhU3RyZWFtQnVmZmVyW2luZGV4MisrXSA9IFhBdWRpb0pTUmVzYW1wbGVkQnVmZmVyW1hBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCsrXTsKCQkJaWYgKFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCA9PSBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU2l6ZSkgewoJCQkJWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID0gMDsKCQkJfQoJCX0KCQlYQXVkaW9KU01lZGlhU3RyZWFtV29ya2VyLnBvc3RNZXNzYWdlKFswLCBYQXVkaW9KU01lZGlhU3RyZWFtQnVmZmVyXSk7CgkJaW5kZXggKz0gWEF1ZGlvSlNTYW1wbGVzUGVyQ2FsbGJhY2s7Cgl9Cn0KZnVuY3Rpb24gWEF1ZGlvSlNSZXNhbXBsZVJlZmlsbCgpIHsKCWlmIChYQXVkaW9KU0F1ZGlvQnVmZmVyU2l6ZSA+IDApIHsKCQkvL1Jlc2FtcGxlIGEgY2h1bmsgb2YgYXVkaW86CgkJdmFyIHJlc2FtcGxlTGVuZ3RoID0gWEF1ZGlvSlNSZXNhbXBsZUNvbnRyb2wucmVzYW1wbGVyKFhBdWRpb0pTR2V0QnVmZmVyU2FtcGxlcygpKTsKCQl2YXIgcmVzYW1wbGVkUmVzdWx0ID0gWEF1ZGlvSlNSZXNhbXBsZUNvbnRyb2wub3V0cHV0QnVmZmVyOwoJCWZvciAodmFyIGluZGV4MiA9IDA7IGluZGV4MiA8IHJlc2FtcGxlTGVuZ3RoOykgewoJCQlYQXVkaW9KU1Jlc2FtcGxlZEJ1ZmZlcltYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyRW5kKytdID0gcmVzYW1wbGVkUmVzdWx0W2luZGV4MisrXTsKCQkJaWYgKFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJFbmQgPT0gWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclNpemUpIHsKCQkJCVhBdWRpb0pTUmVzYW1wbGVCdWZmZXJFbmQgPSAwOwoJCQl9CgkJCWlmIChYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU3RhcnQgPT0gWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlckVuZCkgewoJCQkJWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ICs9IFhBdWRpb0pTQ2hhbm5lbHNBbGxvY2F0ZWQ7CgkJCQlpZiAoWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID09IFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTaXplKSB7CgkJCQkJWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0ID0gMDsKCQkJCX0KCQkJfQoJCX0KCQlYQXVkaW9KU0F1ZGlvQnVmZmVyU2l6ZSA9IDA7Cgl9Cn0KZnVuY3Rpb24gWEF1ZGlvSlNSZXNhbXBsZWRTYW1wbGVzTGVmdCgpIHsKCXJldHVybiAoKFhBdWRpb0pTUmVzYW1wbGVCdWZmZXJTdGFydCA8PSBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyRW5kKSA/IDAgOiBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyU2l6ZSkgKyBYQXVkaW9KU1Jlc2FtcGxlQnVmZmVyRW5kIC0gWEF1ZGlvSlNSZXNhbXBsZUJ1ZmZlclN0YXJ0Owp9CmZ1bmN0aW9uIFhBdWRpb0pTR2V0QnVmZmVyU2FtcGxlcygpIHsKICAgIHJldHVybiBYQXVkaW9KU0dldEFycmF5U2xpY2UoWEF1ZGlvSlNBdWRpb0NvbnRleHRTYW1wbGVCdWZmZXIsIFhBdWRpb0pTQXVkaW9CdWZmZXJTaXplKTsKfQpmdW5jdGlvbiBYQXVkaW9KU0dldEFycmF5U2xpY2UoYnVmZmVyLCBsZW5ndGhPZikgewoJLy9UeXBlZCBhcnJheSBhbmQgbm9ybWFsIGFycmF5IGJ1ZmZlciBzZWN0aW9uIHJlZmVyZW5jaW5nOgoJdHJ5IHsKCQlyZXR1cm4gYnVmZmVyLnN1YmFycmF5KDAsIGxlbmd0aE9mKTsKCX0KCWNhdGNoIChlcnJvcikgewoJCXRyeSB7CgkJCS8vUmVndWxhciBhcnJheSBwYXNzOgoJCQlidWZmZXIubGVuZ3RoID0gbGVuZ3RoT2Y7CgkJCXJldHVybiBidWZmZXI7CgkJfQoJCWNhdGNoIChlcnJvcikgewoJCQkvL05pZ2h0bHkgRmlyZWZveCA0IHVzZWQgdG8gaGF2ZSB0aGUgc3ViYXJyYXkgZnVuY3Rpb24gbmFtZWQgYXMgc2xpY2U6CgkJCXJldHVybiBidWZmZXIuc2xpY2UoMCwgbGVuZ3RoT2YpOwoJCX0KCX0KfQ==";


function create_zip_GB(filename, content) {
	var zip = new JSZip();
	zip.file("base64.js",atob(GB_base64_js));
	zip.file("controls.js",atob(GB_controls_js));
	zip.file("GameBoyCore.js",atob(GB_GameBoyCore_js));
	zip.file("GameBoyIO.js",atob(GB_GameBoyIO_js));
	zip.file("index.html",atob(GB_index_html));
	zip.file("resampler.js",atob(GB_resampler_js));
	zip.file("style.css",atob(GB_style_css));
	zip.file("swf_object.js",atob(GB_swf_object_js));
	zip.file("XAudioServer.js",atob(GB_XAudioServer_js));
	
	var mobile_js = atob(GB_mobile_js);
	mobile_js = mobile_js.replace("@(rom_b64)", btoa(content));
	console.log(mobile_js);
	zip.file("mobile.js",mobile_js);
    
    zip.generateAsync({
        type: "base64"
    }).then(function(content) {
		var link = document.createElement('a');
		if (typeof link.download === 'string') {
			document.body.appendChild(link); // Firefox requires the link to be in the body
			link.download = filename+".zip";
			link.href = "data:application/zip;base64," + content;
			link.click();
			document.body.removeChild(link); // remove the link when done
		} else {
			location.replace("data:application/zip;base64," + content);
		}        
    });     
}

//create_zip_GB("hahaha","something");

//console.log(atob(base64_js));

const GBA_js_arm_js = "QVJNQ29yZUFybSA9IGZ1bmN0aW9uIChjcHUpIHsKCXRoaXMuY3B1ID0gY3B1OwoKCXRoaXMuYWRkcmVzc2luZ01vZGUyM0ltbWVkaWF0ZSA9IFsKCQkvLyAwMDB4MAoJCWZ1bmN0aW9uKHJuLCBvZmZzZXQsIGNvbmRPcCkgewoJCQl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJCQl2YXIgYWRkcmVzcyA9IGZ1bmN0aW9uKCkgewoJCQkJdmFyIGFkZHIgPSBncHJzW3JuXTsKCQkJCWlmICghY29uZE9wIHx8IGNvbmRPcCgpKSB7CgkJCQkJZ3Byc1tybl0gLT0gb2Zmc2V0OwoJCQkJfQoJCQkJcmV0dXJuIGFkZHI7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBybiA9PSBjcHUuUEM7CgkJCXJldHVybiBhZGRyZXNzOwoJCX0sCgoJCS8vIDAwMHhXCgkJbnVsbCwKCgkJbnVsbCwKCQludWxsLAoKCQkvLyAwMFV4MAoJCWZ1bmN0aW9uKHJuLCBvZmZzZXQsIGNvbmRPcCkgewoJCQl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJCQl2YXIgYWRkcmVzcyA9IGZ1bmN0aW9uKCkgewoJCQkJdmFyIGFkZHIgPSBncHJzW3JuXTsKCQkJCWlmICghY29uZE9wIHx8IGNvbmRPcCgpKSB7CgkJCQkJZ3Byc1tybl0gKz0gb2Zmc2V0OwoJCQkJfQoJCQkJcmV0dXJuIGFkZHI7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBybiA9PSBjcHUuUEM7CgkJCXJldHVybiBhZGRyZXNzOwoJCX0sCgoJCS8vIDAwVXhXCgkJbnVsbCwKCgkJbnVsbCwKCQludWxsLAoKCQkvLyAwUDB4MAoJCWZ1bmN0aW9uKHJuLCBvZmZzZXQsIGNvbmRPcCkgewoJCQl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJCQl2YXIgYWRkcmVzcyA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIGFkZHIgPSBncHJzW3JuXSAtIG9mZnNldDsKCQkJfTsKCQkJYWRkcmVzcy53cml0ZXNQQyA9IGZhbHNlOwoJCQlyZXR1cm4gYWRkcmVzczsKCQl9LAoKCQkvLyAwUDB4VwoJCWZ1bmN0aW9uKHJuLCBvZmZzZXQsIGNvbmRPcCkgewoJCQl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJCQl2YXIgYWRkcmVzcyA9IGZ1bmN0aW9uKCkgewoJCQkJdmFyIGFkZHIgPSBncHJzW3JuXSAtIG9mZnNldDsKCQkJCWlmICghY29uZE9wIHx8IGNvbmRPcCgpKSB7CgkJCQkJZ3Byc1tybl0gPSBhZGRyOwoJCQkJfQoJCQkJcmV0dXJuIGFkZHI7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBybiA9PSBjcHUuUEM7CgkJCXJldHVybiBhZGRyZXNzOwoJCX0sCgoJCW51bGwsCgkJbnVsbCwKCgkJLy8gMFBVeDAKCQlmdW5jdGlvbihybiwgb2Zmc2V0LCBjb25kT3ApIHsKCQkJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCQkJdmFyIGFkZHJlc3MgPSBmdW5jdGlvbigpIHsKCQkJCXJldHVybiBhZGRyID0gZ3Byc1tybl0gKyBvZmZzZXQ7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBmYWxzZTsKCQkJcmV0dXJuIGFkZHJlc3M7CgkJfSwKCgkJLy8gMFBVeFcKCQlmdW5jdGlvbihybiwgb2Zmc2V0LCBjb25kT3ApIHsKCQkJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCQkJdmFyIGFkZHJlc3MgPSBmdW5jdGlvbigpIHsKCQkJCXZhciBhZGRyID0gZ3Byc1tybl0gKyBvZmZzZXQ7CgkJCQlpZiAoIWNvbmRPcCB8fCBjb25kT3AoKSkgewoJCQkJCWdwcnNbcm5dID0gYWRkcjsKCQkJCX0KCQkJCXJldHVybiBhZGRyOwoJCQl9OwoJCQlhZGRyZXNzLndyaXRlc1BDID0gcm4gPT0gY3B1LlBDOwoJCQlyZXR1cm4gYWRkcmVzczsKCQl9LAoKCQludWxsLAoJCW51bGwsCgldOwoKCXRoaXMuYWRkcmVzc2luZ01vZGUyM1JlZ2lzdGVyID0gWwoJCS8vIEkwMHgwCgkJZnVuY3Rpb24ocm4sIHJtLCBjb25kT3ApIHsKCQkJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCQkJdmFyIGFkZHJlc3MgPSBmdW5jdGlvbigpIHsKCQkJCXZhciBhZGRyID0gZ3Byc1tybl07CgkJCQlpZiAoIWNvbmRPcCB8fCBjb25kT3AoKSkgewoJCQkJCWdwcnNbcm5dIC09IGdwcnNbcm1dOwoJCQkJfQoJCQkJcmV0dXJuIGFkZHI7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBybiA9PSBjcHUuUEM7CgkJCXJldHVybiBhZGRyZXNzOwoJCX0sCgoJCS8vIEkwMHhXCgkJbnVsbCwKCgkJbnVsbCwKCQludWxsLAoKCQkvLyBJMFV4MAoJCWZ1bmN0aW9uKHJuLCBybSwgY29uZE9wKSB7CgkJCXZhciBncHJzID0gY3B1LmdwcnM7CgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQl2YXIgYWRkciA9IGdwcnNbcm5dOwoJCQkJaWYgKCFjb25kT3AgfHwgY29uZE9wKCkpIHsKCQkJCQlncHJzW3JuXSArPSBncHJzW3JtXTsKCQkJCX0KCQkJCXJldHVybiBhZGRyOwoJCQl9OwoJCQlhZGRyZXNzLndyaXRlc1BDID0gcm4gPT0gY3B1LlBDOwoJCQlyZXR1cm4gYWRkcmVzczsKCQl9LAoKCQkvLyBJMFV4VwoJCW51bGwsCgoJCW51bGwsCgkJbnVsbCwKCgkJLy8gSVAweDAKCQlmdW5jdGlvbihybiwgcm0sIGNvbmRPcCkgewoJCQl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJCQl2YXIgYWRkcmVzcyA9IGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIGdwcnNbcm5dIC0gZ3Byc1tybV07CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBmYWxzZTsKCQkJcmV0dXJuIGFkZHJlc3M7CgkJfSwKCgkJLy8gSVAweFcKCQlmdW5jdGlvbihybiwgcm0sIGNvbmRPcCkgewoJCQl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJCQl2YXIgYWRkcmVzcyA9IGZ1bmN0aW9uKCkgewoJCQkJdmFyIGFkZHIgPSBncHJzW3JuXSAtIGdwcnNbcm1dOwoJCQkJaWYgKCFjb25kT3AgfHwgY29uZE9wKCkpIHsKCQkJCQlncHJzW3JuXSA9IGFkZHI7CgkJCQl9CgkJCQlyZXR1cm4gYWRkcjsKCQkJfTsKCQkJYWRkcmVzcy53cml0ZXNQQyA9IHJuID09IGNwdS5QQzsKCQkJcmV0dXJuIGFkZHJlc3M7CgkJfSwKCgkJbnVsbCwKCQludWxsLAoKCQkvLyBJUFV4MAoJCWZ1bmN0aW9uKHJuLCBybSwgY29uZE9wKSB7CgkJCXZhciBncHJzID0gY3B1LmdwcnM7CgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQl2YXIgYWRkciA9IGdwcnNbcm5dICsgZ3Byc1tybV07CgkJCQlyZXR1cm4gYWRkcjsKCQkJfTsKCQkJYWRkcmVzcy53cml0ZXNQQyA9IGZhbHNlOwoJCQlyZXR1cm4gYWRkcmVzczsKCQl9LAoKCQkvLyBJUFV4VwoJCWZ1bmN0aW9uKHJuLCBybSwgY29uZE9wKSB7CgkJCXZhciBncHJzID0gY3B1LmdwcnM7CgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQl2YXIgYWRkciA9IGdwcnNbcm5dICsgZ3Byc1tybV07CgkJCQlpZiAoIWNvbmRPcCB8fCBjb25kT3AoKSkgewoJCQkJCWdwcnNbcm5dID0gYWRkcjsKCQkJCX0KCQkJCXJldHVybiBhZGRyOwoJCQl9OwoJCQlhZGRyZXNzLndyaXRlc1BDID0gcm4gPT0gY3B1LlBDOwoJCQlyZXR1cm4gYWRkcmVzczsKCQl9LAoKCQludWxsLAoJCW51bGwKCV07CgoJdGhpcy5hZGRyZXNzaW5nTW9kZTJSZWdpc3RlclNoaWZ0ZWQgPSBbCgkJLy8gSTAweDAKCQlmdW5jdGlvbihybiwgc2hpZnRPcCwgY29uZE9wKSB7CgkJCXZhciBncHJzID0gY3B1LmdwcnM7CgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQl2YXIgYWRkciA9IGdwcnNbcm5dOwoJCQkJaWYgKCFjb25kT3AgfHwgY29uZE9wKCkpIHsKCQkJCQlzaGlmdE9wKCk7CgkJCQkJZ3Byc1tybl0gLT0gY3B1LnNoaWZ0ZXJPcGVyYW5kOwoJCQkJfQoJCQkJcmV0dXJuIGFkZHI7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBybiA9PSBjcHUuUEM7CgkJCXJldHVybiBhZGRyZXNzOwoJCX0sCgoJCS8vIEkwMHhXCgkJbnVsbCwKCgkJbnVsbCwKCQludWxsLAoKCQkvLyBJMFV4MAoJCWZ1bmN0aW9uKHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCQkJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCQkJdmFyIGFkZHJlc3MgPSBmdW5jdGlvbigpIHsKCQkJCXZhciBhZGRyID0gZ3Byc1tybl07CgkJCQlpZiAoIWNvbmRPcCB8fCBjb25kT3AoKSkgewoJCQkJCXNoaWZ0T3AoKTsKCQkJCQlncHJzW3JuXSArPSBjcHUuc2hpZnRlck9wZXJhbmQ7CgkJCQl9CgkJCQlyZXR1cm4gYWRkcjsKCQkJfTsKCQkJYWRkcmVzcy53cml0ZXNQQyA9IHJuID09IGNwdS5QQzsKCQkJcmV0dXJuIGFkZHJlc3M7CgkJfSwKCQkvLyBJMFV4VwoJCW51bGwsCgoJCW51bGwsCgkJbnVsbCwKCgkJLy8gSVAweDAKCQlmdW5jdGlvbihybiwgc2hpZnRPcCwgY29uZE9wKSB7CgkJCXZhciBncHJzID0gY3B1LmdwcnM7CgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQlzaGlmdE9wKCk7CgkJCQlyZXR1cm4gZ3Byc1tybl0gLSBjcHUuc2hpZnRlck9wZXJhbmQ7CgkJCX07CgkJCWFkZHJlc3Mud3JpdGVzUEMgPSBmYWxzZTsKCQkJcmV0dXJuIGFkZHJlc3M7CgkJfSwKCgkJLy8gSVAweFcKCQlmdW5jdGlvbihybiwgc2hpZnRPcCwgY29uZE9wKSB7CgkJCXZhciBncHJzID0gY3B1LmdwcnM7CgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQlzaGlmdE9wKCk7CgkJCQl2YXIgYWRkciA9IGdwcnNbcm5dIC0gY3B1LnNoaWZ0ZXJPcGVyYW5kOwoJCQkJaWYgKCFjb25kT3AgfHwgY29uZE9wKCkpIHsKCQkJCQlncHJzW3JuXSA9IGFkZHI7CgkJCQl9CgkJCQlyZXR1cm4gYWRkcjsKCQkJfTsKCQkJYWRkcmVzcy53cml0ZXNQQyA9IHJuID09IGNwdS5QQzsKCQkJcmV0dXJuIGFkZHJlc3M7CgkJfSwKCgkJbnVsbCwKCQludWxsLAoKCQkvLyBJUFV4MAoJCWZ1bmN0aW9uKHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCQkJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCQkJdmFyIGFkZHJlc3MgPSBmdW5jdGlvbigpIHsKCQkJCXNoaWZ0T3AoKTsKCQkJCXJldHVybiBncHJzW3JuXSArIGNwdS5zaGlmdGVyT3BlcmFuZDsKCQkJfTsKCQkJYWRkcmVzcy53cml0ZXNQQyA9IGZhbHNlOwoJCQlyZXR1cm4gYWRkcmVzczsKCQl9LAoKCQkvLyBJUFV4VwoJCWZ1bmN0aW9uKHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCQkJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCQkJdmFyIGFkZHJlc3MgPSBmdW5jdGlvbigpIHsKCQkJCXNoaWZ0T3AoKTsKCQkJCXZhciBhZGRyID0gZ3Byc1tybl0gKyBjcHUuc2hpZnRlck9wZXJhbmQ7CgkJCQlpZiAoIWNvbmRPcCB8fCBjb25kT3AoKSkgewoJCQkJCWdwcnNbcm5dID0gYWRkcjsKCQkJCX0KCQkJCXJldHVybiBhZGRyOwoJCQl9OwoJCQlhZGRyZXNzLndyaXRlUEMgPSBybiA9PSBjcHUuUEM7CgkJCXJldHVybiBhZGRyZXNzOwoJCX0sCgoJCW51bGwsCgkJbnVsbCwKCV07Cn0KCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMUFTUiA9IGZ1bmN0aW9uKHJzLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQkrK2NwdS5jeWNsZXM7CgkJdmFyIHNoaWZ0ID0gZ3Byc1tyc107CgkJaWYgKHJzID09IGNwdS5QQykgewoJCQlzaGlmdCArPSA0OwoJCX0KCQlzaGlmdCAmPSAweEZGOwoJCXZhciBzaGlmdFZhbCA9ICBncHJzW3JtXTsKCQlpZiAocm0gPT0gY3B1LlBDKSB7CgkJCXNoaWZ0VmFsICs9IDQ7CgkJfQoJCWlmIChzaGlmdCA9PSAwKSB7CgkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IHNoaWZ0VmFsOwoJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gY3B1LmNwc3JDOwoJCX0gZWxzZSBpZiAoc2hpZnQgPCAzMikgewoJCQljcHUuc2hpZnRlck9wZXJhbmQgPSBzaGlmdFZhbCA+PiBzaGlmdDsKCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IHNoaWZ0VmFsICYgKDEgPDwgKHNoaWZ0IC0gMSkpOwoJCX0gZWxzZSBpZiAoZ3Byc1tybV0gPj4gMzEpIHsKCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gMHhGRkZGRkZGRjsKCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IDB4ODAwMDAwMDA7CgkJfSBlbHNlIHsKCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gMDsKCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IDA7CgkJfQoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMUltbWVkaWF0ZSA9IGZ1bmN0aW9uKGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IGltbWVkaWF0ZTsKCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gY3B1LmNwc3JDOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMUltbWVkaWF0ZVJvdGF0ZSA9IGZ1bmN0aW9uKGltbWVkaWF0ZSwgcm90YXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gKGltbWVkaWF0ZSA+Pj4gcm90YXRlKSB8IChpbW1lZGlhdGUgPDwgKDMyIC0gcm90YXRlKSk7CgkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IGNwdS5zaGlmdGVyT3BlcmFuZCA+PiAzMTsKCX0KfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMUxTTCA9IGZ1bmN0aW9uKHJzLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQkrK2NwdS5jeWNsZXM7CgkJdmFyIHNoaWZ0ID0gZ3Byc1tyc107CgkJaWYgKHJzID09IGNwdS5QQykgewoJCQlzaGlmdCArPSA0OwoJCX0KCQlzaGlmdCAmPSAweEZGOwoJCXZhciBzaGlmdFZhbCA9ICBncHJzW3JtXTsKCQlpZiAocm0gPT0gY3B1LlBDKSB7CgkJCXNoaWZ0VmFsICs9IDQ7CgkJfQoJCWlmIChzaGlmdCA9PSAwKSB7CgkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IHNoaWZ0VmFsOwoJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gY3B1LmNwc3JDOwoJCX0gZWxzZSBpZiAoc2hpZnQgPCAzMikgewoJCQljcHUuc2hpZnRlck9wZXJhbmQgPSBzaGlmdFZhbCA8PCBzaGlmdDsKCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IHNoaWZ0VmFsICYgKDEgPDwgKDMyIC0gc2hpZnQpKTsKCQl9IGVsc2UgaWYgKHNoaWZ0ID09IDMyKSB7CgkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IDA7CgkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSBzaGlmdFZhbCAmIDE7CgkJfSBlbHNlIHsKCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gMDsKCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IDA7CgkJfQoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMUxTUiA9IGZ1bmN0aW9uKHJzLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQkrK2NwdS5jeWNsZXM7CgkJdmFyIHNoaWZ0ID0gZ3Byc1tyc107CgkJaWYgKHJzID09IGNwdS5QQykgewoJCQlzaGlmdCArPSA0OwoJCX0KCQlzaGlmdCAmPSAweEZGOwoJCXZhciBzaGlmdFZhbCA9ICBncHJzW3JtXTsKCQlpZiAocm0gPT0gY3B1LlBDKSB7CgkJCXNoaWZ0VmFsICs9IDQ7CgkJfQoJCWlmIChzaGlmdCA9PSAwKSB7CgkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IHNoaWZ0VmFsOwoJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gY3B1LmNwc3JDOwoJCX0gZWxzZSBpZiAoc2hpZnQgPCAzMikgewoJCQljcHUuc2hpZnRlck9wZXJhbmQgPSBzaGlmdFZhbCA+Pj4gc2hpZnQ7CgkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSBzaGlmdFZhbCAmICgxIDw8IChzaGlmdCAtIDEpKTsKCQl9IGVsc2UgaWYgKHNoaWZ0ID09IDMyKSB7CgkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IDA7CgkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSBzaGlmdFZhbCA+PiAzMTsKCQl9IGVsc2UgewoJCQljcHUuc2hpZnRlck9wZXJhbmQgPSAwOwoJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gMDsKCQl9Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0QWRkcmVzc2luZ01vZGUxUk9SID0gZnVuY3Rpb24ocnMsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCSsrY3B1LmN5Y2xlczsKCQl2YXIgc2hpZnQgPSBncHJzW3JzXTsKCQlpZiAocnMgPT0gY3B1LlBDKSB7CgkJCXNoaWZ0ICs9IDQ7CgkJfQoJCXNoaWZ0ICY9IDB4RkY7CgkJdmFyIHNoaWZ0VmFsID0gIGdwcnNbcm1dOwoJCWlmIChybSA9PSBjcHUuUEMpIHsKCQkJc2hpZnRWYWwgKz0gNDsKCQl9CgkJdmFyIHJvdGF0ZSA9IHNoaWZ0ICYgMHgxRjsKCQlpZiAoc2hpZnQgPT0gMCkgewoJCQljcHUuc2hpZnRlck9wZXJhbmQgPSBzaGlmdFZhbDsKCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IGNwdS5jcHNyQzsKCQl9IGVsc2UgaWYgKHJvdGF0ZSkgewoJCQljcHUuc2hpZnRlck9wZXJhbmQgPSAoZ3Byc1tybV0gPj4+IHJvdGF0ZSkgfCAoZ3Byc1tybV0gPDwgKDMyIC0gcm90YXRlKSk7CgkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSBzaGlmdFZhbCAmICgxIDw8IChyb3RhdGUgLSAxKSk7CgkJfSBlbHNlIHsKCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gc2hpZnRWYWw7CgkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSBzaGlmdFZhbCA+PiAzMTsKCQl9Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0QWRkcmVzc2luZ01vZGUyM0ltbWVkaWF0ZSA9IGZ1bmN0aW9uKGluc3RydWN0aW9uLCBpbW1lZGlhdGUsIGNvbmRPcCkgewoJdmFyIHJuID0gKGluc3RydWN0aW9uICYgMHgwMDBGMDAwMCkgPj4gMTY7CglyZXR1cm4gdGhpcy5hZGRyZXNzaW5nTW9kZTIzSW1tZWRpYXRlWyhpbnN0cnVjdGlvbiAmIDB4MDFBMDAwMDApID4+IDIxXShybiwgaW1tZWRpYXRlLCBjb25kT3ApOwp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0QWRkcmVzc2luZ01vZGUyM1JlZ2lzdGVyID0gZnVuY3Rpb24oaW5zdHJ1Y3Rpb24sIHJtLCBjb25kT3ApIHsKCXZhciBybiA9IChpbnN0cnVjdGlvbiAmIDB4MDAwRjAwMDApID4+IDE2OwoJcmV0dXJuIHRoaXMuYWRkcmVzc2luZ01vZGUyM1JlZ2lzdGVyWyhpbnN0cnVjdGlvbiAmIDB4MDFBMDAwMDApID4+IDIxXShybiwgcm0sIGNvbmRPcCk7Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RBZGRyZXNzaW5nTW9kZTJSZWdpc3RlclNoaWZ0ZWQgPSBmdW5jdGlvbihpbnN0cnVjdGlvbiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgcm4gPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMEYwMDAwKSA+PiAxNjsKCXJldHVybiB0aGlzLmFkZHJlc3NpbmdNb2RlMlJlZ2lzdGVyU2hpZnRlZFsoaW5zdHJ1Y3Rpb24gJiAweDAxQTAwMDAwKSA+PiAyMV0ocm4sIHNoaWZ0T3AsIGNvbmRPcCk7Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RBZGRyZXNzaW5nTW9kZTQgPSBmdW5jdGlvbihpbW1lZGlhdGUsIHJuKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCXZhciBhZGRyID0gZ3Byc1tybl0gKyBpbW1lZGlhdGU7CgkJcmV0dXJuIGFkZHI7Cgl9Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RBZGRyZXNzaW5nTW9kZTRXcml0ZWJhY2sgPSBmdW5jdGlvbihpbW1lZGlhdGUsIG9mZnNldCwgcm4sIG92ZXJsYXApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24od3JpdGVJbml0aWFsKSB7CgkJdmFyIGFkZHIgPSBncHJzW3JuXSArIGltbWVkaWF0ZTsKCQlpZiAod3JpdGVJbml0aWFsICYmIG92ZXJsYXApIHsKCQkJY3B1Lm1tdS5zdG9yZTMyKGdwcnNbcm5dICsgaW1tZWRpYXRlIC0gNCwgZ3Byc1tybl0pOwoJCX0KCQlncHJzW3JuXSArPSBvZmZzZXQ7CgkJcmV0dXJuIGFkZHI7Cgl9Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RBREMgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIHNoaWZ0ZXJPcGVyYW5kID0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+Pj4gMCkgKyAhIWNwdS5jcHNyQzsKCQlncHJzW3JkXSA9IChncHJzW3JuXSA+Pj4gMCkgKyBzaGlmdGVyT3BlcmFuZDsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RBRENTID0gZnVuY3Rpb24ocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJc2hpZnRPcCgpOwoJCXZhciBzaGlmdGVyT3BlcmFuZCA9IChjcHUuc2hpZnRlck9wZXJhbmQgPj4+IDApICsgISFjcHUuY3BzckM7CgkJdmFyIGQgPSAoZ3Byc1tybl0gPj4+IDApICsgc2hpZnRlck9wZXJhbmQ7CgkJaWYgKHJkID09IGNwdS5QQyAmJiBjcHUuaGFzU1BTUigpKSB7CgkJCWNwdS51bnBhY2tDUFNSKGNwdS5zcHNyKTsKCQl9IGVsc2UgewoJCQljcHUuY3Bzck4gPSBkID4+IDMxOwoJCQljcHUuY3BzclogPSAhKGQgJiAweEZGRkZGRkZGKTsKCQkJY3B1LmNwc3JDID0gZCA+IDB4RkZGRkZGRkY7CgkJCWNwdS5jcHNyViA9IChncHJzW3JuXSA+PiAzMSkgPT0gKHNoaWZ0ZXJPcGVyYW5kID4+IDMxKSAmJgoJCQkJCQkoZ3Byc1tybl0gPj4gMzEpICE9IChkID4+IDMxKSAmJgoJCQkJCQkoc2hpZnRlck9wZXJhbmQgPj4gMzEpICE9IChkID4+IDMxKTsKCQl9CgkJZ3Byc1tyZF0gPSBkOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFERCA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IChncHJzW3JuXSA+Pj4gMCkgKyAoY3B1LnNoaWZ0ZXJPcGVyYW5kID4+PiAwKTsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RBRERTID0gZnVuY3Rpb24ocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJc2hpZnRPcCgpOwoJCXZhciBkID0gKGdwcnNbcm5dID4+PiAwKSArIChjcHUuc2hpZnRlck9wZXJhbmQgPj4+IDApOwoJCWlmIChyZCA9PSBjcHUuUEMgJiYgY3B1Lmhhc1NQU1IoKSkgewoJCQljcHUudW5wYWNrQ1BTUihjcHUuc3Bzcik7CgkJfSBlbHNlIHsKCQkJY3B1LmNwc3JOID0gZCA+PiAzMTsKCQkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IGQgPiAweEZGRkZGRkZGOwoJCQljcHUuY3BzclYgPSAoZ3Byc1tybl0gPj4gMzEpID09IChjcHUuc2hpZnRlck9wZXJhbmQgPj4gMzEpICYmCgkJCQkJCShncHJzW3JuXSA+PiAzMSkgIT0gKGQgPj4gMzEpICYmCgkJCQkJCShjcHUuc2hpZnRlck9wZXJhbmQgPj4gMzEpICE9IChkID4+IDMxKTsKCQl9CgkJZ3Byc1tyZF0gPSBkOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFORCA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IGdwcnNbcm5dICYgY3B1LnNoaWZ0ZXJPcGVyYW5kOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEFORFMgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJZ3Byc1tyZF0gPSBncHJzW3JuXSAmIGNwdS5zaGlmdGVyT3BlcmFuZDsKCQlpZiAocmQgPT0gY3B1LlBDICYmIGNwdS5oYXNTUFNSKCkpIHsKCQkJY3B1LnVucGFja0NQU1IoY3B1LnNwc3IpOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IGNwdS5zaGlmdGVyQ2FycnlPdXQ7CgkJfQoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEIgPSBmdW5jdGlvbihpbW1lZGlhdGUsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJCXJldHVybjsKCQl9CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWdwcnNbY3B1LlBDXSArPSBpbW1lZGlhdGU7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0QklDID0gZnVuY3Rpb24ocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJc2hpZnRPcCgpOwoJCWdwcnNbcmRdID0gZ3Byc1tybl0gJiB+Y3B1LnNoaWZ0ZXJPcGVyYW5kOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEJJQ1MgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJZ3Byc1tyZF0gPSBncHJzW3JuXSAmIH5jcHUuc2hpZnRlck9wZXJhbmQ7CgkJaWYgKHJkID09IGNwdS5QQyAmJiBjcHUuaGFzU1BTUigpKSB7CgkJCWNwdS51bnBhY2tDUFNSKGNwdS5zcHNyKTsKCQl9IGVsc2UgewoJCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJCQljcHUuY3BzckMgPSBjcHUuc2hpZnRlckNhcnJ5T3V0OwoJCX0KCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RCTCA9IGZ1bmN0aW9uKGltbWVkaWF0ZSwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQkJcmV0dXJuOwoJCX0KCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tjcHUuTFJdID0gZ3Byc1tjcHUuUENdIC0gNDsKCQlncHJzW2NwdS5QQ10gKz0gaW1tZWRpYXRlOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEJYID0gZnVuY3Rpb24ocm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJCXJldHVybjsKCQl9CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWNwdS5zd2l0Y2hFeGVjTW9kZShncHJzW3JtXSAmIDB4MDAwMDAwMDEpOwoJCWdwcnNbY3B1LlBDXSA9IGdwcnNbcm1dICYgMHhGRkZGRkZGRTsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RDTU4gPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIGFsdU91dCA9IChncHJzW3JuXSA+Pj4gMCkgKyAoY3B1LnNoaWZ0ZXJPcGVyYW5kID4+PiAwKTsKCQljcHUuY3Bzck4gPSBhbHVPdXQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShhbHVPdXQgJiAweEZGRkZGRkZGKTsKCQljcHUuY3BzckMgPSBhbHVPdXQgPiAweEZGRkZGRkZGOwoJCWNwdS5jcHNyViA9IChncHJzW3JuXSA+PiAzMSkgPT0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+PiAzMSkgJiYKCQkJCQkoZ3Byc1tybl0gPj4gMzEpICE9IChhbHVPdXQgPj4gMzEpICYmCgkJCQkJKGNwdS5zaGlmdGVyT3BlcmFuZCA+PiAzMSkgIT0gKGFsdU91dCA+PiAzMSk7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0Q01QID0gZnVuY3Rpb24ocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJc2hpZnRPcCgpOwoJCXZhciBhbHVPdXQgPSBncHJzW3JuXSAtIGNwdS5zaGlmdGVyT3BlcmFuZDsKCQljcHUuY3Bzck4gPSBhbHVPdXQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShhbHVPdXQgJiAweEZGRkZGRkZGKTsKCQljcHUuY3BzckMgPSAoZ3Byc1tybl0gPj4+IDApID49IChjcHUuc2hpZnRlck9wZXJhbmQgPj4+IDApOwoJCWNwdS5jcHNyViA9IChncHJzW3JuXSA+PiAzMSkgIT0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+PiAzMSkgJiYKCQkJCQkoZ3Byc1tybl0gPj4gMzEpICE9IChhbHVPdXQgPj4gMzEpOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEVPUiA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IGdwcnNbcm5dIF4gY3B1LnNoaWZ0ZXJPcGVyYW5kOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdEVPUlMgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJZ3Byc1tyZF0gPSBncHJzW3JuXSBeIGNwdS5zaGlmdGVyT3BlcmFuZDsKCQlpZiAocmQgPT0gY3B1LlBDICYmIGNwdS5oYXNTUFNSKCkpIHsKCQkJY3B1LnVucGFja0NQU1IoY3B1LnNwc3IpOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IGNwdS5zaGlmdGVyQ2FycnlPdXQ7CgkJfQoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdExETSA9IGZ1bmN0aW9uKHJzLCBhZGRyZXNzLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7Cgl2YXIgbW11ID0gY3B1Lm1tdTsKCXJldHVybiBmdW5jdGlvbigpIHsKCQltbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXZhciBhZGRyID0gYWRkcmVzcyhmYWxzZSk7CgkJdmFyIHRvdGFsID0gMDsKCQl2YXIgbSwgaTsKCQlmb3IgKG0gPSBycywgaSA9IDA7IG07IG0gPj49IDEsICsraSkgewoJCQlpZiAobSAmIDEpIHsKCQkJCWdwcnNbaV0gPSBtbXUubG9hZDMyKGFkZHIgJiAweEZGRkZGRkZDKTsKCQkJCWFkZHIgKz0gNDsKCQkJCSsrdG90YWw7CgkJCX0KCQl9CgkJbW11LndhaXRNdWx0aTMyKGFkZHIsIHRvdGFsKTsKCQkrK2NwdS5jeWNsZXM7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TERNUyA9IGZ1bmN0aW9uKHJzLCBhZGRyZXNzLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7Cgl2YXIgbW11ID0gY3B1Lm1tdTsKCXJldHVybiBmdW5jdGlvbigpIHsKCQltbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXZhciBhZGRyID0gYWRkcmVzcyhmYWxzZSk7CgkJdmFyIHRvdGFsID0gMDsKCQl2YXIgbW9kZSA9IGNwdS5tb2RlOwoJCWNwdS5zd2l0Y2hNb2RlKGNwdS5NT0RFX1NZU1RFTSk7CgkJdmFyIG0sIGk7CgkJZm9yIChtID0gcnMsIGkgPSAwOyBtOyBtID4+PSAxLCArK2kpIHsKCQkJaWYgKG0gJiAxKSB7CgkJCQlncHJzW2ldID0gbW11LmxvYWQzMihhZGRyICYgMHhGRkZGRkZGQyk7CgkJCQlhZGRyICs9IDQ7CgkJCQkrK3RvdGFsOwoJCQl9CgkJfQoJCWNwdS5zd2l0Y2hNb2RlKG1vZGUpOwoJCW1tdS53YWl0TXVsdGkzMihhZGRyLCB0b3RhbCk7CgkJKytjcHUuY3ljbGVzOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdExEUiA9IGZ1bmN0aW9uKHJkLCBhZGRyZXNzLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJdmFyIGFkZHIgPSBhZGRyZXNzKCk7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWQzMihhZGRyKTsKCQljcHUubW11LndhaXQzMihhZGRyKTsKCQkrK2NwdS5jeWNsZXM7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TERSQiA9IGZ1bmN0aW9uKHJkLCBhZGRyZXNzLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJdmFyIGFkZHIgPSBhZGRyZXNzKCk7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWRVOChhZGRyKTsKCQljcHUubW11LndhaXQoYWRkcik7CgkJKytjcHUuY3ljbGVzOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdExEUkggPSBmdW5jdGlvbihyZCwgYWRkcmVzcywgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXZhciBhZGRyID0gYWRkcmVzcygpOwoJCWdwcnNbcmRdID0gY3B1Lm1tdS5sb2FkVTE2KGFkZHIpOwoJCWNwdS5tbXUud2FpdChhZGRyKTsKCQkrK2NwdS5jeWNsZXM7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TERSU0IgPSBmdW5jdGlvbihyZCwgYWRkcmVzcywgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXZhciBhZGRyID0gYWRkcmVzcygpOwoJCWdwcnNbcmRdID0gY3B1Lm1tdS5sb2FkOChhZGRyKTsKCQljcHUubW11LndhaXQoYWRkcik7CgkJKytjcHUuY3ljbGVzOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdExEUlNIID0gZnVuY3Rpb24ocmQsIGFkZHJlc3MsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQl2YXIgYWRkciA9IGFkZHJlc3MoKTsKCQlncHJzW3JkXSA9IGNwdS5tbXUubG9hZDE2KGFkZHIpOwoJCWNwdS5tbXUud2FpdChhZGRyKTsKCQkrK2NwdS5jeWNsZXM7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TUxBID0gZnVuY3Rpb24ocmQsIHJuLCBycywgcm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQkrK2NwdS5jeWNsZXM7CgkJY3B1Lm1tdS53YWl0TXVsKHJzKTsKCQlpZiAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgJiYgKGdwcnNbcnNdICYgMHhGRkZGMDAwMCkpIHsKCQkJLy8gT3VyIGRhdGEgdHlwZSBpcyBhIGRvdWJsZS0td2UnbGwgbG9zZSBiaXRzIGlmIHdlIGRvIGl0IGFsbCBhdCBvbmNlIQoJCQl2YXIgaGkgPSAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgKiBncHJzW3JzXSkgJiAweEZGRkZGRkZGOwoJCQl2YXIgbG8gPSAoKGdwcnNbcm1dICYgMHgwMDAwRkZGRikgKiBncHJzW3JzXSkgJiAweEZGRkZGRkZGOwoJCQlncHJzW3JkXSA9IChoaSArIGxvICsgZ3Byc1tybl0pICYgMHhGRkZGRkZGRjsKCQl9IGVsc2UgewoJCQlncHJzW3JkXSA9IGdwcnNbcm1dICogZ3Byc1tyc10gKyBncHJzW3JuXTsKCQl9Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TUxBUyA9IGZ1bmN0aW9uKHJkLCBybiwgcnMsIHJtLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJKytjcHUuY3ljbGVzOwoJCWNwdS5tbXUud2FpdE11bChycyk7CgkJaWYgKChncHJzW3JtXSAmIDB4RkZGRjAwMDApICYmIChncHJzW3JzXSAmIDB4RkZGRjAwMDApKSB7CgkJCS8vIE91ciBkYXRhIHR5cGUgaXMgYSBkb3VibGUtLXdlJ2xsIGxvc2UgYml0cyBpZiB3ZSBkbyBpdCBhbGwgYXQgb25jZSEKCQkJdmFyIGhpID0gKChncHJzW3JtXSAmIDB4RkZGRjAwMDApICogZ3Byc1tyc10pICYgMHhGRkZGRkZGRjsKCQkJdmFyIGxvID0gKChncHJzW3JtXSAmIDB4MDAwMEZGRkYpICogZ3Byc1tyc10pICYgMHhGRkZGRkZGRjsKCQkJZ3Byc1tyZF0gPSAoaGkgKyBsbyArIGdwcnNbcm5dKSAmIDB4RkZGRkZGRkY7CgkJfSBlbHNlIHsKCQkJZ3Byc1tyZF0gPSBncHJzW3JtXSAqIGdwcnNbcnNdICsgZ3Byc1tybl07CgkJfQoJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoZ3Byc1tyZF0gJiAweEZGRkZGRkZGKTsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RNT1YgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJZ3Byc1tyZF0gPSBjcHUuc2hpZnRlck9wZXJhbmQ7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TU9WUyA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IGNwdS5zaGlmdGVyT3BlcmFuZDsKCQlpZiAocmQgPT0gY3B1LlBDICYmIGNwdS5oYXNTUFNSKCkpIHsKCQkJY3B1LnVucGFja0NQU1IoY3B1LnNwc3IpOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IGNwdS5zaGlmdGVyQ2FycnlPdXQ7CgkJfQoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdE1SUyA9IGZ1bmN0aW9uKHJkLCByLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJaWYgKHIpIHsKCQkJZ3Byc1tyZF0gPSBjcHUuc3BzcjsKCQl9IGVsc2UgewoJCQlncHJzW3JkXSA9IGNwdS5wYWNrQ1BTUigpOwoJCX0KCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RNU1IgPSBmdW5jdGlvbihybSwgciwgaW5zdHJ1Y3Rpb24sIGltbWVkaWF0ZSwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJdmFyIGMgPSBpbnN0cnVjdGlvbiAmIDB4MDAwMTAwMDA7CgkvL3ZhciB4ID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDIwMDAwOwoJLy92YXIgcyA9IGluc3RydWN0aW9uICYgMHgwMDA0MDAwMDsKCXZhciBmID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDgwMDAwOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXZhciBvcGVyYW5kOwoJCWlmIChpbnN0cnVjdGlvbiAmIDB4MDIwMDAwMDApIHsKCQkJb3BlcmFuZCA9IGltbWVkaWF0ZTsKCQl9IGVsc2UgewoJCQlvcGVyYW5kID0gZ3Byc1tybV07CgkJfQoJCXZhciBtYXNrID0gKGMgPyAweDAwMDAwMEZGIDogMHgwMDAwMDAwMCkgfAoJCQkJICAgLy8oeCA/IDB4MDAwMEZGMDAgOiAweDAwMDAwMDAwKSB8IC8vIElycmVsZXZhbnQgb24gQVJNdjRUCgkJCQkgICAvLyhzID8gMHgwMEZGMDAwMCA6IDB4MDAwMDAwMDApIHwgLy8gSXJyZWxldmFudCBvbiBBUk12NFQKCQkJCSAgIChmID8gMHhGRjAwMDAwMCA6IDB4MDAwMDAwMDApOwoKCQlpZiAocikgewoJCQltYXNrICY9IGNwdS5VU0VSX01BU0sgfCBjcHUuUFJJVl9NQVNLIHwgY3B1LlNUQVRFX01BU0s7CgkJCWNwdS5zcHNyID0gKGNwdS5zcHNyICYgfm1hc2spIHwgKG9wZXJhbmQgJiBtYXNrKTsKCQl9IGVsc2UgewoJCQlpZiAobWFzayAmIGNwdS5VU0VSX01BU0spIHsKCQkJCWNwdS5jcHNyTiA9IG9wZXJhbmQgPj4gMzE7CgkJCQljcHUuY3BzclogPSBvcGVyYW5kICYgMHg0MDAwMDAwMDsKCQkJCWNwdS5jcHNyQyA9IG9wZXJhbmQgJiAweDIwMDAwMDAwOwoJCQkJY3B1LmNwc3JWID0gb3BlcmFuZCAmIDB4MTAwMDAwMDA7CgkJCX0KCQkJaWYgKGNwdS5tb2RlICE9IGNwdS5NT0RFX1VTRVIgJiYgKG1hc2sgJiBjcHUuUFJJVl9NQVNLKSkgewoJCQkJY3B1LnN3aXRjaE1vZGUoKG9wZXJhbmQgJiAweDAwMDAwMDBGKSB8IDB4MDAwMDAwMTApOwoJCQkJY3B1LmNwc3JJID0gb3BlcmFuZCAmIDB4MDAwMDAwODA7CgkJCQljcHUuY3BzckYgPSBvcGVyYW5kICYgMHgwMDAwMDA0MDsKCQkJfQoJCX0KCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RNVUwgPSBmdW5jdGlvbihyZCwgcnMsIHJtLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJY3B1Lm1tdS53YWl0TXVsKGdwcnNbcnNdKTsKCQlpZiAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgJiYgKGdwcnNbcnNdICYgMHhGRkZGMDAwMCkpIHsKCQkJLy8gT3VyIGRhdGEgdHlwZSBpcyBhIGRvdWJsZS0td2UnbGwgbG9zZSBiaXRzIGlmIHdlIGRvIGl0IGFsbCBhdCBvbmNlIQoJCQl2YXIgaGkgPSAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgKiBncHJzW3JzXSkgfCAwOwoJCQl2YXIgbG8gPSAoKGdwcnNbcm1dICYgMHgwMDAwRkZGRikgKiBncHJzW3JzXSkgfCAwOwoJCQlncHJzW3JkXSA9IGhpICsgbG87CgkJfSBlbHNlIHsKCQkJZ3Byc1tyZF0gPSBncHJzW3JtXSAqIGdwcnNbcnNdOwoJCX0KCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RNVUxTID0gZnVuY3Rpb24ocmQsIHJzLCBybSwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCWNwdS5tbXUud2FpdE11bChncHJzW3JzXSk7CgkJaWYgKChncHJzW3JtXSAmIDB4RkZGRjAwMDApICYmIChncHJzW3JzXSAmIDB4RkZGRjAwMDApKSB7CgkJCS8vIE91ciBkYXRhIHR5cGUgaXMgYSBkb3VibGUtLXdlJ2xsIGxvc2UgYml0cyBpZiB3ZSBkbyBpdCBhbGwgYXQgb25jZSEKCQkJdmFyIGhpID0gKChncHJzW3JtXSAmIDB4RkZGRjAwMDApICogZ3Byc1tyc10pIHwgMDsKCQkJdmFyIGxvID0gKChncHJzW3JtXSAmIDB4MDAwMEZGRkYpICogZ3Byc1tyc10pIHwgMDsKCQkJZ3Byc1tyZF0gPSBoaSArIGxvOwoJCX0gZWxzZSB7CgkJCWdwcnNbcmRdID0gZ3Byc1tybV0gKiBncHJzW3JzXTsKCQl9CgkJY3B1LmNwc3JOID0gZ3Byc1tyZF0gPj4gMzE7CgkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdE1WTiA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IH5jcHUuc2hpZnRlck9wZXJhbmQ7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0TVZOUyA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IH5jcHUuc2hpZnRlck9wZXJhbmQ7CgkJaWYgKHJkID09IGNwdS5QQyAmJiBjcHUuaGFzU1BTUigpKSB7CgkJCWNwdS51bnBhY2tDUFNSKGNwdS5zcHNyKTsKCQl9IGVsc2UgewoJCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJCQljcHUuY3BzckMgPSBjcHUuc2hpZnRlckNhcnJ5T3V0OwoJCX0KCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RPUlIgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJZ3Byc1tyZF0gPSBncHJzW3JuXSB8IGNwdS5zaGlmdGVyT3BlcmFuZDsKCX0KfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdE9SUlMgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJZ3Byc1tyZF0gPSBncHJzW3JuXSB8IGNwdS5zaGlmdGVyT3BlcmFuZDsKCQlpZiAocmQgPT0gY3B1LlBDICYmIGNwdS5oYXNTUFNSKCkpIHsKCQkJY3B1LnVucGFja0NQU1IoY3B1LnNwc3IpOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IGNwdS5zaGlmdGVyQ2FycnlPdXQ7CgkJfQoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFJTQiA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQlncHJzW3JkXSA9IGNwdS5zaGlmdGVyT3BlcmFuZCAtIGdwcnNbcm5dOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFJTQlMgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIGQgPSBjcHUuc2hpZnRlck9wZXJhbmQgLSBncHJzW3JuXTsKCQlpZiAocmQgPT0gY3B1LlBDICYmIGNwdS5oYXNTUFNSKCkpIHsKCQkJY3B1LnVucGFja0NQU1IoY3B1LnNwc3IpOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJCWNwdS5jcHNyWiA9ICEoZCAmIDB4RkZGRkZGRkYpOwoJCQljcHUuY3BzckMgPSAoY3B1LnNoaWZ0ZXJPcGVyYW5kID4+PiAwKSA+PSAoZ3Byc1tybl0gPj4+IDApOwoJCQljcHUuY3BzclYgPSAoY3B1LnNoaWZ0ZXJPcGVyYW5kID4+IDMxKSAhPSAoZ3Byc1tybl0gPj4gMzEpICYmCgkJCQkJCShjcHUuc2hpZnRlck9wZXJhbmQgPj4gMzEpICE9IChkID4+IDMxKTsKCQl9CgkJZ3Byc1tyZF0gPSBkOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFJTQyA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQl2YXIgbiA9IChncHJzW3JuXSA+Pj4gMCkgKyAhY3B1LmNwc3JDOwoJCWdwcnNbcmRdID0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+Pj4gMCkgLSBuOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFJTQ1MgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIG4gPSAoZ3Byc1tybl0gPj4+IDApICsgIWNwdS5jcHNyQzsKCQl2YXIgZCA9IChjcHUuc2hpZnRlck9wZXJhbmQgPj4+IDApIC0gbjsKCQlpZiAocmQgPT0gY3B1LlBDICYmIGNwdS5oYXNTUFNSKCkpIHsKCQkJY3B1LnVucGFja0NQU1IoY3B1LnNwc3IpOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJCWNwdS5jcHNyWiA9ICEoZCAmIDB4RkZGRkZGRkYpOwoJCQljcHUuY3BzckMgPSAoY3B1LnNoaWZ0ZXJPcGVyYW5kID4+PiAwKSA+PSAoZCA+Pj4gMCk7CgkJCWNwdS5jcHNyViA9IChjcHUuc2hpZnRlck9wZXJhbmQgPj4gMzEpICE9IChuID4+IDMxKSAmJgoJCQkJCQkoY3B1LnNoaWZ0ZXJPcGVyYW5kID4+IDMxKSAhPSAoZCA+PiAzMSk7CgkJfQoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RTQkMgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIHNoaWZ0ZXJPcGVyYW5kID0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+Pj4gMCkgKyAhY3B1LmNwc3JDOwoJCWdwcnNbcmRdID0gKGdwcnNbcm5dID4+PiAwKSAtIHNoaWZ0ZXJPcGVyYW5kOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFNCQ1MgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIHNoaWZ0ZXJPcGVyYW5kID0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+Pj4gMCkgKyAhY3B1LmNwc3JDOwoJCXZhciBkID0gKGdwcnNbcm5dID4+PiAwKSAtIHNoaWZ0ZXJPcGVyYW5kOwoJCWlmIChyZCA9PSBjcHUuUEMgJiYgY3B1Lmhhc1NQU1IoKSkgewoJCQljcHUudW5wYWNrQ1BTUihjcHUuc3Bzcik7CgkJfSBlbHNlIHsKCQkJY3B1LmNwc3JOID0gZCA+PiAzMTsKCQkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IChncHJzW3JuXSA+Pj4gMCkgPj0gKGQgPj4+IDApOwoJCQljcHUuY3BzclYgPSAoZ3Byc1tybl0gPj4gMzEpICE9IChzaGlmdGVyT3BlcmFuZCA+PiAzMSkgJiYKCQkJCQkJKGdwcnNbcm5dID4+IDMxKSAhPSAoZCA+PiAzMSk7CgkJfQoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RTTUxBTCA9IGZ1bmN0aW9uKHJkLCBybiwgcnMsIHJtLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBTSElGVF8zMiA9IDEvMHgxMDAwMDAwMDA7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCWNwdS5jeWNsZXMgKz0gMjsKCQljcHUubW11LndhaXRNdWwocnMpOwoJCXZhciBoaSA9IChncHJzW3JtXSAmIDB4RkZGRjAwMDApICogZ3Byc1tyc107CgkJdmFyIGxvID0gKGdwcnNbcm1dICYgMHgwMDAwRkZGRikgKiBncHJzW3JzXTsKCQl2YXIgY2FycnkgPSAoZ3Byc1tybl0gPj4+IDApICsgaGkgKyBsbzsKCQlncHJzW3JuXSA9IGNhcnJ5OwoJCWdwcnNbcmRdICs9IE1hdGguZmxvb3IoY2FycnkgKiBTSElGVF8zMik7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U01MQUxTID0gZnVuY3Rpb24ocmQsIHJuLCBycywgcm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIFNISUZUXzMyID0gMS8weDEwMDAwMDAwMDsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJY3B1LmN5Y2xlcyArPSAyOwoJCWNwdS5tbXUud2FpdE11bChycyk7CgkJdmFyIGhpID0gKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgKiBncHJzW3JzXTsKCQl2YXIgbG8gPSAoZ3Byc1tybV0gJiAweDAwMDBGRkZGKSAqIGdwcnNbcnNdOwoJCXZhciBjYXJyeSA9IChncHJzW3JuXSA+Pj4gMCkgKyBoaSArIGxvOwoJCWdwcnNbcm5dID0gY2Fycnk7CgkJZ3Byc1tyZF0gKz0gTWF0aC5mbG9vcihjYXJyeSAqIFNISUZUXzMyKTsKCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKChncHJzW3JkXSAmIDB4RkZGRkZGRkYpIHx8IChncHJzW3JuXSAmIDB4RkZGRkZGRkYpKTsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RTTVVMTCA9IGZ1bmN0aW9uKHJkLCBybiwgcnMsIHJtLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBTSElGVF8zMiA9IDEvMHgxMDAwMDAwMDA7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCSsrY3B1LmN5Y2xlczsKCQljcHUubW11LndhaXRNdWwoZ3Byc1tyc10pOwoJCXZhciBoaSA9ICgoZ3Byc1tybV0gJiAweEZGRkYwMDAwKSA+PiAwKSAqIChncHJzW3JzXSA+PiAwKTsKCQl2YXIgbG8gPSAoKGdwcnNbcm1dICYgMHgwMDAwRkZGRikgPj4gMCkgKiAoZ3Byc1tyc10gPj4gMCk7CgkJZ3Byc1tybl0gPSAoKGhpICYgMHhGRkZGRkZGRikgKyAobG8gJiAweEZGRkZGRkZGKSkgJiAweEZGRkZGRkZGOwoJCWdwcnNbcmRdID0gTWF0aC5mbG9vcihoaSAqIFNISUZUXzMyICsgbG8gKiBTSElGVF8zMik7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U01VTExTID0gZnVuY3Rpb24ocmQsIHJuLCBycywgcm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIFNISUZUXzMyID0gMS8weDEwMDAwMDAwMDsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJKytjcHUuY3ljbGVzOwoJCWNwdS5tbXUud2FpdE11bChncHJzW3JzXSk7CgkJdmFyIGhpID0gKChncHJzW3JtXSAmIDB4RkZGRjAwMDApID4+IDApICogKGdwcnNbcnNdID4+IDApOwoJCXZhciBsbyA9ICgoZ3Byc1tybV0gJiAweDAwMDBGRkZGKSA+PiAwKSAqIChncHJzW3JzXSA+PiAwKTsKCQlncHJzW3JuXSA9ICgoaGkgJiAweEZGRkZGRkZGKSArIChsbyAmIDB4RkZGRkZGRkYpKSAmIDB4RkZGRkZGRkY7CgkJZ3Byc1tyZF0gPSBNYXRoLmZsb29yKGhpICogU0hJRlRfMzIgKyBsbyAqIFNISUZUXzMyKTsKCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKChncHJzW3JkXSAmIDB4RkZGRkZGRkYpIHx8IChncHJzW3JuXSAmIDB4RkZGRkZGRkYpKTsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RTVE0gPSBmdW5jdGlvbihycywgYWRkcmVzcywgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJdmFyIG1tdSA9IGNwdS5tbXU7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJbW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJCXJldHVybjsKCQl9CgkJbW11LndhaXQzMihncHJzW2NwdS5QQ10pOwoJCXZhciBhZGRyID0gYWRkcmVzcyh0cnVlKTsKCQl2YXIgdG90YWwgPSAwOwoJCXZhciBtLCBpOwoJCWZvciAobSA9IHJzLCBpID0gMDsgbTsgbSA+Pj0gMSwgKytpKSB7CgkJCWlmIChtICYgMSkgewoJCQkJbW11LnN0b3JlMzIoYWRkciwgZ3Byc1tpXSk7CgkJCQlhZGRyICs9IDQ7CgkJCQkrK3RvdGFsOwoJCQl9CgkJfQoJCW1tdS53YWl0TXVsdGkzMihhZGRyLCB0b3RhbCk7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U1RNUyA9IGZ1bmN0aW9uKHJzLCBhZGRyZXNzLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7Cgl2YXIgbW11ID0gY3B1Lm1tdTsKCXJldHVybiBmdW5jdGlvbigpIHsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQltbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQkJcmV0dXJuOwoJCX0KCQltbXUud2FpdDMyKGdwcnNbY3B1LlBDXSk7CgkJdmFyIG1vZGUgPSBjcHUubW9kZTsKCQl2YXIgYWRkciA9IGFkZHJlc3ModHJ1ZSk7CgkJdmFyIHRvdGFsID0gMDsKCQl2YXIgbSwgaTsKCQljcHUuc3dpdGNoTW9kZShjcHUuTU9ERV9TWVNURU0pOwoJCWZvciAobSA9IHJzLCBpID0gMDsgbTsgbSA+Pj0gMSwgKytpKSB7CgkJCWlmIChtICYgMSkgewoJCQkJbW11LnN0b3JlMzIoYWRkciwgZ3Byc1tpXSk7CgkJCQlhZGRyICs9IDQ7CgkJCQkrK3RvdGFsOwoJCQl9CgkJfQoJCWNwdS5zd2l0Y2hNb2RlKG1vZGUpOwoJCW1tdS53YWl0TXVsdGkzMihhZGRyLCB0b3RhbCk7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U1RSID0gZnVuY3Rpb24ocmQsIGFkZHJlc3MsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJCXJldHVybjsKCQl9CgkJdmFyIGFkZHIgPSBhZGRyZXNzKCk7CgkJY3B1Lm1tdS5zdG9yZTMyKGFkZHIsIGdwcnNbcmRdKTsKCQljcHUubW11LndhaXQzMihhZGRyKTsKCQljcHUubW11LndhaXQzMihncHJzW2NwdS5QQ10pOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFNUUkIgPSBmdW5jdGlvbihyZCwgYWRkcmVzcywgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQkJcmV0dXJuOwoJCX0KCQl2YXIgYWRkciA9IGFkZHJlc3MoKTsKCQljcHUubW11LnN0b3JlOChhZGRyLCBncHJzW3JkXSk7CgkJY3B1Lm1tdS53YWl0KGFkZHIpOwoJCWNwdS5tbXUud2FpdDMyKGdwcnNbY3B1LlBDXSk7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U1RSSCA9IGZ1bmN0aW9uKHJkLCBhZGRyZXNzLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCQlyZXR1cm47CgkJfQoJCXZhciBhZGRyID0gYWRkcmVzcygpOwoJCWNwdS5tbXUuc3RvcmUxNihhZGRyLCBncHJzW3JkXSk7CgkJY3B1Lm1tdS53YWl0KGFkZHIpOwoJCWNwdS5tbXUud2FpdDMyKGdwcnNbY3B1LlBDXSk7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U1VCID0gZnVuY3Rpb24ocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJc2hpZnRPcCgpOwoJCWdwcnNbcmRdID0gZ3Byc1tybl0gLSBjcHUuc2hpZnRlck9wZXJhbmQ7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U1VCUyA9IGZ1bmN0aW9uKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQlyZXR1cm47CgkJfQoJCXNoaWZ0T3AoKTsKCQl2YXIgZCA9IGdwcnNbcm5dIC0gY3B1LnNoaWZ0ZXJPcGVyYW5kOwoJCWlmIChyZCA9PSBjcHUuUEMgJiYgY3B1Lmhhc1NQU1IoKSkgewoJCQljcHUudW5wYWNrQ1BTUihjcHUuc3Bzcik7CgkJfSBlbHNlIHsKCQkJY3B1LmNwc3JOID0gZCA+PiAzMTsKCQkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJCWNwdS5jcHNyQyA9IChncHJzW3JuXSA+Pj4gMCkgPj0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+Pj4gMCk7CgkJCWNwdS5jcHNyViA9IChncHJzW3JuXSA+PiAzMSkgIT0gKGNwdS5zaGlmdGVyT3BlcmFuZCA+PiAzMSkgJiYKCQkJCQkJKGdwcnNbcm5dID4+IDMxKSAhPSAoZCA+PiAzMSk7CgkJfQoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RTV0kgPSBmdW5jdGlvbihpbW1lZGlhdGUsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQlpZiAoY29uZE9wICYmICFjb25kT3AoKSkgewoJCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJCXJldHVybjsKCQl9CgkJY3B1LmlycS5zd2kzMihpbW1lZGlhdGUpOwoJCWNwdS5tbXUud2FpdFByZWZldGNoMzIoZ3Byc1tjcHUuUENdKTsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RTV1AgPSBmdW5jdGlvbihyZCwgcm4sIHJtLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJY3B1Lm1tdS53YWl0MzIoZ3Byc1tybl0pOwoJCWNwdS5tbXUud2FpdDMyKGdwcnNbcm5dKTsKCQl2YXIgZCA9IGNwdS5tbXUubG9hZDMyKGdwcnNbcm5dKTsKCQljcHUubW11LnN0b3JlMzIoZ3Byc1tybl0sIGdwcnNbcm1dKTsKCQlncHJzW3JkXSA9IGQ7CgkJKytjcHUuY3ljbGVzOwoJfQp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0U1dQQiA9IGZ1bmN0aW9uKHJkLCBybiwgcm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQljcHUubW11LndhaXQoZ3Byc1tybl0pOwoJCWNwdS5tbXUud2FpdChncHJzW3JuXSk7CgkJdmFyIGQgPSBjcHUubW11LmxvYWQ4KGdwcnNbcm5dKTsKCQljcHUubW11LnN0b3JlOChncHJzW3JuXSwgZ3Byc1tybV0pOwoJCWdwcnNbcmRdID0gZDsKCQkrK2NwdS5jeWNsZXM7Cgl9Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RURVEgPSBmdW5jdGlvbihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQlzaGlmdE9wKCk7CgkJdmFyIGFsdU91dCA9IGdwcnNbcm5dIF4gY3B1LnNoaWZ0ZXJPcGVyYW5kOwoJCWNwdS5jcHNyTiA9IGFsdU91dCA+PiAzMTsKCQljcHUuY3BzclogPSAhKGFsdU91dCAmIDB4RkZGRkZGRkYpOwoJCWNwdS5jcHNyQyA9IGNwdS5zaGlmdGVyQ2FycnlPdXQ7Cgl9Owp9OwoKQVJNQ29yZUFybS5wcm90b3R5cGUuY29uc3RydWN0VFNUID0gZnVuY3Rpb24ocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJc2hpZnRPcCgpOwoJCXZhciBhbHVPdXQgPSBncHJzW3JuXSAmIGNwdS5zaGlmdGVyT3BlcmFuZDsKCQljcHUuY3Bzck4gPSBhbHVPdXQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShhbHVPdXQgJiAweEZGRkZGRkZGKTsKCQljcHUuY3BzckMgPSBjcHUuc2hpZnRlckNhcnJ5T3V0OwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFVNTEFMID0gZnVuY3Rpb24ocmQsIHJuLCBycywgcm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIFNISUZUXzMyID0gMS8weDEwMDAwMDAwMDsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJY3B1LmN5Y2xlcyArPSAyOwoJCWNwdS5tbXUud2FpdE11bChycyk7CgkJdmFyIGhpID0gKChncHJzW3JtXSAmIDB4RkZGRjAwMDApID4+PiAwKSAqIChncHJzW3JzXSA+Pj4gMCk7CgkJdmFyIGxvID0gKGdwcnNbcm1dICYgMHgwMDAwRkZGRikgKiAoZ3Byc1tyc10gPj4+IDApOwoJCXZhciBjYXJyeSA9IChncHJzW3JuXSA+Pj4gMCkgKyBoaSArIGxvOwoJCWdwcnNbcm5dID0gY2Fycnk7CgkJZ3Byc1tyZF0gKz0gY2FycnkgKiBTSElGVF8zMjsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RVTUxBTFMgPSBmdW5jdGlvbihyZCwgcm4sIHJzLCBybSwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgU0hJRlRfMzIgPSAxLzB4MTAwMDAwMDAwOwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQljcHUuY3ljbGVzICs9IDI7CgkJY3B1Lm1tdS53YWl0TXVsKHJzKTsKCQl2YXIgaGkgPSAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgPj4+IDApICogKGdwcnNbcnNdID4+PiAwKTsKCQl2YXIgbG8gPSAoZ3Byc1tybV0gJiAweDAwMDBGRkZGKSAqIChncHJzW3JzXSA+Pj4gMCk7CgkJdmFyIGNhcnJ5ID0gKGdwcnNbcm5dID4+PiAwKSArIGhpICsgbG87CgkJZ3Byc1tybl0gPSBjYXJyeTsKCQlncHJzW3JkXSArPSBjYXJyeSAqIFNISUZUXzMyOwoJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoKGdwcnNbcmRdICYgMHhGRkZGRkZGRikgfHwgKGdwcnNbcm5dICYgMHhGRkZGRkZGRikpOwoJfTsKfTsKCkFSTUNvcmVBcm0ucHJvdG90eXBlLmNvbnN0cnVjdFVNVUxMID0gZnVuY3Rpb24ocmQsIHJuLCBycywgcm0sIGNvbmRPcCkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIFNISUZUXzMyID0gMS8weDEwMDAwMDAwMDsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2gzMihncHJzW2NwdS5QQ10pOwoJCWlmIChjb25kT3AgJiYgIWNvbmRPcCgpKSB7CgkJCXJldHVybjsKCQl9CgkJKytjcHUuY3ljbGVzOwoJCWNwdS5tbXUud2FpdE11bChncHJzW3JzXSk7CgkJdmFyIGhpID0gKChncHJzW3JtXSAmIDB4RkZGRjAwMDApID4+PiAwKSAqIChncHJzW3JzXSA+Pj4gMCk7CgkJdmFyIGxvID0gKChncHJzW3JtXSAmIDB4MDAwMEZGRkYpID4+PiAwKSAqIChncHJzW3JzXSA+Pj4gMCk7CgkJZ3Byc1tybl0gPSAoKGhpICYgMHhGRkZGRkZGRikgKyAobG8gJiAweEZGRkZGRkZGKSkgJiAweEZGRkZGRkZGOwoJCWdwcnNbcmRdID0gKGhpICogU0hJRlRfMzIgKyBsbyAqIFNISUZUXzMyKSA+Pj4gMDsKCX07Cn07CgpBUk1Db3JlQXJtLnByb3RvdHlwZS5jb25zdHJ1Y3RVTVVMTFMgPSBmdW5jdGlvbihyZCwgcm4sIHJzLCBybSwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgU0hJRlRfMzIgPSAxLzB4MTAwMDAwMDAwOwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaDMyKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCAmJiAhY29uZE9wKCkpIHsKCQkJcmV0dXJuOwoJCX0KCQkrK2NwdS5jeWNsZXM7CgkJY3B1Lm1tdS53YWl0TXVsKGdwcnNbcnNdKTsKCQl2YXIgaGkgPSAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgPj4+IDApICogKGdwcnNbcnNdID4+PiAwKTsKCQl2YXIgbG8gPSAoKGdwcnNbcm1dICYgMHgwMDAwRkZGRikgPj4+IDApICogKGdwcnNbcnNdID4+PiAwKTsKCQlncHJzW3JuXSA9ICgoaGkgJiAweEZGRkZGRkZGKSArIChsbyAmIDB4RkZGRkZGRkYpKSAmIDB4RkZGRkZGRkY7CgkJZ3Byc1tyZF0gPSAoaGkgKiBTSElGVF8zMiArIGxvICogU0hJRlRfMzIpID4+PiAwOwoJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoKGdwcnNbcmRdICYgMHhGRkZGRkZGRikgfHwgKGdwcnNbcm5dICYgMHhGRkZGRkZGRikpOwoJfTsKfTsK";

const GBA_js_audio_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VBdWRpbygpIHsKCXdpbmRvdy5BdWRpb0NvbnRleHQgPSB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7CglpZiAod2luZG93LkF1ZGlvQ29udGV4dCkgewoJCXZhciBzZWxmID0gdGhpczsKCQl0aGlzLmNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7CgkJdGhpcy5idWZmZXJTaXplID0gMDsKCQl0aGlzLmJ1ZmZlclNpemUgPSA0MDk2OwoJCXRoaXMubWF4U2FtcGxlcyA9IHRoaXMuYnVmZmVyU2l6ZSA8PCAyOwoJCXRoaXMuYnVmZmVycyA9IFtuZXcgRmxvYXQzMkFycmF5KHRoaXMubWF4U2FtcGxlcyksIG5ldyBGbG9hdDMyQXJyYXkodGhpcy5tYXhTYW1wbGVzKV07CgkJdGhpcy5zYW1wbGVNYXNrID0gdGhpcy5tYXhTYW1wbGVzIC0gMTsKCQlpZiAodGhpcy5jb250ZXh0LmNyZWF0ZVNjcmlwdFByb2Nlc3NvcikgewoJCQl0aGlzLmpzQXVkaW8gPSB0aGlzLmNvbnRleHQuY3JlYXRlU2NyaXB0UHJvY2Vzc29yKHRoaXMuYnVmZmVyU2l6ZSk7CgkJfSBlbHNlIHsKCQkJdGhpcy5qc0F1ZGlvID0gdGhpcy5jb250ZXh0LmNyZWF0ZUphdmFTY3JpcHROb2RlKHRoaXMuYnVmZmVyU2l6ZSk7CgkJfQoJCXRoaXMuanNBdWRpby5vbmF1ZGlvcHJvY2VzcyA9IGZ1bmN0aW9uKGUpIHsgc2VsZi5hdWRpb1Byb2Nlc3MoZSkgfTsKCX0gZWxzZSB7CgkJdGhpcy5jb250ZXh0ID0gbnVsbDsKCX0KCgl0aGlzLm1hc3RlckVuYWJsZSA9IGZhbHNlOwoJdGhpcy5tYXN0ZXJWb2x1bWUgPSAwLjAwOwoKCXRoaXMuU09VTkRfTUFYID0gMHg0MDA7Cgl0aGlzLkZJRk9fTUFYID0gMHgyMDA7Cgl0aGlzLlBTR19NQVggPSAweDA4MDsKfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7Cgl0aGlzLmZpZm9BID0gW107Cgl0aGlzLmZpZm9CID0gW107Cgl0aGlzLmZpZm9BU2FtcGxlID0gMDsKCXRoaXMuZmlmb0JTYW1wbGUgPSAwOwoKCXRoaXMuZW5hYmxlZCA9IGZhbHNlOwoJaWYgKHRoaXMuY29udGV4dCkgewoJCXRyeSB7CgkJCXRoaXMuanNBdWRpby5kaXNjb25uZWN0KHRoaXMuY29udGV4dC5kZXN0aW5hdGlvbik7CgkJfSBjYXRjaCAoZSkgewoJCX0KCX0KCgl0aGlzLmVuYWJsZUNoYW5uZWwzID0gZmFsc2U7Cgl0aGlzLmVuYWJsZUNoYW5uZWw0ID0gZmFsc2U7Cgl0aGlzLmVuYWJsZUNoYW5uZWxBID0gZmFsc2U7Cgl0aGlzLmVuYWJsZUNoYW5uZWxCID0gZmFsc2U7Cgl0aGlzLmVuYWJsZVJpZ2h0Q2hhbm5lbEEgPSBmYWxzZTsKCXRoaXMuZW5hYmxlTGVmdENoYW5uZWxBID0gZmFsc2U7Cgl0aGlzLmVuYWJsZVJpZ2h0Q2hhbm5lbEIgPSBmYWxzZTsKCXRoaXMuZW5hYmxlTGVmdENoYW5uZWxCID0gZmFsc2U7CgoJdGhpcy5wbGF5aW5nQ2hhbm5lbDMgPSBmYWxzZTsKCXRoaXMucGxheWluZ0NoYW5uZWw0ID0gZmFsc2U7CgoJdGhpcy52b2x1bWVMZWZ0ID0gMDsKCXRoaXMudm9sdW1lUmlnaHQgPSAwOwoJdGhpcy5yYXRpb0NoYW5uZWxBID0gMTsKCXRoaXMucmF0aW9DaGFubmVsQiA9IDE7Cgl0aGlzLmVuYWJsZWRMZWZ0ID0gMDsKCXRoaXMuZW5hYmxlZFJpZ2h0ID0gMDsKCgl0aGlzLmRtYUEgPSAtMTsKCXRoaXMuZG1hQiA9IC0xOwoJdGhpcy5zb3VuZFRpbWVyQSA9IDA7Cgl0aGlzLnNvdW5kVGltZXJCID0gMDsKCgl0aGlzLnNvdW5kUmF0aW8gPSAxOwoJdGhpcy5zb3VuZEJpYXMgPSAweDIwMDsKCgl0aGlzLnNxdWFyZUNoYW5uZWxzID0gbmV3IEFycmF5KCk7Cglmb3IgKHZhciBpID0gMDsgaSA8IDI7ICsraSkgewoJCXRoaXMuc3F1YXJlQ2hhbm5lbHNbaV0gPSB7CgkJCWVuYWJsZWQ6IGZhbHNlLAoJCQlwbGF5aW5nOiBmYWxzZSwKCQkJc2FtcGxlOiAwLAoJCQlkdXR5OiAwLjUsCgkJCWluY3JlbWVudDogMCwKCQkJc3RlcDogMCwKCQkJaW5pdGlhbFZvbHVtZTogMCwKCQkJdm9sdW1lOiAwLAoJCQlmcmVxdWVuY3k6IDAsCgkJCWludGVydmFsOiAwLAoJCQlzd2VlcFN0ZXBzOiAwLAoJCQlzd2VlcEluY3JlbWVudDogMCwKCQkJc3dlZXBJbnRlcnZhbDogMCwKCQkJZG9Td2VlcDogZmFsc2UsCgkJCXJhaXNlOiAwLAoJCQlsb3dlcjogMCwKCQkJbmV4dFN0ZXA6IDAsCgkJCXRpbWVkOiBmYWxzZSwKCQkJbGVuZ3RoOiAwLAoJCQllbmQ6IDAKCQl9Cgl9CgoJdGhpcy53YXZlRGF0YSA9IG5ldyBVaW50OEFycmF5KDMyKTsKCXRoaXMuY2hhbm5lbDNEaW1lbnNpb24gPSAwOwoJdGhpcy5jaGFubmVsM0JhbmsgPSAwOwoJdGhpcy5jaGFubmVsM1ZvbHVtZSA9IDA7Cgl0aGlzLmNoYW5uZWwzSW50ZXJ2YWwgPSAwOwoJdGhpcy5jaGFubmVsM05leHQgPSAwOwoJdGhpcy5jaGFubmVsM0xlbmd0aCA9IDA7Cgl0aGlzLmNoYW5uZWwzVGltZWQgPSBmYWxzZTsKCXRoaXMuY2hhbm5lbDNFbmQgPSAwOwoJdGhpcy5jaGFubmVsM1BvaW50ZXIgPTA7Cgl0aGlzLmNoYW5uZWwzU2FtcGxlID0gMDsKCgl0aGlzLmNwdUZyZXF1ZW5jeSA9IHRoaXMuY29yZS5pcnEuRlJFUVVFTkNZOwoKCXRoaXMuY2hhbm5lbDQgPSB7CgkJc2FtcGxlOiAwLAoJCWxmc3I6IDAsCgkJd2lkdGg6IDE1LAoJCWludGVydmFsOiB0aGlzLmNwdUZyZXF1ZW5jeSAvIDUyNDI4OCwKCQlpbmNyZW1lbnQ6IDAsCgkJc3RlcDogMCwKCQlpbml0aWFsVm9sdW1lOiAwLAoJCXZvbHVtZTogMCwKCQluZXh0U3RlcDogMCwKCQl0aW1lZDogZmFsc2UsCgkJbGVuZ3RoOiAwLAoJCWVuZDogMAoJfTsKCgl0aGlzLm5leHRFdmVudCA9IDA7CgoJdGhpcy5uZXh0U2FtcGxlID0gMDsKCXRoaXMub3V0cHV0UG9pbnRlciA9IDA7Cgl0aGlzLnNhbXBsZVBvaW50ZXIgPSAwOwoKCXRoaXMuYmFja3VwID0gMDsKCXRoaXMudG90YWxTYW1wbGVzID0gMDsKCgl0aGlzLnNhbXBsZVJhdGUgPSAzMjc2ODsKCXRoaXMuc2FtcGxlSW50ZXJ2YWwgPSB0aGlzLmNwdUZyZXF1ZW5jeSAvIHRoaXMuc2FtcGxlUmF0ZTsKCXRoaXMucmVzYW1wbGVSYXRpbyA9IDE7CglpZiAodGhpcy5jb250ZXh0KSB7CgkJdGhpcy5yZXNhbXBsZVJhdGlvID0gdGhpcy5zYW1wbGVSYXRlIC8gdGhpcy5jb250ZXh0LnNhbXBsZVJhdGU7Cgl9CgoJdGhpcy53cml0ZVNxdWFyZUNoYW5uZWxGQygwLCAwKTsKCXRoaXMud3JpdGVTcXVhcmVDaGFubmVsRkMoMSwgMCk7Cgl0aGlzLndyaXRlQ2hhbm5lbDRGQygwKTsKfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLmZyZWV6ZSA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuIHsKCQluZXh0U2FtcGxlOiB0aGlzLm5leHRTYW1wbGUKCX07Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS5kZWZyb3N0ID0gZnVuY3Rpb24oZnJvc3QpIHsKCXRoaXMubmV4dFNhbXBsZSA9IGZyb3N0Lm5leHRTYW1wbGU7Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uKHBhdXNlZCkgewoJaWYgKHRoaXMuY29udGV4dCkgewoJCWlmIChwYXVzZWQpIHsKCQkJdHJ5IHsKCQkJCXRoaXMuanNBdWRpby5kaXNjb25uZWN0KHRoaXMuY29udGV4dC5kZXN0aW5hdGlvbik7CgkJCX0gY2F0Y2ggKGUpIHsKCQkJCS8vIFNpZ2gKCQkJfQoJCX0gZWxzZSBpZiAodGhpcy5lbmFibGVkKSB7CgkJCXRoaXMuanNBdWRpby5jb25uZWN0KHRoaXMuY29udGV4dC5kZXN0aW5hdGlvbik7CgkJfQoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUudXBkYXRlVGltZXJzID0gZnVuY3Rpb24oKSB7Cgl2YXIgY3ljbGVzID0gdGhpcy5jcHUuY3ljbGVzOwoJaWYgKCF0aGlzLmVuYWJsZWQgfHwgKGN5Y2xlcyA8IHRoaXMubmV4dEV2ZW50ICYmIGN5Y2xlcyA8IHRoaXMubmV4dFNhbXBsZSkpIHsKCQlyZXR1cm47Cgl9CgoJaWYgKGN5Y2xlcyA+PSB0aGlzLm5leHRFdmVudCkgewoJCXZhciBjaGFubmVsID0gdGhpcy5zcXVhcmVDaGFubmVsc1swXTsKCQl0aGlzLm5leHRFdmVudCA9IEluZmluaXR5OwoJCWlmIChjaGFubmVsLnBsYXlpbmcpIHsKCQkJdGhpcy51cGRhdGVTcXVhcmVDaGFubmVsKGNoYW5uZWwsIGN5Y2xlcyk7CgkJfQoKCQljaGFubmVsID0gdGhpcy5zcXVhcmVDaGFubmVsc1sxXTsKCQlpZiAoY2hhbm5lbC5wbGF5aW5nKSB7CgkJCXRoaXMudXBkYXRlU3F1YXJlQ2hhbm5lbChjaGFubmVsLCBjeWNsZXMpOwoJCX0KCgkJaWYgKHRoaXMuZW5hYmxlQ2hhbm5lbDMgJiYgdGhpcy5wbGF5aW5nQ2hhbm5lbDMpIHsKCQkJaWYgKGN5Y2xlcyA+PSB0aGlzLmNoYW5uZWwzTmV4dCkgewoJCQkJaWYgKHRoaXMuY2hhbm5lbDNXcml0ZSkgewoJCQkJCXZhciBzYW1wbGUgPSB0aGlzLndhdmVEYXRhW3RoaXMuY2hhbm5lbDNQb2ludGVyID4+IDFdOwoJCQkJCXRoaXMuY2hhbm5lbDNTYW1wbGUgPSAoKChzYW1wbGUgPj4gKCh0aGlzLmNoYW5uZWwzUG9pbnRlciAmIDEpIDw8IDIpKSAmIDB4RikgLSAweDgpIC8gODsKCQkJCQl0aGlzLmNoYW5uZWwzUG9pbnRlciA9ICh0aGlzLmNoYW5uZWwzUG9pbnRlciArIDEpOwoJCQkJCWlmICh0aGlzLmNoYW5uZWwzRGltZW5zaW9uICYmIHRoaXMuY2hhbm5lbDNQb2ludGVyID49IDY0KSB7CgkJCQkJCXRoaXMuY2hhbm5lbDNQb2ludGVyIC09IDY0OwoJCQkJCX0gZWxzZSBpZiAoIXRoaXMuY2hhbm5lbDNCYW5rICYmIHRoaXMuY2hhbm5lbDNQb2ludGVyID49IDMyKSB7CgkJCQkJCXRoaXMuY2hhbm5lbDNQb2ludGVyIC09IDMyOwoJCQkJCX0gZWxzZSBpZiAodGhpcy5jaGFubmVsM1BvaW50ZXIgPj0gNjQpIHsKCQkJCQkJdGhpcy5jaGFubmVsM1BvaW50ZXIgLT0gMzI7CgkJCQkJfQoJCQkJfQoJCQkJdGhpcy5jaGFubmVsM05leHQgKz0gdGhpcy5jaGFubmVsM0ludGVydmFsOwoJCQkJaWYgKHRoaXMuY2hhbm5lbDNJbnRlcnZhbCAmJiB0aGlzLm5leHRFdmVudCA+IHRoaXMuY2hhbm5lbDNOZXh0KSB7CgkJCQkJdGhpcy5uZXh0RXZlbnQgPSB0aGlzLmNoYW5uZWwzTmV4dDsKCQkJCX0KCQkJfQoJCQlpZiAodGhpcy5jaGFubmVsM1RpbWVkICYmIGN5Y2xlcyA+PSB0aGlzLmNoYW5uZWwzRW5kKSB7CgkJCQl0aGlzLnBsYXlpbmdDaGFubmVsMyA9IGZhbHNlOwoJCQl9CgkJfQoKCQlpZiAodGhpcy5lbmFibGVDaGFubmVsNCAmJiB0aGlzLnBsYXlpbmdDaGFubmVsNCkgewoJCQlpZiAodGhpcy5jaGFubmVsNC50aW1lZCAmJiBjeWNsZXMgPj0gdGhpcy5jaGFubmVsNC5lbmQpIHsKCQkJCXRoaXMucGxheWluZ0NoYW5uZWw0ID0gZmFsc2U7CgkJCX0gZWxzZSB7CgkJCQlpZiAoY3ljbGVzID49IHRoaXMuY2hhbm5lbDQubmV4dCkgewoJCQkJCXRoaXMuY2hhbm5lbDQubGZzciA+Pj0gMTsKCQkJCQl2YXIgc2FtcGxlID0gdGhpcy5jaGFubmVsNC5sZnNyICYgMTsKCQkJCQl0aGlzLmNoYW5uZWw0Lmxmc3IgfD0gKCgodGhpcy5jaGFubmVsNC5sZnNyID4+IDEpICYgMSkgXiBzYW1wbGUpIDw8ICh0aGlzLmNoYW5uZWw0LndpZHRoIC0gMSk7CgkJCQkJdGhpcy5jaGFubmVsNC5uZXh0ICs9IHRoaXMuY2hhbm5lbDQuaW50ZXJ2YWw7CgkJCQkJdGhpcy5jaGFubmVsNC5zYW1wbGUgPSAoc2FtcGxlIC0gMC41KSAqIDIgKiB0aGlzLmNoYW5uZWw0LnZvbHVtZTsKCQkJCX0KCQkJCXRoaXMudXBkYXRlRW52ZWxvcGUodGhpcy5jaGFubmVsNCwgY3ljbGVzKTsKCQkJCWlmICh0aGlzLm5leHRFdmVudCA+IHRoaXMuY2hhbm5lbDQubmV4dCkgewoJCQkJCXRoaXMubmV4dEV2ZW50ID0gdGhpcy5jaGFubmVsNC5uZXh0OwoJCQkJfQoJCQkJaWYgKHRoaXMuY2hhbm5lbDQudGltZWQgJiYgdGhpcy5uZXh0RXZlbnQgPiB0aGlzLmNoYW5uZWw0LmVuZCkgewoJCQkJCXRoaXMubmV4dEV2ZW50ID0gdGhpcy5jaGFubmVsNC5lbmQ7CgkJCQl9CgkJCX0KCQl9Cgl9CgoJaWYgKGN5Y2xlcyA+PSB0aGlzLm5leHRTYW1wbGUpIHsKCQl0aGlzLnNhbXBsZSgpOwoJCXRoaXMubmV4dFNhbXBsZSArPSB0aGlzLnNhbXBsZUludGVydmFsOwoJfQoKCXRoaXMubmV4dEV2ZW50ID0gTWF0aC5jZWlsKHRoaXMubmV4dEV2ZW50KTsKCWlmICgodGhpcy5uZXh0RXZlbnQgPCBjeWNsZXMpIHx8ICh0aGlzLm5leHRTYW1wbGUgPCBjeWNsZXMpKSB7CgkJLy8gU1RNIGluc3RydWN0aW9ucyBtYXkgdGFrZSBhIGxvbmcgdGltZQoJCXRoaXMudXBkYXRlVGltZXJzKCk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS53cml0ZUVuYWJsZSA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmVuYWJsZWQgPSAhIXZhbHVlOwoJdGhpcy5uZXh0RXZlbnQgPSB0aGlzLmNwdS5jeWNsZXM7Cgl0aGlzLm5leHRTYW1wbGUgPSB0aGlzLm5leHRFdmVudDsKCXRoaXMudXBkYXRlVGltZXJzKCk7Cgl0aGlzLmNvcmUuaXJxLnBvbGxOZXh0RXZlbnQoKTsKCWlmICh0aGlzLmNvbnRleHQpIHsKCQlpZiAodmFsdWUpIHsKCQkJdGhpcy5qc0F1ZGlvLmNvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKTsKCQl9IGVsc2UgewoJCQl0cnkgewoJCQkJdGhpcy5qc0F1ZGlvLmRpc2Nvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKTsKCQkJfSBjYXRjaCAoZSkgewoJCQl9CgkJfQoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUud3JpdGVTb3VuZENvbnRyb2xMbyA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLm1hc3RlclZvbHVtZUxlZnQgPSB2YWx1ZSAmIDB4NzsKCXRoaXMubWFzdGVyVm9sdW1lUmlnaHQgPSAodmFsdWUgPj4gNCkgJiAweDc7Cgl0aGlzLmVuYWJsZWRMZWZ0ID0gKHZhbHVlID4+IDgpICYgMHhGOwoJdGhpcy5lbmFibGVkUmlnaHQgPSAodmFsdWUgPj4gMTIpICYgMHhGOwoKCXRoaXMuc2V0U3F1YXJlQ2hhbm5lbEVuYWJsZWQodGhpcy5zcXVhcmVDaGFubmVsc1swXSwgKHRoaXMuZW5hYmxlZExlZnQgfCB0aGlzLmVuYWJsZWRSaWdodCkgJiAweDEpOwoJdGhpcy5zZXRTcXVhcmVDaGFubmVsRW5hYmxlZCh0aGlzLnNxdWFyZUNoYW5uZWxzWzFdLCAodGhpcy5lbmFibGVkTGVmdCB8IHRoaXMuZW5hYmxlZFJpZ2h0KSAmIDB4Mik7Cgl0aGlzLmVuYWJsZUNoYW5uZWwzID0gKHRoaXMuZW5hYmxlZExlZnQgfCB0aGlzLmVuYWJsZWRSaWdodCkgJiAweDQ7Cgl0aGlzLnNldENoYW5uZWw0RW5hYmxlZCgodGhpcy5lbmFibGVkTGVmdCB8IHRoaXMuZW5hYmxlZFJpZ2h0KSAmIDB4OCk7CgoJdGhpcy51cGRhdGVUaW1lcnMoKTsKCXRoaXMuY29yZS5pcnEucG9sbE5leHRFdmVudCgpOwp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUud3JpdGVTb3VuZENvbnRyb2xIaSA9IGZ1bmN0aW9uKHZhbHVlKSB7Cglzd2l0Y2ggKHZhbHVlICYgMHgwMDAzKSB7CgljYXNlIDA6CgkJdGhpcy5zb3VuZFJhdGlvID0gMC4yNTsKCQlicmVhazsKCWNhc2UgMToKCQl0aGlzLnNvdW5kUmF0aW8gPSAwLjUwOwoJCWJyZWFrOwoJY2FzZSAyOgoJCXRoaXMuc291bmRSYXRpbyA9IDE7CgkJYnJlYWs7Cgl9Cgl0aGlzLnJhdGlvQ2hhbm5lbEEgPSAoKCh2YWx1ZSAmIDB4MDAwNCkgPj4gMikgKyAxKSAqIDAuNTsKCXRoaXMucmF0aW9DaGFubmVsQiA9ICgoKHZhbHVlICYgMHgwMDA4KSA+PiAzKSArIDEpICogMC41OwoKCXRoaXMuZW5hYmxlUmlnaHRDaGFubmVsQSA9IHZhbHVlICYgMHgwMTAwOwoJdGhpcy5lbmFibGVMZWZ0Q2hhbm5lbEEgPSB2YWx1ZSAmIDB4MDIwMDsKCXRoaXMuZW5hYmxlQ2hhbm5lbEEgID0gdmFsdWUgJiAweDAzMDA7Cgl0aGlzLnNvdW5kVGltZXJBID0gdmFsdWUgJiAweDA0MDA7CglpZiAodmFsdWUgJiAweDA4MDApIHsKCQl0aGlzLmZpZm9BID0gW107Cgl9Cgl0aGlzLmVuYWJsZVJpZ2h0Q2hhbm5lbEIgPSB2YWx1ZSAmIDB4MTAwMDsKCXRoaXMuZW5hYmxlTGVmdENoYW5uZWxCID0gdmFsdWUgJiAweDIwMDA7Cgl0aGlzLmVuYWJsZUNoYW5uZWxCICA9IHZhbHVlICYgMHgzMDAwOwoJdGhpcy5zb3VuZFRpbWVyQiA9IHZhbHVlICYgMHg0MDAwOwoJaWYgKHZhbHVlICYgMHg4MDAwKSB7CgkJdGhpcy5maWZvQiA9IFtdOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUucmVzZXRTcXVhcmVDaGFubmVsID0gZnVuY3Rpb24oY2hhbm5lbCkgewoJaWYgKGNoYW5uZWwuc3RlcCkgewoJCWNoYW5uZWwubmV4dFN0ZXAgPSB0aGlzLmNwdS5jeWNsZXMgKyBjaGFubmVsLnN0ZXA7Cgl9CglpZiAoY2hhbm5lbC5lbmFibGVkICYmICFjaGFubmVsLnBsYXlpbmcpIHsKCQljaGFubmVsLnJhaXNlID0gdGhpcy5jcHUuY3ljbGVzOwoJCWNoYW5uZWwubG93ZXIgPSBjaGFubmVsLnJhaXNlICsgY2hhbm5lbC5kdXR5ICogY2hhbm5lbC5pbnRlcnZhbDsKCQljaGFubmVsLmVuZCA9IHRoaXMuY3B1LmN5Y2xlcyArIGNoYW5uZWwubGVuZ3RoOwoJCXRoaXMubmV4dEV2ZW50ID0gdGhpcy5jcHUuY3ljbGVzOwoJfQoJY2hhbm5lbC5wbGF5aW5nID0gY2hhbm5lbC5lbmFibGVkOwoJdGhpcy51cGRhdGVUaW1lcnMoKTsKCXRoaXMuY29yZS5pcnEucG9sbE5leHRFdmVudCgpOwp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUuc2V0U3F1YXJlQ2hhbm5lbEVuYWJsZWQgPSBmdW5jdGlvbihjaGFubmVsLCBlbmFibGUpIHsKCWlmICghKGNoYW5uZWwuZW5hYmxlZCAmJiBjaGFubmVsLnBsYXlpbmcpICYmIGVuYWJsZSkgewoJCWNoYW5uZWwuZW5hYmxlZCA9ICEhZW5hYmxlOwoJCXRoaXMudXBkYXRlVGltZXJzKCk7CgkJdGhpcy5jb3JlLmlycS5wb2xsTmV4dEV2ZW50KCk7Cgl9IGVsc2UgewoJCWNoYW5uZWwuZW5hYmxlZCA9ICEhZW5hYmxlOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUud3JpdGVTcXVhcmVDaGFubmVsU3dlZXAgPSBmdW5jdGlvbihjaGFubmVsSWQsIHZhbHVlKSB7Cgl2YXIgY2hhbm5lbCA9IHRoaXMuc3F1YXJlQ2hhbm5lbHNbY2hhbm5lbElkXTsKCWNoYW5uZWwuc3dlZXBTdGVwcyA9IHZhbHVlICYgMHgwNzsKCWNoYW5uZWwuc3dlZXBJbmNyZW1lbnQgPSAodmFsdWUgJiAweDA4KSA/IC0xIDogMTsKCWNoYW5uZWwuc3dlZXBJbnRlcnZhbCA9ICgodmFsdWUgPj4gNCkgJiAweDcpICogdGhpcy5jcHVGcmVxdWVuY3kgLyAxMjg7CgljaGFubmVsLmRvU3dlZXAgPSAhIWNoYW5uZWwuc3dlZXBJbnRlcnZhbDsKCWNoYW5uZWwubmV4dFN3ZWVwID0gdGhpcy5jcHUuY3ljbGVzICsgY2hhbm5lbC5zd2VlcEludGVydmFsOwoJdGhpcy5yZXNldFNxdWFyZUNoYW5uZWwoY2hhbm5lbCk7Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS53cml0ZVNxdWFyZUNoYW5uZWxETEUgPSBmdW5jdGlvbihjaGFubmVsSWQsIHZhbHVlKSB7Cgl2YXIgY2hhbm5lbCA9IHRoaXMuc3F1YXJlQ2hhbm5lbHNbY2hhbm5lbElkXTsKCXZhciBkdXR5ID0gKHZhbHVlID4+IDYpICYgMHgzOwoJc3dpdGNoIChkdXR5KSB7CgljYXNlIDA6CgkJY2hhbm5lbC5kdXR5ID0gMC4xMjU7CgkJYnJlYWs7CgljYXNlIDE6CgkJY2hhbm5lbC5kdXR5ID0gMC4yNTsKCQlicmVhazsKCWNhc2UgMjoKCQljaGFubmVsLmR1dHkgPSAwLjU7CgkJYnJlYWs7CgljYXNlIDM6CgkJY2hhbm5lbC5kdXR5ID0gMC43NTsKCQlicmVhazsKCX0KCXRoaXMud3JpdGVDaGFubmVsTEUoY2hhbm5lbCwgdmFsdWUpOwoJdGhpcy5yZXNldFNxdWFyZUNoYW5uZWwoY2hhbm5lbCk7Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS53cml0ZVNxdWFyZUNoYW5uZWxGQyA9IGZ1bmN0aW9uKGNoYW5uZWxJZCwgdmFsdWUpIHsKCXZhciBjaGFubmVsID0gdGhpcy5zcXVhcmVDaGFubmVsc1tjaGFubmVsSWRdOwoJdmFyIGZyZXF1ZW5jeSA9IHZhbHVlICYgMjA0NzsKCWNoYW5uZWwuZnJlcXVlbmN5ID0gZnJlcXVlbmN5OwoJY2hhbm5lbC5pbnRlcnZhbCA9IHRoaXMuY3B1RnJlcXVlbmN5ICogKDIwNDggLSBmcmVxdWVuY3kpIC8gMTMxMDcyOwoJY2hhbm5lbC50aW1lZCA9ICEhKHZhbHVlICYgMHg0MDAwKTsKCglpZiAodmFsdWUgJiAweDgwMDApIHsKCQl0aGlzLnJlc2V0U3F1YXJlQ2hhbm5lbChjaGFubmVsKTsKCQljaGFubmVsLnZvbHVtZSA9IGNoYW5uZWwuaW5pdGlhbFZvbHVtZTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLnVwZGF0ZVNxdWFyZUNoYW5uZWwgPSBmdW5jdGlvbihjaGFubmVsLCBjeWNsZXMpIHsKCWlmIChjaGFubmVsLnRpbWVkICYmIGN5Y2xlcyA+PSBjaGFubmVsLmVuZCkgewoJCWNoYW5uZWwucGxheWluZyA9IGZhbHNlOwoJCXJldHVybjsKCX0KCglpZiAoY2hhbm5lbC5kb1N3ZWVwICYmIGN5Y2xlcyA+PSBjaGFubmVsLm5leHRTd2VlcCkgewoJCWNoYW5uZWwuZnJlcXVlbmN5ICs9IGNoYW5uZWwuc3dlZXBJbmNyZW1lbnQgKiAoY2hhbm5lbC5mcmVxdWVuY3kgPj4gY2hhbm5lbC5zd2VlcFN0ZXBzKTsKCQlpZiAoY2hhbm5lbC5mcmVxdWVuY3kgPCAwKSB7CgkJCWNoYW5uZWwuZnJlcXVlbmN5ID0gMDsKCQl9IGVsc2UgaWYgKGNoYW5uZWwuZnJlcXVlbmN5ID4gMjA0NykgewoJCQljaGFubmVsLmZyZXF1ZW5jeSA9IDIwNDc7CgkJCWNoYW5uZWwucGxheWluZyA9IGZhbHNlOwoJCQlyZXR1cm47CgkJfQoJCWNoYW5uZWwuaW50ZXJ2YWwgPSB0aGlzLmNwdUZyZXF1ZW5jeSAqICgyMDQ4IC0gY2hhbm5lbC5mcmVxdWVuY3kpIC8gMTMxMDcyOwoJCWNoYW5uZWwubmV4dFN3ZWVwICs9IGNoYW5uZWwuc3dlZXBJbnRlcnZhbDsKCX0KCglpZiAoY3ljbGVzID49IGNoYW5uZWwucmFpc2UpIHsKCQljaGFubmVsLnNhbXBsZSA9IGNoYW5uZWwudm9sdW1lOwoJCWNoYW5uZWwubG93ZXIgPSBjaGFubmVsLnJhaXNlICsgY2hhbm5lbC5kdXR5ICogY2hhbm5lbC5pbnRlcnZhbDsKCQljaGFubmVsLnJhaXNlICs9IGNoYW5uZWwuaW50ZXJ2YWw7Cgl9IGVsc2UgaWYgKGN5Y2xlcyA+PSBjaGFubmVsLmxvd2VyKSB7CgkJY2hhbm5lbC5zYW1wbGUgPSAtY2hhbm5lbC52b2x1bWU7CgkJY2hhbm5lbC5sb3dlciArPSBjaGFubmVsLmludGVydmFsOwoJfQoKCXRoaXMudXBkYXRlRW52ZWxvcGUoY2hhbm5lbCwgY3ljbGVzKTsKCglpZiAodGhpcy5uZXh0RXZlbnQgPiBjaGFubmVsLnJhaXNlKSB7CgkJdGhpcy5uZXh0RXZlbnQgPSBjaGFubmVsLnJhaXNlOwoJfQoJaWYgKHRoaXMubmV4dEV2ZW50ID4gY2hhbm5lbC5sb3dlcikgewoJCXRoaXMubmV4dEV2ZW50ID0gY2hhbm5lbC5sb3dlcjsKCX0KCWlmIChjaGFubmVsLnRpbWVkICYmIHRoaXMubmV4dEV2ZW50ID4gY2hhbm5lbC5lbmQpIHsKCQl0aGlzLm5leHRFdmVudCA9IGNoYW5uZWwuZW5kOwoJfQoJaWYgKGNoYW5uZWwuZG9Td2VlcCAmJiB0aGlzLm5leHRFdmVudCA+IGNoYW5uZWwubmV4dFN3ZWVwKSB7CgkJdGhpcy5uZXh0RXZlbnQgPSBjaGFubmVsLm5leHRTd2VlcDsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLndyaXRlQ2hhbm5lbDNMbyA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmNoYW5uZWwzRGltZW5zaW9uID0gdmFsdWUgJiAweDIwOwoJdGhpcy5jaGFubmVsM0JhbmsgPSB2YWx1ZSAmIDB4NDA7Cgl2YXIgZW5hYmxlID0gdmFsdWUgJiAweDgwOwoJaWYgKCF0aGlzLmNoYW5uZWwzV3JpdGUgJiYgZW5hYmxlKSB7CgkJdGhpcy5jaGFubmVsM1dyaXRlID0gZW5hYmxlOwoJCXRoaXMucmVzZXRDaGFubmVsMygpOwoJfSBlbHNlIHsKCQl0aGlzLmNoYW5uZWwzV3JpdGUgPSBlbmFibGU7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS53cml0ZUNoYW5uZWwzSGkgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5jaGFubmVsM0xlbmd0aCA9IHRoaXMuY3B1RnJlcXVlbmN5ICogKDB4MTAwIC0gKHZhbHVlICYgMHhGRikpIC8gMjU2OwoJdmFyIHZvbHVtZSA9ICh2YWx1ZSA+PiAxMykgJiAweDc7Cglzd2l0Y2ggKHZvbHVtZSkgewoJY2FzZSAwOgoJCXRoaXMuY2hhbm5lbDNWb2x1bWUgPSAwOwoJCWJyZWFrOwoJY2FzZSAxOgoJCXRoaXMuY2hhbm5lbDNWb2x1bWUgPSAxOwoJCWJyZWFrOwoJY2FzZSAyOgoJCXRoaXMuY2hhbm5lbDNWb2x1bWUgPSAwLjU7CgkJYnJlYWs7CgljYXNlIDM6CgkJdGhpcy5jaGFubmVsM1ZvbHVtZSA9IDAuMjU7CgkJYnJlYWs7CglkZWZhdWx0OgoJCXRoaXMuY2hhbm5lbDNWb2x1bWUgPSAwLjc1OwoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUud3JpdGVDaGFubmVsM1ggPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5jaGFubmVsM0ludGVydmFsID0gdGhpcy5jcHVGcmVxdWVuY3kgKiAoMjA0OCAtICh2YWx1ZSAmIDB4N0ZGKSkgLyAyMDk3MTUyOwoJdGhpcy5jaGFubmVsM1RpbWVkID0gISEodmFsdWUgJiAweDQwMDApOwoJaWYgKHRoaXMuY2hhbm5lbDNXcml0ZSkgewoJCXRoaXMucmVzZXRDaGFubmVsMygpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUucmVzZXRDaGFubmVsMyA9IGZ1bmN0aW9uKCkgewoJdGhpcy5jaGFubmVsM05leHQgPSB0aGlzLmNwdS5jeWNsZXM7Cgl0aGlzLm5leHRFdmVudCA9IHRoaXMuY2hhbm5lbDNOZXh0OwoJdGhpcy5jaGFubmVsM0VuZCA9IHRoaXMuY3B1LmN5Y2xlcyArIHRoaXMuY2hhbm5lbDNMZW5ndGg7Cgl0aGlzLnBsYXlpbmdDaGFubmVsMyA9IHRoaXMuY2hhbm5lbDNXcml0ZTsKCXRoaXMudXBkYXRlVGltZXJzKCk7Cgl0aGlzLmNvcmUuaXJxLnBvbGxOZXh0RXZlbnQoKTsKfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLndyaXRlV2F2ZURhdGEgPSBmdW5jdGlvbihvZmZzZXQsIGRhdGEsIHdpZHRoKSB7CglpZiAoIXRoaXMuY2hhbm5lbDNCYW5rKSB7CgkJb2Zmc2V0ICs9IDE2OwoJfQoJaWYgKHdpZHRoID09IDIpIHsKCQl0aGlzLndhdmVEYXRhW29mZnNldF0gPSBkYXRhICYgMHhGRjsKCQlkYXRhID4+PSA4OwoJCSsrb2Zmc2V0OwoJfQoJdGhpcy53YXZlRGF0YVtvZmZzZXRdID0gZGF0YSAmIDB4RkY7Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS5zZXRDaGFubmVsNEVuYWJsZWQgPSBmdW5jdGlvbihlbmFibGUpIHsKCWlmICghdGhpcy5lbmFibGVDaGFubmVsNCAmJiBlbmFibGUpIHsKCQl0aGlzLmNoYW5uZWw0Lm5leHQgPSB0aGlzLmNwdS5jeWNsZXM7CgkJdGhpcy5jaGFubmVsNC5lbmQgPSB0aGlzLmNwdS5jeWNsZXMgKyB0aGlzLmNoYW5uZWw0Lmxlbmd0aDsKCQl0aGlzLmVuYWJsZUNoYW5uZWw0ID0gdHJ1ZTsKCQl0aGlzLnBsYXlpbmdDaGFubmVsNCA9IHRydWU7CgkJdGhpcy5uZXh0RXZlbnQgPSB0aGlzLmNwdS5jeWNsZXM7CgkJdGhpcy51cGRhdGVFbnZlbG9wZSh0aGlzLmNoYW5uZWw0KTsKCQl0aGlzLnVwZGF0ZVRpbWVycygpOwoJCXRoaXMuY29yZS5pcnEucG9sbE5leHRFdmVudCgpOwoJfSBlbHNlIHsKCQl0aGlzLmVuYWJsZUNoYW5uZWw0ID0gZW5hYmxlOwoJfQp9CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS53cml0ZUNoYW5uZWw0TEUgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy53cml0ZUNoYW5uZWxMRSh0aGlzLmNoYW5uZWw0LCB2YWx1ZSk7Cgl0aGlzLnJlc2V0Q2hhbm5lbDQoKTsKfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLndyaXRlQ2hhbm5lbDRGQyA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmNoYW5uZWw0LnRpbWVkID0gISEodmFsdWUgJiAweDQwMDApOwoKCXZhciByID0gdmFsdWUgJiAweDc7CglpZiAoIXIpIHsKCQlyID0gMC41OwoJfQoJdmFyIHMgPSAodmFsdWUgPj4gNCkgJiAweEY7Cgl2YXIgaW50ZXJ2YWwgPSB0aGlzLmNwdUZyZXF1ZW5jeSAqIChyICogKDIgPDwgcykpIC8gNTI0Mjg4OwoJaWYgKGludGVydmFsICE9IHRoaXMuY2hhbm5lbDQuaW50ZXJ2YWwpIHsKCQl0aGlzLmNoYW5uZWw0LmludGVydmFsID0gaW50ZXJ2YWw7CgkJdGhpcy5yZXNldENoYW5uZWw0KCk7Cgl9CgoJdmFyIHdpZHRoID0gKHZhbHVlICYgMHg4KSA/IDcgOiAxNTsKCWlmICh3aWR0aCAhPSB0aGlzLmNoYW5uZWw0LndpZHRoKSB7CgkJdGhpcy5jaGFubmVsNC53aWR0aCA9IHdpZHRoOwoJCXRoaXMucmVzZXRDaGFubmVsNCgpOwoJfQoKCWlmICh2YWx1ZSAmIDB4ODAwMCkgewoJCXRoaXMucmVzZXRDaGFubmVsNCgpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUucmVzZXRDaGFubmVsNCA9IGZ1bmN0aW9uKCkgewoJaWYgKHRoaXMuY2hhbm5lbDQud2lkdGggPT0gMTUpIHsKCQl0aGlzLmNoYW5uZWw0Lmxmc3IgPSAweDQwMDA7Cgl9IGVsc2UgewoJCXRoaXMuY2hhbm5lbDQubGZzciA9IDB4NDA7Cgl9Cgl0aGlzLmNoYW5uZWw0LnZvbHVtZSA9IHRoaXMuY2hhbm5lbDQuaW5pdGlhbFZvbHVtZTsKCWlmICh0aGlzLmNoYW5uZWw0LnN0ZXApIHsKCQl0aGlzLmNoYW5uZWw0Lm5leHRTdGVwID0gdGhpcy5jcHUuY3ljbGVzICsgdGhpcy5jaGFubmVsNC5zdGVwOwoJfQoJdGhpcy5jaGFubmVsNC5lbmQgPSB0aGlzLmNwdS5jeWNsZXMgKyB0aGlzLmNoYW5uZWw0Lmxlbmd0aDsKCXRoaXMuY2hhbm5lbDQubmV4dCA9IHRoaXMuY3B1LmN5Y2xlczsKCXRoaXMubmV4dEV2ZW50ID0gdGhpcy5jaGFubmVsNC5uZXh0OwoKCXRoaXMucGxheWluZ0NoYW5uZWw0ID0gdGhpcy5lbmFibGVDaGFubmVsNDsKCXRoaXMudXBkYXRlVGltZXJzKCk7Cgl0aGlzLmNvcmUuaXJxLnBvbGxOZXh0RXZlbnQoKTsKfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLndyaXRlQ2hhbm5lbExFID0gZnVuY3Rpb24oY2hhbm5lbCwgdmFsdWUpIHsKCWNoYW5uZWwubGVuZ3RoID0gdGhpcy5jcHVGcmVxdWVuY3kgKiAoKDB4NDAgLSAodmFsdWUgJiAweDNGKSkgLyAyNTYpOwoKCWlmICh2YWx1ZSAmIDB4MDgwMCkgewoJCWNoYW5uZWwuaW5jcmVtZW50ID0gMSAvIDE2OwoJfSBlbHNlIHsKCQljaGFubmVsLmluY3JlbWVudCA9IC0xIC8gMTY7Cgl9CgljaGFubmVsLmluaXRpYWxWb2x1bWUgPSAoKHZhbHVlID4+IDEyKSAmIDB4RikgLyAxNjsKCgljaGFubmVsLnN0ZXAgPSB0aGlzLmNwdUZyZXF1ZW5jeSAqICgoKHZhbHVlID4+IDgpICYgMHg3KSAvIDY0KTsKfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLnVwZGF0ZUVudmVsb3BlID0gZnVuY3Rpb24oY2hhbm5lbCwgY3ljbGVzKSB7CglpZiAoY2hhbm5lbC5zdGVwKSB7CgkJaWYgKGN5Y2xlcyA+PSBjaGFubmVsLm5leHRTdGVwKSB7CgkJCWNoYW5uZWwudm9sdW1lICs9IGNoYW5uZWwuaW5jcmVtZW50OwoJCQlpZiAoY2hhbm5lbC52b2x1bWUgPiAxKSB7CgkJCQljaGFubmVsLnZvbHVtZSA9IDE7CgkJCX0gZWxzZSBpZiAoY2hhbm5lbC52b2x1bWUgPCAwKSB7CgkJCQljaGFubmVsLnZvbHVtZSA9IDA7CgkJCX0KCQkJY2hhbm5lbC5uZXh0U3RlcCArPSBjaGFubmVsLnN0ZXA7CgkJfQoKCQlpZiAodGhpcy5uZXh0RXZlbnQgPiBjaGFubmVsLm5leHRTdGVwKSB7CgkJCXRoaXMubmV4dEV2ZW50ID0gY2hhbm5lbC5uZXh0U3RlcDsKCQl9Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS5hcHBlbmRUb0ZpZm9BID0gZnVuY3Rpb24odmFsdWUpIHsKCXZhciBiOwoJaWYgKHRoaXMuZmlmb0EubGVuZ3RoID4gMjgpIHsKCQl0aGlzLmZpZm9BID0gdGhpcy5maWZvQS5zbGljZSgtMjgpOwoJfQoJZm9yICh2YXIgaSA9IDA7IGkgPCA0OyArK2kpIHsKCQliID0gKHZhbHVlICYgMHhGRikgPDwgMjQ7CgkJdmFsdWUgPj49IDg7CgkJdGhpcy5maWZvQS5wdXNoKGIgLyAweDgwMDAwMDAwKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlQXVkaW8ucHJvdG90eXBlLmFwcGVuZFRvRmlmb0IgPSBmdW5jdGlvbih2YWx1ZSkgewoJdmFyIGI7CglpZiAodGhpcy5maWZvQi5sZW5ndGggPiAyOCkgewoJCXRoaXMuZmlmb0IgPSB0aGlzLmZpZm9CLnNsaWNlKC0yOCk7Cgl9Cglmb3IgKHZhciBpID0gMDsgaSA8IDQ7ICsraSkgewoJCWIgPSAodmFsdWUgJiAweEZGKSA8PCAyNDsKCQl2YWx1ZSA+Pj0gODsKCQl0aGlzLmZpZm9CLnB1c2goYiAvIDB4ODAwMDAwMDApOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUuc2FtcGxlRmlmb0EgPSBmdW5jdGlvbigpIHsKCWlmICh0aGlzLmZpZm9BLmxlbmd0aCA8PSAxNikgewoJCXZhciBkbWEgPSB0aGlzLmNvcmUuaXJxLmRtYVt0aGlzLmRtYUFdOwoJCWRtYS5uZXh0Q291bnQgPSA0OwoJCXRoaXMuY29yZS5tbXUuc2VydmljZURtYSh0aGlzLmRtYUEsIGRtYSk7Cgl9Cgl0aGlzLmZpZm9BU2FtcGxlID0gdGhpcy5maWZvQS5zaGlmdCgpOwp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUuc2FtcGxlRmlmb0IgPSBmdW5jdGlvbigpIHsKCWlmICh0aGlzLmZpZm9CLmxlbmd0aCA8PSAxNikgewoJCXZhciBkbWEgPSB0aGlzLmNvcmUuaXJxLmRtYVt0aGlzLmRtYUJdOwoJCWRtYS5uZXh0Q291bnQgPSA0OwoJCXRoaXMuY29yZS5tbXUuc2VydmljZURtYSh0aGlzLmRtYUIsIGRtYSk7Cgl9Cgl0aGlzLmZpZm9CU2FtcGxlID0gdGhpcy5maWZvQi5zaGlmdCgpOwp9OwoKR2FtZUJveUFkdmFuY2VBdWRpby5wcm90b3R5cGUuc2NoZWR1bGVGSUZPRG1hID0gZnVuY3Rpb24obnVtYmVyLCBpbmZvKSB7Cglzd2l0Y2ggKGluZm8uZGVzdCkgewoJY2FzZSB0aGlzLmNwdS5tbXUuQkFTRV9JTyB8IHRoaXMuY3B1LmlycS5pby5GSUZPX0FfTE86CgkJLy8gRklYTUU6IGlzIHRoaXMgbmVlZGVkIG9yIGEgaGFjaz8KCQlpbmZvLmRzdENvbnRyb2wgPSAyOwoJCXRoaXMuZG1hQSA9IG51bWJlcjsKCQlicmVhazsKCWNhc2UgdGhpcy5jcHUubW11LkJBU0VfSU8gfCB0aGlzLmNwdS5pcnEuaW8uRklGT19CX0xPOgoJCWluZm8uZHN0Q29udHJvbCA9IDI7CgkJdGhpcy5kbWFCID0gbnVtYmVyOwoJCWJyZWFrOwoJZGVmYXVsdDoKCQl0aGlzLmNvcmUuV0FSTignVHJpZWQgdG8gc2NoZWR1bGUgRklGTyBETUEgZm9yIG5vbi1GSUZPIGRlc3RpbmF0aW9uJyk7CgkJYnJlYWs7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS5zYW1wbGUgPSBmdW5jdGlvbigpIHsKCXZhciBzYW1wbGVMZWZ0ID0gMDsKCXZhciBzYW1wbGVSaWdodCA9IDA7Cgl2YXIgc2FtcGxlOwoJdmFyIGNoYW5uZWw7CgoJY2hhbm5lbCA9IHRoaXMuc3F1YXJlQ2hhbm5lbHNbMF07CglpZiAoY2hhbm5lbC5wbGF5aW5nKSB7CgkJc2FtcGxlID0gY2hhbm5lbC5zYW1wbGUgKiB0aGlzLnNvdW5kUmF0aW8gKiB0aGlzLlBTR19NQVg7CgkJaWYgKHRoaXMuZW5hYmxlZExlZnQgJiAweDEpIHsKCQkJc2FtcGxlTGVmdCArPSBzYW1wbGU7CgkJfQoJCWlmICh0aGlzLmVuYWJsZWRSaWdodCAmIDB4MSkgewoJCQlzYW1wbGVSaWdodCArPSBzYW1wbGU7CgkJfQoJfQoKCWNoYW5uZWwgPSB0aGlzLnNxdWFyZUNoYW5uZWxzWzFdOwoJaWYgKGNoYW5uZWwucGxheWluZykgewoJCXNhbXBsZSA9IGNoYW5uZWwuc2FtcGxlICogdGhpcy5zb3VuZFJhdGlvICogdGhpcy5QU0dfTUFYOwoJCWlmICh0aGlzLmVuYWJsZWRMZWZ0ICYgMHgyKSB7CgkJCXNhbXBsZUxlZnQgKz0gc2FtcGxlOwoJCX0KCQlpZiAodGhpcy5lbmFibGVkUmlnaHQgJiAweDIpIHsKCQkJc2FtcGxlUmlnaHQgKz0gc2FtcGxlOwoJCX0KCX0KCglpZiAodGhpcy5wbGF5aW5nQ2hhbm5lbDMpIHsKCQlzYW1wbGUgPSB0aGlzLmNoYW5uZWwzU2FtcGxlICogdGhpcy5zb3VuZFJhdGlvICogdGhpcy5jaGFubmVsM1ZvbHVtZSAqIHRoaXMuUFNHX01BWDsKCQlpZiAodGhpcy5lbmFibGVkTGVmdCAmIDB4NCkgewoJCQlzYW1wbGVMZWZ0ICs9IHNhbXBsZTsKCQl9CgkJaWYgKHRoaXMuZW5hYmxlZFJpZ2h0ICYgMHg0KSB7CgkJCXNhbXBsZVJpZ2h0ICs9IHNhbXBsZTsKCQl9Cgl9CgoJaWYgKHRoaXMucGxheWluZ0NoYW5uZWw0KSB7CgkJc2FtcGxlID0gdGhpcy5jaGFubmVsNC5zYW1wbGUgKiB0aGlzLnNvdW5kUmF0aW8gKiB0aGlzLlBTR19NQVg7CgkJaWYgKHRoaXMuZW5hYmxlZExlZnQgJiAweDgpIHsKCQkJc2FtcGxlTGVmdCArPSBzYW1wbGU7CgkJfQoJCWlmICh0aGlzLmVuYWJsZWRSaWdodCAmIDB4OCkgewoJCQlzYW1wbGVSaWdodCArPSBzYW1wbGU7CgkJfQoJfQoKCWlmICh0aGlzLmVuYWJsZUNoYW5uZWxBKSB7CgkJc2FtcGxlID0gdGhpcy5maWZvQVNhbXBsZSAqIHRoaXMuRklGT19NQVggKiB0aGlzLnJhdGlvQ2hhbm5lbEE7CgkJaWYgKHRoaXMuZW5hYmxlTGVmdENoYW5uZWxBKSB7CgkJCXNhbXBsZUxlZnQgKz0gc2FtcGxlOwoJCX0KCQlpZiAodGhpcy5lbmFibGVSaWdodENoYW5uZWxBKSB7CgkJCXNhbXBsZVJpZ2h0ICs9IHNhbXBsZTsKCQl9Cgl9CgoJaWYgKHRoaXMuZW5hYmxlQ2hhbm5lbEIpIHsKCQlzYW1wbGUgPSB0aGlzLmZpZm9CU2FtcGxlICogdGhpcy5GSUZPX01BWCAqIHRoaXMucmF0aW9DaGFubmVsQjsKCQlpZiAodGhpcy5lbmFibGVMZWZ0Q2hhbm5lbEIpIHsKCQkJc2FtcGxlTGVmdCArPSBzYW1wbGU7CgkJfQoJCWlmICh0aGlzLmVuYWJsZVJpZ2h0Q2hhbm5lbEIpIHsKCQkJc2FtcGxlUmlnaHQgKz0gc2FtcGxlOwoJCX0KCX0KCgl2YXIgc2FtcGxlUG9pbnRlciA9IHRoaXMuc2FtcGxlUG9pbnRlcjsKCXNhbXBsZUxlZnQgKj0gdGhpcy5tYXN0ZXJWb2x1bWUgLyB0aGlzLlNPVU5EX01BWDsKCXNhbXBsZUxlZnQgPSBNYXRoLm1heChNYXRoLm1pbihzYW1wbGVMZWZ0LCAxKSwgLTEpOwoJc2FtcGxlUmlnaHQgKj0gdGhpcy5tYXN0ZXJWb2x1bWUgLyB0aGlzLlNPVU5EX01BWDsKCXNhbXBsZVJpZ2h0ID0gTWF0aC5tYXgoTWF0aC5taW4oc2FtcGxlUmlnaHQsIDEpLCAtMSk7CglpZiAodGhpcy5idWZmZXJzKSB7CgkJdGhpcy5idWZmZXJzWzBdW3NhbXBsZVBvaW50ZXJdID0gc2FtcGxlTGVmdDsKCQl0aGlzLmJ1ZmZlcnNbMV1bc2FtcGxlUG9pbnRlcl0gPSBzYW1wbGVSaWdodDsKCX0KCXRoaXMuc2FtcGxlUG9pbnRlciA9IChzYW1wbGVQb2ludGVyICsgMSkgJiB0aGlzLnNhbXBsZU1hc2s7Cn07CgpHYW1lQm95QWR2YW5jZUF1ZGlvLnByb3RvdHlwZS5hdWRpb1Byb2Nlc3MgPSBmdW5jdGlvbihhdWRpb1Byb2Nlc3NpbmdFdmVudCkgewoJdmFyIGxlZnQgPSBhdWRpb1Byb2Nlc3NpbmdFdmVudC5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7Cgl2YXIgcmlnaHQgPSBhdWRpb1Byb2Nlc3NpbmdFdmVudC5vdXRwdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMSk7CglpZiAodGhpcy5tYXN0ZXJFbmFibGUpIHsKCQl2YXIgaTsKCQl2YXIgbyA9IHRoaXMub3V0cHV0UG9pbnRlcjsKCQlmb3IgKGkgPSAwOyBpIDwgdGhpcy5idWZmZXJTaXplOyArK2ksIG8gKz0gdGhpcy5yZXNhbXBsZVJhdGlvKSB7CgkJCWlmIChvID49IHRoaXMubWF4U2FtcGxlcykgewoJCQkJbyAtPSB0aGlzLm1heFNhbXBsZXM7CgkJCX0KCQkJaWYgKChvIHwgMCkgPT0gdGhpcy5zYW1wbGVQb2ludGVyKSB7CgkJCQkrK3RoaXMuYmFja3VwOwoJCQkJYnJlYWs7CgkJCX0KCQkJbGVmdFtpXSA9IHRoaXMuYnVmZmVyc1swXVtvIHwgMF07CgkJCXJpZ2h0W2ldID0gdGhpcy5idWZmZXJzWzFdW28gfCAwXTsKCQl9CgkJZm9yICg7IGkgPCB0aGlzLmJ1ZmZlclNpemU7ICsraSkgewoJCQlsZWZ0W2ldID0gMDsKCQkJcmlnaHRbaV0gPSAwOwoJCX0KCQl0aGlzLm91dHB1dFBvaW50ZXIgPSBvOwoJCSsrdGhpcy50b3RhbFNhbXBsZXM7Cgl9IGVsc2UgewoJCWZvciAoaSA9IDA7IGkgPCB0aGlzLmJ1ZmZlclNpemU7ICsraSkgewoJCQlsZWZ0W2ldID0gMDsKCQkJcmlnaHRbaV0gPSAwOwoJCX0KCX0KfTsK";

const GBA_js_core_js = "ZnVuY3Rpb24gQVJNQ29yZSgpIHsKCXRoaXMuaW5oZXJpdCgpOwoJdGhpcy5TUCA9IDEzOwoJdGhpcy5MUiA9IDE0OwoJdGhpcy5QQyA9IDE1OwoKCXRoaXMuTU9ERV9BUk0gPSAwOwoJdGhpcy5NT0RFX1RIVU1CID0gMTsKCgl0aGlzLk1PREVfVVNFUiA9IDB4MTA7Cgl0aGlzLk1PREVfRklRID0gMHgxMTsKCXRoaXMuTU9ERV9JUlEgPSAweDEyOwoJdGhpcy5NT0RFX1NVUEVSVklTT1IgPSAweDEzOwoJdGhpcy5NT0RFX0FCT1JUID0gMHgxNzsKCXRoaXMuTU9ERV9VTkRFRklORUQgPSAweDFCOwoJdGhpcy5NT0RFX1NZU1RFTSA9IDB4MUY7CgoJdGhpcy5CQU5LX05PTkUgPSAwCgl0aGlzLkJBTktfRklRID0gMTsKCXRoaXMuQkFOS19JUlEgPSAyOwoJdGhpcy5CQU5LX1NVUEVSVklTT1IgPSAzOwoJdGhpcy5CQU5LX0FCT1JUID0gNDsKCXRoaXMuQkFOS19VTkRFRklORUQgPSA1OwoKCXRoaXMuVU5BTExPQ19NQVNLID0gMHgwRkZGRkYwMDsKCXRoaXMuVVNFUl9NQVNLID0gMHhGMDAwMDAwMDsKCXRoaXMuUFJJVl9NQVNLID0gMHgwMDAwMDBDRjsgLy8gVGhpcyBpcyBvdXQgb2Ygc3BlYywgYnV0IGl0IHNlZW1zIHRvIGJlIHdoYXQncyBkb25lIGluIG90aGVyIGltcGxlbWVudGF0aW9ucwoJdGhpcy5TVEFURV9NQVNLID0gMHgwMDAwMDAyMDsKCgl0aGlzLldPUkRfU0laRV9BUk0gPSA0OwoJdGhpcy5XT1JEX1NJWkVfVEhVTUIgPSAyOwoKCXRoaXMuQkFTRV9SRVNFVCA9IDB4MDAwMDAwMDA7Cgl0aGlzLkJBU0VfVU5ERUYgPSAweDAwMDAwMDA0OwoJdGhpcy5CQVNFX1NXSSA9IDB4MDAwMDAwMDg7Cgl0aGlzLkJBU0VfUEFCVCA9IDB4MDAwMDAwMEM7Cgl0aGlzLkJBU0VfREFCVCA9IDB4MDAwMDAwMTA7Cgl0aGlzLkJBU0VfSVJRID0gMHgwMDAwMDAxODsKCXRoaXMuQkFTRV9GSVEgPSAweDAwMDAwMDFDOwoKCXRoaXMuYXJtQ29tcGlsZXIgPSBuZXcgQVJNQ29yZUFybSh0aGlzKTsKCXRoaXMudGh1bWJDb21waWxlciA9IG5ldyBBUk1Db3JlVGh1bWIodGhpcyk7Cgl0aGlzLmdlbmVyYXRlQ29uZHMoKTsKCgl0aGlzLmdwcnMgPSBuZXcgSW50MzJBcnJheSgxNik7Cn07CgpBUk1Db3JlLnByb3RvdHlwZS5yZXNldENQVSA9IGZ1bmN0aW9uKHN0YXJ0T2Zmc2V0KSB7Cglmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuUEM7ICsraSkgewoJCXRoaXMuZ3Byc1tpXSA9IDA7Cgl9Cgl0aGlzLmdwcnNbdGhpcy5QQ10gPSBzdGFydE9mZnNldCArIHRoaXMuV09SRF9TSVpFX0FSTTsKCgl0aGlzLmxvYWRJbnN0cnVjdGlvbiA9IHRoaXMubG9hZEluc3RydWN0aW9uQXJtOwoJdGhpcy5leGVjTW9kZSA9IHRoaXMuTU9ERV9BUk07Cgl0aGlzLmluc3RydWN0aW9uV2lkdGggPSB0aGlzLldPUkRfU0laRV9BUk07CgoJdGhpcy5tb2RlID0gdGhpcy5NT0RFX1NZU1RFTTsKCgl0aGlzLmNwc3JJID0gZmFsc2U7Cgl0aGlzLmNwc3JGID0gZmFsc2U7CgoJdGhpcy5jcHNyViA9IGZhbHNlOwoJdGhpcy5jcHNyQyA9IGZhbHNlOwoJdGhpcy5jcHNyWiA9IGZhbHNlOwoJdGhpcy5jcHNyTiA9IGZhbHNlOwoKCXRoaXMuYmFua2VkUmVnaXN0ZXJzID0gWwoJCW5ldyBJbnQzMkFycmF5KDcpLAoJCW5ldyBJbnQzMkFycmF5KDcpLAoJCW5ldyBJbnQzMkFycmF5KDIpLAoJCW5ldyBJbnQzMkFycmF5KDIpLAoJCW5ldyBJbnQzMkFycmF5KDIpLAoJCW5ldyBJbnQzMkFycmF5KDIpCgldOwoJdGhpcy5zcHNyID0gMDsKCXRoaXMuYmFua2VkU1BTUnMgPSBuZXcgSW50MzJBcnJheSg2KTsKCgl0aGlzLmN5Y2xlcyA9IDA7CgoJdGhpcy5zaGlmdGVyT3BlcmFuZCA9IDA7Cgl0aGlzLnNoaWZ0ZXJDYXJyeU91dCA9IDA7CgoJdGhpcy5wYWdlID0gbnVsbDsKCXRoaXMucGFnZUlkID0gMDsKCXRoaXMucGFnZVJlZ2lvbiA9IC0xOwoKCXRoaXMuaW5zdHJ1Y3Rpb24gPSBudWxsOwoKCXRoaXMuaXJxLmNsZWFyKCk7CgoJdmFyIGdwcnMgPSB0aGlzLmdwcnM7Cgl2YXIgbW11ID0gdGhpcy5tbXU7Cgl0aGlzLnN0ZXAgPSBmdW5jdGlvbigpIHsKCQl2YXIgaW5zdHJ1Y3Rpb24gPSB0aGlzLmluc3RydWN0aW9uIHx8ICh0aGlzLmluc3RydWN0aW9uID0gdGhpcy5sb2FkSW5zdHJ1Y3Rpb24oZ3Byc1t0aGlzLlBDXSAtIHRoaXMuaW5zdHJ1Y3Rpb25XaWR0aCkpOwoJCWdwcnNbdGhpcy5QQ10gKz0gdGhpcy5pbnN0cnVjdGlvbldpZHRoOwoJCXRoaXMuY29uZGl0aW9uUGFzc2VkID0gdHJ1ZTsKCQlpbnN0cnVjdGlvbigpOwoKCQlpZiAoIWluc3RydWN0aW9uLndyaXRlc1BDKSB7CgkJCWlmICh0aGlzLmluc3RydWN0aW9uICE9IG51bGwpIHsgLy8gV2UgbWlnaHQgaGF2ZSBnb3R0ZW4gYW4gaW50ZXJydXB0IGZyb20gdGhlIGluc3RydWN0aW9uCgkJCQlpZiAoaW5zdHJ1Y3Rpb24ubmV4dCA9PSBudWxsIHx8IGluc3RydWN0aW9uLm5leHQucGFnZS5pbnZhbGlkKSB7CgkJCQkJaW5zdHJ1Y3Rpb24ubmV4dCA9IHRoaXMubG9hZEluc3RydWN0aW9uKGdwcnNbdGhpcy5QQ10gLSB0aGlzLmluc3RydWN0aW9uV2lkdGgpOwoJCQkJfQoJCQkJdGhpcy5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLm5leHQ7CgkJCX0KCQl9IGVsc2UgewoJCQlpZiAodGhpcy5jb25kaXRpb25QYXNzZWQpIHsKCQkJCXZhciBwYyA9IGdwcnNbdGhpcy5QQ10gJj0gMHhGRkZGRkZGRTsKCQkJCWlmICh0aGlzLmV4ZWNNb2RlID09IHRoaXMuTU9ERV9BUk0pIHsKCQkJCQltbXUud2FpdDMyKHBjKTsKCQkJCQltbXUud2FpdFByZWZldGNoMzIocGMpOwoJCQkJfSBlbHNlIHsKCQkJCQltbXUud2FpdChwYyk7CgkJCQkJbW11LndhaXRQcmVmZXRjaChwYyk7CgkJCQl9CgkJCQlncHJzW3RoaXMuUENdICs9IHRoaXMuaW5zdHJ1Y3Rpb25XaWR0aDsKCQkJCWlmICghaW5zdHJ1Y3Rpb24uZml4ZWRKdW1wKSB7CgkJCQkJdGhpcy5pbnN0cnVjdGlvbiA9IG51bGw7CgkJCQl9IGVsc2UgaWYgICh0aGlzLmluc3RydWN0aW9uICE9IG51bGwpIHsKCQkJCQlpZiAoaW5zdHJ1Y3Rpb24ubmV4dCA9PSBudWxsIHx8IGluc3RydWN0aW9uLm5leHQucGFnZS5pbnZhbGlkKSB7CgkJCQkJCWluc3RydWN0aW9uLm5leHQgPSB0aGlzLmxvYWRJbnN0cnVjdGlvbihncHJzW3RoaXMuUENdIC0gdGhpcy5pbnN0cnVjdGlvbldpZHRoKTsKCQkJCQl9CgkJCQkJdGhpcy5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uLm5leHQ7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQl0aGlzLmluc3RydWN0aW9uID0gbnVsbDsKCQkJfQoJCX0KCQl0aGlzLmlycS51cGRhdGVUaW1lcnMoKTsKCX07Cn07CgpBUk1Db3JlLnByb3RvdHlwZS5mcmVlemUgPSBmdW5jdGlvbigpIHsKCXJldHVybiB7CgkJJ2dwcnMnOiBbCgkJCXRoaXMuZ3Byc1swXSwKCQkJdGhpcy5ncHJzWzFdLAoJCQl0aGlzLmdwcnNbMl0sCgkJCXRoaXMuZ3Byc1szXSwKCQkJdGhpcy5ncHJzWzRdLAoJCQl0aGlzLmdwcnNbNV0sCgkJCXRoaXMuZ3Byc1s2XSwKCQkJdGhpcy5ncHJzWzddLAoJCQl0aGlzLmdwcnNbOF0sCgkJCXRoaXMuZ3Byc1s5XSwKCQkJdGhpcy5ncHJzWzEwXSwKCQkJdGhpcy5ncHJzWzExXSwKCQkJdGhpcy5ncHJzWzEyXSwKCQkJdGhpcy5ncHJzWzEzXSwKCQkJdGhpcy5ncHJzWzE0XSwKCQkJdGhpcy5ncHJzWzE1XSwKCQldLAoJCSdtb2RlJzogdGhpcy5tb2RlLAoJCSdjcHNySSc6IHRoaXMuY3BzckksCgkJJ2Nwc3JGJzogdGhpcy5jcHNyRiwKCQknY3BzclYnOiB0aGlzLmNwc3JWLAoJCSdjcHNyQyc6IHRoaXMuY3BzckMsCgkJJ2Nwc3JaJzogdGhpcy5jcHNyWiwKCQknY3Bzck4nOiB0aGlzLmNwc3JOLAoJCSdiYW5rZWRSZWdpc3RlcnMnOiBbCgkJCVsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzBdWzBdLAoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMF1bMV0sCgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1swXVsyXSwKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzBdWzNdLAoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMF1bNF0sCgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1swXVs1XSwKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzBdWzZdCgkJCV0sCgkJCVsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzFdWzBdLAoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMV1bMV0sCgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1sxXVsyXSwKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzFdWzNdLAoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMV1bNF0sCgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1sxXVs1XSwKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzFdWzZdCgkJCV0sCgkJCVsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzJdWzBdLAoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMl1bMV0KCQkJXSwKCQkJWwoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbM11bMF0sCgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1szXVsxXQoJCQldLAoJCQlbCgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1s0XVswXSwKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzRdWzFdCgkJCV0sCgkJCVsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzVdWzBdLAoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbNV1bMV0KCQkJXQoJCV0sCgkJJ3Nwc3InOiB0aGlzLnNwc3IsCgkJJ2JhbmtlZFNQU1JzJzogWwoJCQl0aGlzLmJhbmtlZFNQU1JzWzBdLAoJCQl0aGlzLmJhbmtlZFNQU1JzWzFdLAoJCQl0aGlzLmJhbmtlZFNQU1JzWzJdLAoJCQl0aGlzLmJhbmtlZFNQU1JzWzNdLAoJCQl0aGlzLmJhbmtlZFNQU1JzWzRdLAoJCQl0aGlzLmJhbmtlZFNQU1JzWzVdCgkJXSwKCQknY3ljbGVzJzogdGhpcy5jeWNsZXMKCX07Cn07CgpBUk1Db3JlLnByb3RvdHlwZS5kZWZyb3N0ID0gZnVuY3Rpb24oZnJvc3QpIHsKCXRoaXMuaW5zdHJ1Y3Rpb24gPSBudWxsOwoKCXRoaXMucGFnZSA9IG51bGw7Cgl0aGlzLnBhZ2VJZCA9IDA7Cgl0aGlzLnBhZ2VSZWdpb24gPSAtMTsKCgl0aGlzLmdwcnNbMF0gPSBmcm9zdC5ncHJzWzBdOwoJdGhpcy5ncHJzWzFdID0gZnJvc3QuZ3Byc1sxXTsKCXRoaXMuZ3Byc1syXSA9IGZyb3N0LmdwcnNbMl07Cgl0aGlzLmdwcnNbM10gPSBmcm9zdC5ncHJzWzNdOwoJdGhpcy5ncHJzWzRdID0gZnJvc3QuZ3Byc1s0XTsKCXRoaXMuZ3Byc1s1XSA9IGZyb3N0LmdwcnNbNV07Cgl0aGlzLmdwcnNbNl0gPSBmcm9zdC5ncHJzWzZdOwoJdGhpcy5ncHJzWzddID0gZnJvc3QuZ3Byc1s3XTsKCXRoaXMuZ3Byc1s4XSA9IGZyb3N0LmdwcnNbOF07Cgl0aGlzLmdwcnNbOV0gPSBmcm9zdC5ncHJzWzldOwoJdGhpcy5ncHJzWzEwXSA9IGZyb3N0LmdwcnNbMTBdOwoJdGhpcy5ncHJzWzExXSA9IGZyb3N0LmdwcnNbMTFdOwoJdGhpcy5ncHJzWzEyXSA9IGZyb3N0LmdwcnNbMTJdOwoJdGhpcy5ncHJzWzEzXSA9IGZyb3N0LmdwcnNbMTNdOwoJdGhpcy5ncHJzWzE0XSA9IGZyb3N0LmdwcnNbMTRdOwoJdGhpcy5ncHJzWzE1XSA9IGZyb3N0LmdwcnNbMTVdOwoKCXRoaXMubW9kZSA9IGZyb3N0Lm1vZGU7Cgl0aGlzLmNwc3JJID0gZnJvc3QuY3Bzckk7Cgl0aGlzLmNwc3JGID0gZnJvc3QuY3BzckY7Cgl0aGlzLmNwc3JWID0gZnJvc3QuY3BzclY7Cgl0aGlzLmNwc3JDID0gZnJvc3QuY3BzckM7Cgl0aGlzLmNwc3JaID0gZnJvc3QuY3Bzclo7Cgl0aGlzLmNwc3JOID0gZnJvc3QuY3Bzck47CgoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMF1bMF0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMF1bMF07Cgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1swXVsxXSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1swXVsxXTsKCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzBdWzJdID0gZnJvc3QuYmFua2VkUmVnaXN0ZXJzWzBdWzJdOwoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMF1bM10gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMF1bM107Cgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1swXVs0XSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1swXVs0XTsKCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzBdWzVdID0gZnJvc3QuYmFua2VkUmVnaXN0ZXJzWzBdWzVdOwoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMF1bNl0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMF1bNl07CgoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMV1bMF0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMV1bMF07Cgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1sxXVsxXSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1sxXVsxXTsKCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzFdWzJdID0gZnJvc3QuYmFua2VkUmVnaXN0ZXJzWzFdWzJdOwoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMV1bM10gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMV1bM107Cgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1sxXVs0XSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1sxXVs0XTsKCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzFdWzVdID0gZnJvc3QuYmFua2VkUmVnaXN0ZXJzWzFdWzVdOwoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMV1bNl0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMV1bNl07CgoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbMl1bMF0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbMl1bMF07Cgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1syXVsxXSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1syXVsxXTsKCgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1szXVswXSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1szXVswXTsKCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzNdWzFdID0gZnJvc3QuYmFua2VkUmVnaXN0ZXJzWzNdWzFdOwoKCXRoaXMuYmFua2VkUmVnaXN0ZXJzWzRdWzBdID0gZnJvc3QuYmFua2VkUmVnaXN0ZXJzWzRdWzBdOwoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbNF1bMV0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbNF1bMV07CgoJdGhpcy5iYW5rZWRSZWdpc3RlcnNbNV1bMF0gPSBmcm9zdC5iYW5rZWRSZWdpc3RlcnNbNV1bMF07Cgl0aGlzLmJhbmtlZFJlZ2lzdGVyc1s1XVsxXSA9IGZyb3N0LmJhbmtlZFJlZ2lzdGVyc1s1XVsxXTsKCgl0aGlzLnNwc3IgPSBmcm9zdC5zcHNyOwoJdGhpcy5iYW5rZWRTUFNSc1swXSA9IGZyb3N0LmJhbmtlZFNQU1JzWzBdOwoJdGhpcy5iYW5rZWRTUFNSc1sxXSA9IGZyb3N0LmJhbmtlZFNQU1JzWzFdOwoJdGhpcy5iYW5rZWRTUFNSc1syXSA9IGZyb3N0LmJhbmtlZFNQU1JzWzJdOwoJdGhpcy5iYW5rZWRTUFNSc1szXSA9IGZyb3N0LmJhbmtlZFNQU1JzWzNdOwoJdGhpcy5iYW5rZWRTUFNSc1s0XSA9IGZyb3N0LmJhbmtlZFNQU1JzWzRdOwoJdGhpcy5iYW5rZWRTUFNSc1s1XSA9IGZyb3N0LmJhbmtlZFNQU1JzWzVdOwoKCXRoaXMuY3ljbGVzID0gZnJvc3QuY3ljbGVzOwp9OwoKQVJNQ29yZS5wcm90b3R5cGUuZmV0Y2hQYWdlID0gZnVuY3Rpb24oYWRkcmVzcykgewoJdmFyIHJlZ2lvbiA9IGFkZHJlc3MgPj4gdGhpcy5tbXUuQkFTRV9PRkZTRVQ7Cgl2YXIgcGFnZUlkID0gdGhpcy5tbXUuYWRkcmVzc1RvUGFnZShyZWdpb24sIGFkZHJlc3MgJiB0aGlzLm1tdS5PRkZTRVRfTUFTSyk7CglpZiAocmVnaW9uID09IHRoaXMucGFnZVJlZ2lvbikgewoJCWlmIChwYWdlSWQgPT0gdGhpcy5wYWdlSWQgJiYgIXRoaXMucGFnZS5pbnZhbGlkKSB7CgkJCXJldHVybjsKCQl9CgkJdGhpcy5wYWdlSWQgPSBwYWdlSWQ7Cgl9IGVsc2UgewoJCXRoaXMucGFnZU1hc2sgPSB0aGlzLm1tdS5tZW1vcnlbcmVnaW9uXS5QQUdFX01BU0s7CgkJdGhpcy5wYWdlUmVnaW9uID0gcmVnaW9uOwoJCXRoaXMucGFnZUlkID0gcGFnZUlkOwoJfQoKCXRoaXMucGFnZSA9IHRoaXMubW11LmFjY2Vzc1BhZ2UocmVnaW9uLCBwYWdlSWQpOwp9OwoKQVJNQ29yZS5wcm90b3R5cGUubG9hZEluc3RydWN0aW9uQXJtID0gZnVuY3Rpb24oYWRkcmVzcykgewoJdmFyIG5leHQgPSBudWxsOwoJdGhpcy5mZXRjaFBhZ2UoYWRkcmVzcyk7Cgl2YXIgb2Zmc2V0ID0gKGFkZHJlc3MgJiB0aGlzLnBhZ2VNYXNrKSA+PiAyOwoJbmV4dCA9IHRoaXMucGFnZS5hcm1bb2Zmc2V0XTsKCWlmIChuZXh0KSB7CgkJcmV0dXJuIG5leHQ7Cgl9Cgl2YXIgaW5zdHJ1Y3Rpb24gPSB0aGlzLm1tdS5sb2FkMzIoYWRkcmVzcykgPj4+IDA7CgluZXh0ID0gdGhpcy5jb21waWxlQXJtKGluc3RydWN0aW9uKTsKCW5leHQubmV4dCA9IG51bGw7CgluZXh0LnBhZ2UgPSB0aGlzLnBhZ2U7CgluZXh0LmFkZHJlc3MgPSBhZGRyZXNzOwoJbmV4dC5vcGNvZGUgPSBpbnN0cnVjdGlvbjsKCXRoaXMucGFnZS5hcm1bb2Zmc2V0XSA9IG5leHQ7CglyZXR1cm4gbmV4dDsKfTsKCkFSTUNvcmUucHJvdG90eXBlLmxvYWRJbnN0cnVjdGlvblRodW1iID0gZnVuY3Rpb24oYWRkcmVzcykgewoJdmFyIG5leHQgPSBudWxsOwoJdGhpcy5mZXRjaFBhZ2UoYWRkcmVzcyk7Cgl2YXIgb2Zmc2V0ID0gKGFkZHJlc3MgJiB0aGlzLnBhZ2VNYXNrKSA+PiAxOwoJbmV4dCA9IHRoaXMucGFnZS50aHVtYltvZmZzZXRdOwoJaWYgKG5leHQpIHsKCQlyZXR1cm4gbmV4dDsKCX0KCXZhciBpbnN0cnVjdGlvbiA9IHRoaXMubW11LmxvYWQxNihhZGRyZXNzKTsKCW5leHQgPSB0aGlzLmNvbXBpbGVUaHVtYihpbnN0cnVjdGlvbik7CgluZXh0Lm5leHQgPSBudWxsOwoJbmV4dC5wYWdlID0gdGhpcy5wYWdlOwoJbmV4dC5hZGRyZXNzID0gYWRkcmVzczsKCW5leHQub3Bjb2RlID0gaW5zdHJ1Y3Rpb247Cgl0aGlzLnBhZ2UudGh1bWJbb2Zmc2V0XSA9IG5leHQ7CglyZXR1cm4gbmV4dDsKfTsKCkFSTUNvcmUucHJvdG90eXBlLnNlbGVjdEJhbmsgPSBmdW5jdGlvbihtb2RlKSB7Cglzd2l0Y2ggKG1vZGUpIHsKCWNhc2UgdGhpcy5NT0RFX1VTRVI6CgljYXNlIHRoaXMuTU9ERV9TWVNURU06CgkJLy8gTm8gYmFua2VkIHJlZ2lzdGVycwoJCXJldHVybiB0aGlzLkJBTktfTk9ORTsKCWNhc2UgdGhpcy5NT0RFX0ZJUToKCQlyZXR1cm4gdGhpcy5CQU5LX0ZJUTsKCWNhc2UgdGhpcy5NT0RFX0lSUToKCQlyZXR1cm4gdGhpcy5CQU5LX0lSUTsKCWNhc2UgdGhpcy5NT0RFX1NVUEVSVklTT1I6CgkJcmV0dXJuIHRoaXMuQkFOS19TVVBFUlZJU09SOwoJY2FzZSB0aGlzLk1PREVfQUJPUlQ6CgkJcmV0dXJuIHRoaXMuQkFOS19BQk9SVDsKCWNhc2UgdGhpcy5NT0RFX1VOREVGSU5FRDoKCQlyZXR1cm4gdGhpcy5CQU5LX1VOREVGSU5FRDsKCWRlZmF1bHQ6CgkJdGhyb3cgIkludmFsaWQgdXNlciBtb2RlIHBhc3NlZCB0byBzZWxlY3RCYW5rIjsKCX0KfTsKCkFSTUNvcmUucHJvdG90eXBlLnN3aXRjaEV4ZWNNb2RlID0gZnVuY3Rpb24obmV3TW9kZSkgewoJaWYgKHRoaXMuZXhlY01vZGUgIT0gbmV3TW9kZSkgewoJCXRoaXMuZXhlY01vZGUgPSBuZXdNb2RlOwoJCWlmIChuZXdNb2RlID09IHRoaXMuTU9ERV9BUk0pIHsKCQkJdGhpcy5pbnN0cnVjdGlvbldpZHRoID0gdGhpcy5XT1JEX1NJWkVfQVJNOwoJCQl0aGlzLmxvYWRJbnN0cnVjdGlvbiA9IHRoaXMubG9hZEluc3RydWN0aW9uQXJtOwoJCX0gZWxzZSB7CgkJCXRoaXMuaW5zdHJ1Y3Rpb25XaWR0aCA9IHRoaXMuV09SRF9TSVpFX1RIVU1COwoJCQl0aGlzLmxvYWRJbnN0cnVjdGlvbiA9IHRoaXMubG9hZEluc3RydWN0aW9uVGh1bWI7CgkJfQoJfQoJCn07CgpBUk1Db3JlLnByb3RvdHlwZS5zd2l0Y2hNb2RlID0gZnVuY3Rpb24obmV3TW9kZSkgewoJaWYgKG5ld01vZGUgPT0gdGhpcy5tb2RlKSB7CgkJLy8gTm90IHN3aXRjaGluZyBtb2RlcyBhZnRlciBhbGwKCQlyZXR1cm47Cgl9CglpZiAobmV3TW9kZSAhPSB0aGlzLk1PREVfVVNFUiB8fCBuZXdNb2RlICE9IHRoaXMuTU9ERV9TWVNURU0pIHsKCQkvLyBTd2l0Y2ggYmFua2VkIHJlZ2lzdGVycwoJCXZhciBuZXdCYW5rID0gdGhpcy5zZWxlY3RCYW5rKG5ld01vZGUpOwoJCXZhciBvbGRCYW5rID0gdGhpcy5zZWxlY3RCYW5rKHRoaXMubW9kZSk7CgkJaWYgKG5ld0JhbmsgIT0gb2xkQmFuaykgewoJCQkvLyBUT0RPOiBzdXBwb3J0IEZJUQoJCQlpZiAobmV3TW9kZSA9PSB0aGlzLk1PREVfRklRIHx8IHRoaXMubW9kZSA9PSB0aGlzLk1PREVfRklRKSB7CgkJCQl2YXIgb2xkRmlxQmFuayA9IChvbGRCYW5rID09IHRoaXMuQkFOS19GSVEpICsgMDsKCQkJCXZhciBuZXdGaXFCYW5rID0gKG5ld0JhbmsgPT0gdGhpcy5CQU5LX0ZJUSkgKyAwOwoJCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbb2xkRmlxQmFua11bMl0gPSB0aGlzLmdwcnNbOF07CgkJCQl0aGlzLmJhbmtlZFJlZ2lzdGVyc1tvbGRGaXFCYW5rXVszXSA9IHRoaXMuZ3Byc1s5XTsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzW29sZEZpcUJhbmtdWzRdID0gdGhpcy5ncHJzWzEwXTsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzW29sZEZpcUJhbmtdWzVdID0gdGhpcy5ncHJzWzExXTsKCQkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzW29sZEZpcUJhbmtdWzZdID0gdGhpcy5ncHJzWzEyXTsKCQkJCXRoaXMuZ3Byc1s4XSA9IHRoaXMuYmFua2VkUmVnaXN0ZXJzW25ld0ZpcUJhbmtdWzJdOwoJCQkJdGhpcy5ncHJzWzldID0gdGhpcy5iYW5rZWRSZWdpc3RlcnNbbmV3RmlxQmFua11bM107CgkJCQl0aGlzLmdwcnNbMTBdID0gdGhpcy5iYW5rZWRSZWdpc3RlcnNbbmV3RmlxQmFua11bNF07CgkJCQl0aGlzLmdwcnNbMTFdID0gdGhpcy5iYW5rZWRSZWdpc3RlcnNbbmV3RmlxQmFua11bNV07CgkJCQl0aGlzLmdwcnNbMTJdID0gdGhpcy5iYW5rZWRSZWdpc3RlcnNbbmV3RmlxQmFua11bNl07CgkJCX0KCQkJdGhpcy5iYW5rZWRSZWdpc3RlcnNbb2xkQmFua11bMF0gPSB0aGlzLmdwcnNbdGhpcy5TUF07CgkJCXRoaXMuYmFua2VkUmVnaXN0ZXJzW29sZEJhbmtdWzFdID0gdGhpcy5ncHJzW3RoaXMuTFJdOwoJCQl0aGlzLmdwcnNbdGhpcy5TUF0gPSB0aGlzLmJhbmtlZFJlZ2lzdGVyc1tuZXdCYW5rXVswXTsKCQkJdGhpcy5ncHJzW3RoaXMuTFJdID0gdGhpcy5iYW5rZWRSZWdpc3RlcnNbbmV3QmFua11bMV07CgoJCQl0aGlzLmJhbmtlZFNQU1JzW29sZEJhbmtdID0gdGhpcy5zcHNyOwoJCQl0aGlzLnNwc3IgPSB0aGlzLmJhbmtlZFNQU1JzW25ld0JhbmtdOwoJCX0KCX0KCXRoaXMubW9kZSA9IG5ld01vZGU7Cn07CgpBUk1Db3JlLnByb3RvdHlwZS5wYWNrQ1BTUiA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuIHRoaXMubW9kZSB8ICghIXRoaXMuZXhlY01vZGUgPDwgNSkgfCAoISF0aGlzLmNwc3JGIDw8IDYpIHwgKCEhdGhpcy5jcHNySSA8PCA3KSB8CgkgICAgICAgKCEhdGhpcy5jcHNyTiA8PCAzMSkgfCAoISF0aGlzLmNwc3JaIDw8IDMwKSB8ICghIXRoaXMuY3BzckMgPDwgMjkpIHwgKCEhdGhpcy5jcHNyViA8PCAyOCk7Cn07CgpBUk1Db3JlLnByb3RvdHlwZS51bnBhY2tDUFNSID0gZnVuY3Rpb24oc3BzcikgewoJdGhpcy5zd2l0Y2hNb2RlKHNwc3IgJiAweDAwMDAwMDFGKTsKCXRoaXMuc3dpdGNoRXhlY01vZGUoISEoc3BzciAmIDB4MDAwMDAwMjApKTsKCXRoaXMuY3BzckYgPSBzcHNyICYgMHgwMDAwMDA0MDsKCXRoaXMuY3BzckkgPSBzcHNyICYgMHgwMDAwMDA4MDsKCXRoaXMuY3Bzck4gPSBzcHNyICYgMHg4MDAwMDAwMDsKCXRoaXMuY3BzclogPSBzcHNyICYgMHg0MDAwMDAwMDsKCXRoaXMuY3BzckMgPSBzcHNyICYgMHgyMDAwMDAwMDsKCXRoaXMuY3BzclYgPSBzcHNyICYgMHgxMDAwMDAwMDsKCgl0aGlzLmlycS50ZXN0SVJRKCk7Cn07CgpBUk1Db3JlLnByb3RvdHlwZS5oYXNTUFNSID0gZnVuY3Rpb24oKSB7CglyZXR1cm4gdGhpcy5tb2RlICE9IHRoaXMuTU9ERV9TWVNURU0gJiYgdGhpcy5tb2RlICE9IHRoaXMuTU9ERV9VU0VSOwp9OwoKQVJNQ29yZS5wcm90b3R5cGUucmFpc2VJUlEgPSBmdW5jdGlvbigpIHsKCWlmICh0aGlzLmNwc3JJKSB7CgkJcmV0dXJuOwoJfQoJdmFyIGNwc3IgPSB0aGlzLnBhY2tDUFNSKCk7Cgl2YXIgaW5zdHJ1Y3Rpb25XaWR0aCA9IHRoaXMuaW5zdHJ1Y3Rpb25XaWR0aDsKCXRoaXMuc3dpdGNoTW9kZSh0aGlzLk1PREVfSVJRKTsKCXRoaXMuc3BzciA9IGNwc3I7Cgl0aGlzLmdwcnNbdGhpcy5MUl0gPSB0aGlzLmdwcnNbdGhpcy5QQ10gLSBpbnN0cnVjdGlvbldpZHRoICsgNDsKCXRoaXMuZ3Byc1t0aGlzLlBDXSA9IHRoaXMuQkFTRV9JUlEgKyB0aGlzLldPUkRfU0laRV9BUk07Cgl0aGlzLmluc3RydWN0aW9uID0gbnVsbDsKCXRoaXMuc3dpdGNoRXhlY01vZGUodGhpcy5NT0RFX0FSTSk7Cgl0aGlzLmNwc3JJID0gdHJ1ZTsKfTsKCkFSTUNvcmUucHJvdG90eXBlLnJhaXNlVHJhcCA9IGZ1bmN0aW9uKCkgewoJdmFyIGNwc3IgPSB0aGlzLnBhY2tDUFNSKCk7Cgl2YXIgaW5zdHJ1Y3Rpb25XaWR0aCA9IHRoaXMuaW5zdHJ1Y3Rpb25XaWR0aDsKCXRoaXMuc3dpdGNoTW9kZSh0aGlzLk1PREVfU1VQRVJWSVNPUik7Cgl0aGlzLnNwc3IgPSBjcHNyOwoJdGhpcy5ncHJzW3RoaXMuTFJdID0gdGhpcy5ncHJzW3RoaXMuUENdIC0gaW5zdHJ1Y3Rpb25XaWR0aDsKCXRoaXMuZ3Byc1t0aGlzLlBDXSA9IHRoaXMuQkFTRV9TV0kgKyB0aGlzLldPUkRfU0laRV9BUk07Cgl0aGlzLmluc3RydWN0aW9uID0gbnVsbDsKCXRoaXMuc3dpdGNoRXhlY01vZGUodGhpcy5NT0RFX0FSTSk7Cgl0aGlzLmNwc3JJID0gdHJ1ZTsKfTsKCkFSTUNvcmUucHJvdG90eXBlLmJhZE9wID0gZnVuY3Rpb24oaW5zdHJ1Y3Rpb24pIHsKCXZhciBmdW5jID0gZnVuY3Rpb24oKSB7CgkJdGhyb3cgIklsbGVnYWwgaW5zdHJ1Y3Rpb246IDB4IiArIGluc3RydWN0aW9uLnRvU3RyaW5nKDE2KTsKCX07CglmdW5jLndyaXRlc1BDID0gdHJ1ZTsKCWZ1bmMuZml4ZWRKdW1wID0gZmFsc2U7CglyZXR1cm4gZnVuYzsKfTsKCkFSTUNvcmUucHJvdG90eXBlLmdlbmVyYXRlQ29uZHMgPSBmdW5jdGlvbigpIHsKCXZhciBjcHUgPSB0aGlzOwoJdGhpcy5jb25kcyA9IFsKCQkvLyBFUQoJCWZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gY3B1LmNvbmRpdGlvblBhc3NlZCA9IGNwdS5jcHNyWjsKCQl9LAoJCS8vIE5FCgkJZnVuY3Rpb24oKSB7CgkJCXJldHVybiBjcHUuY29uZGl0aW9uUGFzc2VkID0gIWNwdS5jcHNyWjsKCQl9LAoJCS8vIENTCgkJZnVuY3Rpb24oKSB7CgkJCXJldHVybiBjcHUuY29uZGl0aW9uUGFzc2VkID0gY3B1LmNwc3JDOwoJCX0sCgkJLy8gQ0MKCQlmdW5jdGlvbigpIHsKCQkJcmV0dXJuIGNwdS5jb25kaXRpb25QYXNzZWQgPSAhY3B1LmNwc3JDOwoJCX0sCgkJLy8gTUkKCQlmdW5jdGlvbigpIHsKCQkJcmV0dXJuIGNwdS5jb25kaXRpb25QYXNzZWQgPSBjcHUuY3Bzck47CgkJfSwKCQkvLyBQTAoJCWZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gY3B1LmNvbmRpdGlvblBhc3NlZCA9ICFjcHUuY3Bzck47CgkJfSwKCQkvLyBWUwoJCWZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gY3B1LmNvbmRpdGlvblBhc3NlZCA9IGNwdS5jcHNyVjsKCQl9LAoJCS8vIFZDCgkJZnVuY3Rpb24oKSB7CgkJCXJldHVybiBjcHUuY29uZGl0aW9uUGFzc2VkID0gIWNwdS5jcHNyVjsKCQl9LAoJCS8vIEhJCgkJZnVuY3Rpb24gKCkgewoJCQlyZXR1cm4gY3B1LmNvbmRpdGlvblBhc3NlZCA9IGNwdS5jcHNyQyAmJiAhY3B1LmNwc3JaOwoJCX0sCgkJLy8gTFMKCQlmdW5jdGlvbiAoKSB7CgkJCXJldHVybiBjcHUuY29uZGl0aW9uUGFzc2VkID0gIWNwdS5jcHNyQyB8fCBjcHUuY3Bzclo7CgkJfSwKCQkvLyBHRQoJCWZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIGNwdS5jb25kaXRpb25QYXNzZWQgPSAhY3B1LmNwc3JOID09ICFjcHUuY3BzclY7CgkJfSwKCQkvLyBMVAoJCWZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIGNwdS5jb25kaXRpb25QYXNzZWQgPSAhY3B1LmNwc3JOICE9ICFjcHUuY3BzclY7CgkJfSwKCQkvLyBHVAoJCWZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIGNwdS5jb25kaXRpb25QYXNzZWQgPSAhY3B1LmNwc3JaICYmICFjcHUuY3Bzck4gPT0gIWNwdS5jcHNyVjsKCQl9LAoJCS8vIExFCgkJZnVuY3Rpb24gKCkgewoJCQlyZXR1cm4gY3B1LmNvbmRpdGlvblBhc3NlZCA9IGNwdS5jcHNyWiB8fCAhY3B1LmNwc3JOICE9ICFjcHUuY3BzclY7CgkJfSwKCQkvLyBBTAoJCW51bGwsCgkJbnVsbAoJXQp9CgpBUk1Db3JlLnByb3RvdHlwZS5iYXJyZWxTaGlmdEltbWVkaWF0ZSA9IGZ1bmN0aW9uKHNoaWZ0VHlwZSwgaW1tZWRpYXRlLCBybSkgewoJdmFyIGNwdSA9IHRoaXM7Cgl2YXIgZ3BycyA9IHRoaXMuZ3ByczsKCXZhciBzaGlmdE9wID0gdGhpcy5iYWRPcDsKCXN3aXRjaCAoc2hpZnRUeXBlKSB7CgljYXNlIDB4MDAwMDAwMDA6CgkJLy8gTFNMCgkJaWYgKGltbWVkaWF0ZSkgewoJCQlzaGlmdE9wID0gZnVuY3Rpb24oKSB7CgkJCQljcHUuc2hpZnRlck9wZXJhbmQgPSBncHJzW3JtXSA8PCBpbW1lZGlhdGU7CgkJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gZ3Byc1tybV0gJiAoMSA8PCAoMzIgLSBpbW1lZGlhdGUpKTsKCQkJfTsKCQl9IGVsc2UgewoJCQkvLyBUaGlzIGJvaWxzIGRvd24gdG8gbm8gc2hpZnQKCQkJc2hpZnRPcCA9IGZ1bmN0aW9uKCkgewoJCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gZ3Byc1tybV07CgkJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gY3B1LmNwc3JDOwoJCQl9OwoJCX0KCQlicmVhazsKCWNhc2UgMHgwMDAwMDAyMDoKCQkvLyBMU1IKCQlpZiAoaW1tZWRpYXRlKSB7CgkJCXNoaWZ0T3AgPSBmdW5jdGlvbigpIHsKCQkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IGdwcnNbcm1dID4+PiBpbW1lZGlhdGU7CgkJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gZ3Byc1tybV0gJiAoMSA8PCAoaW1tZWRpYXRlIC0gMSkpOwoJCQl9OwoJCX0gZWxzZSB7CgkJCXNoaWZ0T3AgPSBmdW5jdGlvbigpIHsKCQkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IDA7CgkJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gZ3Byc1tybV0gJiAweDgwMDAwMDAwOwoJCQl9OwoJCX0KCQlicmVhazsKCWNhc2UgMHgwMDAwMDA0MDoKCQkvLyBBU1IKCQlpZiAoaW1tZWRpYXRlKSB7CgkJCXNoaWZ0T3AgPSBmdW5jdGlvbigpIHsKCQkJCWNwdS5zaGlmdGVyT3BlcmFuZCA9IGdwcnNbcm1dID4+IGltbWVkaWF0ZTsKCQkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSBncHJzW3JtXSAmICgxIDw8IChpbW1lZGlhdGUgLSAxKSk7CgkJCX07CgkJfSBlbHNlIHsKCQkJc2hpZnRPcCA9IGZ1bmN0aW9uKCkgewoJCQkJY3B1LnNoaWZ0ZXJDYXJyeU91dCA9IGdwcnNbcm1dICYgMHg4MDAwMDAwMDsKCQkJCWlmIChjcHUuc2hpZnRlckNhcnJ5T3V0KSB7CgkJCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gMHhGRkZGRkZGRjsKCQkJCX0gZWxzZSB7CgkJCQkJY3B1LnNoaWZ0ZXJPcGVyYW5kID0gMDsKCQkJCX0KCQkJfTsKCQl9CgkJYnJlYWs7CgljYXNlIDB4MDAwMDAwNjA6CgkJLy8gUk9SCgkJaWYgKGltbWVkaWF0ZSkgewoJCQlzaGlmdE9wID0gZnVuY3Rpb24oKSB7CgkJCQljcHUuc2hpZnRlck9wZXJhbmQgPSAoZ3Byc1tybV0gPj4+IGltbWVkaWF0ZSkgfCAoZ3Byc1tybV0gPDwgKDMyIC0gaW1tZWRpYXRlKSk7CgkJCQljcHUuc2hpZnRlckNhcnJ5T3V0ID0gZ3Byc1tybV0gJiAoMSA8PCAoaW1tZWRpYXRlIC0gMSkpOwoJCQl9OwoJCX0gZWxzZSB7CgkJCS8vIFJSWAoJCQlzaGlmdE9wID0gZnVuY3Rpb24oKSB7CgkJCQljcHUuc2hpZnRlck9wZXJhbmQgPSAoISFjcHUuY3BzckMgPDwgMzEpIHwgKGdwcnNbcm1dID4+PiAxKTsKCQkJCWNwdS5zaGlmdGVyQ2FycnlPdXQgPSAgZ3Byc1tybV0gJiAweDAwMDAwMDAxOwoJCQl9OwoJCX0KCQlicmVhazsKCX0KCXJldHVybiBzaGlmdE9wOwp9CgpBUk1Db3JlLnByb3RvdHlwZS5jb21waWxlQXJtID0gZnVuY3Rpb24oaW5zdHJ1Y3Rpb24pIHsKCXZhciBvcCA9IHRoaXMuYmFkT3AoaW5zdHJ1Y3Rpb24pOwoJdmFyIGkgPSBpbnN0cnVjdGlvbiAmIDB4MEUwMDAwMDA7Cgl2YXIgY3B1ID0gdGhpczsKCXZhciBncHJzID0gdGhpcy5ncHJzOwoKCXZhciBjb25kT3AgPSB0aGlzLmNvbmRzWyhpbnN0cnVjdGlvbiAmIDB4RjAwMDAwMDApID4+PiAyOF07CglpZiAoKGluc3RydWN0aW9uICYgMHgwRkZGRkZGMCkgPT0gMHgwMTJGRkYxMCkgewoJCS8vIEJYCgkJdmFyIHJtID0gaW5zdHJ1Y3Rpb24gJiAweEY7CgkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdEJYKHJtLCBjb25kT3ApOwoJCW9wLndyaXRlc1BDID0gdHJ1ZTsKCQlvcC5maXhlZEp1bXAgPSBmYWxzZTsKCX0gZWxzZSBpZiAoIShpbnN0cnVjdGlvbiAmIDB4MEMwMDAwMDApICYmIChpID09IDB4MDIwMDAwMDAgfHwgKGluc3RydWN0aW9uICYgMHgwMDAwMDA5MCkgIT0gMHgwMDAwMDA5MCkpIHsKCQl2YXIgb3Bjb2RlID0gaW5zdHJ1Y3Rpb24gJiAweDAxRTAwMDAwOwoJCXZhciBzID0gaW5zdHJ1Y3Rpb24gJiAweDAwMTAwMDAwOwoJCXZhciBzaGlmdHNScyA9IGZhbHNlOwoJCWlmICgob3Bjb2RlICYgMHgwMTgwMDAwMCkgPT0gMHgwMTAwMDAwMCAmJiAhcykgewoJCQl2YXIgciA9IGluc3RydWN0aW9uICYgMHgwMDQwMDAwMDsKCQkJaWYgKChpbnN0cnVjdGlvbiAmIDB4MDBCMEYwMDApID09IDB4MDAyMEYwMDApIHsKCQkJCS8vIE1TUgoJCQkJdmFyIHJtID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDAwMDBGOwoJCQkJdmFyIGltbWVkaWF0ZSA9IGluc3RydWN0aW9uICYgMHgwMDAwMDBGRjsKCQkJCXZhciByb3RhdGVJbW0gPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMDAwRjAwKSA+PiA3OwoJCQkJaW1tZWRpYXRlID0gKGltbWVkaWF0ZSA+Pj4gcm90YXRlSW1tKSB8IChpbW1lZGlhdGUgPDwgKDMyIC0gcm90YXRlSW1tKSk7CgkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0TVNSKHJtLCByLCBpbnN0cnVjdGlvbiwgaW1tZWRpYXRlLCBjb25kT3ApOwoJCQkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCQkJfSBlbHNlIGlmICgoaW5zdHJ1Y3Rpb24gJiAweDAwQkYwMDAwKSA9PSAweDAwMEYwMDAwKSB7CgkJCQkvLyBNUlMKCQkJCXZhciByZCA9IChpbnN0cnVjdGlvbiAmIDB4MDAwMEYwMDApID4+IDEyOwoJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdE1SUyhyZCwgciwgY29uZE9wKTsKCQkJCW9wLndyaXRlc1BDID0gcmQgPT0gdGhpcy5QQzsKCQkJfQoJCX0gZWxzZSB7CgkJCS8vIERhdGEgcHJvY2Vzc2luZy9GU1IgdHJhbnNmZXIKCQkJdmFyIHJuID0gKGluc3RydWN0aW9uICYgMHgwMDBGMDAwMCkgPj4gMTY7CgkJCXZhciByZCA9IChpbnN0cnVjdGlvbiAmIDB4MDAwMEYwMDApID4+IDEyOwoKCQkJLy8gUGFyc2Ugc2hpZnRlciBvcGVyYW5kCgkJCXZhciBzaGlmdFR5cGUgPSBpbnN0cnVjdGlvbiAmIDB4MDAwMDAwNjA7CgkJCXZhciBybSA9IGluc3RydWN0aW9uICYgMHgwMDAwMDAwRjsKCQkJdmFyIHNoaWZ0T3AgPSBmdW5jdGlvbigpIHsKCQkJCXRocm93ICdCVUc6IGludmFsaWQgYmFycmVsIHNoaWZ0ZXInOwoJCQl9OwoJCQlpZiAoaW5zdHJ1Y3Rpb24gJiAweDAyMDAwMDAwKSB7CgkJCQl2YXIgaW1tZWRpYXRlID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDAwMEZGOwoJCQkJdmFyIHJvdGF0ZSA9IChpbnN0cnVjdGlvbiAmIDB4MDAwMDBGMDApID4+IDc7CgkJCQlpZiAoIXJvdGF0ZSkgewoJCQkJCXNoaWZ0T3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMUltbWVkaWF0ZShpbW1lZGlhdGUpOwoJCQkJfSBlbHNlIHsKCQkJCQlzaGlmdE9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RBZGRyZXNzaW5nTW9kZTFJbW1lZGlhdGVSb3RhdGUoaW1tZWRpYXRlLCByb3RhdGUpOwoJCQkJfQoJCQl9IGVsc2UgaWYgKGluc3RydWN0aW9uICYgMHgwMDAwMDAxMCkgewoJCQkJdmFyIHJzID0gKGluc3RydWN0aW9uICYgMHgwMDAwMEYwMCkgPj4gODsKCQkJCXNoaWZ0c1JzID0gdHJ1ZTsKCQkJCXN3aXRjaCAoc2hpZnRUeXBlKSB7CgkJCQljYXNlIDB4MDAwMDAwMDA6CgkJCQkJLy8gTFNMCgkJCQkJc2hpZnRPcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGUxTFNMKHJzLCBybSk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDAwMDAwMjA6CgkJCQkJLy8gTFNSCgkJCQkJc2hpZnRPcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGUxTFNSKHJzLCBybSk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDAwMDAwNDA6CgkJCQkJLy8gQVNSCgkJCQkJc2hpZnRPcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGUxQVNSKHJzLCBybSk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDAwMDAwNjA6CgkJCQkJLy8gUk9SCgkJCQkJc2hpZnRPcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGUxUk9SKHJzLCBybSk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwMDAwMEY4MCkgPj4gNzsKCQkJCXNoaWZ0T3AgPSB0aGlzLmJhcnJlbFNoaWZ0SW1tZWRpYXRlKHNoaWZ0VHlwZSwgaW1tZWRpYXRlLCBybSk7CgkJCX0KCgkJCXN3aXRjaCAob3Bjb2RlKSB7CgkJCWNhc2UgMHgwMDAwMDAwMDoKCQkJCS8vIEFORAoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QU5EUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RBTkQocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMDIwMDAwMDoKCQkJCS8vIEVPUgoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0RU9SUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RFT1IocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMDQwMDAwMDoKCQkJCS8vIFNVQgoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0U1VCUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RTVUIocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMDYwMDAwMDoKCQkJCS8vIFJTQgoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0UlNCUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RSU0IocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMDgwMDAwMDoKCQkJCS8vIEFERAoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QUREUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RBREQocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMEEwMDAwMDoKCQkJCS8vIEFEQwoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QURDUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RBREMocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMEMwMDAwMDoKCQkJCS8vIFNCQwoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0U0JDUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RTQkMocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMEUwMDAwMDoKCQkJCS8vIFJTQwoJCQkJaWYgKHMpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0UlNDUyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RSU0MocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMTAwMDAwMDoKCQkJCS8vIFRTVAoJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFRTVChyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQlicmVhazsKCQkJY2FzZSAweDAxMjAwMDAwOgoJCQkJLy8gVEVRCgkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0VEVRKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKTsKCQkJCWJyZWFrOwoJCQljYXNlIDB4MDE0MDAwMDA6CgkJCQkvLyBDTVAKCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RDTVAocmQsIHJuLCBzaGlmdE9wLCBjb25kT3ApOwoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwMTYwMDAwMDoKCQkJCS8vIENNTgoJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdENNTihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQlicmVhazsKCQkJY2FzZSAweDAxODAwMDAwOgoJCQkJLy8gT1JSCgkJCQlpZiAocykgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RPUlJTKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdE9SUihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAweDAxQTAwMDAwOgoJCQkJLy8gTU9WCgkJCQlpZiAocykgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RNT1ZTKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdE1PVihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAweDAxQzAwMDAwOgoJCQkJLy8gQklDCgkJCQlpZiAocykgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RCSUNTKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdEJJQyhyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAweDAxRTAwMDAwOgoJCQkJLy8gTVZOCgkJCQlpZiAocykgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RNVk5TKHJkLCBybiwgc2hpZnRPcCwgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdE1WTihyZCwgcm4sIHNoaWZ0T3AsIGNvbmRPcCk7CgkJCQl9CgkJCQlicmVhazsKCQkJfQoJCQlvcC53cml0ZXNQQyA9IHJkID09IHRoaXMuUEM7CgkJfQoJfSBlbHNlIGlmICgoaW5zdHJ1Y3Rpb24gJiAweDBGQjAwRkYwKSA9PSAweDAxMDAwMDkwKSB7CgkJLy8gU2luZ2xlIGRhdGEgc3dhcAoJCXZhciBybSA9IGluc3RydWN0aW9uICYgMHgwMDAwMDAwRjsKCQl2YXIgcmQgPSAoaW5zdHJ1Y3Rpb24gPj4gMTIpICYgMHgwMDAwMDAwRjsKCQl2YXIgcm4gPSAoaW5zdHJ1Y3Rpb24gPj4gMTYpICYgMHgwMDAwMDAwRjsKCQlpZiAoaW5zdHJ1Y3Rpb24gJiAweDAwNDAwMDAwKSB7CgkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RTV1BCKHJkLCBybiwgcm0sIGNvbmRPcCk7CgkJfSBlbHNlIHsKCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFNXUChyZCwgcm4sIHJtLCBjb25kT3ApOwoJCX0KCQlvcC53cml0ZXNQQyA9IHJkID09IHRoaXMuUEM7Cgl9IGVsc2UgewoJCXN3aXRjaCAoaSkgewoJCWNhc2UgMHgwMDAwMDAwMDoKCQkJaWYgKChpbnN0cnVjdGlvbiAmIDB4MDEwMDAwRjApID09IDB4MDAwMDAwOTApIHsKCQkJCS8vIE11bHRpcGxpZXMKCQkJCXZhciByZCA9IChpbnN0cnVjdGlvbiAmIDB4MDAwRjAwMDApID4+IDE2OwoJCQkJdmFyIHJuID0gKGluc3RydWN0aW9uICYgMHgwMDAwRjAwMCkgPj4gMTI7CgkJCQl2YXIgcnMgPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMDAwRjAwKSA+PiA4OwoJCQkJdmFyIHJtID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDAwMDBGOwoJCQkJc3dpdGNoIChpbnN0cnVjdGlvbiAmIDB4MDBGMDAwMDApIHsKCQkJCWNhc2UgMHgwMDAwMDAwMDoKCQkJCQkvLyBNVUwKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0TVVMKHJkLCBycywgcm0sIGNvbmRPcCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDAxMDAwMDA6CgkJCQkJLy8gTVVMUwoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RNVUxTKHJkLCBycywgcm0sIGNvbmRPcCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDAyMDAwMDA6CgkJCQkJLy8gTUxBCgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdE1MQShyZCwgcm4sIHJzLCBybSwgY29uZE9wKTsKCQkJCQlicmVhawoJCQkJY2FzZSAweDAwMzAwMDAwOgoJCQkJCS8vIE1MQVMKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0TUxBUyhyZCwgcm4sIHJzLCBybSwgY29uZE9wKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHgwMDgwMDAwMDoKCQkJCQkvLyBVTVVMTAoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RVTVVMTChyZCwgcm4sIHJzLCBybSwgY29uZE9wKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHgwMDkwMDAwMDoKCQkJCQkvLyBVTVVMTFMKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0VU1VTExTKHJkLCBybiwgcnMsIHJtLCBjb25kT3ApOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweDAwQTAwMDAwOgoJCQkJCS8vIFVNTEFMCgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFVNTEFMKHJkLCBybiwgcnMsIHJtLCBjb25kT3ApOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAweDAwQjAwMDAwOgoJCQkJCS8vIFVNTEFMUwoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RVTUxBTFMocmQsIHJuLCBycywgcm0sIGNvbmRPcCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDBDMDAwMDA6CgkJCQkJLy8gU01VTEwKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0U01VTEwocmQsIHJuLCBycywgcm0sIGNvbmRPcCk7CgkJCQkJYnJlYWs7CgkJCQljYXNlIDB4MDBEMDAwMDA6CgkJCQkJLy8gU01VTExTCgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFNNVUxMUyhyZCwgcm4sIHJzLCBybSwgY29uZE9wKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHgwMEUwMDAwMDoKCQkJCQkvLyBTTUxBTAoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RTTUxBTChyZCwgcm4sIHJzLCBybSwgY29uZE9wKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgMHgwMEYwMDAwMDoKCQkJCQkvLyBTTUxBTFMKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0U01MQUxTKHJkLCBybiwgcnMsIHJtLCBjb25kT3ApOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJb3Aud3JpdGVzUEMgPSByZCA9PSB0aGlzLlBDOwoJCQl9IGVsc2UgewoJCQkJLy8gSGFsZndvcmQgYW5kIHNpZ25lZCBieXRlIGRhdGEgdHJhbnNmZXIKCQkJCXZhciBsb2FkID0gaW5zdHJ1Y3Rpb24gJiAweDAwMTAwMDAwOwoJCQkJdmFyIHJkID0gKGluc3RydWN0aW9uICYgMHgwMDAwRjAwMCkgPj4gMTI7CgkJCQl2YXIgaGlPZmZzZXQgPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMDAwRjAwKSA+PiA0OwoJCQkJdmFyIGxvT2Zmc2V0ID0gcm0gPSBpbnN0cnVjdGlvbiAmIDB4MDAwMDAwMEY7CgkJCQl2YXIgaCA9IGluc3RydWN0aW9uICYgMHgwMDAwMDAyMDsKCQkJCXZhciBzID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDAwMDQwOwoJCQkJdmFyIHcgPSBpbnN0cnVjdGlvbiAmIDB4MDAyMDAwMDA7CgkJCQl2YXIgaSA9IGluc3RydWN0aW9uICYgMHgwMDQwMDAwMDsKCgkJCQl2YXIgYWRkcmVzczsKCQkJCWlmIChpKSB7CgkJCQkJdmFyIGltbWVkaWF0ZSA9IGxvT2Zmc2V0IHwgaGlPZmZzZXQ7CgkJCQkJYWRkcmVzcyA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGUyM0ltbWVkaWF0ZShpbnN0cnVjdGlvbiwgaW1tZWRpYXRlLCBjb25kT3ApOwoJCQkJfSBlbHNlIHsKCQkJCQlhZGRyZXNzID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RBZGRyZXNzaW5nTW9kZTIzUmVnaXN0ZXIoaW5zdHJ1Y3Rpb24sIHJtLCBjb25kT3ApOwoJCQkJfQoJCQkJYWRkcmVzcy53cml0ZXNQQyA9ICEhdyAmJiBybiA9PSB0aGlzLlBDOwoKCQkJCWlmICgoaW5zdHJ1Y3Rpb24gJiAweDAwMDAwMDkwKSA9PSAweDAwMDAwMDkwKSB7CgkJCQkJaWYgKGxvYWQpIHsKCQkJCQkJLy8gTG9hZCBbc2lnbmVkXSBoYWxmd29yZC9ieXRlCgkJCQkJCWlmIChoKSB7CgkJCQkJCQlpZiAocykgewoJCQkJCQkJCS8vIExEUlNICgkJCQkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdExEUlNIKHJkLCBhZGRyZXNzLCBjb25kT3ApOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkvLyBMRFJICgkJCQkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdExEUkgocmQsIGFkZHJlc3MsIGNvbmRPcCk7CgkJCQkJCQl9CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlpZiAocykgewoJCQkJCQkJCS8vIExEUlNCCgkJCQkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdExEUlNCKHJkLCBhZGRyZXNzLCBjb25kT3ApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfSBlbHNlIGlmICghcyAmJiBoKSB7CgkJCQkJCS8vIFNUUkgKCQkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFNUUkgocmQsIGFkZHJlc3MsIGNvbmRPcCk7CgkJCQkJfQoJCQkJfQoJCQkJb3Aud3JpdGVzUEMgPSByZCA9PSB0aGlzLlBDIHx8IGFkZHJlc3Mud3JpdGVzUEM7CgkJCX0KCQkJYnJlYWs7CgkJY2FzZSAweDA0MDAwMDAwOgoJCWNhc2UgMHgwNjAwMDAwMDoKCQkJLy8gTERSL1NUUgoJCQl2YXIgcmQgPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMDBGMDAwKSA+PiAxMjsKCQkJdmFyIGxvYWQgPSBpbnN0cnVjdGlvbiAmIDB4MDAxMDAwMDA7CgkJCXZhciBiID0gaW5zdHJ1Y3Rpb24gJiAweDAwNDAwMDAwOwoJCQl2YXIgaSA9IGluc3RydWN0aW9uICYgMHgwMjAwMDAwMDsKCgkJCXZhciBhZGRyZXNzID0gZnVuY3Rpb24oKSB7CgkJCQl0aHJvdyAiVW5pbXBsZW1lbnRlZCBtZW1vcnkgYWNjZXNzOiAweCIgKyBpbnN0cnVjdGlvbi50b1N0cmluZygxNik7CgkJCX07CgkJCWlmICh+aW5zdHJ1Y3Rpb24gJiAweDAxMDAwMDAwKSB7CgkJCQkvLyBDbGVhciB0aGUgVyBiaXQgaWYgdGhlIFAgYml0IGlzIGNsZWFyLS13ZSBkb24ndCBzdXBwb3J0IG1lbW9yeSB0cmFuc2xhdGlvbiwgc28gdGhlc2UgdHVybiBpbnRvIHJlZ3VsYXIgYWNjZXNzZXMKCQkJCWluc3RydWN0aW9uICY9IDB4RkZERkZGRkY7CgkJCX0KCQkJaWYgKGkpIHsKCQkJCS8vIFJlZ2lzdGVyIG9mZnNldAoJCQkJdmFyIHJtID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDAwMDBGOwoJCQkJdmFyIHNoaWZ0VHlwZSA9IGluc3RydWN0aW9uICYgMHgwMDAwMDA2MDsKCQkJCXZhciBzaGlmdEltbWVkaWF0ZSA9IChpbnN0cnVjdGlvbiAmIDB4MDAwMDBGODApID4+IDc7CgkJCQkKCQkJCWlmIChzaGlmdFR5cGUgfHwgc2hpZnRJbW1lZGlhdGUpIHsKCQkJCQl2YXIgc2hpZnRPcCA9IHRoaXMuYmFycmVsU2hpZnRJbW1lZGlhdGUoc2hpZnRUeXBlLCBzaGlmdEltbWVkaWF0ZSwgcm0pOwoJCQkJCWFkZHJlc3MgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMlJlZ2lzdGVyU2hpZnRlZChpbnN0cnVjdGlvbiwgc2hpZnRPcCwgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJYWRkcmVzcyA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGUyM1JlZ2lzdGVyKGluc3RydWN0aW9uLCBybSwgY29uZE9wKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCS8vIEltbWVkaWF0ZQoJCQkJdmFyIG9mZnNldCA9IGluc3RydWN0aW9uICYgMHgwMDAwMEZGRjsKCQkJCWFkZHJlc3MgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdEFkZHJlc3NpbmdNb2RlMjNJbW1lZGlhdGUoaW5zdHJ1Y3Rpb24sIG9mZnNldCwgY29uZE9wKTsKCQkJfQoJCQlpZiAobG9hZCkgewoJCQkJaWYgKGIpIHsKCQkJCQkvLyBMRFJCCgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdExEUkIocmQsIGFkZHJlc3MsIGNvbmRPcCk7CgkJCQl9IGVsc2UgewoJCQkJCS8vIExEUgoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RMRFIocmQsIGFkZHJlc3MsIGNvbmRPcCk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQlpZiAoYikgewoJCQkJCS8vIFNUUkIKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0U1RSQihyZCwgYWRkcmVzcywgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJLy8gU1RSCgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFNUUihyZCwgYWRkcmVzcywgY29uZE9wKTsKCQkJCX0KCQkJfQoJCQlvcC53cml0ZXNQQyA9IHJkID09IHRoaXMuUEMgfHwgYWRkcmVzcy53cml0ZXNQQzsKCQkJYnJlYWs7CgkJY2FzZSAweDA4MDAwMDAwOgoJCQkvLyBCbG9jayBkYXRhIHRyYW5zZmVyCgkJCXZhciBsb2FkID0gaW5zdHJ1Y3Rpb24gJiAweDAwMTAwMDAwOwoJCQl2YXIgdyA9IGluc3RydWN0aW9uICYgMHgwMDIwMDAwMDsKCQkJdmFyIHVzZXIgPSBpbnN0cnVjdGlvbiAmIDB4MDA0MDAwMDA7CgkJCXZhciB1ID0gaW5zdHJ1Y3Rpb24gJiAweDAwODAwMDAwOwoJCQl2YXIgcCA9IGluc3RydWN0aW9uICYgMHgwMTAwMDAwMDsKCQkJdmFyIHJzID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDBGRkZGOwoJCQl2YXIgcm4gPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMEYwMDAwKSA+PiAxNjsKCgkJCXZhciBhZGRyZXNzOwoJCQl2YXIgaW1tZWRpYXRlID0gMDsKCQkJdmFyIG9mZnNldCA9IDA7CgkJCXZhciBvdmVybGFwID0gZmFsc2U7CgkJCWlmICh1KSB7CgkJCQlpZiAocCkgewoJCQkJCWltbWVkaWF0ZSA9IDQ7CgkJCQl9CgkJCQlmb3IgKHZhciBtID0gMHgwMSwgaSA9IDA7IGkgPCAxNjsgbSA8PD0gMSwgKytpKSB7CgkJCQkJaWYgKHJzICYgbSkgewoJCQkJCQlpZiAodyAmJiBpID09IHJuICYmICFvZmZzZXQpIHsKCQkJCQkJCXJzICY9IH5tOwoJCQkJCQkJaW1tZWRpYXRlICs9IDQ7CgkJCQkJCQlvdmVybGFwID0gdHJ1ZTsKCQkJCQkJfQoJCQkJCQlvZmZzZXQgKz0gNDsKCQkJCQl9CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQlpZiAoIXApIHsKCQkJCQlpbW1lZGlhdGUgPSA0OwoJCQkJfQoJCQkJZm9yICh2YXIgbSA9IDB4MDEsIGkgPSAwOyBpIDwgMTY7IG0gPDw9IDEsICsraSkgewoJCQkJCWlmIChycyAmIG0pIHsKCQkJCQkJaWYgKHcgJiYgaSA9PSBybiAmJiAhb2Zmc2V0KSB7CgkJCQkJCQlycyAmPSB+bTsKCQkJCQkJCWltbWVkaWF0ZSArPSA0OwoJCQkJCQkJb3ZlcmxhcCA9IHRydWU7CgkJCQkJCX0KCQkJCQkJaW1tZWRpYXRlIC09IDQ7CgkJCQkJCW9mZnNldCAtPSA0OwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlpZiAodykgewoJCQkJYWRkcmVzcyA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QWRkcmVzc2luZ01vZGU0V3JpdGViYWNrKGltbWVkaWF0ZSwgb2Zmc2V0LCBybiwgb3ZlcmxhcCk7CgkJCX0gZWxzZSB7CgkJCQlhZGRyZXNzID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RBZGRyZXNzaW5nTW9kZTQoaW1tZWRpYXRlLCBybik7CgkJCX0KCQkJaWYgKGxvYWQpIHsKCQkJCS8vIExETQoJCQkJaWYgKHVzZXIpIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0TERNUyhycywgYWRkcmVzcywgY29uZE9wKTsKCQkJCX0gZWxzZSB7CgkJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdExETShycywgYWRkcmVzcywgY29uZE9wKTsKCQkJCX0KCQkJCW9wLndyaXRlc1BDID0gISEocnMgJiAoMSA8PCAxNSkpOwoJCQl9IGVsc2UgewoJCQkJLy8gU1RNCgkJCQlpZiAodXNlcikgewoJCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RTVE1TKHJzLCBhZGRyZXNzLCBjb25kT3ApOwoJCQkJfSBlbHNlIHsKCQkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0U1RNKHJzLCBhZGRyZXNzLCBjb25kT3ApOwoJCQkJfQoJCQkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCQkJfQoJCQlicmVhazsKCQljYXNlIDB4MEEwMDAwMDA6CgkJCS8vIEJyYW5jaAoJCQl2YXIgaW1tZWRpYXRlID0gaW5zdHJ1Y3Rpb24gJiAweDAwRkZGRkZGOwoJCQlpZiAoaW1tZWRpYXRlICYgMHgwMDgwMDAwMCkgewoJCQkJaW1tZWRpYXRlIHw9IDB4RkYwMDAwMDA7CgkJCX0KCQkJaW1tZWRpYXRlIDw8PSAyOwoJCQl2YXIgbGluayA9IGluc3RydWN0aW9uICYgMHgwMTAwMDAwMDsKCQkJaWYgKGxpbmspIHsKCQkJCW9wID0gdGhpcy5hcm1Db21waWxlci5jb25zdHJ1Y3RCTChpbW1lZGlhdGUsIGNvbmRPcCk7CgkJCX0gZWxzZSB7CgkJCQlvcCA9IHRoaXMuYXJtQ29tcGlsZXIuY29uc3RydWN0QihpbW1lZGlhdGUsIGNvbmRPcCk7CgkJCX0KCQkJb3Aud3JpdGVzUEMgPSB0cnVlOwoJCQlvcC5maXhlZEp1bXAgPSB0cnVlOwoJCQlicmVhazsKCQljYXNlIDB4MEMwMDAwMDA6CgkJCS8vIENvcHJvY2Vzc29yIGRhdGEgdHJhbnNmZXIKCQkJYnJlYWs7CgkJY2FzZSAweDBFMDAwMDAwOgoJCQkvLyBDb3Byb2Nlc3NvciBkYXRhIG9wZXJhdGlvbi9TV0kKCQkJaWYgKChpbnN0cnVjdGlvbiAmIDB4MEYwMDAwMDApID09IDB4MEYwMDAwMDApIHsKCQkJCS8vIFNXSQoJCQkJdmFyIGltbWVkaWF0ZSA9IChpbnN0cnVjdGlvbiAmIDB4MDBGRkZGRkYpOwoJCQkJb3AgPSB0aGlzLmFybUNvbXBpbGVyLmNvbnN0cnVjdFNXSShpbW1lZGlhdGUsIGNvbmRPcCk7CgkJCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJCQl9CgkJCWJyZWFrOwoJCWRlZmF1bHQ6CgkJCXRocm93ICdCYWQgb3Bjb2RlOiAweCcgKyBpbnN0cnVjdGlvbi50b1N0cmluZygxNik7CgkJfQoJfQoKCW9wLmV4ZWNNb2RlID0gdGhpcy5NT0RFX0FSTTsKCW9wLmZpeGVkSnVtcCA9IG9wLmZpeGVkSnVtcCB8fCBmYWxzZTsKCXJldHVybiBvcDsKfTsKCkFSTUNvcmUucHJvdG90eXBlLmNvbXBpbGVUaHVtYiA9IGZ1bmN0aW9uKGluc3RydWN0aW9uKSB7Cgl2YXIgb3AgPSB0aGlzLmJhZE9wKGluc3RydWN0aW9uICYgMHhGRkZGKTsKCXZhciBjcHUgPSB0aGlzOwoJdmFyIGdwcnMgPSB0aGlzLmdwcnM7CglpZiAoKGluc3RydWN0aW9uICYgMHhGQzAwKSA9PSAweDQwMDApIHsKCQkvLyBEYXRhLXByb2Nlc3NpbmcgcmVnaXN0ZXIKCQl2YXIgcm0gPSAoaW5zdHJ1Y3Rpb24gJiAweDAwMzgpID4+IDM7CgkJdmFyIHJkID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDc7CgkJc3dpdGNoIChpbnN0cnVjdGlvbiAmIDB4MDNDMCkgewoJCWNhc2UgMHgwMDAwOgoJCQkvLyBBTkQKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0QU5EKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMDQwOgoJCQkvLyBFT1IKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0RU9SKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMDgwOgoJCQkvLyBMU0woMikKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0TFNMMihyZCwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDBDMDoKCQkJLy8gTFNSKDIpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExTUjIocmQsIHJtKTsKCQkJYnJlYWs7CgkJY2FzZSAweDAxMDA6CgkJCS8vIEFTUigyKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RBU1IyKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMTQwOgoJCQkvLyBBREMKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0QURDKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMTgwOgoJCQkvLyBTQkMKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0U0JDKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMUMwOgoJCQkvLyBST1IKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0Uk9SKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMjAwOgoJCQkvLyBUU1QKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0VFNUKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMjQwOgoJCQkvLyBORUcKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0TkVHKHJkLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMjgwOgoJCQkvLyBDTVAoMikKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0Q01QMihyZCwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDJDMDoKCQkJLy8gQ01OCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdENNTihyZCwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDMwMDoKCQkJLy8gT1JSCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdE9SUihyZCwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDM0MDoKCQkJLy8gTVVMCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdE1VTChyZCwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDM4MDoKCQkJLy8gQklDCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdEJJQyhyZCwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDNDMDoKCQkJLy8gTVZOCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdE1WTihyZCwgcm0pOwoJCQlicmVhazsKCQl9CgkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCX0gZWxzZSBpZiAoKGluc3RydWN0aW9uICYgMHhGQzAwKSA9PSAweDQ0MDApIHsKCQkvLyBTcGVjaWFsIGRhdGEgcHJvY2Vzc2luZyAvIGJyYW5jaC9leGNoYW5nZSBpbnN0cnVjdGlvbiBzZXQKCQl2YXIgcm0gPSAoaW5zdHJ1Y3Rpb24gJiAweDAwNzgpID4+IDM7CgkJdmFyIHJuID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDc7CgkJdmFyIGgxID0gaW5zdHJ1Y3Rpb24gJiAweDAwODA7CgkJdmFyIHJkID0gcm4gfCAoaDEgPj4gNCk7CgkJc3dpdGNoIChpbnN0cnVjdGlvbiAmIDB4MDMwMCkgewoJCWNhc2UgMHgwMDAwOgoJCQkvLyBBREQoNCkKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0QURENChyZCwgcm0pCgkJCW9wLndyaXRlc1BDID0gcmQgPT0gdGhpcy5QQzsKCQkJYnJlYWs7CgkJY2FzZSAweDAxMDA6CgkJCS8vIENNUCgzKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RDTVAzKHJkLCBybSk7CgkJCW9wLndyaXRlc1BDID0gZmFsc2U7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMjAwOgoJCQkvLyBNT1YoMykKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0TU9WMyhyZCwgcm0pOwoJCQlvcC53cml0ZXNQQyA9IHJkID09IHRoaXMuUEM7CgkJCWJyZWFrOwoJCWNhc2UgMHgwMzAwOgoJCQkvLyBCWAoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RCWChyZCwgcm0pOwoJCQlvcC53cml0ZXNQQyA9IHRydWU7CgkJCW9wLmZpeGVkSnVtcCA9IGZhbHNlOwoJCQlicmVhazsKCQl9Cgl9IGVsc2UgaWYgKChpbnN0cnVjdGlvbiAmIDB4RjgwMCkgPT0gMHgxODAwKSB7CgkJLy8gQWRkL3N1YnRyYWN0CgkJdmFyIHJtID0gKGluc3RydWN0aW9uICYgMHgwMUMwKSA+PiA2OwoJCXZhciBybiA9IChpbnN0cnVjdGlvbiAmIDB4MDAzOCkgPj4gMzsKCQl2YXIgcmQgPSBpbnN0cnVjdGlvbiAmIDB4MDAwNzsKCQlzd2l0Y2ggKGluc3RydWN0aW9uICYgMHgwNjAwKSB7CgkJY2FzZSAweDAwMDA6CgkJCS8vIEFERCgzKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RBREQzKHJkLCBybiwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDIwMDoKCQkJLy8gU1VCKDMpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdFNVQjMocmQsIHJuLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwNDAwOgoJCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwMUMwKSA+PiA2OwoJCQlpZiAoaW1tZWRpYXRlKSB7CgkJCQkvLyBBREQoMSkKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdEFERDEocmQsIHJuLCBpbW1lZGlhdGUpOwoJCQl9IGVsc2UgewoJCQkJLy8gTU9WKDIpCgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RNT1YyKHJkLCBybiwgcm0pOwoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgMHgwNjAwOgoJCQkvLyBTVUIoMSkKCQkJdmFyIGltbWVkaWF0ZSA9IChpbnN0cnVjdGlvbiAmIDB4MDFDMCkgPj4gNjsKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0U1VCMShyZCwgcm4sIGltbWVkaWF0ZSk7CgkJCWJyZWFrOwoJCX0KCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJfSBlbHNlIGlmICghKGluc3RydWN0aW9uICYgMHhFMDAwKSkgewoJCS8vIFNoaWZ0IGJ5IGltbWVkaWF0ZQoJCXZhciByZCA9IGluc3RydWN0aW9uICYgMHgwMDA3OwoJCXZhciBybSA9IChpbnN0cnVjdGlvbiAmIDB4MDAzOCkgPj4gMzsKCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwN0MwKSA+PiA2OwoJCXN3aXRjaCAoaW5zdHJ1Y3Rpb24gJiAweDE4MDApIHsKCQljYXNlIDB4MDAwMDoKCQkJLy8gTFNMKDEpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExTTDEocmQsIHJtLCBpbW1lZGlhdGUpOwoJCQlicmVhazsKCQljYXNlIDB4MDgwMDoKCQkJLy8gTFNSKDEpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExTUjEocmQsIHJtLCBpbW1lZGlhdGUpOwoJCQlicmVhazsKCQljYXNlIDB4MTAwMDoKCQkJLy8gQVNSKDEpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdEFTUjEocmQsIHJtLCBpbW1lZGlhdGUpOwoJCQlicmVhazsKCQljYXNlIDB4MTgwMDoKCQkJYnJlYWs7CgkJfQoJCW9wLndyaXRlc1BDID0gZmFsc2U7Cgl9IGVsc2UgaWYgKChpbnN0cnVjdGlvbiAmIDB4RTAwMCkgPT0gMHgyMDAwKSB7CgkJLy8gQWRkL3N1YnRyYWN0L2NvbXBhcmUvbW92ZSBpbW1lZGlhdGUKCQl2YXIgaW1tZWRpYXRlID0gaW5zdHJ1Y3Rpb24gJiAweDAwRkY7CgkJdmFyIHJuID0gKGluc3RydWN0aW9uICYgMHgwNzAwKSA+PiA4OwoJCXN3aXRjaCAoaW5zdHJ1Y3Rpb24gJiAweDE4MDApIHsKCQljYXNlIDB4MDAwMDoKCQkJLy8gTU9WKDEpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdE1PVjEocm4sIGltbWVkaWF0ZSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwODAwOgoJCQkvLyBDTVAoMSkKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0Q01QMShybiwgaW1tZWRpYXRlKTsKCQkJYnJlYWs7CgkJY2FzZSAweDEwMDA6CgkJCS8vIEFERCgyKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RBREQyKHJuLCBpbW1lZGlhdGUpOwoJCQlicmVhazsKCQljYXNlIDB4MTgwMDoKCQkJLy8gU1VCKDIpCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdFNVQjIocm4sIGltbWVkaWF0ZSk7CgkJCWJyZWFrOwoJCX0KCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJfSBlbHNlIGlmICgoaW5zdHJ1Y3Rpb24gJiAweEY4MDApID09IDB4NDgwMCkgewoJCS8vIExEUigzKQoJCXZhciByZCA9IChpbnN0cnVjdGlvbiAmIDB4MDcwMCkgPj4gODsKCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwMEZGKSA8PCAyOwoJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExEUjMocmQsIGltbWVkaWF0ZSk7CgkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCX0gZWxzZSBpZiAoKGluc3RydWN0aW9uICYgMHhGMDAwKSA9PSAweDUwMDApIHsKCQkvLyBMb2FkIGFuZCBzdG9yZSB3aXRoIHJlbGF0aXZlIG9mZnNldAoJCXZhciByZCA9IGluc3RydWN0aW9uICYgMHgwMDA3OwoJCXZhciBybiA9IChpbnN0cnVjdGlvbiAmIDB4MDAzOCkgPj4gMzsKCQl2YXIgcm0gPSAoaW5zdHJ1Y3Rpb24gJiAweDAxQzApID4+IDY7CgkJdmFyIG9wY29kZSA9IGluc3RydWN0aW9uICYgMHgwRTAwOwoJCXN3aXRjaCAob3Bjb2RlKSB7CgkJY2FzZSAweDAwMDA6CgkJCS8vIFNUUigyKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RTVFIyKHJkLCBybiwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MDIwMDoKCQkJLy8gU1RSSCgyKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RTVFJIMihyZCwgcm4sIHJtKTsKCQkJYnJlYWs7CgkJY2FzZSAweDA0MDA6CgkJCS8vIFNUUkIoMikKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0U1RSQjIocmQsIHJuLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwNjAwOgoJCQkvLyBMRFJTQgoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RMRFJTQihyZCwgcm4sIHJtKTsKCQkJYnJlYWs7CgkJY2FzZSAweDA4MDA6CgkJCS8vIExEUigyKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RMRFIyKHJkLCBybiwgcm0pOwoJCQlicmVhazsKCQljYXNlIDB4MEEwMDoKCQkJLy8gTERSSCgyKQoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RMRFJIMihyZCwgcm4sIHJtKTsKCQkJYnJlYWs7CgkJY2FzZSAweDBDMDA6CgkJCS8vIExEUkIoMikKCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0TERSQjIocmQsIHJuLCBybSk7CgkJCWJyZWFrOwoJCWNhc2UgMHgwRTAwOgoJCQkvLyBMRFJTSAoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RMRFJTSChyZCwgcm4sIHJtKTsKCQkJYnJlYWs7CgkJfQoJCW9wLndyaXRlc1BDID0gZmFsc2U7Cgl9IGVsc2UgaWYgKChpbnN0cnVjdGlvbiAmIDB4RTAwMCkgPT0gMHg2MDAwKSB7CgkJLy8gTG9hZCBhbmQgc3RvcmUgd2l0aCBpbW1lZGlhdGUgb2Zmc2V0CgkJdmFyIHJkID0gaW5zdHJ1Y3Rpb24gJiAweDAwMDc7CgkJdmFyIHJuID0gKGluc3RydWN0aW9uICYgMHgwMDM4KSA+PiAzOwoJCXZhciBpbW1lZGlhdGUgPSAoaW5zdHJ1Y3Rpb24gJiAweDA3QzApID4+IDQ7CgkJdmFyIGIgPSBpbnN0cnVjdGlvbiAmIDB4MTAwMDsKCQlpZiAoYikgewoJCQlpbW1lZGlhdGUgPj49IDI7CgkJfQoJCXZhciBsb2FkID0gaW5zdHJ1Y3Rpb24gJiAweDA4MDA7CgkJaWYgKGxvYWQpIHsKCQkJaWYgKGIpIHsKCQkJCS8vIExEUkIoMSkKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExEUkIxKHJkLCBybiwgaW1tZWRpYXRlKTsKCQkJfSBlbHNlIHsKCQkJCS8vIExEUigxKQoJCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0TERSMShyZCwgcm4sIGltbWVkaWF0ZSk7CgkJCX0KCQl9IGVsc2UgewoJCQlpZiAoYikgewoJCQkJLy8gU1RSQigxKQoJCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0U1RSQjEocmQsIHJuLCBpbW1lZGlhdGUpOwoJCQl9IGVsc2UgewoJCQkJLy8gU1RSKDEpCgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RTVFIxKHJkLCBybiwgaW1tZWRpYXRlKTsKCQkJfQoJCX0KCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJfSBlbHNlIGlmICgoaW5zdHJ1Y3Rpb24gJiAweEY2MDApID09IDB4QjQwMCkgewoJCS8vIFB1c2ggYW5kIHBvcCByZWdpc3RlcnMKCQl2YXIgciA9ICEhKGluc3RydWN0aW9uICYgMHgwMTAwKTsKCQl2YXIgcnMgPSBpbnN0cnVjdGlvbiAmIDB4MDBGRjsKCQlpZiAoaW5zdHJ1Y3Rpb24gJiAweDA4MDApIHsKCQkJLy8gUE9QCgkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdFBPUChycywgcik7CgkJCW9wLndyaXRlc1BDID0gcjsKCQkJb3AuZml4ZWRKdW1wID0gZmFsc2U7CgkJfSBlbHNlIHsKCQkJLy8gUFVTSAoJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RQVVNIKHJzLCByKTsKCQkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCQl9Cgl9IGVsc2UgaWYgKGluc3RydWN0aW9uICYgMHg4MDAwKSB7CgkJc3dpdGNoIChpbnN0cnVjdGlvbiAmIDB4NzAwMCkgewoJCWNhc2UgMHgwMDAwOgoJCQkvLyBMb2FkIGFuZCBzdG9yZSBoYWxmd29yZAoJCQl2YXIgcmQgPSBpbnN0cnVjdGlvbiAmIDB4MDAwNzsKCQkJdmFyIHJuID0gKGluc3RydWN0aW9uICYgMHgwMDM4KSA+PiAzOwoJCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwN0MwKSA+PiA1OwoJCQlpZiAoaW5zdHJ1Y3Rpb24gJiAweDA4MDApIHsKCQkJCS8vIExEUkgoMSkKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExEUkgxKHJkLCBybiwgaW1tZWRpYXRlKTsKCQkJfSBlbHNlIHsKCQkJCS8vIFNUUkgoMSkKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdFNUUkgxKHJkLCBybiwgaW1tZWRpYXRlKTsKCQkJfQoJCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJCQlicmVhazsKCQljYXNlIDB4MTAwMDoKCQkJLy8gU1AtcmVsYXRpdmUgbG9hZCBhbmQgc3RvcmUKCQkJdmFyIHJkID0gKGluc3RydWN0aW9uICYgMHgwNzAwKSA+PiA4OwoJCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwMEZGKSA8PCAyOwoJCQl2YXIgbG9hZCA9IGluc3RydWN0aW9uICYgMHgwODAwOwoJCQlpZiAobG9hZCkgewoJCQkJLy8gTERSKDQpCgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RMRFI0KHJkLCBpbW1lZGlhdGUpOwoJCQl9IGVsc2UgewoJCQkJLy8gU1RSKDMpCgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RTVFIzKHJkLCBpbW1lZGlhdGUpOwoJCQl9CgkJCW9wLndyaXRlc1BDID0gZmFsc2U7CgkJCWJyZWFrOwoJCWNhc2UgMHgyMDAwOgoJCQkvLyBMb2FkIGFkZHJlc3MKCQkJdmFyIHJkID0gKGluc3RydWN0aW9uICYgMHgwNzAwKSA+PiA4OwoJCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwMEZGKSA8PCAyOwoJCQlpZiAoaW5zdHJ1Y3Rpb24gJiAweDA4MDApIHsKCQkJCS8vIEFERCg2KQoJCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0QURENihyZCwgaW1tZWRpYXRlKTsKCQkJfSBlbHNlIHsKCQkJCS8vIEFERCg1KQoJCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0QURENShyZCwgaW1tZWRpYXRlKTsKCQkJfQoJCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJCQlicmVhazsKCQljYXNlIDB4MzAwMDoKCQkJLy8gTWlzY2VsbGFuZW91cwoJCQlpZiAoIShpbnN0cnVjdGlvbiAmIDB4MEYwMCkpIHsKCQkJCS8vIEFkanVzdCBzdGFjayBwb2ludGVyCgkJCQkvLyBBREQoNykvU1VCKDQpCgkJCQl2YXIgYiA9IGluc3RydWN0aW9uICYgMHgwMDgwOwoJCQkJdmFyIGltbWVkaWF0ZSA9IChpbnN0cnVjdGlvbiAmIDB4N0YpIDw8IDI7CgkJCQlpZiAoYikgewoJCQkJCWltbWVkaWF0ZSA9IC1pbW1lZGlhdGU7CgkJCQl9CgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RBREQ3KGltbWVkaWF0ZSkKCQkJCW9wLndyaXRlc1BDID0gZmFsc2U7CgkJCX0KCQkJYnJlYWs7CgkJY2FzZSAweDQwMDA6CgkJCS8vIE11bHRpcGxlIGxvYWQgYW5kIHN0b3JlCgkJCXZhciBybiA9IChpbnN0cnVjdGlvbiAmIDB4MDcwMCkgPj4gODsKCQkJdmFyIHJzID0gaW5zdHJ1Y3Rpb24gJiAweDAwRkY7CgkJCWlmIChpbnN0cnVjdGlvbiAmIDB4MDgwMCkgewoJCQkJLy8gTERNSUEKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdExETUlBKHJuLCBycyk7CgkJCX0gZWxzZSB7CgkJCQkvLyBTVE1JQQoJCQkJb3AgPSB0aGlzLnRodW1iQ29tcGlsZXIuY29uc3RydWN0U1RNSUEocm4sIHJzKTsKCQkJfQoJCQlvcC53cml0ZXNQQyA9IGZhbHNlOwoJCQlicmVhazsKCQljYXNlIDB4NTAwMDoKCQkJLy8gQ29uZGl0aW9uYWwgYnJhbmNoCgkJCXZhciBjb25kID0gKGluc3RydWN0aW9uICYgMHgwRjAwKSA+PiA4OwoJCQl2YXIgaW1tZWRpYXRlID0gKGluc3RydWN0aW9uICYgMHgwMEZGKTsKCQkJaWYgKGNvbmQgPT0gMHhGKSB7CgkJCQkvLyBTV0kKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdFNXSShpbW1lZGlhdGUpOwoJCQkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCQkJfSBlbHNlIHsKCQkJCS8vIEIoMSkKCQkJCWlmIChpbnN0cnVjdGlvbiAmIDB4MDA4MCkgewoJCQkJCWltbWVkaWF0ZSB8PSAweEZGRkZGRjAwOwoJCQkJfQoJCQkJaW1tZWRpYXRlIDw8PSAxOwoJCQkJdmFyIGNvbmRPcCA9IHRoaXMuY29uZHNbY29uZF07CgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RCMShpbW1lZGlhdGUsIGNvbmRPcCk7CgkJCQlvcC53cml0ZXNQQyA9IHRydWU7CgkJCQlvcC5maXhlZEp1bXAgPSB0cnVlOwoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgMHg2MDAwOgoJCWNhc2UgMHg3MDAwOgoJCQkvLyBCTChYKQoJCQl2YXIgaW1tZWRpYXRlID0gaW5zdHJ1Y3Rpb24gJiAweDA3RkY7CgkJCXZhciBoID0gaW5zdHJ1Y3Rpb24gJiAweDE4MDA7CgkJCXN3aXRjaCAoaCkgewoJCQljYXNlIDB4MDAwMDoKCQkJCS8vIEIoMikKCQkJCWlmIChpbW1lZGlhdGUgJiAweDA0MDApIHsKCQkJCQlpbW1lZGlhdGUgfD0gMHhGRkZGRjgwMDsKCQkJCX0KCQkJCWltbWVkaWF0ZSA8PD0gMTsKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdEIyKGltbWVkaWF0ZSk7CgkJCQlvcC53cml0ZXNQQyA9IHRydWU7CgkJCQlvcC5maXhlZEp1bXAgPSB0cnVlOwoJCQkJYnJlYWs7CgkJCWNhc2UgMHgwODAwOgoJCQkJLy8gQkxYIChBUk12NVQpCgkJCQkvKm9wID0gZnVuY3Rpb24oKSB7CgkJCQkJdmFyIHBjID0gZ3Byc1tjcHUuUENdOwoJCQkJCWdwcnNbY3B1LlBDXSA9IChncHJzW2NwdS5MUl0gKyAoaW1tZWRpYXRlIDw8IDEpKSAmIDB4RkZGRkZGRkM7CgkJCQkJZ3Byc1tjcHUuTFJdID0gcGMgLSAxOwoJCQkJCWNwdS5zd2l0Y2hFeGVjTW9kZShjcHUuTU9ERV9BUk0pOwoJCQkJfSovCgkJCQlicmVhazsKCQkJY2FzZSAweDEwMDA6CgkJCQkvLyBCTCgxKQoJCQkJaWYgKGltbWVkaWF0ZSAmIDB4MDQwMCkgewoJCQkJCWltbWVkaWF0ZSB8PSAweEZGRkZGQzAwOwoJCQkJfQoJCQkJaW1tZWRpYXRlIDw8PSAxMjsKCQkJCW9wID0gdGhpcy50aHVtYkNvbXBpbGVyLmNvbnN0cnVjdEJMMShpbW1lZGlhdGUpOwoJCQkJb3Aud3JpdGVzUEMgPSBmYWxzZTsKCQkJCWJyZWFrOwoJCQljYXNlIDB4MTgwMDoKCQkJCS8vIEJMKDIpCgkJCQlvcCA9IHRoaXMudGh1bWJDb21waWxlci5jb25zdHJ1Y3RCTDIoaW1tZWRpYXRlKTsKCQkJCW9wLndyaXRlc1BDID0gdHJ1ZTsKCQkJCW9wLmZpeGVkSnVtcCA9IGZhbHNlOwoJCQkJYnJlYWs7CgkJCX0KCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJdGhpcy5XQVJOKCJVbmRlZmluZWQgaW5zdHJ1Y3Rpb246IDB4IiArIGluc3RydWN0aW9uLnRvU3RyaW5nKDE2KSk7CgkJfQoJfSBlbHNlIHsKCQl0aHJvdyAnQmFkIG9wY29kZTogMHgnICsgaW5zdHJ1Y3Rpb24udG9TdHJpbmcoMTYpOwoJfQoKCW9wLmV4ZWNNb2RlID0gdGhpcy5NT0RFX1RIVU1COwoJb3AuZml4ZWRKdW1wID0gb3AuZml4ZWRKdW1wIHx8IGZhbHNlOwoJcmV0dXJuIG9wOwp9Owo=";

const GBA_js_gba_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2UoKSB7Cgl0aGlzLkxPR19FUlJPUiA9IDE7Cgl0aGlzLkxPR19XQVJOID0gMjsKCXRoaXMuTE9HX1NUVUIgPSA0OwoJdGhpcy5MT0dfSU5GTyA9IDg7Cgl0aGlzLkxPR19ERUJVRyA9IDE2OwoKCXRoaXMuU1lTX0lEID0gJ2NvbS5lbmRyaWZ0LmdiYWpzJzsKCgl0aGlzLmxvZ0xldmVsID0gdGhpcy5MT0dfRVJST1IgfCB0aGlzLkxPR19XQVJOOwoKCXRoaXMucm9tID0gbnVsbDsKCgl0aGlzLmNwdSA9IG5ldyBBUk1Db3JlKCk7Cgl0aGlzLm1tdSA9IG5ldyBHYW1lQm95QWR2YW5jZU1NVSgpCgl0aGlzLmlycSA9IG5ldyBHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIoKTsKCXRoaXMuaW8gPSBuZXcgR2FtZUJveUFkdmFuY2VJTygpOwoJdGhpcy5hdWRpbyA9IG5ldyBHYW1lQm95QWR2YW5jZUF1ZGlvKCk7Cgl0aGlzLnZpZGVvID0gbmV3IEdhbWVCb3lBZHZhbmNlVmlkZW8oKTsKCXRoaXMua2V5cGFkID0gbmV3IEdhbWVCb3lBZHZhbmNlS2V5cGFkKCk7Cgl0aGlzLnNpbyA9IG5ldyBHYW1lQm95QWR2YW5jZVNJTygpOwoKCS8vIFRPRE86IHNpbXBsaWZ5IHRoaXMgZ3JhcGgKCXRoaXMuY3B1Lm1tdSA9IHRoaXMubW11OwoJdGhpcy5jcHUuaXJxID0gdGhpcy5pcnE7CgoJdGhpcy5tbXUuY3B1ID0gdGhpcy5jcHU7Cgl0aGlzLm1tdS5jb3JlID0gdGhpczsKCgl0aGlzLmlycS5jcHUgPSB0aGlzLmNwdTsKCXRoaXMuaXJxLmlvID0gdGhpcy5pbzsKCXRoaXMuaXJxLmF1ZGlvID0gdGhpcy5hdWRpbzsKCXRoaXMuaXJxLnZpZGVvID0gdGhpcy52aWRlbzsKCXRoaXMuaXJxLmNvcmUgPSB0aGlzOwoKCXRoaXMuaW8uY3B1ID0gdGhpcy5jcHU7Cgl0aGlzLmlvLmF1ZGlvID0gdGhpcy5hdWRpbzsKCXRoaXMuaW8udmlkZW8gPSB0aGlzLnZpZGVvOwoJdGhpcy5pby5rZXlwYWQgPSB0aGlzLmtleXBhZDsKCXRoaXMuaW8uc2lvID0gdGhpcy5zaW87Cgl0aGlzLmlvLmNvcmUgPSB0aGlzOwoKCXRoaXMuYXVkaW8uY3B1ID0gdGhpcy5jcHU7Cgl0aGlzLmF1ZGlvLmNvcmUgPSB0aGlzOwoKCXRoaXMudmlkZW8uY3B1ID0gdGhpcy5jcHU7Cgl0aGlzLnZpZGVvLmNvcmUgPSB0aGlzOwoKCXRoaXMua2V5cGFkLmNvcmUgPSB0aGlzOwoKCXRoaXMuc2lvLmNvcmUgPSB0aGlzOwoKCXRoaXMua2V5cGFkLnJlZ2lzdGVySGFuZGxlcnMoKTsKCXRoaXMuZG9TdGVwID0gdGhpcy53YWl0RnJhbWU7Cgl0aGlzLnBhdXNlZCA9IGZhbHNlOwoKCXRoaXMuc2VlbkZyYW1lID0gZmFsc2U7Cgl0aGlzLnNlZW5TYXZlID0gZmFsc2U7Cgl0aGlzLmxhc3RWYmxhbmsgPSAwOwoKCXRoaXMucXVldWUgPSBudWxsOwoJdGhpcy5yZXBvcnRGUFMgPSBudWxsOwoJdGhpcy50aHJvdHRsZSA9IDE2OyAvLyBUaGlzIGlzIHJvdWdoLCBidXQgdGhlIDIvM21zIGRpZmZlcmVuY2UgZ2l2ZXMgdXMgYSBnb29kIG92ZXJoZWFkCgoJdmFyIHNlbGYgPSB0aGlzOwoJd2luZG93LnF1ZXVlRnJhbWUgPSBmdW5jdGlvbiAoZikgewoJCXNlbGYucXVldWUgPSB3aW5kb3cuc2V0VGltZW91dChmLCBzZWxmLnRocm90dGxlKTsKCX07CgoJd2luZG93LlVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTDsKCgl0aGlzLnZpZGVvLnZibGFua0NhbGxiYWNrID0gZnVuY3Rpb24oKSB7CgkJc2VsZi5zZWVuRnJhbWUgPSB0cnVlOwoJfTsKfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5zZXRDYW52YXMgPSBmdW5jdGlvbihjYW52YXMpIHsKCXZhciBzZWxmID0gdGhpczsKCWlmIChjYW52YXMub2Zmc2V0V2lkdGggIT0gMjQwIHx8IGNhbnZhcy5vZmZzZXRIZWlnaHQgIT0gMTYwKSB7CgkJdGhpcy5pbmRpcmVjdENhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwoJCXRoaXMuaW5kaXJlY3RDYW52YXMuc2V0QXR0cmlidXRlKCJoZWlnaHQiLCAiMTYwIik7CgkJdGhpcy5pbmRpcmVjdENhbnZhcy5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgIjI0MCIpOwoJCXRoaXMudGFyZ2V0Q2FudmFzID0gY2FudmFzOwoJCXRoaXMuc2V0Q2FudmFzRGlyZWN0KHRoaXMuaW5kaXJlY3RDYW52YXMpOwoJCXZhciB0YXJnZXRDb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CgkJdGhpcy52aWRlby5kcmF3Q2FsbGJhY2sgPSBmdW5jdGlvbigpIHsKCQkJdGFyZ2V0Q29udGV4dC5kcmF3SW1hZ2Uoc2VsZi5pbmRpcmVjdENhbnZhcywgMCwgMCwgY2FudmFzLm9mZnNldFdpZHRoLCBjYW52YXMub2Zmc2V0SGVpZ2h0KTsKCQl9Cgl9IGVsc2UgewoJCXRoaXMuc2V0Q2FudmFzRGlyZWN0KGNhbnZhcyk7CgkJdmFyIHNlbGYgPSB0aGlzOwoJfQp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLnNldENhbnZhc0RpcmVjdCA9IGZ1bmN0aW9uKGNhbnZhcykgewoJdGhpcy5jb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7Cgl0aGlzLnZpZGVvLnNldEJhY2tpbmcodGhpcy5jb250ZXh0KTsKfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5zZXRCaW9zID0gZnVuY3Rpb24oYmlvcywgcmVhbCkgewoJdGhpcy5tbXUubG9hZEJpb3MoYmlvcywgcmVhbCk7Cn07CgpHYW1lQm95QWR2YW5jZS5wcm90b3R5cGUuc2V0Um9tID0gZnVuY3Rpb24ocm9tKSB7Cgl0aGlzLnJlc2V0KCk7CgoJdGhpcy5yb20gPSB0aGlzLm1tdS5sb2FkUm9tKHJvbSwgdHJ1ZSk7CglpZiAoIXRoaXMucm9tKSB7CgkJcmV0dXJuIGZhbHNlOwoJfQoJdGhpcy5yZXRyaWV2ZVNhdmVkYXRhKCk7CglyZXR1cm4gdHJ1ZTsKfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5oYXNSb20gPSBmdW5jdGlvbigpIHsKCXJldHVybiAhIXRoaXMucm9tOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmxvYWRSb21Gcm9tRmlsZSA9IGZ1bmN0aW9uKHJvbUZpbGUsIGNhbGxiYWNrKSB7Cgl2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCXZhciBzZWxmID0gdGhpczsKCXJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7CgkJdmFyIHJlc3VsdCA9IHNlbGYuc2V0Um9tKGUudGFyZ2V0LnJlc3VsdCk7CgkJaWYgKGNhbGxiYWNrKSB7CgkJCWNhbGxiYWNrKHJlc3VsdCk7CgkJfQoJfQoJcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKHJvbUZpbGUpOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7Cgl0aGlzLmF1ZGlvLnBhdXNlKHRydWUpOwoKCXRoaXMubW11LmNsZWFyKCk7Cgl0aGlzLmlvLmNsZWFyKCk7Cgl0aGlzLmF1ZGlvLmNsZWFyKCk7Cgl0aGlzLnZpZGVvLmNsZWFyKCk7Cgl0aGlzLnNpby5jbGVhcigpOwoKCXRoaXMubW11Lm1tYXAodGhpcy5tbXUuUkVHSU9OX0lPLCB0aGlzLmlvKTsKCXRoaXMubW11Lm1tYXAodGhpcy5tbXUuUkVHSU9OX1BBTEVUVEVfUkFNLCB0aGlzLnZpZGVvLnJlbmRlclBhdGgucGFsZXR0ZSk7Cgl0aGlzLm1tdS5tbWFwKHRoaXMubW11LlJFR0lPTl9WUkFNLCB0aGlzLnZpZGVvLnJlbmRlclBhdGgudnJhbSk7Cgl0aGlzLm1tdS5tbWFwKHRoaXMubW11LlJFR0lPTl9PQU0sIHRoaXMudmlkZW8ucmVuZGVyUGF0aC5vYW0pOwoKCXRoaXMuY3B1LnJlc2V0Q1BVKDApOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLnN0ZXAgPSBmdW5jdGlvbigpIHsKCXdoaWxlICh0aGlzLmRvU3RlcCgpKSB7CgkJdGhpcy5jcHUuc3RlcCgpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLndhaXRGcmFtZSA9IGZ1bmN0aW9uKCkgewoJdmFyIHNlZW4gPSB0aGlzLnNlZW5GcmFtZTsKCXRoaXMuc2VlbkZyYW1lID0gZmFsc2U7CglyZXR1cm4gIXNlZW47Cn07CgpHYW1lQm95QWR2YW5jZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbigpIHsKCXRoaXMucGF1c2VkID0gdHJ1ZTsKCXRoaXMuYXVkaW8ucGF1c2UodHJ1ZSk7CglpZiAodGhpcy5xdWV1ZSkgewoJCWNsZWFyVGltZW91dCh0aGlzLnF1ZXVlKTsKCQl0aGlzLnF1ZXVlID0gbnVsbDsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5hZHZhbmNlRnJhbWUgPSBmdW5jdGlvbigpIHsKCXRoaXMuc3RlcCgpOwoJaWYgKHRoaXMuc2VlblNhdmUpIHsKCQlpZiAoIXRoaXMubW11LnNhdmVOZWVkc0ZsdXNoKCkpIHsKCQkJdGhpcy5zdG9yZVNhdmVkYXRhKCk7CgkJCXRoaXMuc2VlblNhdmUgPSBmYWxzZTsKCQl9IGVsc2UgewoJCQl0aGlzLm1tdS5mbHVzaFNhdmUoKTsKCQl9Cgl9IGVsc2UgaWYgKHRoaXMubW11LnNhdmVOZWVkc0ZsdXNoKCkpIHsKCQl0aGlzLnNlZW5TYXZlID0gdHJ1ZTsKCQl0aGlzLm1tdS5mbHVzaFNhdmUoKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5ydW5TdGFibGUgPSBmdW5jdGlvbigpIHsKCWlmICh0aGlzLmludGVydmFsKSB7CgkJcmV0dXJuOyAvLyBBbHJlYWR5IHJ1bm5pbmcKCX0KCXZhciBzZWxmID0gdGhpczsKCXZhciB0aW1lciA9IDA7Cgl2YXIgZnJhbWVzID0gMDsKCXZhciBydW5GdW5jOwoJdmFyIHN0YXJ0ID0gRGF0ZS5ub3coKTsKCXRoaXMucGF1c2VkID0gZmFsc2U7Cgl0aGlzLmF1ZGlvLnBhdXNlKGZhbHNlKTsKCglpZiAodGhpcy5yZXBvcnRGUFMpIHsKCQlydW5GdW5jID0gZnVuY3Rpb24oKSB7CgkJCXRyeSB7CgkJCQl0aW1lciArPSBEYXRlLm5vdygpIC0gc3RhcnQ7CgkJCQlpZiAoc2VsZi5wYXVzZWQpIHsKCQkJCQlyZXR1cm47CgkJCQl9IGVsc2UgewoJCQkJCXF1ZXVlRnJhbWUocnVuRnVuYyk7CgkJCQl9CgkJCQlzdGFydCA9IERhdGUubm93KCk7CgkJCQlzZWxmLmFkdmFuY2VGcmFtZSgpOwoJCQkJKytmcmFtZXM7CgkJCQlpZiAoZnJhbWVzID09IDYwKSB7CgkJCQkJc2VsZi5yZXBvcnRGUFMoKGZyYW1lcyAqIDEwMDApIC8gdGltZXIpOwoJCQkJCWZyYW1lcyA9IDA7CgkJCQkJdGltZXIgPSAwOwoJCQkJfQoJCQl9IGNhdGNoKGV4Y2VwdGlvbikgewoJCQkJc2VsZi5FUlJPUihleGNlcHRpb24pOwoJCQkJaWYgKGV4Y2VwdGlvbi5zdGFjaykgewoJCQkJCXNlbGYubG9nU3RhY2tUcmFjZShleGNlcHRpb24uc3RhY2suc3BsaXQoJ1xuJykpOwoJCQkJfQoJCQkJdGhyb3cgZXhjZXB0aW9uOwoJCQl9CgkJfTsKCX0gZWxzZSB7CgkJcnVuRnVuYyA9IGZ1bmN0aW9uKCkgewoJCQl0cnkgewoJCQkJaWYgKHNlbGYucGF1c2VkKSB7CgkJCQkJcmV0dXJuOwoJCQkJfSBlbHNlIHsKCQkJCQlxdWV1ZUZyYW1lKHJ1bkZ1bmMpOwoJCQkJfQoJCQkJc2VsZi5hZHZhbmNlRnJhbWUoKTsKCQkJfSBjYXRjaChleGNlcHRpb24pIHsKCQkJCXNlbGYuRVJST1IoZXhjZXB0aW9uKTsKCQkJCWlmIChleGNlcHRpb24uc3RhY2spIHsKCQkJCQlzZWxmLmxvZ1N0YWNrVHJhY2UoZXhjZXB0aW9uLnN0YWNrLnNwbGl0KCdcbicpKTsKCQkJCX0KCQkJCXRocm93IGV4Y2VwdGlvbjsKCQkJfQoJCX07Cgl9CglxdWV1ZUZyYW1lKHJ1bkZ1bmMpOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLnNldFNhdmVkYXRhID0gZnVuY3Rpb24oZGF0YSkgewoJdGhpcy5tbXUubG9hZFNhdmVkYXRhKGRhdGEpOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmxvYWRTYXZlZGF0YUZyb21GaWxlID0gZnVuY3Rpb24oc2F2ZUZpbGUpIHsKCXZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoJdmFyIHNlbGYgPSB0aGlzOwoJcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHsgc2VsZi5zZXRTYXZlZGF0YShlLnRhcmdldC5yZXN1bHQpOyB9CglyZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoc2F2ZUZpbGUpOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmRlY29kZVNhdmVkYXRhID0gZnVuY3Rpb24oc3RyaW5nKSB7Cgl0aGlzLnNldFNhdmVkYXRhKHRoaXMuZGVjb2RlQmFzZTY0KHN0cmluZykpOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmRlY29kZUJhc2U2NCA9IGZ1bmN0aW9uKHN0cmluZykgewoJdmFyIGxlbmd0aCA9IChzdHJpbmcubGVuZ3RoICogMyAvIDQpOwoJaWYgKHN0cmluZ1tzdHJpbmcubGVuZ3RoIC0gMl0gPT0gJz0nKSB7CgkJbGVuZ3RoIC09IDI7Cgl9IGVsc2UgaWYgKHN0cmluZ1tzdHJpbmcubGVuZ3RoIC0gMV0gPT0gJz0nKSB7CgkJbGVuZ3RoIC09IDE7Cgl9Cgl2YXIgYnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGxlbmd0aCk7Cgl2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7Cgl2YXIgYml0cyA9IHN0cmluZy5tYXRjaCgvLi4uLi9nKTsKCWZvciAodmFyIGkgPSAwOyBpICsgMiA8IGxlbmd0aDsgaSArPSAzKSB7CgkJdmFyIHMgPSBhdG9iKGJpdHMuc2hpZnQoKSk7CgkJdmlld1tpXSA9IHMuY2hhckNvZGVBdCgwKTsKCQl2aWV3W2kgKyAxXSA9IHMuY2hhckNvZGVBdCgxKTsKCQl2aWV3W2kgKyAyXSA9IHMuY2hhckNvZGVBdCgyKTsKCX0KCWlmIChpIDwgbGVuZ3RoKSB7CgkJdmFyIHMgPSBhdG9iKGJpdHMuc2hpZnQoKSk7CgkJdmlld1tpKytdID0gcy5jaGFyQ29kZUF0KDApOwoJCWlmIChzLmxlbmd0aCA+IDEpIHsKCQkJdmlld1tpKytdID0gcy5jaGFyQ29kZUF0KDEpOwoJCX0KCX0KCglyZXR1cm4gYnVmZmVyOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmVuY29kZUJhc2U2NCA9IGZ1bmN0aW9uKHZpZXcpIHsKCXZhciBkYXRhID0gW107Cgl2YXIgYjsKCXZhciB3b3Jkc3RyaW5nID0gW107Cgl2YXIgdHJpcGxldDsKCWZvciAodmFyIGkgPSAwOyBpIDwgdmlldy5ieXRlTGVuZ3RoOyArK2kpIHsKCQliID0gdmlldy5nZXRVaW50OChpLCB0cnVlKTsKCQl3b3Jkc3RyaW5nLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShiKSk7CgkJd2hpbGUgKHdvcmRzdHJpbmcubGVuZ3RoID49IDMpIHsKCQkJdHJpcGxldCA9IHdvcmRzdHJpbmcuc3BsaWNlKDAsIDMpOwoJCQlkYXRhLnB1c2goYnRvYSh0cmlwbGV0LmpvaW4oJycpKSk7CgkJfQoJfTsKCWlmICh3b3Jkc3RyaW5nLmxlbmd0aCkgewoJCWRhdGEucHVzaChidG9hKHdvcmRzdHJpbmcuam9pbignJykpKTsKCX0KCXJldHVybiBkYXRhLmpvaW4oJycpOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmRvd25sb2FkU2F2ZWRhdGEgPSBmdW5jdGlvbigpIHsKCXZhciBzcmFtID0gdGhpcy5tbXUuc2F2ZTsKCWlmICghc3JhbSkgewoJCXRoaXMuV0FSTigiTm8gc2F2ZSBkYXRhIGF2YWlsYWJsZSIpOwoJCXJldHVybiBudWxsOwoJfQoJaWYgKHdpbmRvdy5VUkwpIHsKCQl2YXIgdXJsID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3NyYW0uYnVmZmVyXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJyB9KSk7CgkJd2luZG93Lm9wZW4odXJsKTsKCX0gZWxzZSB7CgkJdmFyIGRhdGEgPSB0aGlzLmVuY29kZUJhc2U2NChzcmFtLnZpZXcpOwoJCXdpbmRvdy5vcGVuKCdkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsJyArIGRhdGEsIHRoaXMucm9tLmNvZGUgKyAnLnNhdicpOwoJfQp9OwoKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5zdG9yZVNhdmVkYXRhID0gZnVuY3Rpb24oKSB7Cgl2YXIgc3JhbSA9IHRoaXMubW11LnNhdmU7Cgl0cnkgewoJCXZhciBzdG9yYWdlID0gd2luZG93LmxvY2FsU3RvcmFnZTsKCQlzdG9yYWdlW3RoaXMuU1lTX0lEICsgJy4nICsgdGhpcy5tbXUuY2FydC5jb2RlXSA9IHRoaXMuZW5jb2RlQmFzZTY0KHNyYW0udmlldyk7Cgl9IGNhdGNoIChlKSB7CgkJdGhpcy5XQVJOKCdDb3VsZCBub3Qgc3RvcmUgc2F2ZWRhdGEhICcgKyBlKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5yZXRyaWV2ZVNhdmVkYXRhID0gZnVuY3Rpb24oKSB7Cgl0cnkgewoJCXZhciBzdG9yYWdlID0gd2luZG93LmxvY2FsU3RvcmFnZTsKCQl2YXIgZGF0YSA9IHN0b3JhZ2VbdGhpcy5TWVNfSUQgKyAnLicgKyB0aGlzLm1tdS5jYXJ0LmNvZGVdOwoJCWlmIChkYXRhKSB7CgkJCXRoaXMuZGVjb2RlU2F2ZWRhdGEoZGF0YSk7CgkJCXJldHVybiB0cnVlOwoJCX0KCX0gY2F0Y2ggKGUpIHsKCQl0aGlzLldBUk4oJ0NvdWxkIG5vdCByZXRyaWV2ZSBzYXZlZGF0YSEgJyArIGUpOwoJfQoJcmV0dXJuIGZhbHNlOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmZyZWV6ZSA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuIHsKCQknY3B1JzogdGhpcy5jcHUuZnJlZXplKCksCgkJJ21tdSc6IHRoaXMubW11LmZyZWV6ZSgpLAoJCSdpcnEnOiB0aGlzLmlycS5mcmVlemUoKSwKCQknaW8nOiB0aGlzLmlvLmZyZWV6ZSgpLAoJCSdhdWRpbyc6IHRoaXMuYXVkaW8uZnJlZXplKCksCgkJJ3ZpZGVvJzogdGhpcy52aWRlby5mcmVlemUoKQoJfQp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmRlZnJvc3QgPSBmdW5jdGlvbihmcm9zdCkgewoJdGhpcy5jcHUuZGVmcm9zdChmcm9zdC5jcHUpOwoJdGhpcy5tbXUuZGVmcm9zdChmcm9zdC5tbXUpOwoJdGhpcy5hdWRpby5kZWZyb3N0KGZyb3N0LmF1ZGlvKTsKCXRoaXMudmlkZW8uZGVmcm9zdChmcm9zdC52aWRlbyk7Cgl0aGlzLmlycS5kZWZyb3N0KGZyb3N0LmlycSk7Cgl0aGlzLmlvLmRlZnJvc3QoZnJvc3QuaW8pOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uKGxldmVsLCBtZXNzYWdlKSB7fTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5zZXRMb2dnZXIgPSBmdW5jdGlvbihsb2dnZXIpIHsKCXRoaXMubG9nID0gbG9nZ2VyOwp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLmxvZ1N0YWNrVHJhY2UgPSBmdW5jdGlvbihzdGFjaykgewoJdmFyIG92ZXJmbG93ID0gc3RhY2subGVuZ3RoIC0gMzI7Cgl0aGlzLkVSUk9SKCdTdGFjayB0cmFjZSBmb2xsb3dzOicpOwoJaWYgKG92ZXJmbG93ID4gMCkgewoJCXRoaXMubG9nKC0xLCAnPiAoVG9vIG1hbnkgZnJhbWVzKScpOwoJfQoJZm9yICh2YXIgaSA9IE1hdGgubWF4KG92ZXJmbG93LCAwKTsgaSA8IHN0YWNrLmxlbmd0aDsgKytpKSB7CgkJdGhpcy5sb2coLTEsICc+ICcgKyBzdGFja1tpXSk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZS5wcm90b3R5cGUuRVJST1IgPSBmdW5jdGlvbihlcnJvcikgewoJaWYgKHRoaXMubG9nTGV2ZWwgJiB0aGlzLkxPR19FUlJPUikgewoJCXRoaXMubG9nKHRoaXMuTE9HX0VSUk9SLCBlcnJvcik7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZS5wcm90b3R5cGUuV0FSTiA9IGZ1bmN0aW9uKHdhcm4pIHsKCWlmICh0aGlzLmxvZ0xldmVsICYgdGhpcy5MT0dfV0FSTikgewoJCXRoaXMubG9nKHRoaXMuTE9HX1dBUk4sIHdhcm4pOwoJfQp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLlNUVUIgPSBmdW5jdGlvbihmdW5jKSB7CglpZiAodGhpcy5sb2dMZXZlbCAmIHRoaXMuTE9HX1NUVUIpIHsKCQl0aGlzLmxvZyh0aGlzLkxPR19TVFVCLCBmdW5jKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlLnByb3RvdHlwZS5JTkZPID0gZnVuY3Rpb24oaW5mbykgewoJaWYgKHRoaXMubG9nTGV2ZWwgJiB0aGlzLkxPR19JTkZPKSB7CgkJdGhpcy5sb2codGhpcy5MT0dfSU5GTywgaW5mbyk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZS5wcm90b3R5cGUuREVCVUcgPSBmdW5jdGlvbihpbmZvKSB7CglpZiAodGhpcy5sb2dMZXZlbCAmIHRoaXMuTE9HX0RFQlVHKSB7CgkJdGhpcy5sb2codGhpcy5MT0dfREVCVUcsIGluZm8pOwoJfQp9OwoKR2FtZUJveUFkdmFuY2UucHJvdG90eXBlLkFTU0VSVF9VTlJFQUNIRUQgPSBmdW5jdGlvbihlcnIpIHsKCXRocm93IG5ldyBFcnJvcigiU2hvdWxkIGJlIHVucmVhY2hlZDogIiArIGVycik7Cn07CgpHYW1lQm95QWR2YW5jZS5wcm90b3R5cGUuQVNTRVJUID0gZnVuY3Rpb24odGVzdCwgZXJyKSB7CglpZiAoIXRlc3QpIHsKCQl0aHJvdyBuZXcgRXJyb3IoIkFzc2VydGlvbiBmYWlsZWQ6ICIgKyBlcnIpOwoJfQp9Owo=";

const GBA_js_gpio_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VHUElPKGNvcmUsIHJvbSkgewoJdGhpcy5jb3JlID0gY29yZTsKCXRoaXMucm9tID0gcm9tOwoKCXRoaXMucmVhZFdyaXRlID0gMDsKCXRoaXMuZGlyZWN0aW9uID0gMDsKCgl0aGlzLmRldmljZSA9IG5ldyBHYW1lQm95QWR2YW5jZVJUQyh0aGlzKTsgLy8gVE9ETzogU3VwcG9ydCBtb3JlIGRldmljZXMKfTsKCkdhbWVCb3lBZHZhbmNlR1BJTy5wcm90b3R5cGUuc3RvcmUxNiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXN3aXRjaCAob2Zmc2V0KSB7CgljYXNlIDB4QzQ6CgkJdGhpcy5kZXZpY2Uuc2V0UGlucyh2YWx1ZSAmIDB4Rik7CgkJYnJlYWs7CgljYXNlIDB4QzY6CgkJdGhpcy5kaXJlY3Rpb24gPSB2YWx1ZSAmIDB4RjsKCQl0aGlzLmRldmljZS5zZXREaXJlY3Rpb24odGhpcy5kaXJlY3Rpb24pOwoJCWJyZWFrOwoJY2FzZSAweEM4OgoJCXRoaXMucmVhZFdyaXRlID0gdmFsdWUgJiAxOwoJCWJyZWFrOwoJZGVmYXVsdDoKCQl0aHJvdyBuZXcgRXJyb3IoJ0JVRzogQmFkIG9mZnNldCBwYXNzZWQgdG8gR1BJTzogJyArIG9mZnNldC50b1N0cmluZygxNikpOwoJfQoJaWYgKHRoaXMucmVhZFdyaXRlKSB7CgkJdmFyIG9sZCA9IHRoaXMucm9tLnZpZXcuZ2V0VWludDE2KG9mZnNldCwgdHJ1ZSk7CgkJb2xkICY9IH50aGlzLmRpcmVjdGlvbjsKCQl0aGlzLnJvbS52aWV3LnNldFVpbnQxNihvZmZzZXQsIG9sZCB8ICh2YWx1ZSAmIHRoaXMuZGlyZWN0aW9uKSwgdHJ1ZSk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUdQSU8ucHJvdG90eXBlLm91dHB1dFBpbnMgPSBmdW5jdGlvbihueWJibGUpIHsKCWlmICh0aGlzLnJlYWRXcml0ZSkgewoJCXZhciBvbGQgPSB0aGlzLnJvbS52aWV3LmdldFVpbnQxNigweEM0LCB0cnVlKTsKCQlvbGQgJj0gdGhpcy5kaXJlY3Rpb247CgkJdGhpcy5yb20udmlldy5zZXRVaW50MTYoMHhDNCwgb2xkIHwgKG55YmJsZSAmIH50aGlzLmRpcmVjdGlvbiAmIDB4RiksIHRydWUpOwoJfQp9OwoKZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VSVEMoZ3BpbykgewoJdGhpcy5ncGlvID0gZ3BpbzsKCgkvLyBQSU5PVVQ6IFNDSyB8IFNJTyB8IENTIHwgLQoJdGhpcy5waW5zID0gMDsKCXRoaXMuZGlyZWN0aW9uID0gMDsKCgl0aGlzLnRvdGFsQnl0ZXMgPSBbCgkJMCwgLy8gRm9yY2UgcmVzZXQKCQkwLCAvLyBFbXB0eQoJCTcsIC8vIERhdGUvVGltZQoJCTAsIC8vIEZvcmNlIElSUQoJCTEsIC8vIENvbnRyb2wgcmVnaXN0ZXIKCQkwLCAvLyBFbXB0eQoJCTMsIC8vIFRpbWUKCQkwIC8vIEVtcHR5CgldOwoJdGhpcy5ieXRlc1JlbWFpbmluZyA9IDA7CgoJLy8gVHJhbnNmZXIgc2VxdWVuY2U6CgkvLyA9PSBJbml0aWF0ZQoJLy8gPiBISSB8IC0gfCBMTyB8IC0KCS8vID4gSEkgfCAtIHwgSEkgfCAtCgkvLyA9PSBUcmFuc2ZlciBiaXQgKHg4KQoJLy8gPiBMTyB8IHggfCBISSB8IC0KCS8vID4gSEkgfCAtIHwgSEkgfCAtCgkvLyA8ID8/IHwgeCB8ID8/IHwgLQoJLy8gPT0gVGVybWluYXRlCgkvLyA+ICAtIHwgLSB8IExPIHwgLQoJdGhpcy50cmFuc2ZlclN0ZXAgPSAwOwoKCXRoaXMucmVhZGluZyA9IDA7Cgl0aGlzLmJpdHNSZWFkID0gMDsKCXRoaXMuYml0cyA9IDA7Cgl0aGlzLmNvbW1hbmQgPSAtMTsKCgl0aGlzLmNvbnRyb2wgPSAweDQwOwoJdGhpcy50aW1lID0gWwoJCTAsIC8vIFllYXIKCQkwLCAvLyBNb250aAoJCTAsIC8vIERheQoJCTAsIC8vIERheSBvZiB3ZWVrCgkJMCwgLy8gSG91cgoJCTAsIC8vIE1pbnV0ZQoJCTAgLy8gU2Vjb25kCgldOwp9OwoKR2FtZUJveUFkdmFuY2VSVEMucHJvdG90eXBlLnNldFBpbnMgPSBmdW5jdGlvbihueWJibGUpIHsKCXN3aXRjaCAodGhpcy50cmFuc2ZlclN0ZXApIHsKCWNhc2UgMDoKCQlpZiAoKG55YmJsZSAmIDUpID09IDEpIHsKCQkJdGhpcy50cmFuc2ZlclN0ZXAgPSAxOwoJCX0KCQlicmVhazsKCWNhc2UgMToKCQlpZiAobnliYmxlICYgNCkgewoJCQl0aGlzLnRyYW5zZmVyU3RlcCA9IDI7CgkJfQoJCWJyZWFrOwoJY2FzZSAyOgoJCWlmICghKG55YmJsZSAmIDEpKSB7CgkJCXRoaXMuYml0cyAmPSB+KDEgPDwgdGhpcy5iaXRzUmVhZCk7CgkJCXRoaXMuYml0cyB8PSAoKG55YmJsZSAmIDIpID4+IDEpIDw8IHRoaXMuYml0c1JlYWQ7CgkJfSBlbHNlIHsKCQkJaWYgKG55YmJsZSAmIDQpIHsKCQkJCS8vIFNJTyBkaXJlY3Rpb24gc2hvdWxkIGFsd2F5cyAhPSB0aGlzLnJlYWQKCQkJCWlmICgodGhpcy5kaXJlY3Rpb24gJiAyKSAmJiAhdGhpcy5yZWFkKSB7CgkJCQkJKyt0aGlzLmJpdHNSZWFkOwoJCQkJCWlmICh0aGlzLmJpdHNSZWFkID09IDgpIHsKCQkJCQkJdGhpcy5wcm9jZXNzQnl0ZSgpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJdGhpcy5ncGlvLm91dHB1dFBpbnMoNSB8ICh0aGlzLnNpb091dHB1dFBpbigpIDw8IDEpKTsKCQkJCQkrK3RoaXMuYml0c1JlYWQ7CgkJCQkJaWYgKHRoaXMuYml0c1JlYWQgPT0gOCkgewoJCQkJCQktLXRoaXMuYnl0ZXNSZW1haW5pbmc7CgkJCQkJCWlmICh0aGlzLmJ5dGVzUmVtYWluaW5nIDw9IDApIHsKCQkJCQkJCXRoaXMuY29tbWFuZCA9IC0xOwoJCQkJCQl9CgkJCQkJCXRoaXMuYml0c1JlYWQgPSAwOwoJCQkJCX0KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXRoaXMuYml0c1JlYWQgPSAwOwoJCQkJdGhpcy5ieXRlc1JlbWFpbmluZyA9IDA7CgkJCQl0aGlzLmNvbW1hbmQgPSAtMTsKCQkJCXRoaXMudHJhbnNmZXJTdGVwID0gMDsKCQkJfQoJCX0KCQlicmVhazsKCX0KCgl0aGlzLnBpbnMgPSBueWJibGUgJiA3Owp9OwoKR2FtZUJveUFkdmFuY2VSVEMucHJvdG90eXBlLnNldERpcmVjdGlvbiA9IGZ1bmN0aW9uKGRpcmVjdGlvbikgewoJdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247Cn07CgpHYW1lQm95QWR2YW5jZVJUQy5wcm90b3R5cGUucHJvY2Vzc0J5dGUgPSBmdW5jdGlvbigpIHsKCS0tdGhpcy5ieXRlc1JlbWFpbmluZzsKCXN3aXRjaCAodGhpcy5jb21tYW5kKSB7CgljYXNlIC0xOgoJCWlmICgodGhpcy5iaXRzICYgMHgwRikgPT0gMHgwNikgewoJCQl0aGlzLmNvbW1hbmQgPSAodGhpcy5iaXRzID4+IDQpICYgNzsKCQkJdGhpcy5yZWFkaW5nID0gdGhpcy5iaXRzICYgMHg4MDsKCgkJCXRoaXMuYnl0ZXNSZW1haW5pbmcgPSB0aGlzLnRvdGFsQnl0ZXNbdGhpcy5jb21tYW5kXTsKCQkJc3dpdGNoICh0aGlzLmNvbW1hbmQpIHsKCQkJY2FzZSAwOgoJCQkJdGhpcy5jb250cm9sID0gMDsKCQkJCWJyZWFrOwoJCQljYXNlIDI6CgkJCWNhc2UgNjoKCQkJCXRoaXMudXBkYXRlQ2xvY2soKTsKCQkJCWJyZWFrOwoJCQl9CgkJfSBlbHNlIHsKCQkJdGhpcy5ncGlvLmNvcmUuV0FSTignSW52YWxpZCBSVEMgY29tbWFuZCBieXRlOiAnICsgdGhpcy5iaXRzLnRvU3RyaW5nKDE2KSk7CgkJfQoJCWJyZWFrOwoJY2FzZSA0OgoJCS8vIENvbnRyb2wKCQl0aGlzLmNvbnRyb2wgPSB0aGlzLmJpdHMgJiAweDQwOwoJCWJyZWFrOwoJfQkKCXRoaXMuYml0cyA9IDA7Cgl0aGlzLmJpdHNSZWFkID0gMDsKCWlmICghdGhpcy5ieXRlc1JlbWFpbmluZykgewoJCXRoaXMuY29tbWFuZCA9IC0xOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VSVEMucHJvdG90eXBlLnNpb091dHB1dFBpbiA9IGZ1bmN0aW9uKCkgewoJdmFyIG91dHB1dEJ5dGUgPSAwOwoJc3dpdGNoICh0aGlzLmNvbW1hbmQpIHsKCWNhc2UgNDoKCQlvdXRwdXRCeXRlID0gdGhpcy5jb250cm9sOwoJCWJyZWFrOwoJY2FzZSAyOgoJY2FzZSA2OgoJCW91dHB1dEJ5dGUgPSB0aGlzLnRpbWVbNyAtIHRoaXMuYnl0ZXNSZW1haW5pbmddOwoJCWJyZWFrOwoJfQoJdmFyIG91dHB1dCA9IChvdXRwdXRCeXRlID4+IHRoaXMuYml0c1JlYWQpICYgMTsKCXJldHVybiBvdXRwdXQ7Cn07CgpHYW1lQm95QWR2YW5jZVJUQy5wcm90b3R5cGUudXBkYXRlQ2xvY2sgPSBmdW5jdGlvbigpIHsKCXZhciBkYXRlID0gbmV3IERhdGUoKTsKCXRoaXMudGltZVswXSA9IHRoaXMuYmNkKGRhdGUuZ2V0RnVsbFllYXIoKSk7Cgl0aGlzLnRpbWVbMV0gPSB0aGlzLmJjZChkYXRlLmdldE1vbnRoKCkgKyAxKTsKCXRoaXMudGltZVsyXSA9IHRoaXMuYmNkKGRhdGUuZ2V0RGF0ZSgpKTsKCXRoaXMudGltZVszXSA9IGRhdGUuZ2V0RGF5KCkgLSAxOwoJaWYgKHRoaXMudGltZVszXSA8IDApIHsKCQl0aGlzLnRpbWVbM10gPSA2OwoJfQoJaWYgKHRoaXMuY29udHJvbCAmIDB4NDApIHsKCQkvLyAyNCBob3VyCgkJdGhpcy50aW1lWzRdID0gdGhpcy5iY2QoZGF0ZS5nZXRIb3VycygpKTsKCX0gZWxzZSB7CgkJdGhpcy50aW1lWzRdID0gdGhpcy5iY2QoZGF0ZS5nZXRIb3VycygpICUgMik7CgkJaWYgKGRhdGUuZ2V0SG91cnMoKSA+PSAxMikgewoJCQl0aGlzLnRpbWVbNF0gfD0gMHg4MDsKCQl9Cgl9Cgl0aGlzLnRpbWVbNV0gPSB0aGlzLmJjZChkYXRlLmdldE1pbnV0ZXMoKSk7Cgl0aGlzLnRpbWVbNl0gPSB0aGlzLmJjZChkYXRlLmdldFNlY29uZHMoKSk7Cn07CgpHYW1lQm95QWR2YW5jZVJUQy5wcm90b3R5cGUuYmNkID0gZnVuY3Rpb24oYmluYXJ5KSB7Cgl2YXIgY291bnRlciA9IGJpbmFyeSAlIDEwOwoJYmluYXJ5IC89IDEwOwoJY291bnRlciArPSAoYmluYXJ5ICUgMTApIDw8IDQ7CglyZXR1cm4gY291bnRlcjsKfTsK";

const GBA_js_io_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VJTygpIHsKCS8vIFZpZGVvCgl0aGlzLkRJU1BDTlQgPSAweDAwMDsKCXRoaXMuR1JFRU5TV1AgPSAweDAwMjsKCXRoaXMuRElTUFNUQVQgPSAweDAwNDsKCXRoaXMuVkNPVU5UID0gMHgwMDY7Cgl0aGlzLkJHMENOVCA9IDB4MDA4OwoJdGhpcy5CRzFDTlQgPSAweDAwQTsKCXRoaXMuQkcyQ05UID0gMHgwMEM7Cgl0aGlzLkJHM0NOVCA9IDB4MDBFOwoJdGhpcy5CRzBIT0ZTID0gMHgwMTA7Cgl0aGlzLkJHMFZPRlMgPSAweDAxMjsKCXRoaXMuQkcxSE9GUyA9IDB4MDE0OwoJdGhpcy5CRzFWT0ZTID0gMHgwMTY7Cgl0aGlzLkJHMkhPRlMgPSAweDAxODsKCXRoaXMuQkcyVk9GUyA9IDB4MDFBOwoJdGhpcy5CRzNIT0ZTID0gMHgwMUM7Cgl0aGlzLkJHM1ZPRlMgPSAweDAxRTsKCXRoaXMuQkcyUEEgPSAweDAyMDsKCXRoaXMuQkcyUEIgPSAweDAyMjsKCXRoaXMuQkcyUEMgPSAweDAyNDsKCXRoaXMuQkcyUEQgPSAweDAyNjsKCXRoaXMuQkcyWF9MTyA9IDB4MDI4OwoJdGhpcy5CRzJYX0hJID0gMHgwMkE7Cgl0aGlzLkJHMllfTE8gPSAweDAyQzsKCXRoaXMuQkcyWV9ISSA9IDB4MDJFOwoJdGhpcy5CRzNQQSA9IDB4MDMwOwoJdGhpcy5CRzNQQiA9IDB4MDMyOwoJdGhpcy5CRzNQQyA9IDB4MDM0OwoJdGhpcy5CRzNQRCA9IDB4MDM2OwoJdGhpcy5CRzNYX0xPID0gMHgwMzg7Cgl0aGlzLkJHM1hfSEkgPSAweDAzQTsKCXRoaXMuQkczWV9MTyA9IDB4MDNDOwoJdGhpcy5CRzNZX0hJID0gMHgwM0U7Cgl0aGlzLldJTjBIID0gMHgwNDA7Cgl0aGlzLldJTjFIID0gMHgwNDI7Cgl0aGlzLldJTjBWID0gMHgwNDQ7Cgl0aGlzLldJTjFWID0gMHgwNDY7Cgl0aGlzLldJTklOID0gMHgwNDg7Cgl0aGlzLldJTk9VVCA9IDB4MDRBOwoJdGhpcy5NT1NBSUMgPSAweDA0QzsKCXRoaXMuQkxEQ05UID0gMHgwNTA7Cgl0aGlzLkJMREFMUEhBID0gMHgwNTI7Cgl0aGlzLkJMRFkgPSAweDA1NDsKCgkvLyBTb3VuZAoJdGhpcy5TT1VORDFDTlRfTE8gPSAweDA2MDsKCXRoaXMuU09VTkQxQ05UX0hJID0gMHgwNjI7Cgl0aGlzLlNPVU5EMUNOVF9YID0gMHgwNjQ7Cgl0aGlzLlNPVU5EMkNOVF9MTyA9IDB4MDY4OwoJdGhpcy5TT1VORDJDTlRfSEkgPSAweDA2QzsKCXRoaXMuU09VTkQzQ05UX0xPID0gMHgwNzA7Cgl0aGlzLlNPVU5EM0NOVF9ISSA9IDB4MDcyOwoJdGhpcy5TT1VORDNDTlRfWCA9IDB4MDc0OwoJdGhpcy5TT1VORDRDTlRfTE8gPSAweDA3ODsKCXRoaXMuU09VTkQ0Q05UX0hJID0gMHgwN0M7Cgl0aGlzLlNPVU5EQ05UX0xPID0gMHgwODA7Cgl0aGlzLlNPVU5EQ05UX0hJID0gMHgwODI7Cgl0aGlzLlNPVU5EQ05UX1ggPSAweDA4NDsKCXRoaXMuU09VTkRCSUFTID0gMHgwODg7Cgl0aGlzLldBVkVfUkFNMF9MTyA9IDB4MDkwOwoJdGhpcy5XQVZFX1JBTTBfSEkgPSAweDA5MjsKCXRoaXMuV0FWRV9SQU0xX0xPID0gMHgwOTQ7Cgl0aGlzLldBVkVfUkFNMV9ISSA9IDB4MDk2OwoJdGhpcy5XQVZFX1JBTTJfTE8gPSAweDA5ODsKCXRoaXMuV0FWRV9SQU0yX0hJID0gMHgwOUE7Cgl0aGlzLldBVkVfUkFNM19MTyA9IDB4MDlDOwoJdGhpcy5XQVZFX1JBTTNfSEkgPSAweDA5RTsKCXRoaXMuRklGT19BX0xPID0gMHgwQTA7Cgl0aGlzLkZJRk9fQV9ISSA9IDB4MEEyOwoJdGhpcy5GSUZPX0JfTE8gPSAweDBBNDsKCXRoaXMuRklGT19CX0hJID0gMHgwQTY7CgoJLy8gRE1BCgl0aGlzLkRNQTBTQURfTE8gPSAweDBCMDsKCXRoaXMuRE1BMFNBRF9ISSA9IDB4MEIyOwoJdGhpcy5ETUEwREFEX0xPID0gMHgwQjQ7Cgl0aGlzLkRNQTBEQURfSEkgPSAweDBCNjsKCXRoaXMuRE1BMENOVF9MTyA9IDB4MEI4OwoJdGhpcy5ETUEwQ05UX0hJID0gMHgwQkE7Cgl0aGlzLkRNQTFTQURfTE8gPSAweDBCQzsKCXRoaXMuRE1BMVNBRF9ISSA9IDB4MEJFOwoJdGhpcy5ETUExREFEX0xPID0gMHgwQzA7Cgl0aGlzLkRNQTFEQURfSEkgPSAweDBDMjsKCXRoaXMuRE1BMUNOVF9MTyA9IDB4MEM0OwoJdGhpcy5ETUExQ05UX0hJID0gMHgwQzY7Cgl0aGlzLkRNQTJTQURfTE8gPSAweDBDODsKCXRoaXMuRE1BMlNBRF9ISSA9IDB4MENBOwoJdGhpcy5ETUEyREFEX0xPID0gMHgwQ0M7Cgl0aGlzLkRNQTJEQURfSEkgPSAweDBDRTsKCXRoaXMuRE1BMkNOVF9MTyA9IDB4MEQwOwoJdGhpcy5ETUEyQ05UX0hJID0gMHgwRDI7Cgl0aGlzLkRNQTNTQURfTE8gPSAweDBENDsKCXRoaXMuRE1BM1NBRF9ISSA9IDB4MEQ2OwoJdGhpcy5ETUEzREFEX0xPID0gMHgwRDg7Cgl0aGlzLkRNQTNEQURfSEkgPSAweDBEQTsKCXRoaXMuRE1BM0NOVF9MTyA9IDB4MERDOwoJdGhpcy5ETUEzQ05UX0hJID0gMHgwREU7CgoJLy8gVGltZXJzCgl0aGlzLlRNMENOVF9MTyA9IDB4MTAwOwoJdGhpcy5UTTBDTlRfSEkgPSAweDEwMjsKCXRoaXMuVE0xQ05UX0xPID0gMHgxMDQ7Cgl0aGlzLlRNMUNOVF9ISSA9IDB4MTA2OwoJdGhpcy5UTTJDTlRfTE8gPSAweDEwODsKCXRoaXMuVE0yQ05UX0hJID0gMHgxMEE7Cgl0aGlzLlRNM0NOVF9MTyA9IDB4MTBDOwoJdGhpcy5UTTNDTlRfSEkgPSAweDEwRTsKCgkvLyBTSU8gKG5vdGU6IHNvbWUgb2YgdGhlc2UgYXJlIHJlcGVhdGVkKQoJdGhpcy5TSU9EQVRBMzJfTE8gPSAweDEyMDsKCXRoaXMuU0lPTVVMVEkwID0gMHgxMjA7Cgl0aGlzLlNJT0RBVEEzMl9ISSA9IDB4MTIyOwoJdGhpcy5TSU9NVUxUSTEgPSAweDEyMjsKCXRoaXMuU0lPTVVMVEkyID0gMHgxMjQ7Cgl0aGlzLlNJT01VTFRJMyA9IDB4MTI2OwoJdGhpcy5TSU9DTlQgPSAweDEyODsKCXRoaXMuU0lPTUxUX1NFTkQgPSAweDEyQTsKCXRoaXMuU0lPREFUQTggPSAweDEyQTsKCXRoaXMuUkNOVCA9IDB4MTM0OwoJdGhpcy5KT1lDTlQgPSAweDE0MDsKCXRoaXMuSk9ZX1JFQ1YgPSAweDE1MDsKCXRoaXMuSk9ZX1RSQU5TID0gMHgxNTQ7Cgl0aGlzLkpPWVNUQVQgPSAweDE1ODsKCgkvLyBLZXlwYWQKCXRoaXMuS0VZSU5QVVQgPSAweDEzMDsKCXRoaXMuS0VZQ05UID0gMHgxMzI7CgoJLy8gSW50ZXJydXB0cywgZXRjCgl0aGlzLklFID0gMHgyMDA7Cgl0aGlzLklGID0gMHgyMDI7Cgl0aGlzLldBSVRDTlQgPSAweDIwNDsKCXRoaXMuSU1FID0gMHgyMDg7CgoJdGhpcy5QT1NURkxHID0gMHgzMDA7Cgl0aGlzLkhBTFRDTlQgPSAweDMwMTsKCgl0aGlzLkRFRkFVTFRfRElTUENOVCA9IDB4MDA4MDsKCXRoaXMuREVGQVVMVF9TT1VOREJJQVMgPSAweDIwMDsKCXRoaXMuREVGQVVMVF9CR1BBID0gMTsKCXRoaXMuREVGQVVMVF9CR1BEID0gMTsKCXRoaXMuREVGQVVMVF9SQ05UID0gMHg4MDAwOwp9OwoKR2FtZUJveUFkdmFuY2VJTy5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHsKCXRoaXMucmVnaXN0ZXJzID0gbmV3IFVpbnQxNkFycmF5KHRoaXMuY3B1Lm1tdS5TSVpFX0lPKTsKCgl0aGlzLnJlZ2lzdGVyc1t0aGlzLkRJU1BDTlQgPj4gMV0gPSB0aGlzLkRFRkFVTFRfRElTUENOVDsKCXRoaXMucmVnaXN0ZXJzW3RoaXMuU09VTkRCSUFTID4+IDFdID0gdGhpcy5ERUZBVUxUX1NPVU5EQklBUzsKCXRoaXMucmVnaXN0ZXJzW3RoaXMuQkcyUEEgPj4gMV0gPSB0aGlzLkRFRkFVTFRfQkdQQTsKCXRoaXMucmVnaXN0ZXJzW3RoaXMuQkcyUEQgPj4gMV0gPSB0aGlzLkRFRkFVTFRfQkdQRDsKCXRoaXMucmVnaXN0ZXJzW3RoaXMuQkczUEEgPj4gMV0gPSB0aGlzLkRFRkFVTFRfQkdQQTsKCXRoaXMucmVnaXN0ZXJzW3RoaXMuQkczUEQgPj4gMV0gPSB0aGlzLkRFRkFVTFRfQkdQRDsKCXRoaXMucmVnaXN0ZXJzW3RoaXMuUkNOVCA+PiAxXSA9IHRoaXMuREVGQVVMVF9SQ05UOwp9OwoKR2FtZUJveUFkdmFuY2VJTy5wcm90b3R5cGUuZnJlZXplID0gZnVuY3Rpb24oKSB7CglyZXR1cm4gewoJCSdyZWdpc3RlcnMnOiBTZXJpYWxpemVyLnByZWZpeCh0aGlzLnJlZ2lzdGVycy5idWZmZXIpCgl9Owp9OwoKR2FtZUJveUFkdmFuY2VJTy5wcm90b3R5cGUuZGVmcm9zdCA9IGZ1bmN0aW9uKGZyb3N0KSB7Cgl0aGlzLnJlZ2lzdGVycyA9IG5ldyBVaW50MTZBcnJheShmcm9zdC5yZWdpc3RlcnMpOwoJLy8gVmlkZW8gcmVnaXN0ZXJzIGRvbid0IHNlcmlhbGl6ZSB0aGVtc2VsdmVzCglmb3IgKHZhciBpID0gMDsgaSA8PSB0aGlzLkJMRFk7IGkgKz0gMikgewoJCXRoaXMuc3RvcmUxNih0aGlzLnJlZ2lzdGVyc1tpID4+IDFdKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlSU8ucHJvdG90eXBlLmxvYWQ4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7Cgl0aHJvdyAnVW5pbXBsbWVuZXRlZCB1bmFsaWduZWQgSS9PIGFjY2Vzcyc7Cn0KCkdhbWVCb3lBZHZhbmNlSU8ucHJvdG90eXBlLmxvYWQxNiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuICh0aGlzLmxvYWRVMTYob2Zmc2V0KSA8PCAxNikgPj4gMTY7Cn0KCkdhbWVCb3lBZHZhbmNlSU8ucHJvdG90eXBlLmxvYWQzMiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJb2Zmc2V0ICY9IDB4RkZGRkZGRkM7Cglzd2l0Y2ggKG9mZnNldCkgewoJY2FzZSB0aGlzLkRNQTBDTlRfTE86CgljYXNlIHRoaXMuRE1BMUNOVF9MTzoKCWNhc2UgdGhpcy5ETUEyQ05UX0xPOgoJY2FzZSB0aGlzLkRNQTNDTlRfTE86CgkJcmV0dXJuIHRoaXMubG9hZFUxNihvZmZzZXQgfCAyKSA8PCAxNjsKCWNhc2UgdGhpcy5JTUU6CgkJcmV0dXJuIHRoaXMubG9hZFUxNihvZmZzZXQpICYgMHhGRkZGOwoJY2FzZSB0aGlzLkpPWV9SRUNWOgoJY2FzZSB0aGlzLkpPWV9UUkFOUzoKIAkJdGhpcy5jb3JlLlNUVUIoJ1VuaW1wbGVtZW50ZWQgSk9ZIHJlZ2lzdGVyIHJlYWQ6IDB4JyArIG9mZnNldC50b1N0cmluZygxNikpOwogCQlyZXR1cm4gMDsKCX0KCglyZXR1cm4gdGhpcy5sb2FkVTE2KG9mZnNldCkgfCAodGhpcy5sb2FkVTE2KG9mZnNldCB8IDIpIDw8IDE2KTsKfTsKCkdhbWVCb3lBZHZhbmNlSU8ucHJvdG90eXBlLmxvYWRVOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJdmFyIG9kZCA9IG9mZnNldCAmIDB4MDAwMTsKCXZhciB2YWx1ZSA9IHRoaXMubG9hZFUxNihvZmZzZXQgJiAweEZGRkUpOwoJcmV0dXJuICh2YWx1ZSA+Pj4gKG9kZCA8PCAzKSkgJiAweEZGOwp9CgpHYW1lQm95QWR2YW5jZUlPLnByb3RvdHlwZS5sb2FkVTE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7Cglzd2l0Y2ggKG9mZnNldCkgewoJY2FzZSB0aGlzLkRJU1BDTlQ6CgljYXNlIHRoaXMuQkcwQ05UOgoJY2FzZSB0aGlzLkJHMUNOVDoKCWNhc2UgdGhpcy5CRzJDTlQ6CgljYXNlIHRoaXMuQkczQ05UOgoJY2FzZSB0aGlzLldJTklOOgoJY2FzZSB0aGlzLldJTk9VVDoKCWNhc2UgdGhpcy5TT1VORDFDTlRfTE86CgljYXNlIHRoaXMuU09VTkQzQ05UX0xPOgoJY2FzZSB0aGlzLlNPVU5EQ05UX0xPOgoJY2FzZSB0aGlzLlNPVU5EQ05UX0hJOgoJY2FzZSB0aGlzLlNPVU5EQklBUzoKCWNhc2UgdGhpcy5CTERDTlQ6CgljYXNlIHRoaXMuQkxEQUxQSEE6CgoJY2FzZSB0aGlzLlRNMENOVF9ISToKCWNhc2UgdGhpcy5UTTFDTlRfSEk6CgljYXNlIHRoaXMuVE0yQ05UX0hJOgoJY2FzZSB0aGlzLlRNM0NOVF9ISToKCWNhc2UgdGhpcy5ETUEwQ05UX0hJOgoJY2FzZSB0aGlzLkRNQTFDTlRfSEk6CgljYXNlIHRoaXMuRE1BMkNOVF9ISToKCWNhc2UgdGhpcy5ETUEzQ05UX0hJOgoJY2FzZSB0aGlzLlJDTlQ6CgljYXNlIHRoaXMuV0FJVENOVDoKCWNhc2UgdGhpcy5JRToKCWNhc2UgdGhpcy5JRjoKCWNhc2UgdGhpcy5JTUU6CgljYXNlIHRoaXMuUE9TVEZMRzoKCQkvLyBIYW5kbGVkIHRyYW5zcGFyZW50bHkgYnkgdGhlIHdyaXR0ZW4gcmVnaXN0ZXJzCgkJYnJlYWs7CgoJLy8gVmlkZW8KCWNhc2UgdGhpcy5ESVNQU1RBVDoKCQlyZXR1cm4gdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdIHwgdGhpcy52aWRlby5yZWFkRGlzcGxheVN0YXQoKTsKCWNhc2UgdGhpcy5WQ09VTlQ6CgkJcmV0dXJuIHRoaXMudmlkZW8udmNvdW50OwoKCS8vIFNvdW5kCgljYXNlIHRoaXMuU09VTkQxQ05UX0hJOgoJY2FzZSB0aGlzLlNPVU5EMkNOVF9MTzoKCQlyZXR1cm4gdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdICYgMHhGRkMwOwoJY2FzZSB0aGlzLlNPVU5EMUNOVF9YOgoJY2FzZSB0aGlzLlNPVU5EMkNOVF9ISToKCWNhc2UgdGhpcy5TT1VORDNDTlRfWDoKCQlyZXR1cm4gdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdICYgMHg0MDAwOwoJY2FzZSB0aGlzLlNPVU5EM0NOVF9ISToKCQlyZXR1cm4gdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdICYgMHhFMDAwOwoJY2FzZSB0aGlzLlNPVU5ENENOVF9MTzoKCQlyZXR1cm4gdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdICYgMHhGRjAwOwoJY2FzZSB0aGlzLlNPVU5ENENOVF9ISToKCQlyZXR1cm4gdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdICYgMHg0MEZGOwoJY2FzZSB0aGlzLlNPVU5EQ05UX1g6CgkJdGhpcy5jb3JlLlNUVUIoJ1VuaW1wbGVtZW50ZWQgc291bmQgcmVnaXN0ZXIgcmVhZDogU09VTkRDTlRfWCcpOwoJCXJldHVybiB0aGlzLnJlZ2lzdGVyc1tvZmZzZXQgPj4gMV0gfCAweDAwMDA7CgoJLy8gVGltZXJzCgljYXNlIHRoaXMuVE0wQ05UX0xPOgoJCXJldHVybiB0aGlzLmNwdS5pcnEudGltZXJSZWFkKDApOwoJY2FzZSB0aGlzLlRNMUNOVF9MTzoKCQlyZXR1cm4gdGhpcy5jcHUuaXJxLnRpbWVyUmVhZCgxKTsKCWNhc2UgdGhpcy5UTTJDTlRfTE86CgkJcmV0dXJuIHRoaXMuY3B1LmlycS50aW1lclJlYWQoMik7CgljYXNlIHRoaXMuVE0zQ05UX0xPOgoJCXJldHVybiB0aGlzLmNwdS5pcnEudGltZXJSZWFkKDMpOwoKCS8vIFNJTwoJY2FzZSB0aGlzLlNJT0NOVDoKCQlyZXR1cm4gdGhpcy5zaW8ucmVhZFNJT0NOVCgpOwoKCWNhc2UgdGhpcy5LRVlJTlBVVDoKCQl0aGlzLmtleXBhZC5wb2xsR2FtZXBhZHMoKTsKCQlyZXR1cm4gdGhpcy5rZXlwYWQuY3VycmVudERvd247CgljYXNlIHRoaXMuS0VZQ05UOgoJCXRoaXMuY29yZS5TVFVCKCdVbmltcGxlbWVudGVkIEkvTyByZWdpc3RlciByZWFkOiBLRVlDTlQnKTsKCQlyZXR1cm4gMDsKCgljYXNlIHRoaXMuQkcwSE9GUzoKCWNhc2UgdGhpcy5CRzBWT0ZTOgoJY2FzZSB0aGlzLkJHMUhPRlM6CgljYXNlIHRoaXMuQkcxVk9GUzoKCWNhc2UgdGhpcy5CRzJIT0ZTOgoJY2FzZSB0aGlzLkJHMlZPRlM6CgljYXNlIHRoaXMuQkczSE9GUzoKCWNhc2UgdGhpcy5CRzNWT0ZTOgoJY2FzZSB0aGlzLkJHMlBBOgoJY2FzZSB0aGlzLkJHMlBCOgoJY2FzZSB0aGlzLkJHMlBDOgoJY2FzZSB0aGlzLkJHMlBEOgoJY2FzZSB0aGlzLkJHM1BBOgoJY2FzZSB0aGlzLkJHM1BCOgoJY2FzZSB0aGlzLkJHM1BDOgoJY2FzZSB0aGlzLkJHM1BEOgoJY2FzZSB0aGlzLkJHMlhfTE86CgljYXNlIHRoaXMuQkcyWF9ISToKCWNhc2UgdGhpcy5CRzJZX0xPOgoJY2FzZSB0aGlzLkJHMllfSEk6CgljYXNlIHRoaXMuQkczWF9MTzoKCWNhc2UgdGhpcy5CRzNYX0hJOgoJY2FzZSB0aGlzLkJHM1lfTE86CgljYXNlIHRoaXMuQkczWV9ISToKCWNhc2UgdGhpcy5XSU4wSDoKCWNhc2UgdGhpcy5XSU4xSDoKCWNhc2UgdGhpcy5XSU4wVjoKCWNhc2UgdGhpcy5XSU4xVjoKCWNhc2UgdGhpcy5CTERZOgoJY2FzZSB0aGlzLkRNQTBTQURfTE86CgljYXNlIHRoaXMuRE1BMFNBRF9ISToKCWNhc2UgdGhpcy5ETUEwREFEX0xPOgoJY2FzZSB0aGlzLkRNQTBEQURfSEk6CgljYXNlIHRoaXMuRE1BMENOVF9MTzoKCWNhc2UgdGhpcy5ETUExU0FEX0xPOgoJY2FzZSB0aGlzLkRNQTFTQURfSEk6CgljYXNlIHRoaXMuRE1BMURBRF9MTzoKCWNhc2UgdGhpcy5ETUExREFEX0hJOgoJY2FzZSB0aGlzLkRNQTFDTlRfTE86CgljYXNlIHRoaXMuRE1BMlNBRF9MTzoKCWNhc2UgdGhpcy5ETUEyU0FEX0hJOgoJY2FzZSB0aGlzLkRNQTJEQURfTE86CgljYXNlIHRoaXMuRE1BMkRBRF9ISToKCWNhc2UgdGhpcy5ETUEyQ05UX0xPOgoJY2FzZSB0aGlzLkRNQTNTQURfTE86CgljYXNlIHRoaXMuRE1BM1NBRF9ISToKCWNhc2UgdGhpcy5ETUEzREFEX0xPOgoJY2FzZSB0aGlzLkRNQTNEQURfSEk6CgljYXNlIHRoaXMuRE1BM0NOVF9MTzoKCWNhc2UgdGhpcy5GSUZPX0FfTE86CgljYXNlIHRoaXMuRklGT19BX0hJOgoJY2FzZSB0aGlzLkZJRk9fQl9MTzoKCWNhc2UgdGhpcy5GSUZPX0JfSEk6CgkJdGhpcy5jb3JlLldBUk4oJ1JlYWQgZm9yIHdyaXRlLW9ubHkgcmVnaXN0ZXI6IDB4JyArIG9mZnNldC50b1N0cmluZygxNikpOwoJCXJldHVybiB0aGlzLmNvcmUubW11LmJhZE1lbW9yeS5sb2FkVTE2KDApOwoKCWNhc2UgdGhpcy5NT1NBSUM6CgkJdGhpcy5jb3JlLldBUk4oJ1JlYWQgZm9yIHdyaXRlLW9ubHkgcmVnaXN0ZXI6IDB4JyArIG9mZnNldC50b1N0cmluZygxNikpOwoJCXJldHVybiAwOwoKCWNhc2UgdGhpcy5TSU9NVUxUSTA6CiAJY2FzZSB0aGlzLlNJT01VTFRJMToKIAljYXNlIHRoaXMuU0lPTVVMVEkyOgogCWNhc2UgdGhpcy5TSU9NVUxUSTM6CiAJCXJldHVybiB0aGlzLnNpby5yZWFkKChvZmZzZXQgLSB0aGlzLlNJT01VTFRJMCkgPj4gMSk7CgogCWNhc2UgdGhpcy5TSU9EQVRBODoKIAkJdGhpcy5jb3JlLlNUVUIoJ1VuaW1wbGVtZW50ZWQgU0lPIHJlZ2lzdGVyIHJlYWQ6IDB4JyArIG9mZnNldC50b1N0cmluZygxNikpOwogCQlyZXR1cm4gMDsKCWNhc2UgdGhpcy5KT1lDTlQ6CgljYXNlIHRoaXMuSk9ZU1RBVDoKIAkJdGhpcy5jb3JlLlNUVUIoJ1VuaW1wbGVtZW50ZWQgSk9ZIHJlZ2lzdGVyIHJlYWQ6IDB4JyArIG9mZnNldC50b1N0cmluZygxNikpOwogCQlyZXR1cm4gMDsKCglkZWZhdWx0OgoJCXRoaXMuY29yZS5XQVJOKCdCYWQgSS9PIHJlZ2lzdGVyIHJlYWQ6IDB4JyArIG9mZnNldC50b1N0cmluZygxNikpOwoJCXJldHVybiB0aGlzLmNvcmUubW11LmJhZE1lbW9yeS5sb2FkVTE2KDApOwoJfQoJcmV0dXJuIHRoaXMucmVnaXN0ZXJzW29mZnNldCA+PiAxXTsKfTsKCkdhbWVCb3lBZHZhbmNlSU8ucHJvdG90eXBlLnN0b3JlOCA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXN3aXRjaCAob2Zmc2V0KSB7CgljYXNlIHRoaXMuV0lOSU46CgkJdGhpcy52YWx1ZSAmIDB4M0Y7CgkJYnJlYWs7CgljYXNlIHRoaXMuV0lOSU4gfCAxOgoJCXRoaXMudmFsdWUgJiAweDNGOwoJCWJyZWFrOwoJY2FzZSB0aGlzLldJTk9VVDoKCQl0aGlzLnZhbHVlICYgMHgzRjsKCQlicmVhazsKCWNhc2UgdGhpcy5XSU5PVVQgfCAxOgoJCXRoaXMudmFsdWUgJiAweDNGOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNPVU5EMUNOVF9MTzoKCWNhc2UgdGhpcy5TT1VORDFDTlRfTE8gfCAxOgoJY2FzZSB0aGlzLlNPVU5EMUNOVF9ISToKCWNhc2UgdGhpcy5TT1VORDFDTlRfSEkgfCAxOgoJY2FzZSB0aGlzLlNPVU5EMUNOVF9YOgoJY2FzZSB0aGlzLlNPVU5EMUNOVF9YIHwgMToKCWNhc2UgdGhpcy5TT1VORDJDTlRfTE86CgljYXNlIHRoaXMuU09VTkQyQ05UX0xPIHwgMToKCWNhc2UgdGhpcy5TT1VORDJDTlRfSEk6CgljYXNlIHRoaXMuU09VTkQyQ05UX0hJIHwgMToKCWNhc2UgdGhpcy5TT1VORDNDTlRfTE86CgljYXNlIHRoaXMuU09VTkQzQ05UX0xPIHwgMToKCWNhc2UgdGhpcy5TT1VORDNDTlRfSEk6CgljYXNlIHRoaXMuU09VTkQzQ05UX0hJIHwgMToKCWNhc2UgdGhpcy5TT1VORDNDTlRfWDoKCWNhc2UgdGhpcy5TT1VORDNDTlRfWCB8IDE6CgljYXNlIHRoaXMuU09VTkQ0Q05UX0xPOgoJY2FzZSB0aGlzLlNPVU5ENENOVF9MTyB8IDE6CgljYXNlIHRoaXMuU09VTkQ0Q05UX0hJOgoJY2FzZSB0aGlzLlNPVU5ENENOVF9ISSB8IDE6CgljYXNlIHRoaXMuU09VTkRDTlRfTE86CgljYXNlIHRoaXMuU09VTkRDTlRfTE8gfCAxOgoJY2FzZSB0aGlzLlNPVU5EQ05UX1g6CgljYXNlIHRoaXMuSUY6CgljYXNlIHRoaXMuSU1FOgoJCWJyZWFrOwoJY2FzZSB0aGlzLlNPVU5EQklBUyB8IDE6CgkJdGhpcy5TVFVCX1JFRygnc291bmQnLCBvZmZzZXQpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkhBTFRDTlQ6CgkJdmFsdWUgJj0gMHg4MDsKCQlpZiAoIXZhbHVlKSB7CgkJCXRoaXMuY29yZS5pcnEuaGFsdCgpOwoJCX0gZWxzZSB7CgkJCXRoaXMuY29yZS5TVFVCKCdTdG9wJyk7CgkJfQoJCXJldHVybjsKCWRlZmF1bHQ6CgkJdGhpcy5TVFVCX1JFRygnOC1iaXQgSS9PJywgb2Zmc2V0KTsKCQlicmVhazsKCX0KCglpZiAob2Zmc2V0ICYgMSkgewoJCXZhbHVlIDw8PSA4OwoJCXZhbHVlIHw9ICh0aGlzLnJlZ2lzdGVyc1tvZmZzZXQgPj4gMV0gJiAweDAwRkYpOwoJfSBlbHNlIHsKCQl2YWx1ZSAmPSAweDAwRkY7CgkJdmFsdWUgfD0gKHRoaXMucmVnaXN0ZXJzW29mZnNldCA+PiAxXSAmIDB4RkYwMCk7Cgl9Cgl0aGlzLnN0b3JlMTYob2Zmc2V0ICYgMHhGRkZGRkZFLCB2YWx1ZSk7Cn07CgpHYW1lQm95QWR2YW5jZUlPLnByb3RvdHlwZS5zdG9yZTE2ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJc3dpdGNoIChvZmZzZXQpIHsKCS8vIFZpZGVvCgljYXNlIHRoaXMuRElTUENOVDoKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVEaXNwbGF5Q29udHJvbCh2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuRElTUFNUQVQ6CgkJdmFsdWUgJj0gdGhpcy52aWRlby5ESVNQU1RBVF9NQVNLOwoJCXRoaXMudmlkZW8ud3JpdGVEaXNwbGF5U3RhdCh2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkcwQ05UOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRDb250cm9sKDAsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzFDTlQ6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZENvbnRyb2woMSwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHMkNOVDoKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVCYWNrZ3JvdW5kQ29udHJvbCgyLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczQ05UOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRDb250cm9sKDMsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzBIT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRIT2Zmc2V0KDAsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzBWT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRWT2Zmc2V0KDAsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzFIT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRIT2Zmc2V0KDEsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzFWT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRWT2Zmc2V0KDEsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzJIT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRIT2Zmc2V0KDIsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzJWT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRWT2Zmc2V0KDIsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzNIT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRIT2Zmc2V0KDMsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzNWT0ZTOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRWT2Zmc2V0KDMsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzJYX0xPOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRSZWZYKDIsICh0aGlzLnJlZ2lzdGVyc1sob2Zmc2V0ID4+IDEpIHwgMV0gPDwgMTYpIHwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHMlhfSEk6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFJlZlgoMiwgdGhpcy5yZWdpc3RlcnNbKG9mZnNldCA+PiAxKSBeIDFdIHwgKHZhbHVlIDw8IDE2KSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkcyWV9MTzoKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVCYWNrZ3JvdW5kUmVmWSgyLCAodGhpcy5yZWdpc3RlcnNbKG9mZnNldCA+PiAxKSB8IDFdIDw8IDE2KSB8IHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzJZX0hJOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRSZWZZKDIsIHRoaXMucmVnaXN0ZXJzWyhvZmZzZXQgPj4gMSkgXiAxXSB8ICh2YWx1ZSA8PCAxNikpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHMlBBOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRQYXJhbUEoMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHMlBCOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRQYXJhbUIoMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHMlBDOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRQYXJhbUMoMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHMlBEOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRQYXJhbUQoMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHM1hfTE86CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFJlZlgoMywgKHRoaXMucmVnaXN0ZXJzWyhvZmZzZXQgPj4gMSkgfCAxXSA8PCAxNikgfCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczWF9ISToKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVCYWNrZ3JvdW5kUmVmWCgzLCB0aGlzLnJlZ2lzdGVyc1sob2Zmc2V0ID4+IDEpIF4gMV0gfCAodmFsdWUgPDwgMTYpKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzNZX0xPOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRSZWZZKDMsICh0aGlzLnJlZ2lzdGVyc1sob2Zmc2V0ID4+IDEpIHwgMV0gPDwgMTYpIHwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHM1lfSEk6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFJlZlkoMywgdGhpcy5yZWdpc3RlcnNbKG9mZnNldCA+PiAxKSBeIDFdIHwgKHZhbHVlIDw8IDE2KSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczUEE6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFBhcmFtQSgzLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczUEI6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFBhcmFtQigzLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczUEM6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFBhcmFtQygzLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczUEQ6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFBhcmFtRCgzLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuV0lOMEg6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlV2luMEgodmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLldJTjFIOgoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZVdpbjFIKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5XSU4wVjoKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVXaW4wVih2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuV0lOMVY6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlV2luMVYodmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLldJTklOOgoJCXZhbHVlICY9IDB4M0YzRjsKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVXaW5Jbih2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuV0lOT1VUOgoJCXZhbHVlICY9IDB4M0YzRjsKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVXaW5PdXQodmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJMRENOVDoKCQl2YWx1ZSAmPSAweDdGRkY7CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmxlbmRDb250cm9sKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CTERBTFBIQToKCQl2YWx1ZSAmPSAweDFGMUY7CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmxlbmRBbHBoYSh2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkxEWToKCQl2YWx1ZSAmPSAweDAwMUY7CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmxlbmRZKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5NT1NBSUM6CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlTW9zYWljKHZhbHVlKTsKCQlicmVhazsKCgkvLyBTb3VuZAoJY2FzZSB0aGlzLlNPVU5EMUNOVF9MTzoKCQl2YWx1ZSAmPSAweDAwN0Y7CgkJdGhpcy5hdWRpby53cml0ZVNxdWFyZUNoYW5uZWxTd2VlcCgwLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuU09VTkQxQ05UX0hJOgoJCXRoaXMuYXVkaW8ud3JpdGVTcXVhcmVDaGFubmVsRExFKDAsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDFDTlRfWDoKCQl2YWx1ZSAmPSAweEM3RkY7CgkJdGhpcy5hdWRpby53cml0ZVNxdWFyZUNoYW5uZWxGQygwLCB2YWx1ZSk7CgkJdmFsdWUgJj0gfjB4ODAwMDsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDJDTlRfTE86CgkJdGhpcy5hdWRpby53cml0ZVNxdWFyZUNoYW5uZWxETEUoMSwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNPVU5EMkNOVF9ISToKCQl2YWx1ZSAmPSAweEM3RkY7CgkJdGhpcy5hdWRpby53cml0ZVNxdWFyZUNoYW5uZWxGQygxLCB2YWx1ZSk7CgkJdmFsdWUgJj0gfjB4ODAwMDsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDNDTlRfTE86CgkJdmFsdWUgJj0gMHgwMEUwOwoJCXRoaXMuYXVkaW8ud3JpdGVDaGFubmVsM0xvKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDNDTlRfSEk6CgkJdmFsdWUgJj0gMHhFMEZGOwoJCXRoaXMuYXVkaW8ud3JpdGVDaGFubmVsM0hpKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDNDTlRfWDoKCQl2YWx1ZSAmPSAweEM3RkY7CgkJdGhpcy5hdWRpby53cml0ZUNoYW5uZWwzWCh2YWx1ZSk7CgkJdmFsdWUgJj0gfjB4ODAwMDsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDRDTlRfTE86CgkJdmFsdWUgJj0gMHhGRjNGOwoJCXRoaXMuYXVkaW8ud3JpdGVDaGFubmVsNExFKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TT1VORDRDTlRfSEk6CgkJdmFsdWUgJj0gMHhDMEZGOwoJCXRoaXMuYXVkaW8ud3JpdGVDaGFubmVsNEZDKHZhbHVlKTsKCQl2YWx1ZSAmPSB+MHg4MDAwOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNPVU5EQ05UX0xPOgoJCXZhbHVlICY9IDB4RkY3NzsKCQl0aGlzLmF1ZGlvLndyaXRlU291bmRDb250cm9sTG8odmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNPVU5EQ05UX0hJOgoJCXZhbHVlICY9IDB4RkYwRjsKCQl0aGlzLmF1ZGlvLndyaXRlU291bmRDb250cm9sSGkodmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNPVU5EQ05UX1g6CgkJdmFsdWUgJj0gMHgwMDgwOwoJCXRoaXMuYXVkaW8ud3JpdGVFbmFibGUodmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLldBVkVfUkFNMF9MTzoKCWNhc2UgdGhpcy5XQVZFX1JBTTBfSEk6CgljYXNlIHRoaXMuV0FWRV9SQU0xX0xPOgoJY2FzZSB0aGlzLldBVkVfUkFNMV9ISToKCWNhc2UgdGhpcy5XQVZFX1JBTTJfTE86CgljYXNlIHRoaXMuV0FWRV9SQU0yX0hJOgoJY2FzZSB0aGlzLldBVkVfUkFNM19MTzoKCWNhc2UgdGhpcy5XQVZFX1JBTTNfSEk6CgkJdGhpcy5hdWRpby53cml0ZVdhdmVEYXRhKG9mZnNldCAtIHRoaXMuV0FWRV9SQU0wX0xPLCB2YWx1ZSwgMik7CgkJYnJlYWs7CgoJLy8gRE1BCgljYXNlIHRoaXMuRE1BMFNBRF9MTzoKCWNhc2UgdGhpcy5ETUEwREFEX0xPOgoJY2FzZSB0aGlzLkRNQTFTQURfTE86CgljYXNlIHRoaXMuRE1BMURBRF9MTzoKCWNhc2UgdGhpcy5ETUEyU0FEX0xPOgoJY2FzZSB0aGlzLkRNQTJEQURfTE86CgljYXNlIHRoaXMuRE1BM1NBRF9MTzoKCWNhc2UgdGhpcy5ETUEzREFEX0xPOgoJCXRoaXMuc3RvcmUzMihvZmZzZXQsICh0aGlzLnJlZ2lzdGVyc1sob2Zmc2V0ID4+IDEpICsgMV0gPDwgMTYpIHwgdmFsdWUpOwoJCXJldHVybjsKCgljYXNlIHRoaXMuRE1BMFNBRF9ISToKCWNhc2UgdGhpcy5ETUEwREFEX0hJOgoJY2FzZSB0aGlzLkRNQTFTQURfSEk6CgljYXNlIHRoaXMuRE1BMURBRF9ISToKCWNhc2UgdGhpcy5ETUEyU0FEX0hJOgoJY2FzZSB0aGlzLkRNQTJEQURfSEk6CgljYXNlIHRoaXMuRE1BM1NBRF9ISToKCWNhc2UgdGhpcy5ETUEzREFEX0hJOgoJCXRoaXMuc3RvcmUzMihvZmZzZXQgLSAyLCB0aGlzLnJlZ2lzdGVyc1sob2Zmc2V0ID4+IDEpIC0gMV0gfCAodmFsdWUgPDwgMTYpKTsKCQlyZXR1cm47CgoJY2FzZSB0aGlzLkRNQTBDTlRfTE86CgkJdGhpcy5jcHUuaXJxLmRtYVNldFdvcmRDb3VudCgwLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuRE1BMENOVF9ISToKCQkvLyBUaGUgRE1BIHJlZ2lzdGVycyBuZWVkIHRvIHNldCB0aGUgdmFsdWVzIGJlZm9yZSB3cml0aW5nIHRoZSBjb250cm9sLCBhcyB3cml0aW5nIHRoZQoJCS8vIGNvbnRyb2wgY2FuIHN5bmNocm9ub3VzbHkgdHJpZ2dlciBhIERNQSB0cmFuc2ZlcgoJCXRoaXMucmVnaXN0ZXJzW29mZnNldCA+PiAxXSA9IHZhbHVlICYgMHhGRkUwOwoJCXRoaXMuY3B1LmlycS5kbWFXcml0ZUNvbnRyb2woMCwgdmFsdWUpOwoJCXJldHVybjsKCWNhc2UgdGhpcy5ETUExQ05UX0xPOgoJCXRoaXMuY3B1LmlycS5kbWFTZXRXb3JkQ291bnQoMSwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkRNQTFDTlRfSEk6CgkJdGhpcy5yZWdpc3RlcnNbb2Zmc2V0ID4+IDFdID0gdmFsdWUgJiAweEZGRTA7CgkJdGhpcy5jcHUuaXJxLmRtYVdyaXRlQ29udHJvbCgxLCB2YWx1ZSk7CgkJcmV0dXJuOwoJY2FzZSB0aGlzLkRNQTJDTlRfTE86CgkJdGhpcy5jcHUuaXJxLmRtYVNldFdvcmRDb3VudCgyLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuRE1BMkNOVF9ISToKCQl0aGlzLnJlZ2lzdGVyc1tvZmZzZXQgPj4gMV0gPSB2YWx1ZSAmIDB4RkZFMDsKCQl0aGlzLmNwdS5pcnEuZG1hV3JpdGVDb250cm9sKDIsIHZhbHVlKTsKCQlyZXR1cm47CgljYXNlIHRoaXMuRE1BM0NOVF9MTzoKCQl0aGlzLmNwdS5pcnEuZG1hU2V0V29yZENvdW50KDMsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5ETUEzQ05UX0hJOgoJCXRoaXMucmVnaXN0ZXJzW29mZnNldCA+PiAxXSA9IHZhbHVlICYgMHhGRkUwOwoJCXRoaXMuY3B1LmlycS5kbWFXcml0ZUNvbnRyb2woMywgdmFsdWUpOwoJCXJldHVybjsKCgkvLyBUaW1lcnMKCWNhc2UgdGhpcy5UTTBDTlRfTE86CgkJdGhpcy5jcHUuaXJxLnRpbWVyU2V0UmVsb2FkKDAsIHZhbHVlKTsKCQlyZXR1cm47CgljYXNlIHRoaXMuVE0xQ05UX0xPOgoJCXRoaXMuY3B1LmlycS50aW1lclNldFJlbG9hZCgxLCB2YWx1ZSk7CgkJcmV0dXJuOwoJY2FzZSB0aGlzLlRNMkNOVF9MTzoKCQl0aGlzLmNwdS5pcnEudGltZXJTZXRSZWxvYWQoMiwgdmFsdWUpOwoJCXJldHVybjsKCWNhc2UgdGhpcy5UTTNDTlRfTE86CgkJdGhpcy5jcHUuaXJxLnRpbWVyU2V0UmVsb2FkKDMsIHZhbHVlKTsKCQlyZXR1cm47CgoJY2FzZSB0aGlzLlRNMENOVF9ISToKCQl2YWx1ZSAmPSAweDAwQzcKCQl0aGlzLmNwdS5pcnEudGltZXJXcml0ZUNvbnRyb2woMCwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlRNMUNOVF9ISToKCQl2YWx1ZSAmPSAweDAwQzcKCQl0aGlzLmNwdS5pcnEudGltZXJXcml0ZUNvbnRyb2woMSwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlRNMkNOVF9ISToKCQl2YWx1ZSAmPSAweDAwQzcKCQl0aGlzLmNwdS5pcnEudGltZXJXcml0ZUNvbnRyb2woMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlRNM0NOVF9ISToKCQl2YWx1ZSAmPSAweDAwQzcKCQl0aGlzLmNwdS5pcnEudGltZXJXcml0ZUNvbnRyb2woMywgdmFsdWUpOwoJCWJyZWFrOwoKCS8vIFNJTwoJY2FzZSB0aGlzLlNJT01VTFRJMDoKIAljYXNlIHRoaXMuU0lPTVVMVEkxOgogCWNhc2UgdGhpcy5TSU9NVUxUSTI6CiAJY2FzZSB0aGlzLlNJT01VTFRJMzoKIAljYXNlIHRoaXMuU0lPREFUQTg6CiAJCXRoaXMuU1RVQl9SRUcoJ1NJTycsIG9mZnNldCk7CiAJCWJyZWFrOwoJY2FzZSB0aGlzLlJDTlQ6CgkJdGhpcy5zaW8uc2V0TW9kZSgoKHZhbHVlID4+IDEyKSAmIDB4QykgfCAoKHRoaXMucmVnaXN0ZXJzW3RoaXMuU0lPQ05UID4+IDFdID4+IDEyKSAmIDB4MykpOwoJCXRoaXMuc2lvLndyaXRlUkNOVCh2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuU0lPQ05UOgoJCXRoaXMuc2lvLnNldE1vZGUoKCh2YWx1ZSA+PiAxMikgJiAweDMpIHwgKCh0aGlzLnJlZ2lzdGVyc1t0aGlzLlJDTlQgPj4gMV0gPj4gMTIpICYgMHhDKSk7CgkJdGhpcy5zaW8ud3JpdGVTSU9DTlQodmFsdWUpOwoJCXJldHVybjsKCWNhc2UgdGhpcy5KT1lDTlQ6CgljYXNlIHRoaXMuSk9ZU1RBVDoKCQl0aGlzLlNUVUJfUkVHKCdKT1knLCBvZmZzZXQpOwoJCWJyZWFrOwoKCS8vIE1pc2MKCWNhc2UgdGhpcy5JRToKCQl2YWx1ZSAmPSAweDNGRkY7CgkJdGhpcy5jcHUuaXJxLnNldEludGVycnVwdHNFbmFibGVkKHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5JRjoKCQl0aGlzLmNwdS5pcnEuZGlzbWlzc0lSUXModmFsdWUpOwoJCXJldHVybjsKCWNhc2UgdGhpcy5XQUlUQ05UOgoJCXZhbHVlICY9IDB4REZGRjsKCQl0aGlzLmNwdS5tbXUuYWRqdXN0VGltaW5ncyh2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuSU1FOgoJCXZhbHVlICY9IDB4MDAwMTsKCQl0aGlzLmNwdS5pcnEubWFzdGVyRW5hYmxlKHZhbHVlKTsKCQlicmVhazsKCWRlZmF1bHQ6CgkJdGhpcy5TVFVCX1JFRygnSS9PJywgb2Zmc2V0KTsKCX0KCXRoaXMucmVnaXN0ZXJzW29mZnNldCA+PiAxXSA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VJTy5wcm90b3R5cGUuc3RvcmUzMiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXN3aXRjaCAob2Zmc2V0KSB7CgljYXNlIHRoaXMuQkcyWF9MTzoKCQl2YWx1ZSAmPSAweDBGRkZGRkZGOwoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRSZWZYKDIsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5CRzJZX0xPOgoJCXZhbHVlICY9IDB4MEZGRkZGRkY7CgkJdGhpcy52aWRlby5yZW5kZXJQYXRoLndyaXRlQmFja2dyb3VuZFJlZlkoMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkJHM1hfTE86CgkJdmFsdWUgJj0gMHgwRkZGRkZGRjsKCQl0aGlzLnZpZGVvLnJlbmRlclBhdGgud3JpdGVCYWNrZ3JvdW5kUmVmWCgzLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuQkczWV9MTzoKCQl2YWx1ZSAmPSAweDBGRkZGRkZGOwoJCXRoaXMudmlkZW8ucmVuZGVyUGF0aC53cml0ZUJhY2tncm91bmRSZWZZKDMsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5ETUEwU0FEX0xPOgoJCXRoaXMuY3B1LmlycS5kbWFTZXRTb3VyY2VBZGRyZXNzKDAsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5ETUEwREFEX0xPOgoJCXRoaXMuY3B1LmlycS5kbWFTZXREZXN0QWRkcmVzcygwLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuRE1BMVNBRF9MTzoKCQl0aGlzLmNwdS5pcnEuZG1hU2V0U291cmNlQWRkcmVzcygxLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuRE1BMURBRF9MTzoKCQl0aGlzLmNwdS5pcnEuZG1hU2V0RGVzdEFkZHJlc3MoMSwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkRNQTJTQURfTE86CgkJdGhpcy5jcHUuaXJxLmRtYVNldFNvdXJjZUFkZHJlc3MoMiwgdmFsdWUpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLkRNQTJEQURfTE86CgkJdGhpcy5jcHUuaXJxLmRtYVNldERlc3RBZGRyZXNzKDIsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5ETUEzU0FEX0xPOgoJCXRoaXMuY3B1LmlycS5kbWFTZXRTb3VyY2VBZGRyZXNzKDMsIHZhbHVlKTsKCQlicmVhazsKCWNhc2UgdGhpcy5ETUEzREFEX0xPOgoJCXRoaXMuY3B1LmlycS5kbWFTZXREZXN0QWRkcmVzcygzLCB2YWx1ZSk7CgkJYnJlYWs7CgljYXNlIHRoaXMuRklGT19BX0xPOgoJCXRoaXMuYXVkaW8uYXBwZW5kVG9GaWZvQSh2YWx1ZSk7CgkJcmV0dXJuOwoJY2FzZSB0aGlzLkZJRk9fQl9MTzoKCQl0aGlzLmF1ZGlvLmFwcGVuZFRvRmlmb0IodmFsdWUpOwoJCXJldHVybjsKCgkvLyBIaWdoIGJpdHMgb2YgdGhpcyB3cml0ZSBzaG91bGQgYmUgaWdub3JlZAoJY2FzZSB0aGlzLklNRToKCQl0aGlzLnN0b3JlMTYob2Zmc2V0LCB2YWx1ZSAmIDB4RkZGRik7CgkJcmV0dXJuOwoJY2FzZSB0aGlzLkpPWV9SRUNWOgoJY2FzZSB0aGlzLkpPWV9UUkFOUzoKCQl0aGlzLlNUVUJfUkVHKCdKT1knLCBvZmZzZXQpOwoJCXJldHVybjsKCWRlZmF1bHQ6CgkJdGhpcy5zdG9yZTE2KG9mZnNldCwgdmFsdWUgJiAweEZGRkYpOwoJCXRoaXMuc3RvcmUxNihvZmZzZXQgfCAyLCB2YWx1ZSA+Pj4gMTYpOwoJCXJldHVybjsKCX0KCgl0aGlzLnJlZ2lzdGVyc1tvZmZzZXQgPj4gMV0gPSB2YWx1ZSAmIDB4RkZGRjsKCXRoaXMucmVnaXN0ZXJzWyhvZmZzZXQgPj4gMSkgKyAxXSA9IHZhbHVlID4+PiAxNjsKfTsKCkdhbWVCb3lBZHZhbmNlSU8ucHJvdG90eXBlLmludmFsaWRhdGVQYWdlID0gZnVuY3Rpb24oYWRkcmVzcykge307CgpHYW1lQm95QWR2YW5jZUlPLnByb3RvdHlwZS5TVFVCX1JFRyA9IGZ1bmN0aW9uKHR5cGUsIG9mZnNldCkgewoJdGhpcy5jb3JlLlNUVUIoJ1VuaW1wbGVtZW50ZWQgJyArIHR5cGUgKyAnIHJlZ2lzdGVyIHdyaXRlOiAnICsgb2Zmc2V0LnRvU3RyaW5nKDE2KSk7Cn07Cg==";

const GBA_js_irq_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyKCkgewoJdGhpcy5pbmhlcml0KCk7Cgl0aGlzLkZSRVFVRU5DWSA9IDB4MTAwMDAwMDsKCgl0aGlzLmNwdSA9IG51bGw7Cgl0aGlzLmVuYWJsZSA9IGZhbHNlOwoKCXRoaXMuSVJRX1ZCTEFOSyA9IDB4MDsKCXRoaXMuSVJRX0hCTEFOSyA9IDB4MTsKCXRoaXMuSVJRX1ZDT1VOVEVSID0gMHgyOwoJdGhpcy5JUlFfVElNRVIwID0gMHgzOwoJdGhpcy5JUlFfVElNRVIxID0gMHg0OwoJdGhpcy5JUlFfVElNRVIyID0gMHg1OwoJdGhpcy5JUlFfVElNRVIzID0gMHg2OwoJdGhpcy5JUlFfU0lPID0gMHg3OwoJdGhpcy5JUlFfRE1BMCA9IDB4ODsKCXRoaXMuSVJRX0RNQTEgPSAweDk7Cgl0aGlzLklSUV9ETUEyID0gMHhBOwoJdGhpcy5JUlFfRE1BMyA9IDB4QjsKCXRoaXMuSVJRX0tFWVBBRCA9IDB4QzsKCXRoaXMuSVJRX0dBTUVQQUsgPSAweEQ7CgoJdGhpcy5NQVNLX1ZCTEFOSyA9IDB4MDAwMTsKCXRoaXMuTUFTS19IQkxBTksgPSAweDAwMDI7Cgl0aGlzLk1BU0tfVkNPVU5URVIgPSAweDAwMDQ7Cgl0aGlzLk1BU0tfVElNRVIwID0gMHgwMDA4OwoJdGhpcy5NQVNLX1RJTUVSMSA9IDB4MDAxMDsKCXRoaXMuTUFTS19USU1FUjIgPSAweDAwMjA7Cgl0aGlzLk1BU0tfVElNRVIzID0gMHgwMDQwOwoJdGhpcy5NQVNLX1NJTyA9IDB4MDA4MDsKCXRoaXMuTUFTS19ETUEwID0gMHgwMTAwOwoJdGhpcy5NQVNLX0RNQTEgPSAweDAyMDA7Cgl0aGlzLk1BU0tfRE1BMiA9IDB4MDQwMDsKCXRoaXMuTUFTS19ETUEzID0gMHgwODAwOwoJdGhpcy5NQVNLX0tFWVBBRCA9IDB4MTAwMDsKCXRoaXMuTUFTS19HQU1FUEFLID0gMHgyMDAwOwp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkgewoJdGhpcy5lbmFibGUgPSBmYWxzZTsKCXRoaXMuZW5hYmxlZElSUXMgPSAwOwoJdGhpcy5pbnRlcnJ1cHRGbGFncyA9IDA7CgoJdGhpcy5kbWEgPSBuZXcgQXJyYXkoKTsKCWZvciAodmFyIGkgPSAwOyBpIDwgNDsgKytpKSB7CgkJdGhpcy5kbWEucHVzaCh7CgkJCXNvdXJjZTogMCwKCQkJZGVzdDogMCwKCQkJY291bnQ6IDAsCgkJCW5leHRTb3VyY2U6IDAsCgkJCW5leHREZXN0OiAwLAoJCQluZXh0Q291bnQ6IDAsCgkJCXNyY0NvbnRyb2w6IDAsCgkJCWRzdENvbnRyb2w6IDAsCgkJCXJlcGVhdDogZmFsc2UsCgkJCXdpZHRoOiAwLAoJCQlkcnE6IGZhbHNlLAoJCQl0aW1pbmc6IDAsCgkJCWRvSXJxOiBmYWxzZSwKCQkJZW5hYmxlOiBmYWxzZSwKCQkJbmV4dElSUTogMAoJCX0pOwoJfQoKCXRoaXMudGltZXJzRW5hYmxlZCA9IDA7Cgl0aGlzLnRpbWVycyA9IG5ldyBBcnJheSgpOwoJZm9yICh2YXIgaSA9IDA7IGkgPCA0OyArK2kpIHsKCQl0aGlzLnRpbWVycy5wdXNoKHsKCQkJcmVsb2FkOiAwLAoJCQlvbGRSZWxvYWQ6IDAsCgkJCXByZXNjYWxlQml0czogMCwKCQkJY291bnRVcDogZmFsc2UsCgkJCWRvSXJxOiBmYWxzZSwKCQkJZW5hYmxlOiBmYWxzZSwKCQkJbGFzdEV2ZW50OiAwLAoJCQluZXh0RXZlbnQ6IDAsCgkJCW92ZXJmbG93SW50ZXJ2YWw6IDEKCQl9KTsKCX0KCgl0aGlzLm5leHRFdmVudCA9IDA7Cgl0aGlzLnNwcmluZ0lSUSA9IGZhbHNlOwoJdGhpcy5yZXNldFNQKCk7Cn07CgpHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIucHJvdG90eXBlLmZyZWV6ZSA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuIHsKCQknZW5hYmxlJzogdGhpcy5lbmFibGUsCgkJJ2VuYWJsZWRJUlFzJzogdGhpcy5lbmFibGVkSVJRcywKCQknaW50ZXJydXB0RmxhZ3MnOiB0aGlzLmludGVycnVwdEZsYWdzLAoJCSdkbWEnOiB0aGlzLmRtYSwKCQkndGltZXJzJzogdGhpcy50aW1lcnMsCgkJJ25leHRFdmVudCc6IHRoaXMubmV4dEV2ZW50LAoJCSdzcHJpbmdJUlEnOiB0aGlzLnNwcmluZ0lSUQoJfTsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUuZGVmcm9zdCA9IGZ1bmN0aW9uKGZyb3N0KSB7Cgl0aGlzLmVuYWJsZSA9IGZyb3N0LmVuYWJsZTsKCXRoaXMuZW5hYmxlZElSUXMgPSBmcm9zdC5lbmFibGVkSVJRczsKCXRoaXMuaW50ZXJydXB0RmxhZ3MgPSBmcm9zdC5pbnRlcnJ1cHRGbGFnczsKCXRoaXMuZG1hID0gZnJvc3QuZG1hOwoJdGhpcy50aW1lcnMgPSBmcm9zdC50aW1lcnM7Cgl0aGlzLnRpbWVyc0VuYWJsZWQgPSAwOwoJaWYgKHRoaXMudGltZXJzWzBdLmVuYWJsZSkgewoJCSsrdGhpcy50aW1lcnNFbmFibGVkOwoJfQoJaWYgKHRoaXMudGltZXJzWzFdLmVuYWJsZSkgewoJCSsrdGhpcy50aW1lcnNFbmFibGVkOwoJfQoJaWYgKHRoaXMudGltZXJzWzJdLmVuYWJsZSkgewoJCSsrdGhpcy50aW1lcnNFbmFibGVkOwoJfQoJaWYgKHRoaXMudGltZXJzWzNdLmVuYWJsZSkgewoJCSsrdGhpcy50aW1lcnNFbmFibGVkOwoJfQoJdGhpcy5uZXh0RXZlbnQgPSBmcm9zdC5uZXh0RXZlbnQ7Cgl0aGlzLnNwcmluZ0lSUSA9IGZyb3N0LnNwcmluZ0lSUTsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUudXBkYXRlVGltZXJzID0gZnVuY3Rpb24oKSB7CglpZiAodGhpcy5uZXh0RXZlbnQgPiB0aGlzLmNwdS5jeWNsZXMpIHsKCQlyZXR1cm47Cgl9CgoJaWYgKHRoaXMuc3ByaW5nSVJRKSB7CgkJdGhpcy5jcHUucmFpc2VJUlEoKTsKCQl0aGlzLnNwcmluZ0lSUSA9IGZhbHNlOwoJfQoKCXRoaXMudmlkZW8udXBkYXRlVGltZXJzKHRoaXMuY3B1KTsKCXRoaXMuYXVkaW8udXBkYXRlVGltZXJzKCk7CglpZiAodGhpcy50aW1lcnNFbmFibGVkKSB7CgkJdmFyIHRpbWVyID0gdGhpcy50aW1lcnNbMF07CgkJaWYgKHRpbWVyLmVuYWJsZSkgewoJCQlpZiAodGhpcy5jcHUuY3ljbGVzID49IHRpbWVyLm5leHRFdmVudCkgewoJCQkJdGltZXIubGFzdEV2ZW50ID0gdGltZXIubmV4dEV2ZW50OwoJCQkJdGltZXIubmV4dEV2ZW50ICs9IHRpbWVyLm92ZXJmbG93SW50ZXJ2YWw7CgkJCQl0aGlzLmlvLnJlZ2lzdGVyc1t0aGlzLmlvLlRNMENOVF9MTyA+PiAxXSA9IHRpbWVyLnJlbG9hZDsKCQkJCXRpbWVyLm9sZFJlbG9hZCA9IHRpbWVyLnJlbG9hZDsKCgkJCQlpZiAodGltZXIuZG9JcnEpIHsKCQkJCQl0aGlzLnJhaXNlSVJRKHRoaXMuSVJRX1RJTUVSMCk7CgkJCQl9CgoJCQkJaWYgKHRoaXMuYXVkaW8uZW5hYmxlZCkgewoJCQkJCWlmICh0aGlzLmF1ZGlvLmVuYWJsZUNoYW5uZWxBICYmICF0aGlzLmF1ZGlvLnNvdW5kVGltZXJBICYmIHRoaXMuYXVkaW8uZG1hQSA+PSAwKSB7CgkJCQkJCXRoaXMuYXVkaW8uc2FtcGxlRmlmb0EoKTsKCQkJCQl9CgkKCQkJCQlpZiAodGhpcy5hdWRpby5lbmFibGVDaGFubmVsQiAmJiAhdGhpcy5hdWRpby5zb3VuZFRpbWVyQiAmJiB0aGlzLmF1ZGlvLmRtYUIgPj0gMCkgewoJCQkJCQl0aGlzLmF1ZGlvLnNhbXBsZUZpZm9CKCk7CgkJCQkJfQoJCQkJfQoKCQkJCXRpbWVyID0gdGhpcy50aW1lcnNbMV07CgkJCQlpZiAodGltZXIuY291bnRVcCkgewoJCQkJCWlmICgrK3RoaXMuaW8ucmVnaXN0ZXJzW3RoaXMuaW8uVE0xQ05UX0xPID4+IDFdID09IDB4MTAwMDApIHsKCQkJCQkJdGltZXIubmV4dEV2ZW50ID0gdGhpcy5jcHUuY3ljbGVzOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJdGltZXIgPSB0aGlzLnRpbWVyc1sxXTsKCQlpZiAodGltZXIuZW5hYmxlKSB7CgkJCWlmICh0aGlzLmNwdS5jeWNsZXMgPj0gdGltZXIubmV4dEV2ZW50KSB7CgkJCQl0aW1lci5sYXN0RXZlbnQgPSB0aW1lci5uZXh0RXZlbnQ7CgkJCQl0aW1lci5uZXh0RXZlbnQgKz0gdGltZXIub3ZlcmZsb3dJbnRlcnZhbDsKCQkJCWlmICghdGltZXIuY291bnRVcCB8fCB0aGlzLmlvLnJlZ2lzdGVyc1t0aGlzLmlvLlRNMUNOVF9MTyA+PiAxXSA9PSAweDEwMDAwKSB7CgkJCQkJdGhpcy5pby5yZWdpc3RlcnNbdGhpcy5pby5UTTFDTlRfTE8gPj4gMV0gPSB0aW1lci5yZWxvYWQ7CgkJCQl9CgkJCQl0aW1lci5vbGRSZWxvYWQgPSB0aW1lci5yZWxvYWQ7CgoJCQkJaWYgKHRpbWVyLmRvSXJxKSB7CgkJCQkJdGhpcy5yYWlzZUlSUSh0aGlzLklSUV9USU1FUjEpOwoJCQkJfQoKCQkJCWlmICh0aW1lci5jb3VudFVwKSB7CgkJCQkJdGltZXIubmV4dEV2ZW50ID0gMDsKCQkJCX0KCgkJCQlpZiAodGhpcy5hdWRpby5lbmFibGVkKSB7CgkJCQkJaWYgKHRoaXMuYXVkaW8uZW5hYmxlQ2hhbm5lbEEgJiYgdGhpcy5hdWRpby5zb3VuZFRpbWVyQSAmJiB0aGlzLmF1ZGlvLmRtYUEgPj0gMCkgewoJCQkJCQl0aGlzLmF1ZGlvLnNhbXBsZUZpZm9BKCk7CgkJCQkJfQoJCgkJCQkJaWYgKHRoaXMuYXVkaW8uZW5hYmxlQ2hhbm5lbEIgJiYgdGhpcy5hdWRpby5zb3VuZFRpbWVyQiAmJiB0aGlzLmF1ZGlvLmRtYUIgPj0gMCkgewoJCQkJCQl0aGlzLmF1ZGlvLnNhbXBsZUZpZm9CKCk7CgkJCQkJfQoJCQkJfQoKCQkJCXRpbWVyID0gdGhpcy50aW1lcnNbMl07CgkJCQlpZiAodGltZXIuY291bnRVcCkgewoJCQkJCWlmICgrK3RoaXMuaW8ucmVnaXN0ZXJzW3RoaXMuaW8uVE0yQ05UX0xPID4+IDFdID09IDB4MTAwMDApIHsKCQkJCQkJdGltZXIubmV4dEV2ZW50ID0gdGhpcy5jcHUuY3ljbGVzOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJdGltZXIgPSB0aGlzLnRpbWVyc1syXTsKCQlpZiAodGltZXIuZW5hYmxlKSB7CgkJCWlmICh0aGlzLmNwdS5jeWNsZXMgPj0gdGltZXIubmV4dEV2ZW50KSB7CgkJCQl0aW1lci5sYXN0RXZlbnQgPSB0aW1lci5uZXh0RXZlbnQ7CgkJCQl0aW1lci5uZXh0RXZlbnQgKz0gdGltZXIub3ZlcmZsb3dJbnRlcnZhbDsKCQkJCWlmICghdGltZXIuY291bnRVcCB8fCB0aGlzLmlvLnJlZ2lzdGVyc1t0aGlzLmlvLlRNMkNOVF9MTyA+PiAxXSA9PSAweDEwMDAwKSB7CgkJCQkJdGhpcy5pby5yZWdpc3RlcnNbdGhpcy5pby5UTTJDTlRfTE8gPj4gMV0gPSB0aW1lci5yZWxvYWQ7CgkJCQl9CgkJCQl0aW1lci5vbGRSZWxvYWQgPSB0aW1lci5yZWxvYWQ7CgoJCQkJaWYgKHRpbWVyLmRvSXJxKSB7CgkJCQkJdGhpcy5yYWlzZUlSUSh0aGlzLklSUV9USU1FUjIpOwoJCQkJfQoKCQkJCWlmICh0aW1lci5jb3VudFVwKSB7CgkJCQkJdGltZXIubmV4dEV2ZW50ID0gMDsKCQkJCX0KCgkJCQl0aW1lciA9IHRoaXMudGltZXJzWzNdOwoJCQkJaWYgKHRpbWVyLmNvdW50VXApIHsKCQkJCQlpZiAoKyt0aGlzLmlvLnJlZ2lzdGVyc1t0aGlzLmlvLlRNM0NOVF9MTyA+PiAxXSA9PSAweDEwMDAwKSB7CgkJCQkJCXRpbWVyLm5leHRFdmVudCA9IHRoaXMuY3B1LmN5Y2xlczsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXRpbWVyID0gdGhpcy50aW1lcnNbM107CgkJaWYgKHRpbWVyLmVuYWJsZSkgewoJCQlpZiAodGhpcy5jcHUuY3ljbGVzID49IHRpbWVyLm5leHRFdmVudCkgewoJCQkJdGltZXIubGFzdEV2ZW50ID0gdGltZXIubmV4dEV2ZW50OwoJCQkJdGltZXIubmV4dEV2ZW50ICs9IHRpbWVyLm92ZXJmbG93SW50ZXJ2YWw7CgkJCQlpZiAoIXRpbWVyLmNvdW50VXAgfHwgdGhpcy5pby5yZWdpc3RlcnNbdGhpcy5pby5UTTNDTlRfTE8gPj4gMV0gPT0gMHgxMDAwMCkgewoJCQkJCXRoaXMuaW8ucmVnaXN0ZXJzW3RoaXMuaW8uVE0zQ05UX0xPID4+IDFdID0gdGltZXIucmVsb2FkOwoJCQkJfQoJCQkJdGltZXIub2xkUmVsb2FkID0gdGltZXIucmVsb2FkOwoKCQkJCWlmICh0aW1lci5kb0lycSkgewoJCQkJCXRoaXMucmFpc2VJUlEodGhpcy5JUlFfVElNRVIzKTsKCQkJCX0KCgkJCQlpZiAodGltZXIuY291bnRVcCkgewoJCQkJCXRpbWVyLm5leHRFdmVudCA9IDA7CgkJCQl9CgkJCX0KCQl9Cgl9CgoJdmFyIGRtYSA9IHRoaXMuZG1hWzBdOwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIGRtYS5uZXh0SVJRICYmIHRoaXMuY3B1LmN5Y2xlcyA+PSBkbWEubmV4dElSUSkgewoJCWRtYS5uZXh0SVJRID0gMDsKCQl0aGlzLnJhaXNlSVJRKHRoaXMuSVJRX0RNQTApOwoJfQoKCWRtYSA9IHRoaXMuZG1hWzFdOwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIGRtYS5uZXh0SVJRICYmIHRoaXMuY3B1LmN5Y2xlcyA+PSBkbWEubmV4dElSUSkgewoJCWRtYS5uZXh0SVJRID0gMDsKCQl0aGlzLnJhaXNlSVJRKHRoaXMuSVJRX0RNQTEpOwoJfQoKCWRtYSA9IHRoaXMuZG1hWzJdOwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIGRtYS5uZXh0SVJRICYmIHRoaXMuY3B1LmN5Y2xlcyA+PSBkbWEubmV4dElSUSkgewoJCWRtYS5uZXh0SVJRID0gMDsKCQl0aGlzLnJhaXNlSVJRKHRoaXMuSVJRX0RNQTIpOwoJfQoKCWRtYSA9IHRoaXMuZG1hWzNdOwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIGRtYS5uZXh0SVJRICYmIHRoaXMuY3B1LmN5Y2xlcyA+PSBkbWEubmV4dElSUSkgewoJCWRtYS5uZXh0SVJRID0gMDsKCQl0aGlzLnJhaXNlSVJRKHRoaXMuSVJRX0RNQTMpOwoJfQoKCXRoaXMucG9sbE5leHRFdmVudCgpOwp9CgpHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIucHJvdG90eXBlLnJlc2V0U1AgPSBmdW5jdGlvbigpIHsKCXRoaXMuY3B1LnN3aXRjaE1vZGUodGhpcy5jcHUuTU9ERV9TVVBFUlZJU09SKTsKCXRoaXMuY3B1LmdwcnNbdGhpcy5jcHUuU1BdID0gMHgzMDA3RkUwOwoJdGhpcy5jcHUuc3dpdGNoTW9kZSh0aGlzLmNwdS5NT0RFX0lSUSk7Cgl0aGlzLmNwdS5ncHJzW3RoaXMuY3B1LlNQXSA9IDB4MzAwN0ZBMDsKCXRoaXMuY3B1LnN3aXRjaE1vZGUodGhpcy5jcHUuTU9ERV9TWVNURU0pOwoJdGhpcy5jcHUuZ3Byc1t0aGlzLmNwdS5TUF0gPSAweDMwMDdGMDA7Cn07CgpHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIucHJvdG90eXBlLnN3aTMyID0gZnVuY3Rpb24ob3Bjb2RlKSB7Cgl0aGlzLnN3aShvcGNvZGUgPj4gMTYpOwp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5zd2kgPSBmdW5jdGlvbihvcGNvZGUpIHsKCWlmICh0aGlzLmNvcmUubW11LmJpb3MucmVhbCkgewoJCXRoaXMuY3B1LnJhaXNlVHJhcCgpOwoJCXJldHVybjsKCX0KCglzd2l0Y2ggKG9wY29kZSkgewoJY2FzZSAweDAwOgoJCS8vIFNvZnRSZXNldAoJCXZhciBtZW0gPSB0aGlzLmNvcmUubW11Lm1lbW9yeVt0aGlzLmNvcmUubW11LlJFR0lPTl9XT1JLSU5HX0lSQU1dOwoJCXZhciBmbGFnID0gbWVtLmxvYWRVOCgweDdGRkEpOwoJCWZvciAodmFyIGkgPSAweDdFMDA7IGkgPCAweDgwMDA7IGkgKz0gNCkgewoJCQltZW0uc3RvcmUzMihpLCAwKTsKCQl9CgkJdGhpcy5yZXNldFNQKCk7CgkJaWYgKCFmbGFnKSB7CgkJCXRoaXMuY3B1LmdwcnNbdGhpcy5jcHUuTFJdID0gMHgwODAwMDAwMDsKCQl9IGVsc2UgewoJCQl0aGlzLmNwdS5ncHJzW3RoaXMuY3B1LkxSXSA9IDB4MDIwMDAwMDA7CgkJfQoJCXRoaXMuY3B1LnN3aXRjaEV4ZWNNb2RlKHRoaXMuY3B1Lk1PREVfQVJNKTsKCQl0aGlzLmNwdS5pbnN0cnVjdGlvbi53cml0ZXNQQyA9IHRydWU7CgkJdGhpcy5jcHUuZ3Byc1t0aGlzLmNwdS5QQ10gPSB0aGlzLmNwdS5ncHJzW3RoaXMuY3B1LkxSXTsKCQlicmVhazsKCWNhc2UgMHgwMToKCQkvLyBSZWdpc3RlclJhbVJlc2V0CgkJdmFyIHJlZ2lvbnMgPSB0aGlzLmNwdS5ncHJzWzBdOwoJCWlmIChyZWdpb25zICYgMHgwMSkgewoJCQl0aGlzLmNvcmUubW11Lm1lbW9yeVt0aGlzLmNvcmUubW11LlJFR0lPTl9XT1JLSU5HX1JBTV0gPSBuZXcgTWVtb3J5QmxvY2sodGhpcy5jb3JlLm1tdS5TSVpFX1dPUktJTkdfUkFNLCA5KTsKCQl9CgkJaWYgKHJlZ2lvbnMgJiAweDAyKSB7CgkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jb3JlLm1tdS5TSVpFX1dPUktJTkdfSVJBTSAtIDB4MjAwOyBpICs9IDQpIHsKCQkJCXRoaXMuY29yZS5tbXUubWVtb3J5W3RoaXMuY29yZS5tbXUuUkVHSU9OX1dPUktJTkdfSVJBTV0uc3RvcmUzMihpLCAwKTsKCQkJfQoJCX0KCQlpZiAocmVnaW9ucyAmIDB4MUMpIHsKCQkJdGhpcy52aWRlby5yZW5kZXJQYXRoLmNsZWFyU3Vic2V0cyh0aGlzLmNvcmUubW11LCByZWdpb25zKTsKCQl9CgkJaWYgKHJlZ2lvbnMgJiAweEUwKSB7CgkJCXRoaXMuY29yZS5TVFVCKCdVbmltcGxlbWVudGVkIFJlZ2lzdGVyUmFtUmVzZXQnKTsKCQl9CgkJYnJlYWs7CgljYXNlIDB4MDI6CgkJLy8gSGFsdAoJCXRoaXMuaGFsdCgpOwoJCWJyZWFrOwoJY2FzZSAweDA1OgoJCS8vIFZCbGFua0ludHJXYWl0CgkJdGhpcy5jcHUuZ3Byc1swXSA9IDE7CgkJdGhpcy5jcHUuZ3Byc1sxXSA9IDE7CgkJLy8gRmFsbCB0aHJvdWdoOgoJY2FzZSAweDA0OgoJCS8vIEludHJXYWl0CgkJaWYgKCF0aGlzLmVuYWJsZSkgewoJCQl0aGlzLmlvLnN0b3JlMTYodGhpcy5pby5JTUUsIDEpOwoJCX0KCQlpZiAoIXRoaXMuY3B1LmdwcnNbMF0gJiYgdGhpcy5pbnRlcnJ1cHRGbGFncyAmIHRoaXMuY3B1LmdwcnNbMV0pIHsKCQkJcmV0dXJuOwoJCX0KCQl0aGlzLmRpc21pc3NJUlFzKDB4RkZGRkZGRkYpOwoJCXRoaXMuY3B1LnJhaXNlVHJhcCgpOwoJCWJyZWFrOwoJY2FzZSAweDA2OgoJCS8vIERpdgoJCXZhciByZXN1bHQgPSAodGhpcy5jcHUuZ3Byc1swXSB8IDApIC8gKHRoaXMuY3B1LmdwcnNbMV0gfCAwKTsKCQl2YXIgbW9kID0gKHRoaXMuY3B1LmdwcnNbMF0gfCAwKSAlICh0aGlzLmNwdS5ncHJzWzFdIHwgMCk7CgkJdGhpcy5jcHUuZ3Byc1swXSA9IHJlc3VsdCB8IDA7CgkJdGhpcy5jcHUuZ3Byc1sxXSA9IG1vZCB8IDA7CgkJdGhpcy5jcHUuZ3Byc1szXSA9IE1hdGguYWJzKHJlc3VsdCB8IDApOwoJCWJyZWFrOwoJY2FzZSAweDA3OgoJCS8vIERpdkFybQoJCXZhciByZXN1bHQgPSAodGhpcy5jcHUuZ3Byc1sxXSB8IDApIC8gKHRoaXMuY3B1LmdwcnNbMF0gfCAwKTsKCQl2YXIgbW9kID0gKHRoaXMuY3B1LmdwcnNbMV0gfCAwKSAlICh0aGlzLmNwdS5ncHJzWzBdIHwgMCk7CgkJdGhpcy5jcHUuZ3Byc1swXSA9IHJlc3VsdCB8IDA7CgkJdGhpcy5jcHUuZ3Byc1sxXSA9IG1vZCB8IDA7CgkJdGhpcy5jcHUuZ3Byc1szXSA9IE1hdGguYWJzKHJlc3VsdCB8IDApOwoJCWJyZWFrOwoJY2FzZSAweDA4OgoJCS8vIFNxcnQKCQl2YXIgcm9vdCA9IE1hdGguc3FydCh0aGlzLmNwdS5ncHJzWzBdKTsKCQl0aGlzLmNwdS5ncHJzWzBdID0gcm9vdCB8IDA7IC8vIENvZXJjZSBkb3duIHRvIGludAoJCWJyZWFrOwoJY2FzZSAweDBBOgoJCS8vIEFyY1RhbjIKCQl2YXIgeCA9IHRoaXMuY3B1LmdwcnNbMF0gLyAxNjM4NDsKCQl2YXIgeSA9IHRoaXMuY3B1LmdwcnNbMV0gLyAxNjM4NDsKCQl0aGlzLmNwdS5ncHJzWzBdID0gKE1hdGguYXRhbjIoeSwgeCkgLyAoMiAqIE1hdGguUEkpKSAqIDB4MTAwMDA7CgkJYnJlYWs7CgljYXNlIDB4MEI6CgkJLy8gQ3B1U2V0CgkJdmFyIHNvdXJjZSA9IHRoaXMuY3B1LmdwcnNbMF07CgkJdmFyIGRlc3QgPSB0aGlzLmNwdS5ncHJzWzFdOwoJCXZhciBtb2RlID0gdGhpcy5jcHUuZ3Byc1syXTsKCQl2YXIgY291bnQgPSBtb2RlICYgMHgwMDBGRkZGRjsKCQl2YXIgZmlsbCA9IG1vZGUgJiAweDAxMDAwMDAwOwoJCXZhciB3b3Jkc2l6ZSA9IChtb2RlICYgMHgwNDAwMDAwMCkgPyA0IDogMjsKCQlpZiAoZmlsbCkgewoJCQlpZiAod29yZHNpemUgPT0gNCkgewoJCQkJc291cmNlICY9IDB4RkZGRkZGRkM7CgkJCQlkZXN0ICY9IDB4RkZGRkZGRkM7CgkJCQl2YXIgd29yZCA9IHRoaXMuY3B1Lm1tdS5sb2FkMzIoc291cmNlKTsKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewoJCQkJCXRoaXMuY3B1Lm1tdS5zdG9yZTMyKGRlc3QgKyAoaSA8PCAyKSwgd29yZCk7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQlzb3VyY2UgJj0gMHhGRkZGRkZGRTsKCQkJCWRlc3QgJj0gMHhGRkZGRkZGRTsKCQkJCXZhciB3b3JkID0gdGhpcy5jcHUubW11LmxvYWQxNihzb3VyY2UpOwoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CgkJCQkJdGhpcy5jcHUubW11LnN0b3JlMTYoZGVzdCArIChpIDw8IDEpLCB3b3JkKTsKCQkJCX0KCQkJfQoJCX0gZWxzZSB7CgkJCWlmICh3b3Jkc2l6ZSA9PSA0KSB7CgkJCQlzb3VyY2UgJj0gMHhGRkZGRkZGQzsKCQkJCWRlc3QgJj0gMHhGRkZGRkZGQzsKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewoJCQkJCXZhciB3b3JkID0gdGhpcy5jcHUubW11LmxvYWQzMihzb3VyY2UgKyAoaSA8PCAyKSk7CgkJCQkJdGhpcy5jcHUubW11LnN0b3JlMzIoZGVzdCArIChpIDw8IDIpLCB3b3JkKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXNvdXJjZSAmPSAweEZGRkZGRkZFOwoJCQkJZGVzdCAmPSAweEZGRkZGRkZFOwoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CgkJCQkJdmFyIHdvcmQgPSB0aGlzLmNwdS5tbXUubG9hZDE2KHNvdXJjZSArIChpIDw8IDEpKTsKCQkJCQl0aGlzLmNwdS5tbXUuc3RvcmUxNihkZXN0ICsgKGkgPDwgMSksIHdvcmQpOwoJCQkJfQoJCQl9CgkJfQoJCXJldHVybjsKCWNhc2UgMHgwQzoKCQkvLyBGYXN0Q3B1U2V0CgkJdmFyIHNvdXJjZSA9IHRoaXMuY3B1LmdwcnNbMF0gJiAweEZGRkZGRkZDOwoJCXZhciBkZXN0ID0gdGhpcy5jcHUuZ3Byc1sxXSAmIDB4RkZGRkZGRkM7CgkJdmFyIG1vZGUgPSB0aGlzLmNwdS5ncHJzWzJdOwoJCXZhciBjb3VudCA9IG1vZGUgJiAweDAwMEZGRkZGOwoJCWNvdW50ID0gKChjb3VudCArIDcpID4+IDMpIDw8IDM7CgkJdmFyIGZpbGwgPSBtb2RlICYgMHgwMTAwMDAwMDsKCQlpZiAoZmlsbCkgewoJCQl2YXIgd29yZCA9IHRoaXMuY3B1Lm1tdS5sb2FkMzIoc291cmNlKTsKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CgkJCQl0aGlzLmNwdS5tbXUuc3RvcmUzMihkZXN0ICsgKGkgPDwgMiksIHdvcmQpOwoJCQl9CgkJfSBlbHNlIHsKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7CgkJCQl2YXIgd29yZCA9IHRoaXMuY3B1Lm1tdS5sb2FkMzIoc291cmNlICsgKGkgPDwgMikpOwoJCQkJdGhpcy5jcHUubW11LnN0b3JlMzIoZGVzdCArIChpIDw8IDIpLCB3b3JkKTsKCQkJfQoJCX0KCQlyZXR1cm47CgljYXNlIDB4MEU6CgkJLy8gQmdBZmZpbmVTZXQKCQl2YXIgaSA9IHRoaXMuY3B1LmdwcnNbMl07CgkJdmFyIG94LCBveTsKCQl2YXIgY3gsIGN5OwoJCXZhciBzeCwgc3k7CgkJdmFyIHRoZXRhOwoJCXZhciBvZmZzZXQgPSB0aGlzLmNwdS5ncHJzWzBdOwoJCXZhciBkZXN0aW5hdGlvbiA9IHRoaXMuY3B1LmdwcnNbMV07CgkJdmFyIGEsIGIsIGMsIGQ7CgkJdmFyIHJ4LCByeTsKCQl3aGlsZSAoaS0tKSB7CgkJCS8vIFsgc3ggICAwICAwIF0gICBbIGNvcyh0aGV0YSkgIC1zaW4odGhldGEpICAwIF0gICBbIDEgIDAgIGN4IC0gb3ggXSAgIFsgQSBCIHJ4IF0KCQkJLy8gWyAgMCAgc3kgIDAgXSAqIFsgc2luKHRoZXRhKSAgIGNvcyh0aGV0YSkgIDAgXSAqIFsgMCAgMSAgY3kgLSBveSBdID0gWyBDIEQgcnkgXQoJCQkvLyBbICAwICAgMCAgMSBdICAgWyAgICAgMCAgICAgICAgICAgIDAgICAgICAgMSBdICAgWyAwICAwICAgICAxICAgIF0gICBbIDAgMCAgMSBdCgkJCW94ID0gdGhpcy5jb3JlLm1tdS5sb2FkMzIob2Zmc2V0KSAvIDI1NjsKCQkJb3kgPSB0aGlzLmNvcmUubW11LmxvYWQzMihvZmZzZXQgKyA0KSAvIDI1NjsKCQkJY3ggPSB0aGlzLmNvcmUubW11LmxvYWQxNihvZmZzZXQgKyA4KTsKCQkJY3kgPSB0aGlzLmNvcmUubW11LmxvYWQxNihvZmZzZXQgKyAxMCk7CgkJCXN4ID0gdGhpcy5jb3JlLm1tdS5sb2FkMTYob2Zmc2V0ICsgMTIpIC8gMjU2OwoJCQlzeSA9IHRoaXMuY29yZS5tbXUubG9hZDE2KG9mZnNldCArIDE0KSAvIDI1NjsKCQkJdGhldGEgPSAodGhpcy5jb3JlLm1tdS5sb2FkVTE2KG9mZnNldCArIDE2KSA+PiA4KSAvIDEyOCAqIE1hdGguUEk7CgkJCW9mZnNldCArPSAyMDsKCQkJLy8gUm90YXRpb24KCQkJYSA9IGQgPSBNYXRoLmNvcyh0aGV0YSk7CgkJCWIgPSBjID0gTWF0aC5zaW4odGhldGEpOwoJCQkvLyBTY2FsZQoJCQlhICo9IHN4OwoJCQliICo9IC1zeDsKCQkJYyAqPSBzeTsKCQkJZCAqPSBzeTsKCQkJLy8gVHJhbnNsYXRlCgkJCXJ4ID0gb3ggLSAoYSAqIGN4ICsgYiAqIGN5KTsKCQkJcnkgPSBveSAtIChjICogY3ggKyBkICogY3kpOwoJCQl0aGlzLmNvcmUubW11LnN0b3JlMTYoZGVzdGluYXRpb24sIChhICogMjU2KSB8IDApOwoJCQl0aGlzLmNvcmUubW11LnN0b3JlMTYoZGVzdGluYXRpb24gKyAyLCAoYiAqIDI1NikgfCAwKTsKCQkJdGhpcy5jb3JlLm1tdS5zdG9yZTE2KGRlc3RpbmF0aW9uICsgNCwgKGMgKiAyNTYpIHwgMCk7CgkJCXRoaXMuY29yZS5tbXUuc3RvcmUxNihkZXN0aW5hdGlvbiArIDYsIChkICogMjU2KSB8IDApOwoJCQl0aGlzLmNvcmUubW11LnN0b3JlMzIoZGVzdGluYXRpb24gKyA4LCAocnggKiAyNTYpIHwgMCk7CgkJCXRoaXMuY29yZS5tbXUuc3RvcmUzMihkZXN0aW5hdGlvbiArIDEyLCAocnkgKiAyNTYpIHwgMCk7CgkJCWRlc3RpbmF0aW9uICs9IDE2OwoJCX0KCQlicmVhazsKCWNhc2UgMHgwRjoKCQkvLyBPYmpBZmZpbmVTZXQKCQl2YXIgaSA9IHRoaXMuY3B1LmdwcnNbMl07CgkJdmFyIHN4LCBzeTsKCQl2YXIgdGhldGE7CgkJdmFyIG9mZnNldCA9IHRoaXMuY3B1LmdwcnNbMF07CgkJdmFyIGRlc3RpbmF0aW9uID0gdGhpcy5jcHUuZ3Byc1sxXQoJCXZhciBkaWZmID0gdGhpcy5jcHUuZ3Byc1szXTsKCQl2YXIgYSwgYiwgYywgZDsKCQl3aGlsZSAoaS0tKSB7CgkJCS8vIFsgc3ggICAwIF0gICBbIGNvcyh0aGV0YSkgIC1zaW4odGhldGEpIF0gICBbIEEgQiBdCgkJCS8vIFsgIDAgIHN5IF0gKiBbIHNpbih0aGV0YSkgICBjb3ModGhldGEpIF0gPSBbIEMgRCBdCgkJCXN4ID0gdGhpcy5jb3JlLm1tdS5sb2FkMTYob2Zmc2V0KSAvIDI1NjsKCQkJc3kgPSB0aGlzLmNvcmUubW11LmxvYWQxNihvZmZzZXQgKyAyKSAvIDI1NjsKCQkJdGhldGEgPSAodGhpcy5jb3JlLm1tdS5sb2FkVTE2KG9mZnNldCArIDQpID4+IDgpIC8gMTI4ICogTWF0aC5QSTsKCQkJb2Zmc2V0ICs9IDY7CgkJCS8vIFJvdGF0aW9uCgkJCWEgPSBkID0gTWF0aC5jb3ModGhldGEpOwoJCQliID0gYyA9IE1hdGguc2luKHRoZXRhKTsKCQkJLy8gU2NhbGUKCQkJYSAqPSBzeDsKCQkJYiAqPSAtc3g7CgkJCWMgKj0gc3k7CgkJCWQgKj0gc3k7CgkJCXRoaXMuY29yZS5tbXUuc3RvcmUxNihkZXN0aW5hdGlvbiwgKGEgKiAyNTYpIHwgMCk7CgkJCXRoaXMuY29yZS5tbXUuc3RvcmUxNihkZXN0aW5hdGlvbiArIGRpZmYsIChiICogMjU2KSB8IDApOwoJCQl0aGlzLmNvcmUubW11LnN0b3JlMTYoZGVzdGluYXRpb24gKyBkaWZmICogMiwgKGMgKiAyNTYpIHwgMCk7CgkJCXRoaXMuY29yZS5tbXUuc3RvcmUxNihkZXN0aW5hdGlvbiArIGRpZmYgKiAzLCAoZCAqIDI1NikgfCAwKTsKCQkJZGVzdGluYXRpb24gKz0gZGlmZiAqIDQ7CgkJfQoJCWJyZWFrOwoJY2FzZSAweDExOgoJCS8vIExaNzdVbkNvbXBXcmFtCgkJdGhpcy5sejc3KHRoaXMuY3B1LmdwcnNbMF0sIHRoaXMuY3B1LmdwcnNbMV0sIDEpOwoJCWJyZWFrOwoJY2FzZSAweDEyOgoJCS8vIExaNzdVbkNvbXBWcmFtCgkJdGhpcy5sejc3KHRoaXMuY3B1LmdwcnNbMF0sIHRoaXMuY3B1LmdwcnNbMV0sIDIpOwoJCWJyZWFrOwoJY2FzZSAweDEzOgoJCS8vIEh1ZmZVbkNvbXAKCQl0aGlzLmh1ZmZtYW4odGhpcy5jcHUuZ3Byc1swXSwgdGhpcy5jcHUuZ3Byc1sxXSk7CgkJYnJlYWs7CgljYXNlIDB4MTQ6CgkJLy8gUmxVbkNvbXBXcmFtCgkJdGhpcy5ybCh0aGlzLmNwdS5ncHJzWzBdLCB0aGlzLmNwdS5ncHJzWzFdLCAxKTsKCQlicmVhazsKCWNhc2UgMHgxNToKCQkvLyBSbFVuQ29tcFZyYW0KCQl0aGlzLnJsKHRoaXMuY3B1LmdwcnNbMF0sIHRoaXMuY3B1LmdwcnNbMV0sIDIpOwoJCWJyZWFrOwoJY2FzZSAweDFGOgoJCS8vIE1pZGlLZXkyRnJlcQoJCXZhciBrZXkgPSB0aGlzLmNwdS5tbXUubG9hZDMyKHRoaXMuY3B1LmdwcnNbMF0gKyA0KTsKCQl0aGlzLmNwdS5ncHJzWzBdID0ga2V5IC8gTWF0aC5wb3coMiwgKDE4MCAtIHRoaXMuY3B1LmdwcnNbMV0gLSB0aGlzLmNwdS5ncHJzWzJdIC8gMjU2KSAvIDEyKSA+Pj4gMDsKCQlicmVhazsKCWRlZmF1bHQ6CgkJdGhyb3cgIlVuaW1wbGVtZW50ZWQgc29mdHdhcmUgaW50ZXJydXB0OiAweCIgKyBvcGNvZGUudG9TdHJpbmcoMTYpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5tYXN0ZXJFbmFibGUgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5lbmFibGUgPSB2YWx1ZTsKCglpZiAodGhpcy5lbmFibGUgJiYgdGhpcy5lbmFibGVkSVJRcyAmIHRoaXMuaW50ZXJydXB0RmxhZ3MpIHsKCQl0aGlzLmNwdS5yYWlzZUlSUSgpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5zZXRJbnRlcnJ1cHRzRW5hYmxlZCA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmVuYWJsZWRJUlFzID0gdmFsdWU7CgoJaWYgKHRoaXMuZW5hYmxlZElSUXMgJiB0aGlzLk1BU0tfU0lPKSB7CgkJdGhpcy5jb3JlLlNUVUIoJ1NlcmlhbCBJL08gaW50ZXJydXB0cyBub3QgaW1wbGVtZW50ZWQnKTsKCX0KCglpZiAodGhpcy5lbmFibGVkSVJRcyAmIHRoaXMuTUFTS19LRVlQQUQpIHsKCQl0aGlzLmNvcmUuU1RVQignS2V5cGFkIGludGVycnVwdHMgbm90IGltcGxlbWVudGVkJyk7Cgl9CgoJaWYgKHRoaXMuZW5hYmxlICYmIHRoaXMuZW5hYmxlZElSUXMgJiB0aGlzLmludGVycnVwdEZsYWdzKSB7CgkJdGhpcy5jcHUucmFpc2VJUlEoKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUucG9sbE5leHRFdmVudCA9IGZ1bmN0aW9uKCkgewoJdmFyIG5leHRFdmVudCA9IHRoaXMudmlkZW8ubmV4dEV2ZW50OwoJdmFyIHRlc3Q7CgoJaWYgKHRoaXMuYXVkaW8uZW5hYmxlZCkgewoJCXRlc3QgPSB0aGlzLmF1ZGlvLm5leHRFdmVudDsKCQlpZiAoIW5leHRFdmVudCB8fCB0ZXN0IDwgbmV4dEV2ZW50KSB7CgkJCW5leHRFdmVudCA9IHRlc3Q7CgkJfQoJfQoKCWlmICh0aGlzLnRpbWVyc0VuYWJsZWQpIHsKCQl2YXIgdGltZXIgPSB0aGlzLnRpbWVyc1swXTsKCQl0ZXN0ID0gdGltZXIubmV4dEV2ZW50OwoJCWlmICh0aW1lci5lbmFibGUgJiYgdGVzdCAmJiAoIW5leHRFdmVudCB8fCB0ZXN0IDwgbmV4dEV2ZW50KSkgewoJCQluZXh0RXZlbnQgPSB0ZXN0OwoJCX0KCgkJdGltZXIgPSB0aGlzLnRpbWVyc1sxXTsKCQl0ZXN0ID0gdGltZXIubmV4dEV2ZW50OwoJCWlmICh0aW1lci5lbmFibGUgJiYgdGVzdCAmJiAoIW5leHRFdmVudCB8fCB0ZXN0IDwgbmV4dEV2ZW50KSkgewoJCQluZXh0RXZlbnQgPSB0ZXN0OwoJCX0KCQl0aW1lciA9IHRoaXMudGltZXJzWzJdOwoJCXRlc3QgPSB0aW1lci5uZXh0RXZlbnQ7CgkJaWYgKHRpbWVyLmVuYWJsZSAmJiB0ZXN0ICYmICghbmV4dEV2ZW50IHx8IHRlc3QgPCBuZXh0RXZlbnQpKSB7CgkJCW5leHRFdmVudCA9IHRlc3Q7CgkJfQoJCXRpbWVyID0gdGhpcy50aW1lcnNbM107CgkJdGVzdCA9IHRpbWVyLm5leHRFdmVudDsKCQlpZiAodGltZXIuZW5hYmxlICYmIHRlc3QgJiYgKCFuZXh0RXZlbnQgfHwgdGVzdCA8IG5leHRFdmVudCkpIHsKCQkJbmV4dEV2ZW50ID0gdGVzdDsKCQl9Cgl9CgoJdmFyIGRtYSA9IHRoaXMuZG1hWzBdOwoJdGVzdCA9IGRtYS5uZXh0SVJROwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIHRlc3QgJiYgKCFuZXh0RXZlbnQgfHwgdGVzdCA8IG5leHRFdmVudCkpIHsKCQluZXh0RXZlbnQgPSB0ZXN0OwoJfQoKCWRtYSA9IHRoaXMuZG1hWzFdOwoJdGVzdCA9IGRtYS5uZXh0SVJROwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIHRlc3QgJiYgKCFuZXh0RXZlbnQgfHwgdGVzdCA8IG5leHRFdmVudCkpIHsKCQluZXh0RXZlbnQgPSB0ZXN0OwoJfQoKCWRtYSA9IHRoaXMuZG1hWzJdOwoJdGVzdCA9IGRtYS5uZXh0SVJROwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIHRlc3QgJiYgKCFuZXh0RXZlbnQgfHwgdGVzdCA8IG5leHRFdmVudCkpIHsKCQluZXh0RXZlbnQgPSB0ZXN0OwoJfQoKCWRtYSA9IHRoaXMuZG1hWzNdOwoJdGVzdCA9IGRtYS5uZXh0SVJROwoJaWYgKGRtYS5lbmFibGUgJiYgZG1hLmRvSXJxICYmIHRlc3QgJiYgKCFuZXh0RXZlbnQgfHwgdGVzdCA8IG5leHRFdmVudCkpIHsKCQluZXh0RXZlbnQgPSB0ZXN0OwoJfQoKCXRoaXMuY29yZS5BU1NFUlQobmV4dEV2ZW50ID49IHRoaXMuY3B1LmN5Y2xlcywgIk5leHQgZXZlbnQgaXMgYmVmb3JlIHByZXNlbnQiKTsKCXRoaXMubmV4dEV2ZW50ID0gbmV4dEV2ZW50Owp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS53YWl0Rm9ySVJRID0gZnVuY3Rpb24oKSB7Cgl2YXIgdGltZXI7Cgl2YXIgaXJxUGVuZGluZyA9IHRoaXMudGVzdElSUSgpIHx8IHRoaXMudmlkZW8uaGJsYW5rSVJRIHx8IHRoaXMudmlkZW8udmJsYW5rSVJRIHx8IHRoaXMudmlkZW8udmNvdW50ZXJJUlE7CglpZiAodGhpcy50aW1lcnNFbmFibGVkKSB7CgkJdGltZXIgPSB0aGlzLnRpbWVyc1swXTsKCQlpcnFQZW5kaW5nID0gaXJxUGVuZGluZyB8fCB0aW1lci5kb0lycTsKCQl0aW1lciA9IHRoaXMudGltZXJzWzFdOwoJCWlycVBlbmRpbmcgPSBpcnFQZW5kaW5nIHx8IHRpbWVyLmRvSXJxOwoJCXRpbWVyID0gdGhpcy50aW1lcnNbMl07CgkJaXJxUGVuZGluZyA9IGlycVBlbmRpbmcgfHwgdGltZXIuZG9JcnE7CgkJdGltZXIgPSB0aGlzLnRpbWVyc1szXTsKCQlpcnFQZW5kaW5nID0gaXJxUGVuZGluZyB8fCB0aW1lci5kb0lycTsKCX0KCWlmICghaXJxUGVuZGluZykgewoJCXJldHVybiBmYWxzZTsKCX0KCglmb3IgKDs7KSB7CgkJdGhpcy5wb2xsTmV4dEV2ZW50KCk7CgoJCWlmICghdGhpcy5uZXh0RXZlbnQpIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0gZWxzZSB7CgkJCXRoaXMuY3B1LmN5Y2xlcyA9IHRoaXMubmV4dEV2ZW50OwoJCQl0aGlzLnVwZGF0ZVRpbWVycygpOwoJCQlpZiAodGhpcy5pbnRlcnJ1cHRGbGFncykgewoJCQkJcmV0dXJuIHRydWU7CgkJCX0KCQl9Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIucHJvdG90eXBlLnRlc3RJUlEgPSBmdW5jdGlvbigpIHsKCWlmICh0aGlzLmVuYWJsZSAmJiB0aGlzLmVuYWJsZWRJUlFzICYgdGhpcy5pbnRlcnJ1cHRGbGFncykgewoJCXRoaXMuc3ByaW5nSVJRID0gdHJ1ZTsKCQl0aGlzLm5leHRFdmVudCA9IHRoaXMuY3B1LmN5Y2xlczsKCQlyZXR1cm4gdHJ1ZTsKCX0KCXJldHVybiBmYWxzZTsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUucmFpc2VJUlEgPSBmdW5jdGlvbihpcnFUeXBlKSB7Cgl0aGlzLmludGVycnVwdEZsYWdzIHw9IDEgPDwgaXJxVHlwZTsKCXRoaXMuaW8ucmVnaXN0ZXJzW3RoaXMuaW8uSUYgPj4gMV0gPSB0aGlzLmludGVycnVwdEZsYWdzOwoKCWlmICh0aGlzLmVuYWJsZSAmJiAodGhpcy5lbmFibGVkSVJRcyAmIDEgPDwgaXJxVHlwZSkpIHsKCQl0aGlzLmNwdS5yYWlzZUlSUSgpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5kaXNtaXNzSVJRcyA9IGZ1bmN0aW9uKGlycU1hc2spIHsKCXRoaXMuaW50ZXJydXB0RmxhZ3MgJj0gfmlycU1hc2s7Cgl0aGlzLmlvLnJlZ2lzdGVyc1t0aGlzLmlvLklGID4+IDFdID0gdGhpcy5pbnRlcnJ1cHRGbGFnczsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUuZG1hU2V0U291cmNlQWRkcmVzcyA9IGZ1bmN0aW9uKGRtYSwgYWRkcmVzcykgewoJdGhpcy5kbWFbZG1hXS5zb3VyY2UgPSBhZGRyZXNzICYgMHhGRkZGRkZGRTsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUuZG1hU2V0RGVzdEFkZHJlc3MgPSBmdW5jdGlvbihkbWEsIGFkZHJlc3MpIHsKCXRoaXMuZG1hW2RtYV0uZGVzdCA9IGFkZHJlc3MgJiAweEZGRkZGRkZFOwp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5kbWFTZXRXb3JkQ291bnQgPSBmdW5jdGlvbihkbWEsIGNvdW50KSB7Cgl0aGlzLmRtYVtkbWFdLmNvdW50ID0gY291bnQgPyBjb3VudCA6IChkbWEgPT0gMyA/IDB4MTAwMDAgOiAweDQwMDApOwp9OwoKR2FtZUJveUFkdmFuY2VJbnRlcnJ1cHRIYW5kbGVyLnByb3RvdHlwZS5kbWFXcml0ZUNvbnRyb2wgPSBmdW5jdGlvbihkbWEsIGNvbnRyb2wpIHsKCXZhciBjdXJyZW50RG1hID0gdGhpcy5kbWFbZG1hXTsKCXZhciB3YXNFbmFibGVkID0gY3VycmVudERtYS5lbmFibGU7CgljdXJyZW50RG1hLmRzdENvbnRyb2wgPSAoY29udHJvbCAmIDB4MDA2MCkgPj4gNTsKCWN1cnJlbnREbWEuc3JjQ29udHJvbCA9IChjb250cm9sICYgMHgwMTgwKSA+PiA3OwoJY3VycmVudERtYS5yZXBlYXQgPSAhIShjb250cm9sICYgMHgwMjAwKTsKCWN1cnJlbnREbWEud2lkdGggPSAoY29udHJvbCAmIDB4MDQwMCkgPyA0IDogMjsKCWN1cnJlbnREbWEuZHJxID0gISEoY29udHJvbCAmIDB4MDgwMCk7CgljdXJyZW50RG1hLnRpbWluZyA9IChjb250cm9sICYgMHgzMDAwKSA+PiAxMjsKCWN1cnJlbnREbWEuZG9JcnEgPSAhIShjb250cm9sICYgMHg0MDAwKTsKCWN1cnJlbnREbWEuZW5hYmxlID0gISEoY29udHJvbCAmIDB4ODAwMCk7CgljdXJyZW50RG1hLm5leHRJUlEgPSAwOwoKCWlmIChjdXJyZW50RG1hLmRycSkgewoJCXRoaXMuY29yZS5XQVJOKCdEUlEgbm90IGltcGxlbWVudGVkJyk7Cgl9CgoJaWYgKCF3YXNFbmFibGVkICYmIGN1cnJlbnREbWEuZW5hYmxlKSB7CgkJY3VycmVudERtYS5uZXh0U291cmNlID0gY3VycmVudERtYS5zb3VyY2U7CgkJY3VycmVudERtYS5uZXh0RGVzdCA9IGN1cnJlbnREbWEuZGVzdDsKCQljdXJyZW50RG1hLm5leHRDb3VudCA9IGN1cnJlbnREbWEuY291bnQ7CgkJdGhpcy5jcHUubW11LnNjaGVkdWxlRG1hKGRtYSwgY3VycmVudERtYSk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIucHJvdG90eXBlLnRpbWVyU2V0UmVsb2FkID0gZnVuY3Rpb24odGltZXIsIHJlbG9hZCkgewoJdGhpcy50aW1lcnNbdGltZXJdLnJlbG9hZCA9IHJlbG9hZCAmIDB4RkZGRjsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUudGltZXJXcml0ZUNvbnRyb2wgPSBmdW5jdGlvbih0aW1lciwgY29udHJvbCkgewoJdmFyIGN1cnJlbnRUaW1lciA9IHRoaXMudGltZXJzW3RpbWVyXTsKCXZhciBvbGRQcmVzY2FsZSA9IGN1cnJlbnRUaW1lci5wcmVzY2FsZUJpdHM7Cglzd2l0Y2ggKGNvbnRyb2wgJiAweDAwMDMpIHsKCWNhc2UgMHgwMDAwOgoJCWN1cnJlbnRUaW1lci5wcmVzY2FsZUJpdHMgPSAwOwoJCWJyZWFrOwoJY2FzZSAweDAwMDE6CgkJY3VycmVudFRpbWVyLnByZXNjYWxlQml0cyA9IDY7CgkJYnJlYWs7CgljYXNlIDB4MDAwMjoKCQljdXJyZW50VGltZXIucHJlc2NhbGVCaXRzID0gODsKCQlicmVhazsKCWNhc2UgMHgwMDAzOgoJCWN1cnJlbnRUaW1lci5wcmVzY2FsZUJpdHMgPSAxMDsKCQlicmVhazsKCX0KCWN1cnJlbnRUaW1lci5jb3VudFVwID0gISEoY29udHJvbCAmIDB4MDAwNCk7CgljdXJyZW50VGltZXIuZG9JcnEgPSAhIShjb250cm9sICYgMHgwMDQwKTsKCWN1cnJlbnRUaW1lci5vdmVyZmxvd0ludGVydmFsID0gKDB4MTAwMDAgLSBjdXJyZW50VGltZXIucmVsb2FkKSA8PCBjdXJyZW50VGltZXIucHJlc2NhbGVCaXRzOwoJdmFyIHdhc0VuYWJsZWQgPSBjdXJyZW50VGltZXIuZW5hYmxlOwoJY3VycmVudFRpbWVyLmVuYWJsZSA9ICEhKCgoY29udHJvbCAmIDB4MDA4MCkgPj4gNykgPDwgdGltZXIpOwoJaWYgKCF3YXNFbmFibGVkICYmIGN1cnJlbnRUaW1lci5lbmFibGUpIHsKCQlpZiAoIWN1cnJlbnRUaW1lci5jb3VudFVwKSB7CgkJCWN1cnJlbnRUaW1lci5sYXN0RXZlbnQgPSB0aGlzLmNwdS5jeWNsZXM7CgkJCWN1cnJlbnRUaW1lci5uZXh0RXZlbnQgPSB0aGlzLmNwdS5jeWNsZXMgKyBjdXJyZW50VGltZXIub3ZlcmZsb3dJbnRlcnZhbDsKCQl9IGVsc2UgewoJCQljdXJyZW50VGltZXIubmV4dEV2ZW50ID0gMDsKCQl9CgkJdGhpcy5pby5yZWdpc3RlcnNbKHRoaXMuaW8uVE0wQ05UX0xPICsgKHRpbWVyIDw8IDIpKSA+PiAxXSA9IGN1cnJlbnRUaW1lci5yZWxvYWQ7CgkJY3VycmVudFRpbWVyLm9sZFJlbG9hZCA9IGN1cnJlbnRUaW1lci5yZWxvYWQ7CgkJKyt0aGlzLnRpbWVyc0VuYWJsZWQ7Cgl9IGVsc2UgaWYgKHdhc0VuYWJsZWQgJiYgIWN1cnJlbnRUaW1lci5lbmFibGUpIHsKCQlpZiAoIWN1cnJlbnRUaW1lci5jb3VudFVwKSB7CgkJCXRoaXMuaW8ucmVnaXN0ZXJzWyh0aGlzLmlvLlRNMENOVF9MTyArICh0aW1lciA8PCAyKSkgPj4gMV0gPSBjdXJyZW50VGltZXIub2xkUmVsb2FkICsgKHRoaXMuY3B1LmN5Y2xlcyAtIGN1cnJlbnRUaW1lci5sYXN0RXZlbnQpID4+IG9sZFByZXNjYWxlOwoJCX0KCQktLXRoaXMudGltZXJzRW5hYmxlZDsKCX0gZWxzZSBpZiAoY3VycmVudFRpbWVyLnByZXNjYWxlQml0cyAhPSBvbGRQcmVzY2FsZSAmJiAhY3VycmVudFRpbWVyLmNvdW50VXApIHsKCQkvLyBGSVhNRTogdGhpcyBtaWdodCBiZSBiZWZvcmUgcHJlc2VudAoJCWN1cnJlbnRUaW1lci5uZXh0RXZlbnQgPSBjdXJyZW50VGltZXIubGFzdEV2ZW50ICsgY3VycmVudFRpbWVyLm92ZXJmbG93SW50ZXJ2YWw7Cgl9CgoJLy8gV2UndmUgY2hhbmdlZCB0aGUgdGltZXJzIHNvbWVob3cuLi53ZSBuZWVkIHRvIHJlc2V0IHRoZSBuZXh0IGV2ZW50Cgl0aGlzLnBvbGxOZXh0RXZlbnQoKTsKfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUudGltZXJSZWFkID0gZnVuY3Rpb24odGltZXIpIHsKCXZhciBjdXJyZW50VGltZXIgPSB0aGlzLnRpbWVyc1t0aW1lcl07CglpZiAoY3VycmVudFRpbWVyLmVuYWJsZSAmJiAhY3VycmVudFRpbWVyLmNvdW50VXApIHsKCQlyZXR1cm4gY3VycmVudFRpbWVyLm9sZFJlbG9hZCArICh0aGlzLmNwdS5jeWNsZXMgLSBjdXJyZW50VGltZXIubGFzdEV2ZW50KSA+PiBjdXJyZW50VGltZXIucHJlc2NhbGVCaXRzOwoJfSBlbHNlIHsKCQlyZXR1cm4gdGhpcy5pby5yZWdpc3RlcnNbKHRoaXMuaW8uVE0wQ05UX0xPICsgKHRpbWVyIDw8IDIpKSA+PiAxXTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUuaGFsdCA9IGZ1bmN0aW9uKCkgewoJaWYgKCF0aGlzLmVuYWJsZSkgewoJCXRocm93ICJSZXF1ZXN0ZWQgSEFMVCB3aGVuIGludGVycnVwdHMgd2VyZSBkaXNhYmxlZCEiOwoJfQoJaWYgKCF0aGlzLndhaXRGb3JJUlEoKSkgewoJCXRocm93ICJXYWl0aW5nIG9uIGludGVycnVwdCBmb3JldmVyLiI7Cgl9Cn0KCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUubHo3NyA9IGZ1bmN0aW9uKHNvdXJjZSwgZGVzdCwgdW5pdHNpemUpIHsKCS8vIFRPRE86IG1vdmUgdG8gYSBkaWZmZXJlbnQgZmlsZQoJdmFyIHJlbWFpbmluZyA9ICh0aGlzLmNwdS5tbXUubG9hZDMyKHNvdXJjZSkgJiAweEZGRkZGRjAwKSA+PiA4OwoJLy8gV2UgYXNzdW1lIHRoZSBzaWduYXR1cmUgYnl0ZSAoMHgxMCkgaXMgY29ycmVjdAoJdmFyIGJsb2NraGVhZGVyOwoJdmFyIHNQb2ludGVyID0gc291cmNlICsgNDsKCXZhciBkUG9pbnRlciA9IGRlc3Q7Cgl2YXIgYmxvY2tzUmVtYWluaW5nID0gMDsKCXZhciBibG9jazsKCXZhciBkaXNwOwoJdmFyIGJ5dGVzOwoJdmFyIGJ1ZmZlciA9IDA7Cgl2YXIgbG9hZGVkOwoJd2hpbGUgKHJlbWFpbmluZyA+IDApIHsKCQlpZiAoYmxvY2tzUmVtYWluaW5nKSB7CgkJCWlmIChibG9ja2hlYWRlciAmIDB4ODApIHsKCQkJCS8vIENvbXByZXNzZWQKCQkJCWJsb2NrID0gdGhpcy5jcHUubW11LmxvYWRVOChzUG9pbnRlcikgfCAodGhpcy5jcHUubW11LmxvYWRVOChzUG9pbnRlciArIDEpIDw8IDgpOwoJCQkJc1BvaW50ZXIgKz0gMjsKCQkJCWRpc3AgPSBkUG9pbnRlciAtICgoKGJsb2NrICYgMHgwMDBGKSA8PCA4KSB8ICgoYmxvY2sgJiAweEZGMDApID4+IDgpKSAtIDE7CgkJCQlieXRlcyA9ICgoYmxvY2sgJiAweDAwRjApID4+IDQpICsgMzsKCQkJCXdoaWxlIChieXRlcy0tICYmIHJlbWFpbmluZykgewoJCQkJCWxvYWRlZCA9IHRoaXMuY3B1Lm1tdS5sb2FkVTgoZGlzcCsrKTsKCQkJCQlpZiAodW5pdHNpemUgPT0gMikgewoJCQkJCQlidWZmZXIgPj49IDg7CgkJCQkJCWJ1ZmZlciB8PSBsb2FkZWQgPDwgODsKCQkJCQkJaWYgKGRQb2ludGVyICYgMSkgewoJCQkJCQkJdGhpcy5jcHUubW11LnN0b3JlMTYoZFBvaW50ZXIgLSAxLCBidWZmZXIpOwoJCQkJCQl9CgkJCQkJfSBlbHNlIHsKCQkJCQkJdGhpcy5jcHUubW11LnN0b3JlOChkUG9pbnRlciwgbG9hZGVkKTsKCQkJCQl9CgkJCQkJLS1yZW1haW5pbmc7CgkJCQkJKytkUG9pbnRlcjsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCS8vIFVuY29tcHJlc3NlZAoJCQkJbG9hZGVkID0gdGhpcy5jcHUubW11LmxvYWRVOChzUG9pbnRlcisrKTsKCQkJCWlmICh1bml0c2l6ZSA9PSAyKSB7CgkJCQkJYnVmZmVyID4+PSA4OwoJCQkJCWJ1ZmZlciB8PSBsb2FkZWQgPDwgODsKCQkJCQlpZiAoZFBvaW50ZXIgJiAxKSB7CgkJCQkJCXRoaXMuY3B1Lm1tdS5zdG9yZTE2KGRQb2ludGVyIC0gMSwgYnVmZmVyKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXRoaXMuY3B1Lm1tdS5zdG9yZTgoZFBvaW50ZXIsIGxvYWRlZCk7CgkJCQl9CgkJCQktLXJlbWFpbmluZzsKCQkJCSsrZFBvaW50ZXI7CgkJCX0KCQkJYmxvY2toZWFkZXIgPDw9IDE7CgkJCS0tYmxvY2tzUmVtYWluaW5nOwoJCX0gZWxzZSB7CgkJCWJsb2NraGVhZGVyID0gdGhpcy5jcHUubW11LmxvYWRVOChzUG9pbnRlcisrKTsKCQkJYmxvY2tzUmVtYWluaW5nID0gODsKCQl9Cgl9Cn07CgpHYW1lQm95QWR2YW5jZUludGVycnVwdEhhbmRsZXIucHJvdG90eXBlLmh1ZmZtYW4gPSBmdW5jdGlvbihzb3VyY2UsIGRlc3QpIHsKCXNvdXJjZSA9IHNvdXJjZSAmIDB4RkZGRkZGRkM7Cgl2YXIgaGVhZGVyID0gdGhpcy5jcHUubW11LmxvYWQzMihzb3VyY2UpOwoJdmFyIHJlbWFpbmluZyA9IGhlYWRlciA+PiA4OwoJdmFyIGJpdHMgPSBoZWFkZXIgJiAweEY7CglpZiAoMzIgJSBiaXRzKSB7CgkJdGhyb3cgJ1VuaW1wbGVtZW50ZWQgdW5hbGlnbmVkIEh1ZmZtYW4nOwoJfQoJdmFyIHBhZGRpbmcgPSAoNCAtIHJlbWFpbmluZykgJiAweDM7CglyZW1haW5pbmcgJj0gMHhGRkZGRkZGQzsKCS8vIFdlIGFzc3VtZSB0aGUgc2lnbmF0dXJlIGJ5dGUgKDB4MjApIGlzIGNvcnJlY3QKCXZhciB0cmVlID0gW107Cgl2YXIgdHJlZXNpemUgPSAodGhpcy5jcHUubW11LmxvYWRVOChzb3VyY2UgKyA0KSA8PCAxKSArIDE7Cgl2YXIgYmxvY2s7Cgl2YXIgc1BvaW50ZXIgPSBzb3VyY2UgKyA1ICsgdHJlZXNpemU7Cgl2YXIgZFBvaW50ZXIgPSBkZXN0ICYgMHhGRkZGRkZGQzsKCXZhciBpOwoJZm9yIChpID0gMDsgaSA8IHRyZWVzaXplOyArK2kpIHsKCQl0cmVlLnB1c2godGhpcy5jcHUubW11LmxvYWRVOChzb3VyY2UgKyA1ICsgaSkpOwoJfQoJdmFyIG5vZGU7Cgl2YXIgb2Zmc2V0ID0gMDsKCXZhciBiaXRzUmVtYWluaW5nOwoJdmFyIHJlYWRCaXRzOwoJdmFyIGJpdHNTZWVuID0gMDsKCW5vZGUgPSB0cmVlWzBdOwoJd2hpbGUgKHJlbWFpbmluZyA+IDApIHsKCQl2YXIgYml0c3RyZWFtID0gdGhpcy5jcHUubW11LmxvYWQzMihzUG9pbnRlcik7CgkJc1BvaW50ZXIgKz0gNDsKCQlmb3IgKGJpdHNSZW1haW5pbmcgPSAzMjsgYml0c1JlbWFpbmluZyA+IDA7IC0tYml0c1JlbWFpbmluZywgYml0c3RyZWFtIDw8PSAxKSB7CgkJCWlmICh0eXBlb2YgKG5vZGUpID09PSAnbnVtYmVyJykgewoJCQkJLy8gTGF6aWx5IGNvbnN0cnVjdCB0cmVlCgkJCQl2YXIgbmV4dCA9IChvZmZzZXQgLSAxIHwgMSkgKyAoKG5vZGUgJiAweDNGKSA8PCAxKSArIDI7CgkJCQlub2RlID0gewoJCQkJCWw6IG5leHQsCgkJCQkJcjogbmV4dCArIDEsCgkJCQkJbFRlcm06IG5vZGUgJiAweDgwLAoJCQkJCXJUZXJtOiBub2RlICYgMHg0MAoJCQkJfTsKCQkJCXRyZWVbb2Zmc2V0XSA9IG5vZGU7CgkJCX0KCgkJCWlmIChiaXRzdHJlYW0gJiAweDgwMDAwMDAwKSB7CgkJCQkvLyBHbyByaWdodAoJCQkJaWYgKG5vZGUuclRlcm0pIHsKCQkJCQlyZWFkQml0cyA9IHRyZWVbbm9kZS5yXTsKCQkJCX0gZWxzZSB7CgkJCQkJb2Zmc2V0ID0gbm9kZS5yOwoJCQkJCW5vZGUgPSB0cmVlW25vZGUucl07CgkJCQkJY29udGludWU7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQkvLyBHbyBsZWZ0CgkJCQlpZiAobm9kZS5sVGVybSkgewoJCQkJCXJlYWRCaXRzID0gdHJlZVtub2RlLmxdOwoJCQkJfSBlbHNlIHsKCQkJCQlvZmZzZXQgPSBub2RlLmw7CgkJCQkJbm9kZSA9IHRyZWVbb2Zmc2V0XTsKCQkJCQljb250aW51ZTsKCQkJCX0KCQkJfQoKCQkJYmxvY2sgfD0gKHJlYWRCaXRzICYgKCgxIDw8IGJpdHMpIC0gMSkpIDw8IGJpdHNTZWVuOwoJCQliaXRzU2VlbiArPSBiaXRzOwoJCQlvZmZzZXQgPSAwOwoJCQlub2RlID0gdHJlZVswXTsKCQkJaWYgKGJpdHNTZWVuID09IDMyKSB7CgkJCQliaXRzU2VlbiA9IDA7CgkJCQl0aGlzLmNwdS5tbXUuc3RvcmUzMihkUG9pbnRlciwgYmxvY2spOwoJCQkJZFBvaW50ZXIgKz0gNDsKCQkJCXJlbWFpbmluZyAtPSA0OwoJCQkJYmxvY2sgPSAwOwoJCQl9CgkJfQoKCX0KCWlmIChwYWRkaW5nKSB7CgkJdGhpcy5jcHUubW11LnN0b3JlMzIoZFBvaW50ZXIsIGJsb2NrKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlSW50ZXJydXB0SGFuZGxlci5wcm90b3R5cGUucmwgPSBmdW5jdGlvbihzb3VyY2UsIGRlc3QsIHVuaXRzaXplKSB7Cglzb3VyY2UgPSBzb3VyY2UgJiAweEZGRkZGRkZDOwoJdmFyIHJlbWFpbmluZyA9ICh0aGlzLmNwdS5tbXUubG9hZDMyKHNvdXJjZSkgJiAweEZGRkZGRjAwKSA+PiA4OwoJdmFyIHBhZGRpbmcgPSAoNCAtIHJlbWFpbmluZykgJiAweDM7CgkvLyBXZSBhc3N1bWUgdGhlIHNpZ25hdHVyZSBieXRlICgweDMwKSBpcyBjb3JyZWN0Cgl2YXIgYmxvY2toZWFkZXI7Cgl2YXIgYmxvY2s7Cgl2YXIgc1BvaW50ZXIgPSBzb3VyY2UgKyA0OwoJdmFyIGRQb2ludGVyID0gZGVzdDsKCXZhciBidWZmZXIgPSAwOwoJd2hpbGUgKHJlbWFpbmluZyA+IDApIHsKCQlibG9ja2hlYWRlciA9IHRoaXMuY3B1Lm1tdS5sb2FkVTgoc1BvaW50ZXIrKyk7CgkJaWYgKGJsb2NraGVhZGVyICYgMHg4MCkgewoJCQkvLyBDb21wcmVzc2VkCgkJCWJsb2NraGVhZGVyICY9IDB4N0Y7CgkJCWJsb2NraGVhZGVyICs9IDM7CgkJCWJsb2NrID0gdGhpcy5jcHUubW11LmxvYWRVOChzUG9pbnRlcisrKTsKCQkJd2hpbGUgKGJsb2NraGVhZGVyLS0gJiYgcmVtYWluaW5nKSB7CgkJCQktLXJlbWFpbmluZzsKCQkJCWlmICh1bml0c2l6ZSA9PSAyKSB7CgkJCQkJYnVmZmVyID4+PSA4OwoJCQkJCWJ1ZmZlciB8PSBibG9jayA8PCA4OwoJCQkJCWlmIChkUG9pbnRlciAmIDEpIHsKCQkJCQkJdGhpcy5jcHUubW11LnN0b3JlMTYoZFBvaW50ZXIgLSAxLCBidWZmZXIpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJdGhpcy5jcHUubW11LnN0b3JlOChkUG9pbnRlciwgYmxvY2spOwoJCQkJfQoJCQkJKytkUG9pbnRlcjsKCQkJfQoJCX0gZWxzZSB7CgkJCS8vIFVuY29tcHJlc3NlZAoJCQlibG9ja2hlYWRlcisrOwoJCQl3aGlsZSAoYmxvY2toZWFkZXItLSAmJiByZW1haW5pbmcpIHsKCQkJCS0tcmVtYWluaW5nOwoJCQkJYmxvY2sgPSB0aGlzLmNwdS5tbXUubG9hZFU4KHNQb2ludGVyKyspOwoJCQkJaWYgKHVuaXRzaXplID09IDIpIHsKCQkJCQlidWZmZXIgPj49IDg7CgkJCQkJYnVmZmVyIHw9IGJsb2NrIDw8IDg7CgkJCQkJaWYgKGRQb2ludGVyICYgMSkgewoJCQkJCQl0aGlzLmNwdS5tbXUuc3RvcmUxNihkUG9pbnRlciAtIDEsIGJ1ZmZlcik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQl0aGlzLmNwdS5tbXUuc3RvcmU4KGRQb2ludGVyLCBibG9jayk7CgkJCQl9CgkJCQkrK2RQb2ludGVyOwoJCQl9CgkJfQoJfQoJd2hpbGUgKHBhZGRpbmctLSkgewoJCXRoaXMuY3B1Lm1tdS5zdG9yZTgoZFBvaW50ZXIrKywgMCk7Cgl9Cn07Cg==";

const GBA_js_keypad_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VLZXlwYWQoKSB7Cgl0aGlzLktFWUNPREVfTEVGVCA9IDM3OwoJdGhpcy5LRVlDT0RFX1VQID0gMzg7Cgl0aGlzLktFWUNPREVfUklHSFQgPSAzOTsKCXRoaXMuS0VZQ09ERV9ET1dOID0gNDA7Cgl0aGlzLktFWUNPREVfU1RBUlQgPSAxMzsKCXRoaXMuS0VZQ09ERV9TRUxFQ1QgPSAyMjA7Cgl0aGlzLktFWUNPREVfQSA9IDkwOwoJdGhpcy5LRVlDT0RFX0IgPSA4ODsKCXRoaXMuS0VZQ09ERV9MID0gNjU7Cgl0aGlzLktFWUNPREVfUiA9IDgzOwoKCXRoaXMuR0FNRVBBRF9MRUZUID0gMTQ7Cgl0aGlzLkdBTUVQQURfVVAgPSAxMjsKCXRoaXMuR0FNRVBBRF9SSUdIVCA9IDE1OwoJdGhpcy5HQU1FUEFEX0RPV04gPSAxMzsKCXRoaXMuR0FNRVBBRF9TVEFSVCA9IDk7Cgl0aGlzLkdBTUVQQURfU0VMRUNUID0gODsKCXRoaXMuR0FNRVBBRF9BID0gMTsKCXRoaXMuR0FNRVBBRF9CID0gMDsKCXRoaXMuR0FNRVBBRF9MID0gNDsKCXRoaXMuR0FNRVBBRF9SID0gNTsKCXRoaXMuR0FNRVBBRF9USFJFU0hPTEQgPSAwLjI7CgoJdGhpcy5BID0gMDsKCXRoaXMuQiA9IDE7Cgl0aGlzLlNFTEVDVCA9IDI7Cgl0aGlzLlNUQVJUID0gMzsKCXRoaXMuUklHSFQgPSA0OwoJdGhpcy5MRUZUID0gNTsKCXRoaXMuVVAgPSA2OwoJdGhpcy5ET1dOID0gNzsKCXRoaXMuUiA9IDg7Cgl0aGlzLkwgPSA5OwoKCXRoaXMuY3VycmVudERvd24gPSAweDAzRkY7Cgl0aGlzLmVhdElucHV0ID0gZmFsc2U7CgoJdGhpcy5nYW1lcGFkcyA9IFtdOwp9OwoKR2FtZUJveUFkdmFuY2VLZXlwYWQucHJvdG90eXBlLmtleWJvYXJkSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHsKCXZhciB0b2dnbGUgPSAwOwoJc3dpdGNoIChlLmtleUNvZGUpIHsKCWNhc2UgdGhpcy5LRVlDT0RFX1NUQVJUOgoJCXRvZ2dsZSA9IHRoaXMuU1RBUlQ7CgkJYnJlYWs7CgljYXNlIHRoaXMuS0VZQ09ERV9TRUxFQ1Q6CgkJdG9nZ2xlID0gdGhpcy5TRUxFQ1Q7CgkJYnJlYWs7CgljYXNlIHRoaXMuS0VZQ09ERV9BOgoJCXRvZ2dsZSA9IHRoaXMuQTsKCQlicmVhazsKCWNhc2UgdGhpcy5LRVlDT0RFX0I6CgkJdG9nZ2xlID0gdGhpcy5COwoJCWJyZWFrOwoJY2FzZSB0aGlzLktFWUNPREVfTDoKCQl0b2dnbGUgPSB0aGlzLkw7CgkJYnJlYWs7CgljYXNlIHRoaXMuS0VZQ09ERV9SOgoJCXRvZ2dsZSA9IHRoaXMuUjsKCQlicmVhazsKCWNhc2UgdGhpcy5LRVlDT0RFX1VQOgoJCXRvZ2dsZSA9IHRoaXMuVVA7CgkJYnJlYWs7CgljYXNlIHRoaXMuS0VZQ09ERV9SSUdIVDoKCQl0b2dnbGUgPSB0aGlzLlJJR0hUOwoJCWJyZWFrOwoJY2FzZSB0aGlzLktFWUNPREVfRE9XTjoKCQl0b2dnbGUgPSB0aGlzLkRPV047CgkJYnJlYWs7CgljYXNlIHRoaXMuS0VZQ09ERV9MRUZUOgoJCXRvZ2dsZSA9IHRoaXMuTEVGVDsKCQlicmVhazsKCWRlZmF1bHQ6CgkJcmV0dXJuOwoJfQoKCXRvZ2dsZSA9IDEgPDwgdG9nZ2xlOwoJaWYgKGUudHlwZSA9PSAia2V5ZG93biIpIHsKCQl0aGlzLmN1cnJlbnREb3duICY9IH50b2dnbGU7Cgl9IGVsc2UgewoJCXRoaXMuY3VycmVudERvd24gfD0gdG9nZ2xlOwoJfQoKCWlmICh0aGlzLmVhdElucHV0KSB7CgkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VLZXlwYWQucHJvdG90eXBlLmdhbWVwYWRIYW5kbGVyID0gZnVuY3Rpb24oZ2FtZXBhZCkgewoJdmFyIHZhbHVlID0gMDsKCWlmIChnYW1lcGFkLmJ1dHRvbnNbdGhpcy5HQU1FUEFEX0xFRlRdID4gdGhpcy5HQU1FUEFEX1RIUkVTSE9MRCkgewoJCXZhbHVlIHw9IDEgPDwgdGhpcy5MRUZUOwoJfQoJaWYgKGdhbWVwYWQuYnV0dG9uc1t0aGlzLkdBTUVQQURfVVBdID4gdGhpcy5HQU1FUEFEX1RIUkVTSE9MRCkgewoJCXZhbHVlIHw9IDEgPDwgdGhpcy5VUDsKCX0KCWlmIChnYW1lcGFkLmJ1dHRvbnNbdGhpcy5HQU1FUEFEX1JJR0hUXSA+IHRoaXMuR0FNRVBBRF9USFJFU0hPTEQpIHsKCQl2YWx1ZSB8PSAxIDw8IHRoaXMuUklHSFQ7Cgl9CglpZiAoZ2FtZXBhZC5idXR0b25zW3RoaXMuR0FNRVBBRF9ET1dOXSA+IHRoaXMuR0FNRVBBRF9USFJFU0hPTEQpIHsKCQl2YWx1ZSB8PSAxIDw8IHRoaXMuRE9XTjsKCX0KCWlmIChnYW1lcGFkLmJ1dHRvbnNbdGhpcy5HQU1FUEFEX1NUQVJUXSA+IHRoaXMuR0FNRVBBRF9USFJFU0hPTEQpIHsKCQl2YWx1ZSB8PSAxIDw8IHRoaXMuU1RBUlQ7Cgl9CglpZiAoZ2FtZXBhZC5idXR0b25zW3RoaXMuR0FNRVBBRF9TRUxFQ1RdID4gdGhpcy5HQU1FUEFEX1RIUkVTSE9MRCkgewoJCXZhbHVlIHw9IDEgPDwgdGhpcy5TRUxFQ1Q7Cgl9CglpZiAoZ2FtZXBhZC5idXR0b25zW3RoaXMuR0FNRVBBRF9BXSA+IHRoaXMuR0FNRVBBRF9USFJFU0hPTEQpIHsKCQl2YWx1ZSB8PSAxIDw8IHRoaXMuQTsKCX0KCWlmIChnYW1lcGFkLmJ1dHRvbnNbdGhpcy5HQU1FUEFEX0JdID4gdGhpcy5HQU1FUEFEX1RIUkVTSE9MRCkgewoJCXZhbHVlIHw9IDEgPDwgdGhpcy5COwoJfQoJaWYgKGdhbWVwYWQuYnV0dG9uc1t0aGlzLkdBTUVQQURfTF0gPiB0aGlzLkdBTUVQQURfVEhSRVNIT0xEKSB7CgkJdmFsdWUgfD0gMSA8PCB0aGlzLkw7Cgl9CglpZiAoZ2FtZXBhZC5idXR0b25zW3RoaXMuR0FNRVBBRF9SXSA+IHRoaXMuR0FNRVBBRF9USFJFU0hPTEQpIHsKCQl2YWx1ZSB8PSAxIDw8IHRoaXMuUjsKCX0KCgl0aGlzLmN1cnJlbnREb3duID0gfnZhbHVlICYgMHgzRkY7Cn07CgpHYW1lQm95QWR2YW5jZUtleXBhZC5wcm90b3R5cGUuZ2FtZXBhZENvbm5lY3RIYW5kbGVyID0gZnVuY3Rpb24oZ2FtZXBhZCkgewoJdGhpcy5nYW1lcGFkcy5wdXNoKGdhbWVwYWQpOwp9OwoKR2FtZUJveUFkdmFuY2VLZXlwYWQucHJvdG90eXBlLmdhbWVwYWREaXNjb25uZWN0SGFuZGxlciA9IGZ1bmN0aW9uKGdhbWVwYWQpIHsKCXRoaXMuZ2FtZXBhZHMgPSBzZWxmLmdhbWVwYWRzLmZpbHRlcihmdW5jdGlvbihvdGhlcikgeyByZXR1cm4gb3RoZXIgIT0gZ2FtZXBhZCB9KTsKfTsKCkdhbWVCb3lBZHZhbmNlS2V5cGFkLnByb3RvdHlwZS5wb2xsR2FtZXBhZHMgPSBmdW5jdGlvbigpIHsKCXZhciBuYXZpZ2F0b3JMaXN0ID0gW107CglpZiAobmF2aWdhdG9yLndlYmtpdEdldEdhbWVwYWRzKSB7CgkJbmF2aWdhdG9yTGlzdCA9IG5hdmlnYXRvci53ZWJraXRHZXRHYW1lcGFkcygpOwoJfSBlbHNlIGlmIChuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMpIHsKCQluYXZpZ2F0b3JMaXN0ID0gbmF2aWdhdG9yLmdldEdhbWVwYWRzKCk7Cgl9CgoJLy8gTGV0J3MgYWxsIGdpdmUgYSBzaG91dCBvdXQgdG8gQ2hyb21lIGZvciBtYWtpbmcgdXMgZ2V0IHRoZSBnYW1lcGFkcyBFVkVSWSBGUkFNRQoJaWYgKG5hdmlnYXRvckxpc3QubGVuZ3RoKSB7CgkJdGhpcy5nYW1lcGFkcyA9IFtdOwoJfQoJZm9yICh2YXIgaSA9IDA7IGkgPCBuYXZpZ2F0b3JMaXN0Lmxlbmd0aDsgKytpKSB7CgkJaWYgKG5hdmlnYXRvckxpc3RbaV0pIHsKCQkJdGhpcy5nYW1lcGFkcy5wdXNoKG5hdmlnYXRvckxpc3RbaV0pOwoJCX0KCX0KCWlmICh0aGlzLmdhbWVwYWRzLmxlbmd0aCA+IDApIHsKCQl0aGlzLmdhbWVwYWRIYW5kbGVyKHRoaXMuZ2FtZXBhZHNbMF0pOwoJfQoKfTsKCkdhbWVCb3lBZHZhbmNlS2V5cGFkLnByb3RvdHlwZS5yZWdpc3RlckhhbmRsZXJzID0gZnVuY3Rpb24oKSB7Cgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIHRoaXMua2V5Ym9hcmRIYW5kbGVyLmJpbmQodGhpcyksIHRydWUpOwoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImtleXVwIiwgdGhpcy5rZXlib2FyZEhhbmRsZXIuYmluZCh0aGlzKSwgdHJ1ZSk7CgoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImdhbWVwYWRjb25uZWN0ZWQiLCB0aGlzLmdhbWVwYWRDb25uZWN0SGFuZGxlci5iaW5kKHRoaXMpLCB0cnVlKTsKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtb3pnYW1lcGFkY29ubmVjdGVkIiwgdGhpcy5nYW1lcGFkQ29ubmVjdEhhbmRsZXIuYmluZCh0aGlzKSwgdHJ1ZSk7Cgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigid2Via2l0Z2FtZXBhZGNvbm5lY3RlZCIsIHRoaXMuZ2FtZXBhZENvbm5lY3RIYW5kbGVyLmJpbmQodGhpcyksIHRydWUpOwoKCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJnYW1lcGFkZGlzY29ubmVjdGVkIiwgdGhpcy5nYW1lcGFkRGlzY29ubmVjdEhhbmRsZXIuYmluZCh0aGlzKSwgdHJ1ZSk7Cgl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibW96Z2FtZXBhZGRpc2Nvbm5lY3RlZCIsIHRoaXMuZ2FtZXBhZERpc2Nvbm5lY3RIYW5kbGVyLmJpbmQodGhpcyksIHRydWUpOwoJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIndlYmtpdGdhbWVwYWRkaXNjb25uZWN0ZWQiLCB0aGlzLmdhbWVwYWREaXNjb25uZWN0SGFuZGxlci5iaW5kKHRoaXMpLCB0cnVlKTsKfTsK";

const GBA_js_mmu_js = "ZnVuY3Rpb24gTWVtb3J5VmlldyhtZW1vcnksIG9mZnNldCkgewoJdGhpcy5pbmhlcml0KCk7Cgl0aGlzLmJ1ZmZlciA9IG1lbW9yeTsKCXRoaXMudmlldyA9IG5ldyBEYXRhVmlldyh0aGlzLmJ1ZmZlciwgdHlwZW9mKG9mZnNldCkgPT09ICJudW1iZXIiID8gb2Zmc2V0IDogMCk7Cgl0aGlzLm1hc2sgPSBtZW1vcnkuYnl0ZUxlbmd0aCAtIDE7Cgl0aGlzLnJlc2V0TWFzaygpOwp9OwoKTWVtb3J5Vmlldy5wcm90b3R5cGUucmVzZXRNYXNrID0gZnVuY3Rpb24oKSB7Cgl0aGlzLm1hc2s4ID0gdGhpcy5tYXNrICYgMHhGRkZGRkZGRjsKCXRoaXMubWFzazE2ID0gdGhpcy5tYXNrICYgMHhGRkZGRkZGRTsKCXRoaXMubWFzazMyID0gdGhpcy5tYXNrICYgMHhGRkZGRkZGQzsKfTsKCk1lbW9yeVZpZXcucHJvdG90eXBlLmxvYWQ4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy52aWV3LmdldEludDgob2Zmc2V0ICYgdGhpcy5tYXNrOCk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5sb2FkMTYgPSBmdW5jdGlvbihvZmZzZXQpIHsKCS8vIFVuYWxpZ25lZCAxNi1iaXQgbG9hZHMgYXJlIHVucHJlZGljdGFibGUuLi5sZXQncyBqdXN0IHByZXRlbmQgdGhleSB3b3JrCglyZXR1cm4gdGhpcy52aWV3LmdldEludDE2KG9mZnNldCAmIHRoaXMubWFzaywgdHJ1ZSk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5sb2FkVTggPSBmdW5jdGlvbihvZmZzZXQpIHsKCXJldHVybiB0aGlzLnZpZXcuZ2V0VWludDgob2Zmc2V0ICYgdGhpcy5tYXNrOCk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5sb2FkVTE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CgkvLyBVbmFsaWduZWQgMTYtYml0IGxvYWRzIGFyZSB1bnByZWRpY3RhYmxlLi4ubGV0J3MganVzdCBwcmV0ZW5kIHRoZXkgd29yawoJcmV0dXJuIHRoaXMudmlldy5nZXRVaW50MTYob2Zmc2V0ICYgdGhpcy5tYXNrLCB0cnVlKTsKfTsKCk1lbW9yeVZpZXcucHJvdG90eXBlLmxvYWQzMiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJLy8gVW5hbGlnbmVkIDMyLWJpdCBsb2FkcyBhcmUgInJvdGF0ZWQiIHNvIHRoZXkgbWFrZSBzb21lIHNlbWJsYW5jZSBvZiBzZW5zZQoJdmFyIHJvdGF0ZSA9IChvZmZzZXQgJiAzKSA8PCAzOwoJdmFyIG1lbSA9IHRoaXMudmlldy5nZXRJbnQzMihvZmZzZXQgJiB0aGlzLm1hc2szMiwgdHJ1ZSk7CglyZXR1cm4gKG1lbSA+Pj4gcm90YXRlKSB8IChtZW0gPDwgKDMyIC0gcm90YXRlKSk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5zdG9yZTggPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7Cgl0aGlzLnZpZXcuc2V0SW50OChvZmZzZXQgJiB0aGlzLm1hc2s4LCB2YWx1ZSk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5zdG9yZTE2ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhpcy52aWV3LnNldEludDE2KG9mZnNldCAmIHRoaXMubWFzazE2LCB2YWx1ZSwgdHJ1ZSk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhpcy52aWV3LnNldEludDMyKG9mZnNldCAmIHRoaXMubWFzazMyLCB2YWx1ZSwgdHJ1ZSk7Cn07CgpNZW1vcnlWaWV3LnByb3RvdHlwZS5pbnZhbGlkYXRlUGFnZSA9IGZ1bmN0aW9uKGFkZHJlc3MpIHt9OwoKTWVtb3J5Vmlldy5wcm90b3R5cGUucmVwbGFjZURhdGEgPSBmdW5jdGlvbihtZW1vcnksIG9mZnNldCkgewoJdGhpcy5idWZmZXIgPSBtZW1vcnk7Cgl0aGlzLnZpZXcgPSBuZXcgRGF0YVZpZXcodGhpcy5idWZmZXIsIHR5cGVvZihvZmZzZXQpID09PSAibnVtYmVyIiA/IG9mZnNldCA6IDApOwoJaWYgKHRoaXMuaWNhY2hlKSB7CgkJdGhpcy5pY2FjaGUgPSBuZXcgQXJyYXkodGhpcy5pY2FjaGUubGVuZ3RoKTsKCX0KfTsKCmZ1bmN0aW9uIE1lbW9yeUJsb2NrKHNpemUsIGNhY2hlQml0cykgewoJTWVtb3J5Vmlldy5jYWxsKHRoaXMsIG5ldyBBcnJheUJ1ZmZlcihzaXplKSk7Cgl0aGlzLklDQUNIRV9QQUdFX0JJVFMgPSBjYWNoZUJpdHM7Cgl0aGlzLlBBR0VfTUFTSyA9ICgyIDw8IHRoaXMuSUNBQ0hFX1BBR0VfQklUUykgLSAxOwoJdGhpcy5pY2FjaGUgPSBuZXcgQXJyYXkoc2l6ZSA+PiAodGhpcy5JQ0FDSEVfUEFHRV9CSVRTICsgMSkpOwp9OwoKTWVtb3J5QmxvY2sucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNZW1vcnlWaWV3LnByb3RvdHlwZSk7CgpNZW1vcnlCbG9jay5wcm90b3R5cGUuaW52YWxpZGF0ZVBhZ2UgPSBmdW5jdGlvbihhZGRyZXNzKSB7Cgl2YXIgcGFnZSA9IHRoaXMuaWNhY2hlWyhhZGRyZXNzICYgdGhpcy5tYXNrKSA+PiB0aGlzLklDQUNIRV9QQUdFX0JJVFNdOwoJaWYgKHBhZ2UpIHsKCQlwYWdlLmludmFsaWQgPSB0cnVlOwoJfQp9OwoKZnVuY3Rpb24gUk9NVmlldyhyb20sIG9mZnNldCkgewoJTWVtb3J5Vmlldy5jYWxsKHRoaXMsIHJvbSwgb2Zmc2V0KTsKCXRoaXMuSUNBQ0hFX1BBR0VfQklUUyA9IDEwOwoJdGhpcy5QQUdFX01BU0sgPSAoMiA8PCB0aGlzLklDQUNIRV9QQUdFX0JJVFMpIC0gMTsKCXRoaXMuaWNhY2hlID0gbmV3IEFycmF5KHJvbS5ieXRlTGVuZ3RoID4+ICh0aGlzLklDQUNIRV9QQUdFX0JJVFMgKyAxKSk7Cgl0aGlzLm1hc2sgPSAweDAxRkZGRkZGOwoJdGhpcy5yZXNldE1hc2soKTsKfTsKClJPTVZpZXcucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNZW1vcnlWaWV3LnByb3RvdHlwZSk7CgpST01WaWV3LnByb3RvdHlwZS5zdG9yZTggPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7fTsKClJPTVZpZXcucHJvdG90eXBlLnN0b3JlMTYgPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7CglpZiAob2Zmc2V0IDwgMHhDQSAmJiBvZmZzZXQgPj0gMHhDNCkgewoJCWlmICghdGhpcy5ncGlvKSB7CgkJCXRoaXMuZ3BpbyA9IHRoaXMubW11LmFsbG9jR1BJTyh0aGlzKTsKCQl9CgkJdGhpcy5ncGlvLnN0b3JlMTYob2Zmc2V0LCB2YWx1ZSk7Cgl9Cn07CgpST01WaWV3LnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJaWYgKG9mZnNldCA8IDB4Q0EgJiYgb2Zmc2V0ID49IDB4QzQpIHsKCQlpZiAoIXRoaXMuZ3BpbykgewoJCQl0aGlzLmdwaW8gPSB0aGlzLm1tdS5hbGxvY0dQSU8odGhpcyk7CgkJfQoJCXRoaXMuZ3Bpby5zdG9yZTMyKG9mZnNldCwgdmFsdWUpOwoJfQp9OwoKZnVuY3Rpb24gQklPU1ZpZXcocm9tLCBvZmZzZXQpIHsKCU1lbW9yeVZpZXcuY2FsbCh0aGlzLCByb20sIG9mZnNldCk7Cgl0aGlzLklDQUNIRV9QQUdFX0JJVFMgPSAxNjsKCXRoaXMuUEFHRV9NQVNLID0gKDIgPDwgdGhpcy5JQ0FDSEVfUEFHRV9CSVRTKSAtIDE7Cgl0aGlzLmljYWNoZSA9IG5ldyBBcnJheSgxKTsKfTsKCkJJT1NWaWV3LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTWVtb3J5Vmlldy5wcm90b3R5cGUpOwoKQklPU1ZpZXcucHJvdG90eXBlLmxvYWQ4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglpZiAob2Zmc2V0ID49IHRoaXMuYnVmZmVyLmJ5dGVMZW5ndGgpIHsKCQlyZXR1cm4gLTE7Cgl9CglyZXR1cm4gdGhpcy52aWV3LmdldEludDgob2Zmc2V0KTsKfTsKCkJJT1NWaWV3LnByb3RvdHlwZS5sb2FkMTYgPSBmdW5jdGlvbihvZmZzZXQpIHsKCWlmIChvZmZzZXQgPj0gdGhpcy5idWZmZXIuYnl0ZUxlbmd0aCkgewoJCXJldHVybiAtMTsKCX0KCXJldHVybiB0aGlzLnZpZXcuZ2V0SW50MTYob2Zmc2V0LCB0cnVlKTsKfTsKCkJJT1NWaWV3LnByb3RvdHlwZS5sb2FkVTggPSBmdW5jdGlvbihvZmZzZXQpIHsKCWlmIChvZmZzZXQgPj0gdGhpcy5idWZmZXIuYnl0ZUxlbmd0aCkgewoJCXJldHVybiAtMTsKCX0KCXJldHVybiB0aGlzLnZpZXcuZ2V0VWludDgob2Zmc2V0KTsKfTsKCkJJT1NWaWV3LnByb3RvdHlwZS5sb2FkVTE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglpZiAob2Zmc2V0ID49IHRoaXMuYnVmZmVyLmJ5dGVMZW5ndGgpIHsKCQlyZXR1cm4gLTE7Cgl9CglyZXR1cm4gdGhpcy52aWV3LmdldFVpbnQxNihvZmZzZXQsIHRydWUpOwp9OwoKQklPU1ZpZXcucHJvdG90eXBlLmxvYWQzMiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJaWYgKG9mZnNldCA+PSB0aGlzLmJ1ZmZlci5ieXRlTGVuZ3RoKSB7CgkJcmV0dXJuIC0xOwoJfQoJcmV0dXJuIHRoaXMudmlldy5nZXRJbnQzMihvZmZzZXQsIHRydWUpOwp9OwoKQklPU1ZpZXcucHJvdG90eXBlLnN0b3JlOCA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHt9OwoKQklPU1ZpZXcucHJvdG90eXBlLnN0b3JlMTYgPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7fTsKCkJJT1NWaWV3LnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkge307CgpmdW5jdGlvbiBCYWRNZW1vcnkobW11LCBjcHUpIHsKCXRoaXMuaW5oZXJpdCgpOwoJdGhpcy5jcHUgPSBjcHU7Cgl0aGlzLm1tdSA9IG1tdQp9OwoKQmFkTWVtb3J5LnByb3RvdHlwZS5sb2FkOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMubW11LmxvYWQ4KHRoaXMuY3B1LmdwcnNbdGhpcy5jcHUuUENdIC0gdGhpcy5jcHUuaW5zdHJ1Y3Rpb25XaWR0aCArIChvZmZzZXQgJiAweDMpKTsKfTsKCkJhZE1lbW9yeS5wcm90b3R5cGUubG9hZDE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5tbXUubG9hZDE2KHRoaXMuY3B1LmdwcnNbdGhpcy5jcHUuUENdIC0gdGhpcy5jcHUuaW5zdHJ1Y3Rpb25XaWR0aCArIChvZmZzZXQgJiAweDIpKTsKfTsKCkJhZE1lbW9yeS5wcm90b3R5cGUubG9hZFU4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5tbXUubG9hZFU4KHRoaXMuY3B1LmdwcnNbdGhpcy5jcHUuUENdIC0gdGhpcy5jcHUuaW5zdHJ1Y3Rpb25XaWR0aCArIChvZmZzZXQgJiAweDMpKTsKfTsKCkJhZE1lbW9yeS5wcm90b3R5cGUubG9hZFUxNiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMubW11LmxvYWRVMTYodGhpcy5jcHUuZ3Byc1t0aGlzLmNwdS5QQ10gLSB0aGlzLmNwdS5pbnN0cnVjdGlvbldpZHRoICsgKG9mZnNldCAmIDB4MikpOwp9OwoKQmFkTWVtb3J5LnByb3RvdHlwZS5sb2FkMzIgPSBmdW5jdGlvbihvZmZzZXQpIHsKCWlmICh0aGlzLmNwdS5leGVjTW9kZSA9PSB0aGlzLmNwdS5NT0RFX0FSTSkgewoJCXJldHVybiB0aGlzLm1tdS5sb2FkMzIodGhpcy5jcHUuZ3Byc1t0aGlzLmNwdS5ncHJzLlBDXSAtIHRoaXMuY3B1Lmluc3RydWN0aW9uV2lkdGgpOwoJfSBlbHNlIHsKCQl2YXIgaGFsZndvcmQgPSB0aGlzLm1tdS5sb2FkVTE2KHRoaXMuY3B1LmdwcnNbdGhpcy5jcHUuUENdIC0gdGhpcy5jcHUuaW5zdHJ1Y3Rpb25XaWR0aCk7CgkJcmV0dXJuIGhhbGZ3b3JkIHwgKGhhbGZ3b3JkIDw8IDE2KTsKCX0KfTsKCkJhZE1lbW9yeS5wcm90b3R5cGUuc3RvcmU4ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkge307CgpCYWRNZW1vcnkucHJvdG90eXBlLnN0b3JlMTYgPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7fTsKCkJhZE1lbW9yeS5wcm90b3R5cGUuc3RvcmUzMiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHt9OwoKQmFkTWVtb3J5LnByb3RvdHlwZS5pbnZhbGlkYXRlUGFnZSA9IGZ1bmN0aW9uKGFkZHJlc3MpIHt9OwoKZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VNTVUoKSB7Cgl0aGlzLmluaGVyaXQoKTsKCXRoaXMuUkVHSU9OX0JJT1MgPSAweDA7Cgl0aGlzLlJFR0lPTl9XT1JLSU5HX1JBTSA9IDB4MjsKCXRoaXMuUkVHSU9OX1dPUktJTkdfSVJBTSA9IDB4MzsKCXRoaXMuUkVHSU9OX0lPID0gMHg0OwoJdGhpcy5SRUdJT05fUEFMRVRURV9SQU0gPSAweDU7Cgl0aGlzLlJFR0lPTl9WUkFNID0gMHg2OwoJdGhpcy5SRUdJT05fT0FNID0gMHg3OwoJdGhpcy5SRUdJT05fQ0FSVDAgPSAweDg7Cgl0aGlzLlJFR0lPTl9DQVJUMSA9IDB4QTsKCXRoaXMuUkVHSU9OX0NBUlQyID0gMHhDOwoJdGhpcy5SRUdJT05fQ0FSVF9TUkFNID0gMHhFOwoKCXRoaXMuQkFTRV9CSU9TID0gMHgwMDAwMDAwMDsKCXRoaXMuQkFTRV9XT1JLSU5HX1JBTSA9IDB4MDIwMDAwMDA7Cgl0aGlzLkJBU0VfV09SS0lOR19JUkFNID0gMHgwMzAwMDAwMDsKCXRoaXMuQkFTRV9JTyA9IDB4MDQwMDAwMDA7Cgl0aGlzLkJBU0VfUEFMRVRURV9SQU0gPSAweDA1MDAwMDAwOwoJdGhpcy5CQVNFX1ZSQU0gPSAweDA2MDAwMDAwOwoJdGhpcy5CQVNFX09BTSA9IDB4MDcwMDAwMDA7Cgl0aGlzLkJBU0VfQ0FSVDAgPSAweDA4MDAwMDAwOwoJdGhpcy5CQVNFX0NBUlQxID0gMHgwQTAwMDAwMDsKCXRoaXMuQkFTRV9DQVJUMiA9IDB4MEMwMDAwMDA7Cgl0aGlzLkJBU0VfQ0FSVF9TUkFNID0gMHgwRTAwMDAwMDsKCgl0aGlzLkJBU0VfTUFTSyA9IDB4MEYwMDAwMDA7Cgl0aGlzLkJBU0VfT0ZGU0VUID0gMjQ7Cgl0aGlzLk9GRlNFVF9NQVNLID0gMHgwMEZGRkZGRjsKCgl0aGlzLlNJWkVfQklPUyA9IDB4MDAwMDQwMDA7Cgl0aGlzLlNJWkVfV09SS0lOR19SQU0gPSAweDAwMDQwMDAwOwoJdGhpcy5TSVpFX1dPUktJTkdfSVJBTSA9IDB4MDAwMDgwMDA7Cgl0aGlzLlNJWkVfSU8gPSAweDAwMDAwNDAwOwoJdGhpcy5TSVpFX1BBTEVUVEVfUkFNID0gMHgwMDAwMDQwMDsKCXRoaXMuU0laRV9WUkFNID0gMHgwMDAxODAwMDsKCXRoaXMuU0laRV9PQU0gPSAweDAwMDAwNDAwOwoJdGhpcy5TSVpFX0NBUlQwID0gMHgwMjAwMDAwMDsKCXRoaXMuU0laRV9DQVJUMSA9IDB4MDIwMDAwMDA7Cgl0aGlzLlNJWkVfQ0FSVDIgPSAweDAyMDAwMDAwOwoJdGhpcy5TSVpFX0NBUlRfU1JBTSA9IDB4MDAwMDgwMDA7Cgl0aGlzLlNJWkVfQ0FSVF9GTEFTSDUxMiA9IDB4MDAwMTAwMDA7Cgl0aGlzLlNJWkVfQ0FSVF9GTEFTSDFNID0gMHgwMDAyMDAwMDsKCXRoaXMuU0laRV9DQVJUX0VFUFJPTSA9IDB4MDAwMDIwMDA7CgoJdGhpcy5ETUFfVElNSU5HX05PVyA9IDA7Cgl0aGlzLkRNQV9USU1JTkdfVkJMQU5LID0gMTsKCXRoaXMuRE1BX1RJTUlOR19IQkxBTksgPSAyOwoJdGhpcy5ETUFfVElNSU5HX0NVU1RPTSA9IDM7CgoJdGhpcy5ETUFfSU5DUkVNRU5UID0gMDsKCXRoaXMuRE1BX0RFQ1JFTUVOVCA9IDE7Cgl0aGlzLkRNQV9GSVhFRCA9IDI7Cgl0aGlzLkRNQV9JTkNSRU1FTlRfUkVMT0FEID0gMzsKCgl0aGlzLkRNQV9PRkZTRVQgPSBbIDEsIC0xLCAwLCAxIF07CgoJdGhpcy5XQUlUU1RBVEVTID0gWyAwLCAwLCAyLCAwLCAwLCAwLCAwLCAwLCA0LCA0LCA0LCA0LCA0LCA0LCA0IF07Cgl0aGlzLldBSVRTVEFURVNfMzIgPSBbIDAsIDAsIDUsIDAsIDAsIDEsIDAsIDEsIDcsIDcsIDksIDksIDEzLCAxMywgOCBdOwoJdGhpcy5XQUlUU1RBVEVTX1NFUSA9IFsgMCwgMCwgMiwgMCwgMCwgMCwgMCwgMCwgMiwgMiwgNCwgNCwgOCwgOCwgNCBdOwoJdGhpcy5XQUlUU1RBVEVTX1NFUV8zMiA9IFsgMCwgMCwgNSwgMCwgMCwgMSwgMCwgMSwgNSwgNSwgOSwgOSwgMTcsIDE3LCA4IF07Cgl0aGlzLk5VTExXQUlUID0gWyAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwIF07CgoJZm9yICh2YXIgaSA9IDE1OyBpIDwgMjU2OyArK2kpIHsKCQl0aGlzLldBSVRTVEFURVNbaV0gPSAwOwoJCXRoaXMuV0FJVFNUQVRFU18zMltpXSA9IDA7CgkJdGhpcy5XQUlUU1RBVEVTX1NFUVtpXSA9IDA7CgkJdGhpcy5XQUlUU1RBVEVTX1NFUV8zMltpXSA9IDA7CgkJdGhpcy5OVUxMV0FJVFtpXSA9IDA7Cgl9CgoJdGhpcy5ST01fV1MgPSBbIDQsIDMsIDIsIDggXTsKCXRoaXMuUk9NX1dTX1NFUSA9IFsKCQlbIDIsIDEgXSwKCQlbIDQsIDEgXSwKCQlbIDgsIDEgXQoJXTsKCgl0aGlzLklDQUNIRV9QQUdFX0JJVFMgPSA4OwoJdGhpcy5QQUdFX01BU0sgPSAoMiA8PCB0aGlzLklDQUNIRV9QQUdFX0JJVFMpIC0gMTsKCgl0aGlzLmJpb3MgPSBudWxsOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLm1tYXAgPSBmdW5jdGlvbihyZWdpb24sIG9iamVjdCkgewoJdGhpcy5tZW1vcnlbcmVnaW9uXSA9IG9iamVjdDsKfQoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7Cgl0aGlzLmJhZE1lbW9yeSA9IG5ldyBCYWRNZW1vcnkodGhpcywgdGhpcy5jcHUpOwoJdGhpcy5tZW1vcnkgPSBbCgkJdGhpcy5iaW9zLAoJCXRoaXMuYmFkTWVtb3J5LCAvLyBVbnVzZWQKCQluZXcgTWVtb3J5QmxvY2sodGhpcy5TSVpFX1dPUktJTkdfUkFNLCA5KSwKCQluZXcgTWVtb3J5QmxvY2sodGhpcy5TSVpFX1dPUktJTkdfSVJBTSwgNyksCgkJbnVsbCwgLy8gVGhpcyBpcyBvd25lZCBieSBHYW1lQm95QWR2YW5jZUlPCgkJbnVsbCwgLy8gVGhpcyBpcyBvd25lZCBieSBHYW1lQm95QWR2YW5jZVBhbGV0dGUKCQludWxsLCAvLyBUaGlzIGlzIG93bmVkIGJ5IEdhbWVCb3lBZHZhbmNlVlJBTQoJCW51bGwsIC8vIFRoaXMgaXMgb3duZWQgYnkgR2FtZUJveUFkdmFuY2VPQU0KCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSwKCQl0aGlzLmJhZE1lbW9yeSAvLyBVbnVzZWQKCV07Cglmb3IgKHZhciBpID0gMTY7IGkgPCAyNTY7ICsraSkgewoJCXRoaXMubWVtb3J5W2ldID0gdGhpcy5iYWRNZW1vcnk7Cgl9CgoJdGhpcy53YWl0c3RhdGVzID0gdGhpcy5XQUlUU1RBVEVTLnNsaWNlKDApOwoJdGhpcy53YWl0c3RhdGVzU2VxID0gdGhpcy5XQUlUU1RBVEVTX1NFUS5zbGljZSgwKTsKCXRoaXMud2FpdHN0YXRlczMyID0gdGhpcy5XQUlUU1RBVEVTXzMyLnNsaWNlKDApOwoJdGhpcy53YWl0c3RhdGVzU2VxMzIgPSB0aGlzLldBSVRTVEFURVNfU0VRXzMyLnNsaWNlKDApOwoJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2ggPSB0aGlzLldBSVRTVEFURVNfU0VRLnNsaWNlKDApOwoJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2gzMiA9IHRoaXMuV0FJVFNUQVRFU19TRVFfMzIuc2xpY2UoMCk7CgoJdGhpcy5jYXJ0ID0gbnVsbDsKCXRoaXMuc2F2ZSA9IG51bGw7CgoJdGhpcy5ETUFfUkVHSVNURVIgPSBbCgkJdGhpcy5jb3JlLmlvLkRNQTBDTlRfSEkgPj4gMSwKCQl0aGlzLmNvcmUuaW8uRE1BMUNOVF9ISSA+PiAxLAoJCXRoaXMuY29yZS5pby5ETUEyQ05UX0hJID4+IDEsCgkJdGhpcy5jb3JlLmlvLkRNQTNDTlRfSEkgPj4gMQoJXTsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5mcmVlemUgPSBmdW5jdGlvbigpIHsKCXJldHVybiB7CgkJJ3JhbSc6IFNlcmlhbGl6ZXIucHJlZml4KHRoaXMubWVtb3J5W3RoaXMuUkVHSU9OX1dPUktJTkdfUkFNXS5idWZmZXIpLAoJCSdpcmFtJzogU2VyaWFsaXplci5wcmVmaXgodGhpcy5tZW1vcnlbdGhpcy5SRUdJT05fV09SS0lOR19JUkFNXS5idWZmZXIpLAoJfTsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5kZWZyb3N0ID0gZnVuY3Rpb24oZnJvc3QpIHsKCXRoaXMubWVtb3J5W3RoaXMuUkVHSU9OX1dPUktJTkdfUkFNXS5yZXBsYWNlRGF0YShmcm9zdC5yYW0pOwoJdGhpcy5tZW1vcnlbdGhpcy5SRUdJT05fV09SS0lOR19JUkFNXS5yZXBsYWNlRGF0YShmcm9zdC5pcmFtKTsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5sb2FkQmlvcyA9IGZ1bmN0aW9uKGJpb3MsIHJlYWwpIHsKCXRoaXMuYmlvcyA9IG5ldyBCSU9TVmlldyhiaW9zKTsKCXRoaXMuYmlvcy5yZWFsID0gISFyZWFsOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmxvYWRSb20gPSBmdW5jdGlvbihyb20sIHByb2Nlc3MpIHsKCXZhciBjYXJ0ID0gewoJCXRpdGxlOiBudWxsLAoJCWNvZGU6IG51bGwsCgkJbWFrZXI6IG51bGwsCgkJbWVtb3J5OiByb20sCgkJc2F2ZVR5cGU6IG51bGwsCgl9OwoKCXZhciBsbyA9IG5ldyBST01WaWV3KHJvbSk7CglpZiAobG8udmlldy5nZXRVaW50OCgweEIyKSAhPSAweDk2KSB7CgkJLy8gTm90IGEgdmFsaWQgUk9NCgkJcmV0dXJuIG51bGw7Cgl9Cglsby5tbXUgPSB0aGlzOyAvLyBOZWVkZWQgZm9yIEdQSU8KCXRoaXMubWVtb3J5W3RoaXMuUkVHSU9OX0NBUlQwXSA9IGxvOwoJdGhpcy5tZW1vcnlbdGhpcy5SRUdJT05fQ0FSVDFdID0gbG87Cgl0aGlzLm1lbW9yeVt0aGlzLlJFR0lPTl9DQVJUMl0gPSBsbzsKCglpZiAocm9tLmJ5dGVMZW5ndGggPiAweDAxMDAwMDAwKSB7CgkJdmFyIGhpID0gbmV3IFJPTVZpZXcocm9tLCAweDAxMDAwMDAwKTsKCQl0aGlzLm1lbW9yeVt0aGlzLlJFR0lPTl9DQVJUMCArIDFdID0gaGk7CgkJdGhpcy5tZW1vcnlbdGhpcy5SRUdJT05fQ0FSVDEgKyAxXSA9IGhpOwoJCXRoaXMubWVtb3J5W3RoaXMuUkVHSU9OX0NBUlQyICsgMV0gPSBoaTsKCX0KCglpZiAocHJvY2VzcykgewoJCXZhciBuYW1lID0gJyc7CgkJZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgKytpKSB7CgkJCXZhciBjID0gbG8ubG9hZFU4KGkgKyAweEEwKTsKCQkJaWYgKCFjKSB7CgkJCQlicmVhazsKCQkJfQoJCQluYW1lICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyk7CgkJfQoJCWNhcnQudGl0bGUgPSBuYW1lOwoKCQl2YXIgY29kZSA9ICcnOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgNDsgKytpKSB7CgkJCXZhciBjID0gbG8ubG9hZFU4KGkgKyAweEFDKTsKCQkJaWYgKCFjKSB7CgkJCQlicmVhazsKCQkJfQoJCQljb2RlICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYyk7CgkJfQoJCWNhcnQuY29kZSA9IGNvZGU7CgoJCXZhciBtYWtlciA9ICcnOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgMjsgKytpKSB7CgkJCXZhciBjID0gbG8ubG9hZFU4KGkgKyAweEIwKTsKCQkJaWYgKCFjKSB7CgkJCQlicmVhazsKCQkJfQoJCQltYWtlciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpOwoJCX0KCQljYXJ0Lm1ha2VyID0gbWFrZXI7CgoJCS8vIEZpbmQgc2F2ZWRhdGEgdHlwZQoJCXZhciBzdGF0ZSA9ICcnOwoJCXZhciBuZXh0OwoJCXZhciB0ZXJtaW5hbCA9IGZhbHNlOwoJCWZvciAodmFyIGkgPSAweEU0OyBpIDwgcm9tLmJ5dGVMZW5ndGggJiYgIXRlcm1pbmFsOyArK2kpIHsKCQkJbmV4dCA9IFN0cmluZy5mcm9tQ2hhckNvZGUobG8ubG9hZFU4KGkpKTsKCQkJc3RhdGUgKz0gbmV4dDsKCQkJc3dpdGNoIChzdGF0ZSkgewoJCQljYXNlICdGJzoKCQkJY2FzZSAnRkwnOgoJCQljYXNlICdGTEEnOgoJCQljYXNlICdGTEFTJzoKCQkJY2FzZSAnRkxBU0gnOgoJCQljYXNlICdGTEFTSF8nOgoJCQljYXNlICdGTEFTSDUnOgoJCQljYXNlICdGTEFTSDUxJzoKCQkJY2FzZSAnRkxBU0g1MTInOgoJCQljYXNlICdGTEFTSDUxMl8nOgoJCQljYXNlICdGTEFTSDEnOgoJCQljYXNlICdGTEFTSDFNJzoKCQkJY2FzZSAnRkxBU0gxTV8nOgoJCQljYXNlICdTJzoKCQkJY2FzZSAnU1InOgoJCQljYXNlICdTUkEnOgoJCQljYXNlICdTUkFNJzoKCQkJY2FzZSAnU1JBTV8nOgoJCQljYXNlICdFJzoKCQkJY2FzZSAnRUUnOgoJCQljYXNlICdFRVAnOgoJCQljYXNlICdFRVBSJzoKCQkJY2FzZSAnRUVQUk8nOgoJCQljYXNlICdFRVBST00nOgoJCQljYXNlICdFRVBST01fJzoKCQkJCWJyZWFrOwoJCQljYXNlICdGTEFTSF9WJzoKCQkJY2FzZSAnRkxBU0g1MTJfVic6CgkJCWNhc2UgJ0ZMQVNIMU1fVic6CgkJCWNhc2UgJ1NSQU1fVic6CgkJCWNhc2UgJ0VFUFJPTV9WJzoKCQkJCXRlcm1pbmFsID0gdHJ1ZTsKCQkJCWJyZWFrOwoJCQlkZWZhdWx0OgoJCQkJc3RhdGUgPSBuZXh0OwoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJaWYgKHRlcm1pbmFsKSB7CgkJCWNhcnQuc2F2ZVR5cGUgPSBzdGF0ZTsKCQkJc3dpdGNoIChzdGF0ZSkgewoJCQljYXNlICdGTEFTSF9WJzoKCQkJY2FzZSAnRkxBU0g1MTJfVic6CgkJCQl0aGlzLnNhdmUgPSB0aGlzLm1lbW9yeVt0aGlzLlJFR0lPTl9DQVJUX1NSQU1dID0gbmV3IEZsYXNoU2F2ZWRhdGEodGhpcy5TSVpFX0NBUlRfRkxBU0g1MTIpOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ0ZMQVNIMU1fVic6CgkJCQl0aGlzLnNhdmUgPSB0aGlzLm1lbW9yeVt0aGlzLlJFR0lPTl9DQVJUX1NSQU1dID0gbmV3IEZsYXNoU2F2ZWRhdGEodGhpcy5TSVpFX0NBUlRfRkxBU0gxTSk7CgkJCQlicmVhazsKCQkJY2FzZSAnU1JBTV9WJzoKCQkJCXRoaXMuc2F2ZSA9IHRoaXMubWVtb3J5W3RoaXMuUkVHSU9OX0NBUlRfU1JBTV0gPSBuZXcgU1JBTVNhdmVkYXRhKHRoaXMuU0laRV9DQVJUX1NSQU0pOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ0VFUFJPTV9WJzoKCQkJCXRoaXMuc2F2ZSA9IHRoaXMubWVtb3J5W3RoaXMuUkVHSU9OX0NBUlQyICsgMV0gPSBuZXcgRUVQUk9NU2F2ZWRhdGEodGhpcy5TSVpFX0NBUlRfRUVQUk9NLCB0aGlzKTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmICghdGhpcy5zYXZlKSB7CgkJCS8vIEFzc3VtZSB3ZSBoYXZlIFNSQU0KCQkJdGhpcy5zYXZlID0gdGhpcy5tZW1vcnlbdGhpcy5SRUdJT05fQ0FSVF9TUkFNXSA9IG5ldyBTUkFNU2F2ZWRhdGEodGhpcy5TSVpFX0NBUlRfU1JBTSk7CgkJfQoJfQoKCXRoaXMuY2FydCA9IGNhcnQ7CglyZXR1cm4gY2FydDsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5sb2FkU2F2ZWRhdGEgPSBmdW5jdGlvbihzYXZlKSB7Cgl0aGlzLnNhdmUucmVwbGFjZURhdGEoc2F2ZSk7Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUubG9hZDggPSBmdW5jdGlvbihvZmZzZXQpIHsKCXJldHVybiB0aGlzLm1lbW9yeVtvZmZzZXQgPj4+IHRoaXMuQkFTRV9PRkZTRVRdLmxvYWQ4KG9mZnNldCAmIDB4MDBGRkZGRkYpOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmxvYWQxNiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMubWVtb3J5W29mZnNldCA+Pj4gdGhpcy5CQVNFX09GRlNFVF0ubG9hZDE2KG9mZnNldCAmIDB4MDBGRkZGRkYpOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmxvYWQzMiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMubWVtb3J5W29mZnNldCA+Pj4gdGhpcy5CQVNFX09GRlNFVF0ubG9hZDMyKG9mZnNldCAmIDB4MDBGRkZGRkYpOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmxvYWRVOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMubWVtb3J5W29mZnNldCA+Pj4gdGhpcy5CQVNFX09GRlNFVF0ubG9hZFU4KG9mZnNldCAmIDB4MDBGRkZGRkYpOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmxvYWRVMTYgPSBmdW5jdGlvbihvZmZzZXQpIHsKCXJldHVybiB0aGlzLm1lbW9yeVtvZmZzZXQgPj4+IHRoaXMuQkFTRV9PRkZTRVRdLmxvYWRVMTYob2Zmc2V0ICYgMHgwMEZGRkZGRik7Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUuc3RvcmU4ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdmFyIG1hc2tlZE9mZnNldCA9IG9mZnNldCAmIDB4MDBGRkZGRkY7Cgl2YXIgbWVtb3J5ID0gdGhpcy5tZW1vcnlbb2Zmc2V0ID4+PiB0aGlzLkJBU0VfT0ZGU0VUXTsKCW1lbW9yeS5zdG9yZTgobWFza2VkT2Zmc2V0LCB2YWx1ZSk7CgltZW1vcnkuaW52YWxpZGF0ZVBhZ2UobWFza2VkT2Zmc2V0KTsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5zdG9yZTE2ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdmFyIG1hc2tlZE9mZnNldCA9IG9mZnNldCAmIDB4MDBGRkZGRkU7Cgl2YXIgbWVtb3J5ID0gdGhpcy5tZW1vcnlbb2Zmc2V0ID4+PiB0aGlzLkJBU0VfT0ZGU0VUXTsKCW1lbW9yeS5zdG9yZTE2KG1hc2tlZE9mZnNldCwgdmFsdWUpOwoJbWVtb3J5LmludmFsaWRhdGVQYWdlKG1hc2tlZE9mZnNldCk7Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUuc3RvcmUzMiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXZhciBtYXNrZWRPZmZzZXQgPSBvZmZzZXQgJiAweDAwRkZGRkZDOwoJdmFyIG1lbW9yeSA9IHRoaXMubWVtb3J5W29mZnNldCA+Pj4gdGhpcy5CQVNFX09GRlNFVF07CgltZW1vcnkuc3RvcmUzMihtYXNrZWRPZmZzZXQsIHZhbHVlKTsKCW1lbW9yeS5pbnZhbGlkYXRlUGFnZShtYXNrZWRPZmZzZXQpOwoJbWVtb3J5LmludmFsaWRhdGVQYWdlKG1hc2tlZE9mZnNldCArIDIpOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLndhaXRQcmVmZXRjaCA9IGZ1bmN0aW9uKG1lbW9yeSkgewoJdGhpcy5jcHUuY3ljbGVzICs9IDEgKyB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFttZW1vcnkgPj4+IHRoaXMuQkFTRV9PRkZTRVRdOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLndhaXRQcmVmZXRjaDMyID0gZnVuY3Rpb24obWVtb3J5KSB7Cgl0aGlzLmNwdS5jeWNsZXMgKz0gMSArIHRoaXMud2FpdHN0YXRlc1ByZWZldGNoMzJbbWVtb3J5ID4+PiB0aGlzLkJBU0VfT0ZGU0VUXTsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS53YWl0ID0gZnVuY3Rpb24obWVtb3J5KSB7Cgl0aGlzLmNwdS5jeWNsZXMgKz0gMSArIHRoaXMud2FpdHN0YXRlc1ttZW1vcnkgPj4+IHRoaXMuQkFTRV9PRkZTRVRdOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLndhaXQzMiA9IGZ1bmN0aW9uKG1lbW9yeSkgewoJdGhpcy5jcHUuY3ljbGVzICs9IDEgKyB0aGlzLndhaXRzdGF0ZXMzMlttZW1vcnkgPj4+IHRoaXMuQkFTRV9PRkZTRVRdOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLndhaXRTZXEgPSBmdW5jdGlvbihtZW1vcnkpIHsKCXRoaXMuY3B1LmN5Y2xlcyArPSAxICsgdGhpcy53YWl0c3RhdGVzU2VxW21lbW9yeSA+Pj4gdGhpcy5CQVNFX09GRlNFVF07Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUud2FpdFNlcTMyID0gZnVuY3Rpb24obWVtb3J5KSB7Cgl0aGlzLmNwdS5jeWNsZXMgKz0gMSArIHRoaXMud2FpdHN0YXRlc1NlcTMyW21lbW9yeSA+Pj4gdGhpcy5CQVNFX09GRlNFVF07Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUud2FpdE11bCA9IGZ1bmN0aW9uKHJzKSB7CglpZiAoKHJzICYgMHhGRkZGRkYwMCA9PSAweEZGRkZGRjAwKSB8fCAhKHJzICYgMHhGRkZGRkYwMCkpIHsKCQl0aGlzLmNwdS5jeWNsZXMgKz0gMTsKCX0gZWxzZSBpZiAoKHJzICYgMHhGRkZGMDAwMCA9PSAweEZGRkYwMDAwKSB8fCAhKHJzICYgMHhGRkZGMDAwMCkpIHsKCQl0aGlzLmNwdS5jeWNsZXMgKz0gMjsKCX0gZWxzZSBpZiAoKHJzICYgMHhGRjAwMDAwMCA9PSAweEZGMDAwMDAwKSB8fCAhKHJzICYgMHhGRjAwMDAwMCkpIHsKCQl0aGlzLmNwdS5jeWNsZXMgKz0gMzsKCX0gZWxzZSB7CgkJdGhpcy5jcHUuY3ljbGVzICs9IDQ7Cgl9Cn0KCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS53YWl0TXVsdGkzMiA9IGZ1bmN0aW9uKG1lbW9yeSwgc2VxKSB7Cgl0aGlzLmNwdS5jeWNsZXMgKz0gMSArIHRoaXMud2FpdHN0YXRlczMyW21lbW9yeSA+Pj4gdGhpcy5CQVNFX09GRlNFVF07Cgl0aGlzLmNwdS5jeWNsZXMgKz0gKDEgKyB0aGlzLndhaXRzdGF0ZXNTZXEzMlttZW1vcnkgPj4+IHRoaXMuQkFTRV9PRkZTRVRdKSAqIChzZXEgLSAxKTsKfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5hZGRyZXNzVG9QYWdlID0gZnVuY3Rpb24ocmVnaW9uLCBhZGRyZXNzKSB7CglyZXR1cm4gYWRkcmVzcyA+PiB0aGlzLm1lbW9yeVtyZWdpb25dLklDQUNIRV9QQUdFX0JJVFM7Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUuYWNjZXNzUGFnZSA9IGZ1bmN0aW9uKHJlZ2lvbiwgcGFnZUlkKSB7Cgl2YXIgbWVtb3J5ID0gdGhpcy5tZW1vcnlbcmVnaW9uXTsKCXZhciBwYWdlID0gbWVtb3J5LmljYWNoZVtwYWdlSWRdOwoJaWYgKCFwYWdlIHx8IHBhZ2UuaW52YWxpZCkgewoJCXBhZ2UgPSB7CgkJCXRodW1iOiBuZXcgQXJyYXkoMSA8PCAobWVtb3J5LklDQUNIRV9QQUdFX0JJVFMpKSwKCQkJYXJtOiBuZXcgQXJyYXkoMSA8PCBtZW1vcnkuSUNBQ0hFX1BBR0VfQklUUyAtIDEpLAoJCQlpbnZhbGlkOiBmYWxzZQoJCX0KCQltZW1vcnkuaWNhY2hlW3BhZ2VJZF0gPSBwYWdlOwoJfQoJcmV0dXJuIHBhZ2U7Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUuc2NoZWR1bGVEbWEgPSBmdW5jdGlvbihudW1iZXIsIGluZm8pIHsKCXN3aXRjaCAoaW5mby50aW1pbmcpIHsKCWNhc2UgdGhpcy5ETUFfVElNSU5HX05PVzoKCQl0aGlzLnNlcnZpY2VEbWEobnVtYmVyLCBpbmZvKTsKCQlicmVhazsKCWNhc2UgdGhpcy5ETUFfVElNSU5HX0hCTEFOSzoKCQkvLyBIYW5kbGVkIGltcGxpY2l0bHkKCQlicmVhazsKCWNhc2UgdGhpcy5ETUFfVElNSU5HX1ZCTEFOSzoKCQkvLyBIYW5kbGVkIGltcGxpY2l0bHkKCQlicmVhazsKCWNhc2UgdGhpcy5ETUFfVElNSU5HX0NVU1RPTToKCQlzd2l0Y2ggKG51bWJlcikgewoJCWNhc2UgMDoKCQkJdGhpcy5jb3JlLldBUk4oJ0Rpc2NhcmRpbmcgaW52YWxpZCBETUEwIHNjaGVkdWxpbmcnKTsKCQkJYnJlYWs7CgkJY2FzZSAxOgoJCWNhc2UgMjoKCQkJdGhpcy5jcHUuaXJxLmF1ZGlvLnNjaGVkdWxlRklGT0RtYShudW1iZXIsIGluZm8pOwoJCQlicmVhazsKCQljYXNlIDM6CgkJCXRoaXMuY3B1LmlycS52aWRlby5zY2hlZHVsZVZDYXB0dXJlRG1hKGRtYSwgaW5mbyk7CgkJCWJyZWFrOwoJCX0KCX0KfTsKCkdhbWVCb3lBZHZhbmNlTU1VLnByb3RvdHlwZS5ydW5IYmxhbmtEbWFzID0gZnVuY3Rpb24oKSB7Cgl2YXIgZG1hOwoJZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNwdS5pcnEuZG1hLmxlbmd0aDsgKytpKSB7CgkJZG1hID0gdGhpcy5jcHUuaXJxLmRtYVtpXTsKCQlpZiAoZG1hLmVuYWJsZSAmJiBkbWEudGltaW5nID09IHRoaXMuRE1BX1RJTUlOR19IQkxBTkspIHsKCQkJdGhpcy5zZXJ2aWNlRG1hKGksIGRtYSk7CgkJfQoJfQp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLnJ1blZibGFua0RtYXMgPSBmdW5jdGlvbigpIHsKCXZhciBkbWE7Cglmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY3B1LmlycS5kbWEubGVuZ3RoOyArK2kpIHsKCQlkbWEgPSB0aGlzLmNwdS5pcnEuZG1hW2ldOwoJCWlmIChkbWEuZW5hYmxlICYmIGRtYS50aW1pbmcgPT0gdGhpcy5ETUFfVElNSU5HX1ZCTEFOSykgewoJCQl0aGlzLnNlcnZpY2VEbWEoaSwgZG1hKTsKCQl9Cgl9Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUuc2VydmljZURtYSA9IGZ1bmN0aW9uKG51bWJlciwgaW5mbykgewoJaWYgKCFpbmZvLmVuYWJsZSkgewoJCS8vIFRoZXJlIHdhcyBhIERNQSBzY2hlZHVsZWQgdGhhdCBnb3QgY2FuY2VsZWQKCQlyZXR1cm47Cgl9CgoJdmFyIHdpZHRoID0gaW5mby53aWR0aDsKCXZhciBzb3VyY2VPZmZzZXQgPSB0aGlzLkRNQV9PRkZTRVRbaW5mby5zcmNDb250cm9sXSAqIHdpZHRoOwoJdmFyIGRlc3RPZmZzZXQgPSB0aGlzLkRNQV9PRkZTRVRbaW5mby5kc3RDb250cm9sXSAqIHdpZHRoOwoJdmFyIHdvcmRzUmVtYWluaW5nID0gaW5mby5uZXh0Q291bnQ7Cgl2YXIgc291cmNlID0gaW5mby5uZXh0U291cmNlICYgdGhpcy5PRkZTRVRfTUFTSzsKCXZhciBkZXN0ID0gaW5mby5uZXh0RGVzdCAmIHRoaXMuT0ZGU0VUX01BU0s7Cgl2YXIgc291cmNlUmVnaW9uID0gaW5mby5uZXh0U291cmNlID4+PiB0aGlzLkJBU0VfT0ZGU0VUOwoJdmFyIGRlc3RSZWdpb24gPSBpbmZvLm5leHREZXN0ID4+PiB0aGlzLkJBU0VfT0ZGU0VUOwoJdmFyIHNvdXJjZUJsb2NrID0gdGhpcy5tZW1vcnlbc291cmNlUmVnaW9uXTsKCXZhciBkZXN0QmxvY2sgPSB0aGlzLm1lbW9yeVtkZXN0UmVnaW9uXTsKCXZhciBzb3VyY2VWaWV3ID0gbnVsbDsKCXZhciBkZXN0VmlldyA9IG51bGw7Cgl2YXIgc291cmNlTWFzayA9IDB4RkZGRkZGRkY7Cgl2YXIgZGVzdE1hc2sgPSAweEZGRkZGRkZGOwoJdmFyIHdvcmQ7CgoJaWYgKGRlc3RCbG9jay5JQ0FDSEVfUEFHRV9CSVRTKSB7CgkJdmFyIGVuZFBhZ2UgPSAoZGVzdCArIHdvcmRzUmVtYWluaW5nICogd2lkdGgpID4+IGRlc3RCbG9jay5JQ0FDSEVfUEFHRV9CSVRTOwoJCWZvciAodmFyIGkgPSBkZXN0ID4+IGRlc3RCbG9jay5JQ0FDSEVfUEFHRV9CSVRTOyBpIDw9IGVuZFBhZ2U7ICsraSkgewoJCQlkZXN0QmxvY2suaW52YWxpZGF0ZVBhZ2UoaSA8PCBkZXN0QmxvY2suSUNBQ0hFX1BBR0VfQklUUyk7CgkJfQoJfQoKCWlmIChkZXN0UmVnaW9uID09IHRoaXMuUkVHSU9OX1dPUktJTkdfUkFNIHx8IGRlc3RSZWdpb24gPT0gdGhpcy5SRUdJT05fV09SS0lOR19JUkFNKSB7CgkJZGVzdFZpZXcgPSBkZXN0QmxvY2sudmlldzsKCQlkZXN0TWFzayA9IGRlc3RCbG9jay5tYXNrOwoJfQoKCWlmIChzb3VyY2VSZWdpb24gPT0gdGhpcy5SRUdJT05fV09SS0lOR19SQU0gfHwgc291cmNlUmVnaW9uID09IHRoaXMuUkVHSU9OX1dPUktJTkdfSVJBTSB8fCBzb3VyY2VSZWdpb24gPT0gdGhpcy5SRUdJT05fQ0FSVDAgfHwgc291cmNlUmVnaW9uID09IHRoaXMuUkVHSU9OX0NBUlQxKSB7CgkJc291cmNlVmlldyA9IHNvdXJjZUJsb2NrLnZpZXc7CgkJc291cmNlTWFzayA9IHNvdXJjZUJsb2NrLm1hc2s7Cgl9CgoJaWYgKHNvdXJjZUJsb2NrICYmIGRlc3RCbG9jaykgewoJCWlmIChzb3VyY2VWaWV3ICYmIGRlc3RWaWV3KSB7CgkJCWlmICh3aWR0aCA9PSA0KSB7CgkJCQlzb3VyY2UgJj0gMHhGRkZGRkZGQzsKCQkJCWRlc3QgJj0gMHhGRkZGRkZGQzsKCQkJCXdoaWxlICh3b3Jkc1JlbWFpbmluZy0tKSB7CgkJCQkJd29yZCA9IHNvdXJjZVZpZXcuZ2V0SW50MzIoc291cmNlICYgc291cmNlTWFzayk7CgkJCQkJZGVzdFZpZXcuc2V0SW50MzIoZGVzdCAmIGRlc3RNYXNrLCB3b3JkKTsKCQkJCQlzb3VyY2UgKz0gc291cmNlT2Zmc2V0OwoJCQkJCWRlc3QgKz0gZGVzdE9mZnNldDsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXdoaWxlICh3b3Jkc1JlbWFpbmluZy0tKSB7CgkJCQkJd29yZCA9IHNvdXJjZVZpZXcuZ2V0VWludDE2KHNvdXJjZSAmIHNvdXJjZU1hc2spOwoJCQkJCWRlc3RWaWV3LnNldFVpbnQxNihkZXN0ICYgZGVzdE1hc2ssIHdvcmQpOwoJCQkJCXNvdXJjZSArPSBzb3VyY2VPZmZzZXQ7CgkJCQkJZGVzdCArPSBkZXN0T2Zmc2V0OwoJCQkJfQoJCQl9CgkJfSBlbHNlIGlmIChzb3VyY2VWaWV3KSB7CgkJCWlmICh3aWR0aCA9PSA0KSB7CgkJCQlzb3VyY2UgJj0gMHhGRkZGRkZGQzsKCQkJCWRlc3QgJj0gMHhGRkZGRkZGQzsKCQkJCXdoaWxlICh3b3Jkc1JlbWFpbmluZy0tKSB7CgkJCQkJd29yZCA9IHNvdXJjZVZpZXcuZ2V0SW50MzIoc291cmNlICYgc291cmNlTWFzaywgdHJ1ZSk7CgkJCQkJZGVzdEJsb2NrLnN0b3JlMzIoZGVzdCwgd29yZCk7CgkJCQkJc291cmNlICs9IHNvdXJjZU9mZnNldDsKCQkJCQlkZXN0ICs9IGRlc3RPZmZzZXQ7CgkJCQl9CgkJCX0gZWxzZSB7CgkJCQl3aGlsZSAod29yZHNSZW1haW5pbmctLSkgewoJCQkJCXdvcmQgPSBzb3VyY2VWaWV3LmdldFVpbnQxNihzb3VyY2UgJiBzb3VyY2VNYXNrLCB0cnVlKTsKCQkJCQlkZXN0QmxvY2suc3RvcmUxNihkZXN0LCB3b3JkKTsKCQkJCQlzb3VyY2UgKz0gc291cmNlT2Zmc2V0OwoJCQkJCWRlc3QgKz0gZGVzdE9mZnNldDsKCQkJCX0KCQkJfQoJCX0gZWxzZSB7CgkJCWlmICh3aWR0aCA9PSA0KSB7CgkJCQlzb3VyY2UgJj0gMHhGRkZGRkZGQzsKCQkJCWRlc3QgJj0gMHhGRkZGRkZGQzsKCQkJCXdoaWxlICh3b3Jkc1JlbWFpbmluZy0tKSB7CgkJCQkJd29yZCA9IHNvdXJjZUJsb2NrLmxvYWQzMihzb3VyY2UpOwoJCQkJCWRlc3RCbG9jay5zdG9yZTMyKGRlc3QsIHdvcmQpOwoJCQkJCXNvdXJjZSArPSBzb3VyY2VPZmZzZXQ7CgkJCQkJZGVzdCArPSBkZXN0T2Zmc2V0OwoJCQkJfQoJCQl9IGVsc2UgewoJCQkJd2hpbGUgKHdvcmRzUmVtYWluaW5nLS0pIHsKCQkJCQl3b3JkID0gc291cmNlQmxvY2subG9hZFUxNihzb3VyY2UpOwoJCQkJCWRlc3RCbG9jay5zdG9yZTE2KGRlc3QsIHdvcmQpOwoJCQkJCXNvdXJjZSArPSBzb3VyY2VPZmZzZXQ7CgkJCQkJZGVzdCArPSBkZXN0T2Zmc2V0OwoJCQkJfQoJCQl9CgkJfQoJfSBlbHNlIHsKCQl0aGlzLmNvcmUuV0FSTignSW52YWxpZCBETUEnKTsKCX0KCglpZiAoaW5mby5kb0lycSkgewoJCWluZm8ubmV4dElSUSA9IHRoaXMuY3B1LmN5Y2xlcyArIDI7CgkJaW5mby5uZXh0SVJRICs9ICh3aWR0aCA9PSA0ID8gdGhpcy53YWl0c3RhdGVzMzJbc291cmNlUmVnaW9uXSArIHRoaXMud2FpdHN0YXRlczMyW2Rlc3RSZWdpb25dCgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy53YWl0c3RhdGVzW3NvdXJjZVJlZ2lvbl0gKyB0aGlzLndhaXRzdGF0ZXNbZGVzdFJlZ2lvbl0pOwoJCWluZm8ubmV4dElSUSArPSAoaW5mby5jb3VudCAtIDEpICogKHdpZHRoID09IDQgPyB0aGlzLndhaXRzdGF0ZXNTZXEzMltzb3VyY2VSZWdpb25dICsgdGhpcy53YWl0c3RhdGVzU2VxMzJbZGVzdFJlZ2lvbl0KCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy53YWl0c3RhdGVzU2VxW3NvdXJjZVJlZ2lvbl0gKyB0aGlzLndhaXRzdGF0ZXNTZXFbZGVzdFJlZ2lvbl0pOwoJfQoKCWluZm8ubmV4dFNvdXJjZSA9IHNvdXJjZSB8IChzb3VyY2VSZWdpb24gPDwgdGhpcy5CQVNFX09GRlNFVCk7CglpbmZvLm5leHREZXN0ID0gZGVzdCB8IChkZXN0UmVnaW9uIDw8IHRoaXMuQkFTRV9PRkZTRVQpOwoJaW5mby5uZXh0Q291bnQgPSB3b3Jkc1JlbWFpbmluZzsKCglpZiAoIWluZm8ucmVwZWF0KSB7CgkJaW5mby5lbmFibGUgPSBmYWxzZTsKCgkJLy8gQ2xlYXIgdGhlIGVuYWJsZSBiaXQgaW4gbWVtb3J5CgkJdmFyIGlvID0gdGhpcy5tZW1vcnlbdGhpcy5SRUdJT05fSU9dOwoJCWlvLnJlZ2lzdGVyc1t0aGlzLkRNQV9SRUdJU1RFUltudW1iZXJdXSAmPSAweDdGRTA7Cgl9IGVsc2UgewoJCWluZm8ubmV4dENvdW50ID0gaW5mby5jb3VudDsKCQlpZiAoaW5mby5kc3RDb250cm9sID09IHRoaXMuRE1BX0lOQ1JFTUVOVF9SRUxPQUQpIHsKCQkJaW5mby5uZXh0RGVzdCA9IGluZm8uZGVzdDsKCQl9CgkJdGhpcy5zY2hlZHVsZURtYShudW1iZXIsIGluZm8pOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmFkanVzdFRpbWluZ3MgPSBmdW5jdGlvbih3b3JkKSB7Cgl2YXIgc3JhbSA9IHdvcmQgJiAweDAwMDM7Cgl2YXIgd3MwID0gKHdvcmQgJiAweDAwMEMpID4+IDI7Cgl2YXIgd3Mwc2VxID0gKHdvcmQgJiAweDAwMTApID4+IDQ7Cgl2YXIgd3MxID0gKHdvcmQgJiAweDAwNjApID4+IDU7Cgl2YXIgd3Mxc2VxID0gKHdvcmQgJiAweDAwODApID4+IDc7Cgl2YXIgd3MyID0gKHdvcmQgJiAweDAzMDApID4+IDg7Cgl2YXIgd3Myc2VxID0gKHdvcmQgJiAweDA0MDApID4+IDEwOwoJdmFyIHByZWZldGNoID0gd29yZCAmIDB4NDAwMDsKCgl0aGlzLndhaXRzdGF0ZXNbdGhpcy5SRUdJT05fQ0FSVF9TUkFNXSA9IHRoaXMuUk9NX1dTW3NyYW1dOwoJdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlRfU1JBTV0gPSB0aGlzLlJPTV9XU1tzcmFtXTsKCXRoaXMud2FpdHN0YXRlczMyW3RoaXMuUkVHSU9OX0NBUlRfU1JBTV0gPSB0aGlzLlJPTV9XU1tzcmFtXTsKCXRoaXMud2FpdHN0YXRlc1NlcTMyW3RoaXMuUkVHSU9OX0NBUlRfU1JBTV0gPSB0aGlzLlJPTV9XU1tzcmFtXTsKCgl0aGlzLndhaXRzdGF0ZXNbdGhpcy5SRUdJT05fQ0FSVDBdID0gdGhpcy53YWl0c3RhdGVzW3RoaXMuUkVHSU9OX0NBUlQwICsgMV0gPSB0aGlzLlJPTV9XU1t3czBdOwoJdGhpcy53YWl0c3RhdGVzW3RoaXMuUkVHSU9OX0NBUlQxXSA9IHRoaXMud2FpdHN0YXRlc1t0aGlzLlJFR0lPTl9DQVJUMSArIDFdID0gdGhpcy5ST01fV1Nbd3MxXTsKCXRoaXMud2FpdHN0YXRlc1t0aGlzLlJFR0lPTl9DQVJUMl0gPSB0aGlzLndhaXRzdGF0ZXNbdGhpcy5SRUdJT05fQ0FSVDIgKyAxXSA9IHRoaXMuUk9NX1dTW3dzMl07CgoJdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQwXSA9IHRoaXMud2FpdHN0YXRlc1NlcVt0aGlzLlJFR0lPTl9DQVJUMCArIDFdID0gdGhpcy5ST01fV1NfU0VRWzBdW3dzMHNlcV07Cgl0aGlzLndhaXRzdGF0ZXNTZXFbdGhpcy5SRUdJT05fQ0FSVDFdID0gdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQxICsgMV0gPSB0aGlzLlJPTV9XU19TRVFbMV1bd3Mxc2VxXTsKCXRoaXMud2FpdHN0YXRlc1NlcVt0aGlzLlJFR0lPTl9DQVJUMl0gPSB0aGlzLndhaXRzdGF0ZXNTZXFbdGhpcy5SRUdJT05fQ0FSVDIgKyAxXSA9IHRoaXMuUk9NX1dTX1NFUVsyXVt3czJzZXFdOwoKCXRoaXMud2FpdHN0YXRlczMyW3RoaXMuUkVHSU9OX0NBUlQwXSA9IHRoaXMud2FpdHN0YXRlczMyW3RoaXMuUkVHSU9OX0NBUlQwICsgMV0gPSB0aGlzLndhaXRzdGF0ZXNbdGhpcy5SRUdJT05fQ0FSVDBdICsgMSArIHRoaXMud2FpdHN0YXRlc1NlcVt0aGlzLlJFR0lPTl9DQVJUMF07Cgl0aGlzLndhaXRzdGF0ZXMzMlt0aGlzLlJFR0lPTl9DQVJUMV0gPSB0aGlzLndhaXRzdGF0ZXMzMlt0aGlzLlJFR0lPTl9DQVJUMSArIDFdID0gdGhpcy53YWl0c3RhdGVzW3RoaXMuUkVHSU9OX0NBUlQxXSArIDEgKyB0aGlzLndhaXRzdGF0ZXNTZXFbdGhpcy5SRUdJT05fQ0FSVDFdOwoJdGhpcy53YWl0c3RhdGVzMzJbdGhpcy5SRUdJT05fQ0FSVDJdID0gdGhpcy53YWl0c3RhdGVzMzJbdGhpcy5SRUdJT05fQ0FSVDIgKyAxXSA9IHRoaXMud2FpdHN0YXRlc1t0aGlzLlJFR0lPTl9DQVJUMl0gKyAxICsgdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQyXTsKCgl0aGlzLndhaXRzdGF0ZXNTZXEzMlt0aGlzLlJFR0lPTl9DQVJUMF0gPSB0aGlzLndhaXRzdGF0ZXNTZXEzMlt0aGlzLlJFR0lPTl9DQVJUMCArIDFdID0gMiAqIHRoaXMud2FpdHN0YXRlc1NlcVt0aGlzLlJFR0lPTl9DQVJUMF0gKyAxOwoJdGhpcy53YWl0c3RhdGVzU2VxMzJbdGhpcy5SRUdJT05fQ0FSVDFdID0gdGhpcy53YWl0c3RhdGVzU2VxMzJbdGhpcy5SRUdJT05fQ0FSVDEgKyAxXSA9IDIgKiB0aGlzLndhaXRzdGF0ZXNTZXFbdGhpcy5SRUdJT05fQ0FSVDFdICsgMTsKCXRoaXMud2FpdHN0YXRlc1NlcTMyW3RoaXMuUkVHSU9OX0NBUlQyXSA9IHRoaXMud2FpdHN0YXRlc1NlcTMyW3RoaXMuUkVHSU9OX0NBUlQyICsgMV0gPSAyICogdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQyXSArIDE7CgoJaWYgKHByZWZldGNoKSB7CgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2hbdGhpcy5SRUdJT05fQ0FSVDBdID0gdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2hbdGhpcy5SRUdJT05fQ0FSVDAgKyAxXSA9IDA7CgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2hbdGhpcy5SRUdJT05fQ0FSVDFdID0gdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2hbdGhpcy5SRUdJT05fQ0FSVDEgKyAxXSA9IDA7CgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2hbdGhpcy5SRUdJT05fQ0FSVDJdID0gdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2hbdGhpcy5SRUdJT05fQ0FSVDIgKyAxXSA9IDA7CgoJCXRoaXMud2FpdHN0YXRlc1ByZWZldGNoMzJbdGhpcy5SRUdJT05fQ0FSVDBdID0gdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2gzMlt0aGlzLlJFR0lPTl9DQVJUMCArIDFdID0gMDsKCQl0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaDMyW3RoaXMuUkVHSU9OX0NBUlQxXSA9IHRoaXMud2FpdHN0YXRlc1ByZWZldGNoMzJbdGhpcy5SRUdJT05fQ0FSVDEgKyAxXSA9IDA7CgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2gzMlt0aGlzLlJFR0lPTl9DQVJUMl0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaDMyW3RoaXMuUkVHSU9OX0NBUlQyICsgMV0gPSAwOwoJfSBlbHNlIHsKCQl0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFt0aGlzLlJFR0lPTl9DQVJUMF0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFt0aGlzLlJFR0lPTl9DQVJUMCArIDFdID0gdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQwXTsKCQl0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFt0aGlzLlJFR0lPTl9DQVJUMV0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFt0aGlzLlJFR0lPTl9DQVJUMSArIDFdID0gdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQxXTsKCQl0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFt0aGlzLlJFR0lPTl9DQVJUMl0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaFt0aGlzLlJFR0lPTl9DQVJUMiArIDFdID0gdGhpcy53YWl0c3RhdGVzU2VxW3RoaXMuUkVHSU9OX0NBUlQyXTsKCgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2gzMlt0aGlzLlJFR0lPTl9DQVJUMF0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaDMyW3RoaXMuUkVHSU9OX0NBUlQwICsgMV0gPSB0aGlzLndhaXRzdGF0ZXNTZXEzMlt0aGlzLlJFR0lPTl9DQVJUMF07CgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2gzMlt0aGlzLlJFR0lPTl9DQVJUMV0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaDMyW3RoaXMuUkVHSU9OX0NBUlQxICsgMV0gPSB0aGlzLndhaXRzdGF0ZXNTZXEzMlt0aGlzLlJFR0lPTl9DQVJUMV07CgkJdGhpcy53YWl0c3RhdGVzUHJlZmV0Y2gzMlt0aGlzLlJFR0lPTl9DQVJUMl0gPSB0aGlzLndhaXRzdGF0ZXNQcmVmZXRjaDMyW3RoaXMuUkVHSU9OX0NBUlQyICsgMV0gPSB0aGlzLndhaXRzdGF0ZXNTZXEzMlt0aGlzLlJFR0lPTl9DQVJUMl07Cgl9Cn07CgpHYW1lQm95QWR2YW5jZU1NVS5wcm90b3R5cGUuc2F2ZU5lZWRzRmx1c2ggPSBmdW5jdGlvbigpIHsKCXJldHVybiB0aGlzLnNhdmUud3JpdGVQZW5kaW5nOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmZsdXNoU2F2ZSA9IGZ1bmN0aW9uKCkgewoJdGhpcy5zYXZlLndyaXRlUGVuZGluZyA9IGZhbHNlOwp9OwoKR2FtZUJveUFkdmFuY2VNTVUucHJvdG90eXBlLmFsbG9jR1BJTyA9IGZ1bmN0aW9uKHJvbSkgewoJcmV0dXJuIG5ldyBHYW1lQm95QWR2YW5jZUdQSU8odGhpcy5jb3JlLCByb20pOwp9Owo=";

const GBA_js_savedata_js = "ZnVuY3Rpb24gU1JBTVNhdmVkYXRhKHNpemUpIHsKCU1lbW9yeVZpZXcuY2FsbCh0aGlzLCBuZXcgQXJyYXlCdWZmZXIoc2l6ZSksIDApOwoKCXRoaXMud3JpdGVQZW5kaW5nID0gZmFsc2U7Cn07CgpTUkFNU2F2ZWRhdGEucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNZW1vcnlWaWV3LnByb3RvdHlwZSk7CgpTUkFNU2F2ZWRhdGEucHJvdG90eXBlLnN0b3JlOCA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXRoaXMudmlldy5zZXRJbnQ4KG9mZnNldCwgdmFsdWUpOwoJdGhpcy53cml0ZVBlbmRpbmcgPSB0cnVlOwp9OwoKU1JBTVNhdmVkYXRhLnByb3RvdHlwZS5zdG9yZTE2ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhpcy52aWV3LnNldEludDE2KG9mZnNldCwgdmFsdWUsIHRydWUpOwoJdGhpcy53cml0ZVBlbmRpbmcgPSB0cnVlOwp9OwoKU1JBTVNhdmVkYXRhLnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhpcy52aWV3LnNldEludDMyKG9mZnNldCwgdmFsdWUsIHRydWUpOwoJdGhpcy53cml0ZVBlbmRpbmcgPSB0cnVlOwp9OwoKZnVuY3Rpb24gRmxhc2hTYXZlZGF0YShzaXplKSB7CglNZW1vcnlWaWV3LmNhbGwodGhpcywgbmV3IEFycmF5QnVmZmVyKHNpemUpLCAwKTsKCgl0aGlzLkNPTU1BTkRfV0lQRSA9IDB4MTA7Cgl0aGlzLkNPTU1BTkRfRVJBU0VfU0VDVE9SID0gMHgzMDsKCXRoaXMuQ09NTUFORF9FUkFTRSA9IDB4ODA7Cgl0aGlzLkNPTU1BTkRfSUQgPSAweDkwOwoJdGhpcy5DT01NQU5EX1dSSVRFID0gMHhBMDsKCXRoaXMuQ09NTUFORF9TV0lUQ0hfQkFOSyA9IDB4QjA7Cgl0aGlzLkNPTU1BTkRfVEVSTUlOQVRFX0lEID0gMHhGMDsKCgl0aGlzLklEX1BBTkFTT05JQyA9IDB4MUIzMjsKCXRoaXMuSURfU0FOWU8gPSAweDEzNjI7CgoJdGhpcy5iYW5rMCA9IG5ldyBEYXRhVmlldyh0aGlzLmJ1ZmZlciwgMCwgMHgwMDAxMDAwMCk7CglpZiAoc2l6ZSA+IDB4MDAwMTAwMDApIHsKCQl0aGlzLmlkID0gdGhpcy5JRF9TQU5ZTzsKCQl0aGlzLmJhbmsxID0gbmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLCAweDAwMDEwMDAwKTsKCX0gZWxzZSB7CgkJdGhpcy5pZCA9IHRoaXMuSURfUEFOQVNPTklDOwoJCXRoaXMuYmFuazEgPSBudWxsOwoJfQoJdGhpcy5iYW5rID0gdGhpcy5iYW5rMDsKCgl0aGlzLmlkTW9kZSA9IGZhbHNlOwoJdGhpcy53cml0ZVBlbmRpbmcgPSBmYWxzZTsKCgl0aGlzLmZpcnN0ID0gMDsKCXRoaXMuc2Vjb25kID0gMDsKCXRoaXMuY29tbWFuZCA9IDA7Cgl0aGlzLnBlbmRpbmdDb21tYW5kID0gMDsKfTsKCkZsYXNoU2F2ZWRhdGEucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNZW1vcnlWaWV3LnByb3RvdHlwZSk7CgpGbGFzaFNhdmVkYXRhLnByb3RvdHlwZS5sb2FkOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJaWYgKHRoaXMuaWRNb2RlICYmIG9mZnNldCA8IDIpIHsKCQlyZXR1cm4gKHRoaXMuaWQgPj4gKG9mZnNldCA8PCAzKSkgJiAweEZGOwoJfSBlbHNlIGlmIChvZmZzZXQgPCAweDEwMDAwKSB7CgkJcmV0dXJuIHRoaXMuYmFuay5nZXRJbnQ4KG9mZnNldCk7Cgl9IGVsc2UgewoJCXJldHVybiAwOwoJfQp9OwoKRmxhc2hTYXZlZGF0YS5wcm90b3R5cGUubG9hZDE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gKHRoaXMubG9hZDgob2Zmc2V0KSAmIDB4RkYpIHwgKHRoaXMubG9hZDgob2Zmc2V0ICsgMSkgPDwgOCk7Cn07CgpGbGFzaFNhdmVkYXRhLnByb3RvdHlwZS5sb2FkMzIgPSBmdW5jdGlvbihvZmZzZXQpIHsKCXJldHVybiAodGhpcy5sb2FkOChvZmZzZXQpICYgMHhGRikgfCAodGhpcy5sb2FkOChvZmZzZXQgKyAxKSA8PCA4KSB8ICh0aGlzLmxvYWQ4KG9mZnNldCArIDIpIDw8IDE2KSB8ICh0aGlzLmxvYWQ4KG9mZnNldCArIDMpIDw8IDI0KTsKfTsKCkZsYXNoU2F2ZWRhdGEucHJvdG90eXBlLmxvYWRVOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMubG9hZDgob2Zmc2V0KSAmIDB4RkY7Cn07CgpGbGFzaFNhdmVkYXRhLnByb3RvdHlwZS5sb2FkVTE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gKHRoaXMubG9hZFU4KG9mZnNldCkgJiAweEZGKSB8ICh0aGlzLmxvYWRVOChvZmZzZXQgKyAxKSA8PCA4KTsKfTsKCkZsYXNoU2F2ZWRhdGEucHJvdG90eXBlLnN0b3JlOCA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXN3aXRjaCAodGhpcy5jb21tYW5kKSB7CgljYXNlIDA6CgkJaWYgKG9mZnNldCA9PSAweDU1NTUpIHsKCQkJaWYgKHRoaXMuc2Vjb25kID09IDB4NTUpIHsKCQkJCXN3aXRjaCAodmFsdWUpIHsKCQkJCWNhc2UgdGhpcy5DT01NQU5EX0VSQVNFOgoJCQkJCXRoaXMucGVuZGluZ0NvbW1hbmQgPSB2YWx1ZTsKCQkJCQlicmVhazsKCQkJCWNhc2UgdGhpcy5DT01NQU5EX0lEOgoJCQkJCXRoaXMuaWRNb2RlID0gdHJ1ZTsKCQkJCQlicmVhazsKCQkJCWNhc2UgdGhpcy5DT01NQU5EX1RFUk1JTkFURV9JRDoKCQkJCQl0aGlzLmlkTW9kZSA9IGZhbHNlOwoJCQkJCWJyZWFrOwoJCQkJZGVmYXVsdDoKCQkJCQl0aGlzLmNvbW1hbmQgPSB2YWx1ZTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCXRoaXMuc2Vjb25kID0gMDsKCQkJCXRoaXMuZmlyc3QgPSAwOwoJCQl9IGVsc2UgewoJCQkJdGhpcy5jb21tYW5kID0gMDsKCQkJCXRoaXMuZmlyc3QgPSB2YWx1ZTsKCQkJCXRoaXMuaWRNb2RlID0gZmFsc2U7CgkJCX0KCQl9IGVsc2UgaWYgKG9mZnNldCA9PSAweDJBQUEgJiYgdGhpcy5maXJzdCA9PSAweEFBKSB7CgkJCXRoaXMuZmlyc3QgPSAwOwoJCQlpZiAodGhpcy5wZW5kaW5nQ29tbWFuZCkgewoJCQkJdGhpcy5jb21tYW5kID0gdGhpcy5wZW5kaW5nQ29tbWFuZDsKCQkJfSBlbHNlIHsKCQkJCXRoaXMuc2Vjb25kID0gdmFsdWU7CgkJCX0KCQl9CgkJYnJlYWs7CgljYXNlIHRoaXMuQ09NTUFORF9FUkFTRToKCQlzd2l0Y2ggKHZhbHVlKSB7CgkJY2FzZSB0aGlzLkNPTU1BTkRfV0lQRToKCQkJaWYgKG9mZnNldCA9PSAweDU1NTUpIHsKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52aWV3LmJ5dGVMZW5ndGg7IGkgKz0gNCkgewoJCQkJCXRoaXMudmlldy5zZXRJbnQzMihpLCAtMSk7CgkJCQl9CgkJCX0KCQkJYnJlYWs7CgkJY2FzZSB0aGlzLkNPTU1BTkRfRVJBU0VfU0VDVE9SOgoJCQlpZiAoKG9mZnNldCAmIDB4MEZGRikgPT0gMCkgewoJCQkJZm9yICh2YXIgaSA9IG9mZnNldDsgaSA8IG9mZnNldCArIDB4MTAwMDsgaSArPSA0KSB7CgkJCQkJdGhpcy5iYW5rLnNldEludDMyKGksIC0xKTsKCQkJCX0KCQkJfQoJCQlicmVhazsKCQl9CgkJdGhpcy5wZW5kaW5nQ29tbWFuZCA9IDA7CgkJdGhpcy5jb21tYW5kID0gMDsKCQlicmVhazsKCWNhc2UgdGhpcy5DT01NQU5EX1dSSVRFOgoJCXRoaXMuYmFuay5zZXRJbnQ4KG9mZnNldCwgdmFsdWUpOwoJCXRoaXMuY29tbWFuZCA9IDA7CgoJCXRoaXMud3JpdGVQZW5kaW5nID0gdHJ1ZTsKCQlicmVhazsKCWNhc2UgdGhpcy5DT01NQU5EX1NXSVRDSF9CQU5LOgoJCWlmICh0aGlzLmJhbmsxICYmIG9mZnNldCA9PSAwKSB7CgkJCWlmICh2YWx1ZSA9PSAxKSB7CgkJCQl0aGlzLmJhbmsgPSB0aGlzLmJhbmsxOwoJCQl9IGVsc2UgewoJCQkJdGhpcy5iYW5rID0gdGhpcy5iYW5rMDsKCQkJfQoJCX0KCQl0aGlzLmNvbW1hbmQgPSAwOwoJCWJyZWFrOwoJfQp9OwoKRmxhc2hTYXZlZGF0YS5wcm90b3R5cGUuc3RvcmUxNiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXRocm93IG5ldyBFcnJvcigiVW5hbGlnbmVkIHNhdmUgdG8gZmxhc2ghIik7Cn07CgpGbGFzaFNhdmVkYXRhLnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhyb3cgbmV3IEVycm9yKCJVbmFsaWduZWQgc2F2ZSB0byBmbGFzaCEiKTsKfTsKCkZsYXNoU2F2ZWRhdGEucHJvdG90eXBlLnJlcGxhY2VEYXRhID0gZnVuY3Rpb24obWVtb3J5KSB7Cgl2YXIgYmFuayA9IHRoaXMudmlldyA9PT0gdGhpcy5iYW5rMTsKCU1lbW9yeVZpZXcucHJvdG90eXBlLnJlcGxhY2VEYXRhLmNhbGwodGhpcywgbWVtb3J5LCAwKTsKCgl0aGlzLmJhbmswID0gbmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLCAwLCAweDAwMDEwMDAwKTsKCWlmIChtZW1vcnkuYnl0ZUxlbmd0aCA+IDB4MDAwMTAwMDApIHsKCQl0aGlzLmJhbmsxID0gbmV3IERhdGFWaWV3KHRoaXMuYnVmZmVyLCAweDAwMDEwMDAwKTsKCX0gZWxzZSB7CgkJdGhpcy5iYW5rMSA9IG51bGw7Cgl9Cgl0aGlzLmJhbmsgPSBiYW5rID8gdGhpcy5iYW5rMSA6IHRoaXMuYmFuazA7Cn07CgpmdW5jdGlvbiBFRVBST01TYXZlZGF0YShzaXplLCBtbXUpIHsKCU1lbW9yeVZpZXcuY2FsbCh0aGlzLCBuZXcgQXJyYXlCdWZmZXIoc2l6ZSksIDApOwoKCXRoaXMud3JpdGVBZGRyZXNzID0gMDsKCXRoaXMucmVhZEJpdHNSZW1haW5pbmcgPSAwOwoJdGhpcy5yZWFkQWRkcmVzcyA9IDA7CgoJdGhpcy5jb21tYW5kID0gMDsKCXRoaXMuY29tbWFuZEJpdHNSZW1haW5pbmcgPSAwOwoKCXRoaXMucmVhbFNpemUgPSAwOwoJdGhpcy5hZGRyZXNzQml0cyA9IDA7Cgl0aGlzLndyaXRlUGVuZGluZyA9IGZhbHNlOwoKCXRoaXMuZG1hID0gbW11LmNvcmUuaXJxLmRtYVszXTsKCgl0aGlzLkNPTU1BTkRfTlVMTCA9IDA7Cgl0aGlzLkNPTU1BTkRfUEVORElORyA9IDE7Cgl0aGlzLkNPTU1BTkRfV1JJVEUgPSAyOwoJdGhpcy5DT01NQU5EX1JFQURfUEVORElORyA9IDM7Cgl0aGlzLkNPTU1BTkRfUkVBRCA9IDQ7Cn07CgpFRVBST01TYXZlZGF0YS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKE1lbW9yeVZpZXcucHJvdG90eXBlKTsKCkVFUFJPTVNhdmVkYXRhLnByb3RvdHlwZS5sb2FkOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJdGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCA4LWJpdCBhY2Nlc3MhIik7Cn07CgpFRVBST01TYXZlZGF0YS5wcm90b3R5cGUubG9hZDE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5sb2FkVTE2KG9mZnNldCk7Cn07CgpFRVBST01TYXZlZGF0YS5wcm90b3R5cGUubG9hZFU4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7Cgl0aHJvdyBuZXcgRXJyb3IoIlVuc3VwcG9ydGVkIDgtYml0IGFjY2VzcyEiKTsKfTsKCkVFUFJPTVNhdmVkYXRhLnByb3RvdHlwZS5sb2FkVTE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglpZiAodGhpcy5jb21tYW5kICE9IHRoaXMuQ09NTUFORF9SRUFEIHx8ICF0aGlzLmRtYS5lbmFibGUpIHsKCQlyZXR1cm4gMTsKCX0KCS0tdGhpcy5yZWFkQml0c1JlbWFpbmluZzsKCWlmICh0aGlzLnJlYWRCaXRzUmVtYWluaW5nIDwgNjQpIHsKCQl2YXIgc3RlcCA9IDYzIC0gdGhpcy5yZWFkQml0c1JlbWFpbmluZzsKCQl2YXIgZGF0YSA9IHRoaXMudmlldy5nZXRVaW50OCgodGhpcy5yZWFkQWRkcmVzcyArIHN0ZXApID4+IDMsIGZhbHNlKSA+PiAoMHg3IC0gKHN0ZXAgJiAweDcpKTsKCQlpZiAoIXRoaXMucmVhZEJpdHNSZW1haW5pbmcpIHsKCQkJdGhpcy5jb21tYW5kID0gdGhpcy5DT01NQU5EX05VTEw7CgkJfQoJCXJldHVybiBkYXRhICYgMHgxOwoJfQoJcmV0dXJuIDA7Cn07CgpFRVBST01TYXZlZGF0YS5wcm90b3R5cGUubG9hZDMyID0gZnVuY3Rpb24ob2Zmc2V0KSB7Cgl0aHJvdyBuZXcgRXJyb3IoIlVuc3VwcG9ydGVkIDMyLWJpdCBhY2Nlc3MhIik7Cn07CgpFRVBST01TYXZlZGF0YS5wcm90b3R5cGUuc3RvcmU4ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCA4LWJpdCBhY2Nlc3MhIik7Cn07CgpFRVBST01TYXZlZGF0YS5wcm90b3R5cGUuc3RvcmUxNiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXN3aXRjaCAodGhpcy5jb21tYW5kKSB7CgkvLyBSZWFkIGhlYWRlcgoJY2FzZSB0aGlzLkNPTU1BTkRfTlVMTDoKCWRlZmF1bHQ6CgkJdGhpcy5jb21tYW5kID0gdmFsdWUgJiAweDE7CgkJYnJlYWs7CgljYXNlIHRoaXMuQ09NTUFORF9QRU5ESU5HOgoJCXRoaXMuY29tbWFuZCA8PD0gMTsKCQl0aGlzLmNvbW1hbmQgfD0gdmFsdWUgJiAweDE7CgkJaWYgKHRoaXMuY29tbWFuZCA9PSB0aGlzLkNPTU1BTkRfV1JJVEUpIHsKCQkJaWYgKCF0aGlzLnJlYWxTaXplKSB7CgkJCQl2YXIgYml0cyA9IHRoaXMuZG1hLmNvdW50IC0gNjc7CgkJCQl0aGlzLnJlYWxTaXplID0gOCA8PCBiaXRzOwoJCQkJdGhpcy5hZGRyZXNzQml0cyA9IGJpdHM7CgkJCX0KCQkJdGhpcy5jb21tYW5kQml0c1JlbWFpbmluZyA9IHRoaXMuYWRkcmVzc0JpdHMgKyA2NCArIDE7CgkJCXRoaXMud3JpdGVBZGRyZXNzID0gMDsKCQl9IGVsc2UgewoJCQlpZiAoIXRoaXMucmVhbFNpemUpIHsKCQkJCXZhciBiaXRzID0gdGhpcy5kbWEuY291bnQgLSAzOwoJCQkJdGhpcy5yZWFsU2l6ZSA9IDggPDwgYml0czsKCQkJCXRoaXMuYWRkcmVzc0JpdHMgPSBiaXRzOwoJCQl9CgkJCXRoaXMuY29tbWFuZEJpdHNSZW1haW5pbmcgPSB0aGlzLmFkZHJlc3NCaXRzICsgMTsKCQkJdGhpcy5yZWFkQWRkcmVzcyA9IDA7CgkJfQoJCWJyZWFrOwoJLy8gRG8gY29tbWFuZHMKCWNhc2UgdGhpcy5DT01NQU5EX1dSSVRFOgoJCS8vIFdyaXRlCgkJaWYgKC0tdGhpcy5jb21tYW5kQml0c1JlbWFpbmluZyA+IDY0KSB7CgkJCXRoaXMud3JpdGVBZGRyZXNzIDw8PSAxOwoJCQl0aGlzLndyaXRlQWRkcmVzcyB8PSAodmFsdWUgJiAweDEpIDw8IDY7CgkJfSBlbHNlIGlmICh0aGlzLmNvbW1hbmRCaXRzUmVtYWluaW5nIDw9IDApIHsKCQkJdGhpcy5jb21tYW5kID0gdGhpcy5DT01NQU5EX05VTEw7CgkJCXRoaXMud3JpdGVQZW5kaW5nID0gdHJ1ZTsKCQl9IGVsc2UgewoJCQl2YXIgY3VycmVudCA9IHRoaXMudmlldy5nZXRVaW50OCh0aGlzLndyaXRlQWRkcmVzcyA+PiAzKTsKCQkJY3VycmVudCAmPSB+KDEgPDwgKDB4NyAtICh0aGlzLndyaXRlQWRkcmVzcyAmIDB4NykpKTsKCQkJY3VycmVudCB8PSAodmFsdWUgJiAweDEpIDw8ICgweDcgLSAodGhpcy53cml0ZUFkZHJlc3MgJiAweDcpKTsKCQkJdGhpcy52aWV3LnNldFVpbnQ4KHRoaXMud3JpdGVBZGRyZXNzID4+IDMsIGN1cnJlbnQpOwoJCQkrK3RoaXMud3JpdGVBZGRyZXNzOwoJCX0KCQlicmVhazsKCWNhc2UgdGhpcy5DT01NQU5EX1JFQURfUEVORElORzoKCQkvLyBSZWFkCgkJaWYgKC0tdGhpcy5jb21tYW5kQml0c1JlbWFpbmluZyA+IDApIHsKCQkJdGhpcy5yZWFkQWRkcmVzcyA8PD0gMTsKCQkJaWYgKHZhbHVlICYgMHgxKSB7CgkJCQl0aGlzLnJlYWRBZGRyZXNzIHw9IDB4NDA7CgkJCX0KCQl9IGVsc2UgewoJCQl0aGlzLnJlYWRCaXRzUmVtYWluaW5nID0gNjg7CgkJCXRoaXMuY29tbWFuZCA9IHRoaXMuQ09NTUFORF9SRUFEOwoJCX0KCQlicmVhazsKCX0KfTsKCkVFUFJPTVNhdmVkYXRhLnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhyb3cgbmV3IEVycm9yKCJVbnN1cHBvcnRlZCAzMi1iaXQgYWNjZXNzISIpOwp9OwoKRUVQUk9NU2F2ZWRhdGEucHJvdG90eXBlLnJlcGxhY2VEYXRhID0gZnVuY3Rpb24obWVtb3J5KSB7CglNZW1vcnlWaWV3LnByb3RvdHlwZS5yZXBsYWNlRGF0YS5jYWxsKHRoaXMsIG1lbW9yeSwgMCk7Cn07Cg==";

const GBA_js_sio_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VTSU8oKSB7Cgl0aGlzLlNJT19OT1JNQUxfOCA9IDA7Cgl0aGlzLlNJT19OT1JNQUxfMzIgPSAxOwoJdGhpcy5TSU9fTVVMVEkgPSAyOwoJdGhpcy5TSU9fVUFSVCA9IDM7Cgl0aGlzLlNJT19HUElPID0gODsKCXRoaXMuU0lPX0pPWUJVUyA9IDEyOwoKCXRoaXMuQkFVRCA9IFsgOTYwMCwgMzg0MDAsIDU3NjAwLCAxMTUyMDAgXTsKfQoKR2FtZUJveUFkdmFuY2VTSU8ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7Cgl0aGlzLm1vZGUgPSB0aGlzLlNJT19HUElPOwoJdGhpcy5zZCA9IGZhbHNlOwoKCXRoaXMuaXJxID0gZmFsc2U7Cgl0aGlzLm11bHRpcGxheWVyID0gewoJCWJhdWQ6IDAsCgkJc2k6IDAsCgkJaWQ6IDAsCgkJZXJyb3I6IDAsCgkJYnVzeTogMCwKCgkJc3RhdGVzOiBbIDB4RkZGRiwgMHhGRkZGLCAweEZGRkYsIDB4RkZGRiBdCgl9OwoKCXRoaXMubGlua0xheWVyID0gbnVsbDsKfTsKCkdhbWVCb3lBZHZhbmNlU0lPLnByb3RvdHlwZS5zZXRNb2RlID0gZnVuY3Rpb24obW9kZSkgewoJaWYgKG1vZGUgJiAweDgpIHsKCQltb2RlICY9IDB4QzsKCX0gZWxzZSB7CgkJbW9kZSAmPSAweDM7Cgl9Cgl0aGlzLm1vZGUgPSBtb2RlOwoKCXRoaXMuY29yZS5JTkZPKCdTZXR0aW5nIFNJTyBtb2RlIHRvICcgKyBoZXgobW9kZSwgMSkpOwp9OwoKR2FtZUJveUFkdmFuY2VTSU8ucHJvdG90eXBlLndyaXRlUkNOVCA9IGZ1bmN0aW9uKHZhbHVlKSB7CglpZiAodGhpcy5tb2RlICE9IHRoaXMuU0lPX0dQSU8pIHsKCQlyZXR1cm47Cgl9CgoJdGhpcy5jb3JlLlNUVUIoJ0dlbmVyYWwgcHVycG9zZSBzZXJpYWwgbm90IHN1cHBvcnRlZCcpOwp9OwoKR2FtZUJveUFkdmFuY2VTSU8ucHJvdG90eXBlLndyaXRlU0lPQ05UID0gZnVuY3Rpb24odmFsdWUpIHsKCXN3aXRjaCAodGhpcy5tb2RlKSB7CgljYXNlIHRoaXMuU0lPX05PUk1BTF84OgoJCXRoaXMuY29yZS5TVFVCKCc4LWJpdCB0cmFuc2ZlciB1bnN1cHBvcnRlZCcpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNJT19OT1JNQUxfMzI6CgkJdGhpcy5jb3JlLlNUVUIoJzMyLWJpdCB0cmFuc2ZlciB1bnN1cHBvcnRlZCcpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNJT19NVUxUSToKCQl0aGlzLm11bHRpcGxheWVyLmJhdWQgPSB2YWx1ZSAmIDB4MDAwMzsKCQlpZiAodGhpcy5saW5rTGF5ZXIpIHsKCQkJdGhpcy5saW5rTGF5ZXIuc2V0QmF1ZCh0aGlzLkJBVURbdGhpcy5tdWx0aXBsYXllci5iYXVkXSk7CgkJfQoKCQlpZiAoIXRoaXMubXVsdGlwbGF5ZXIuc2kpIHsKCQkJdGhpcy5tdWx0aXBsYXllci5idXN5ID0gdmFsdWUgJiAweDAwODA7CgkJCWlmICh0aGlzLmxpbmtMYXllciAmJiB0aGlzLm11bHRpcGxheWVyLmJ1c3kpIHsKCQkJCXRoaXMubGlua0xheWVyLnN0YXJ0TXVsdGlwbGF5ZXJUcmFuc2ZlcigpOwoJCQl9CgkJfQoJCXRoaXMuaXJxID0gdmFsdWUgJiAweDQwMDA7CgkJYnJlYWs7CgljYXNlIHRoaXMuU0lPX1VBUlQ6CgkJdGhpcy5jb3JlLlNUVUIoJ1VBUlQgdW5zdXBwb3J0ZWQnKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TSU9fR1BJTzoKCQkvLyBUaGlzIHJlZ2lzdGVyIGlzbid0IHVzZWQgaW4gZ2VuZXJhbC1wdXJwb3NlIG1vZGUKCQlicmVhazsKCWNhc2UgdGhpcy5TSU9fSk9ZQlVTOgoJCXRoaXMuY29yZS5TVFVCKCdKT1kgQlVTIHVuc3VwcG9ydGVkJyk7CgkJYnJlYWs7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVNJTy5wcm90b3R5cGUucmVhZFNJT0NOVCA9IGZ1bmN0aW9uKCkgewoJdmFyIHZhbHVlID0gKHRoaXMubW9kZSA8PCAxMikgJiAweEZGRkY7Cglzd2l0Y2ggKHRoaXMubW9kZSkgewoJY2FzZSB0aGlzLlNJT19OT1JNQUxfODoKCQl0aGlzLmNvcmUuU1RVQignOC1iaXQgdHJhbnNmZXIgdW5zdXBwb3J0ZWQnKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TSU9fTk9STUFMXzMyOgoJCXRoaXMuY29yZS5TVFVCKCczMi1iaXQgdHJhbnNmZXIgdW5zdXBwb3J0ZWQnKTsKCQlicmVhazsKCWNhc2UgdGhpcy5TSU9fTVVMVEk6CgkJdmFsdWUgfD0gdGhpcy5tdWx0aXBsYXllci5iYXVkOwoJCXZhbHVlIHw9IHRoaXMubXVsdGlwbGF5ZXIuc2k7CgkJdmFsdWUgfD0gKCEhdGhpcy5zZCkgPDwgMzsKCQl2YWx1ZSB8PSB0aGlzLm11bHRpcGxheWVyLmlkIDw8IDQ7CgkJdmFsdWUgfD0gdGhpcy5tdWx0aXBsYXllci5lcnJvcjsKCQl2YWx1ZSB8PSB0aGlzLm11bHRpcGxheWVyLmJ1c3k7CgkJdmFsdWUgfD0gKCEhdGhpcy5tdWx0aXBsYXllci5pcnEpIDw8IDE0OwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNJT19VQVJUOgoJCXRoaXMuY29yZS5TVFVCKCdVQVJUIHVuc3VwcG9ydGVkJyk7CgkJYnJlYWs7CgljYXNlIHRoaXMuU0lPX0dQSU86CgkJLy8gVGhpcyByZWdpc3RlciBpc24ndCB1c2VkIGluIGdlbmVyYWwtcHVycG9zZSBtb2RlCgkJYnJlYWs7CgljYXNlIHRoaXMuU0lPX0pPWUJVUzoKCQl0aGlzLmNvcmUuU1RVQignSk9ZIEJVUyB1bnN1cHBvcnRlZCcpOwoJCWJyZWFrOwoJfQoJcmV0dXJuIHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VTSU8ucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbihzbG90KSB7Cglzd2l0Y2ggKHRoaXMubW9kZSkgewoJY2FzZSB0aGlzLlNJT19OT1JNQUxfMzI6CgkJdGhpcy5jb3JlLlNUVUIoJzMyLWJpdCB0cmFuc2ZlciB1bnN1cHBvcnRlZCcpOwoJCWJyZWFrOwoJY2FzZSB0aGlzLlNJT19NVUxUSToKCQlyZXR1cm4gdGhpcy5tdWx0aXBsYXllci5zdGF0ZXNbc2xvdF07CgljYXNlIHRoaXMuU0lPX1VBUlQ6CgkJdGhpcy5jb3JlLlNUVUIoJ1VBUlQgdW5zdXBwb3J0ZWQnKTsKCQlicmVhazsKCWRlZmF1bHQ6CgkJdGhpcy5jb3JlLldBUk4oJ1JlYWRpbmcgZnJvbSB0cmFuc2ZlciByZWdpc3RlciBpbiB1bnN1cHBvcnRlZCBtb2RlJyk7CgkJYnJlYWs7Cgl9CglyZXR1cm4gMDsKfTsK";

const GBA_js_thumb_js ="QVJNQ29yZVRodW1iID0gZnVuY3Rpb24gKGNwdSkgewoJdGhpcy5jcHUgPSBjcHU7Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdEFEQyA9IGZ1bmN0aW9uKHJkLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBtID0gKGdwcnNbcm1dID4+PiAwKSArICEhY3B1LmNwc3JDOwoJCXZhciBvbGREID0gZ3Byc1tyZF07CgkJdmFyIGQgPSAob2xkRCA+Pj4gMCkgKyBtOwoJCXZhciBvbGREbiA9IG9sZEQgPj4gMzE7CgkJdmFyIGRuID0gZCA+PiAzMTsKCQl2YXIgbW4gPSBtID4+IDMxOwoJCWNwdS5jcHNyTiA9IGRuOwoJCWNwdS5jcHNyWiA9ICEoZCAmIDB4RkZGRkZGRkYpOwoJCWNwdS5jcHNyQyA9IGQgPiAweEZGRkZGRkZGOwoJCWNwdS5jcHNyViA9IG9sZERuID09IG1uICYmIG9sZERuICE9IGRuICYmIG1uICE9IGRuOwoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdEFERDEgPSBmdW5jdGlvbihyZCwgcm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBkID0gKGdwcnNbcm5dID4+PiAwKSArIGltbWVkaWF0ZTsKCQljcHUuY3Bzck4gPSBkID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoZCAmIDB4RkZGRkZGRkYpOwoJCWNwdS5jcHNyQyA9IGQgPiAweEZGRkZGRkZGOwoJCWNwdS5jcHNyViA9ICEoZ3Byc1tybl0gPj4gMzEpICYmICgoZ3Byc1tybl0gPj4gMzEgXiBkKSA+PiAzMSkgJiYgKGQgPj4gMzEpOwoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdEFERDIgPSBmdW5jdGlvbihybiwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIGQgPSAoZ3Byc1tybl0gPj4+IDApICsgaW1tZWRpYXRlOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gZCA+IDB4RkZGRkZGRkY7CgkJY3B1LmNwc3JWID0gIShncHJzW3JuXSA+PiAzMSkgJiYgKChncHJzW3JuXSBeIGQpID4+IDMxKSAmJiAoKGltbWVkaWF0ZSBeIGQpID4+IDMxKTsKCQlncHJzW3JuXSA9IGQ7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RBREQzID0gZnVuY3Rpb24ocmQsIHJuLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBkID0gKGdwcnNbcm5dID4+PiAwKSArIChncHJzW3JtXSA+Pj4gMCk7CgkJY3B1LmNwc3JOID0gZCA+PiAzMTsKCQljcHUuY3BzclogPSAhKGQgJiAweEZGRkZGRkZGKTsKCQljcHUuY3BzckMgPSBkID4gMHhGRkZGRkZGRjsKCQljcHUuY3BzclYgPSAhKChncHJzW3JuXSBeIGdwcnNbcm1dKSA+PiAzMSkgJiYgKChncHJzW3JuXSBeIGQpID4+IDMxKSAmJiAoKGdwcnNbcm1dIF4gZCkgPj4gMzEpOwoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdEFERDQgPSBmdW5jdGlvbihyZCwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW3JkXSArPSBncHJzW3JtXTsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdEFERDUgPSBmdW5jdGlvbihyZCwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSAoZ3Byc1tjcHUuUENdICYgMHhGRkZGRkZGQykgKyBpbW1lZGlhdGU7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RBREQ2ID0gZnVuY3Rpb24ocmQsIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcmRdID0gZ3Byc1tjcHUuU1BdICsgaW1tZWRpYXRlOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0QURENyA9IGZ1bmN0aW9uKGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbY3B1LlNQXSArPSBpbW1lZGlhdGU7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RBTkQgPSBmdW5jdGlvbihyZCwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW3JkXSA9IGdwcnNbcmRdICYgZ3Byc1tybV07CgkJY3B1LmNwc3JOID0gZ3Byc1tyZF0gPj4gMzE7CgkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0QVNSMSA9IGZ1bmN0aW9uKHJkLCBybSwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGltbWVkaWF0ZSA9PSAwKSB7CgkJCWNwdS5jcHNyQyA9IGdwcnNbcm1dID4+IDMxOwoJCQlpZiAoY3B1LmNwc3JDKSB7CgkJCQlncHJzW3JkXSA9IDB4RkZGRkZGRkY7CgkJCX0gZWxzZSB7CgkJCQlncHJzW3JkXSA9IDA7CgkJCX0KCQl9IGVsc2UgewoJCQljcHUuY3BzckMgPSBncHJzW3JtXSAmICgxIDw8IChpbW1lZGlhdGUgLSAxKSk7CgkJCWdwcnNbcmRdID0gZ3Byc1tybV0gPj4gaW1tZWRpYXRlOwoJCX0KCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RBU1IyID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIHJzID0gZ3Byc1tybV0gJiAweEZGOwoJCWlmIChycykgewoJCQlpZiAocnMgPCAzMikgewoJCQkJY3B1LmNwc3JDID0gZ3Byc1tyZF0gJiAoMSA8PCAocnMgLSAxKSk7CgkJCQlncHJzW3JkXSA+Pj0gcnM7CgkJCX0gZWxzZSB7CgkJCQljcHUuY3BzckMgPSBncHJzW3JkXSA+PiAzMTsKCQkJCWlmIChjcHUuY3BzckMpIHsKCQkJCQlncHJzW3JkXSA9IDB4RkZGRkZGRkY7CgkJCQl9IGVsc2UgewoJCQkJCWdwcnNbcmRdID0gMDsKCQkJCX0KCQkJfQoJCX0KCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RCMSA9IGZ1bmN0aW9uKGltbWVkaWF0ZSwgY29uZE9wKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGNvbmRPcCgpKSB7CgkJCWdwcnNbY3B1LlBDXSArPSBpbW1lZGlhdGU7CgkJfQoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0QjIgPSBmdW5jdGlvbihpbW1lZGlhdGUpIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW2NwdS5QQ10gKz0gaW1tZWRpYXRlOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0QklDID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSBncHJzW3JkXSAmIH5ncHJzW3JtXTsKCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RCTDEgPSBmdW5jdGlvbihpbW1lZGlhdGUpIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW2NwdS5MUl0gPSBncHJzW2NwdS5QQ10gKyBpbW1lZGlhdGU7Cgl9Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdEJMMiA9IGZ1bmN0aW9uKGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBwYyA9IGdwcnNbY3B1LlBDXTsKCQlncHJzW2NwdS5QQ10gPSBncHJzW2NwdS5MUl0gKyAoaW1tZWRpYXRlIDw8IDEpOwoJCWdwcnNbY3B1LkxSXSA9IHBjIC0gMTsKCX0KfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0QlggPSBmdW5jdGlvbihyZCwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQljcHUuc3dpdGNoRXhlY01vZGUoZ3Byc1tybV0gJiAweDAwMDAwMDAxKTsKCQl2YXIgbWlzYWxpZ24gPSAwOwoJCWlmIChybSA9PSAxNSkgewoJCQltaXNhbGlnbiA9IGdwcnNbcm1dICYgMHgwMDAwMDAwMjsKCQl9CgkJZ3Byc1tjcHUuUENdID0gZ3Byc1tybV0gJiAweEZGRkZGRkZFIC0gbWlzYWxpZ247Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RDTU4gPSBmdW5jdGlvbihyZCwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQl2YXIgYWx1T3V0ID0gKGdwcnNbcmRdID4+PiAwKSArIChncHJzW3JtXSA+Pj4gMCk7CgkJY3B1LmNwc3JOID0gYWx1T3V0ID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoYWx1T3V0ICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gYWx1T3V0ID4gMHhGRkZGRkZGRjsKCQljcHUuY3BzclYgPSAoZ3Byc1tyZF0gPj4gMzEpID09IChncHJzW3JtXSA+PiAzMSkgJiYKCQkJCQkoZ3Byc1tyZF0gPj4gMzEpICE9IChhbHVPdXQgPj4gMzEpICYmCgkJCQkJKGdwcnNbcm1dID4+IDMxKSAhPSAoYWx1T3V0ID4+IDMxKTsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdENNUDEgPSBmdW5jdGlvbihybiwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIGFsdU91dCA9IGdwcnNbcm5dIC0gaW1tZWRpYXRlOwoJCWNwdS5jcHNyTiA9IGFsdU91dCA+PiAzMTsKCQljcHUuY3BzclogPSAhKGFsdU91dCAmIDB4RkZGRkZGRkYpOwoJCWNwdS5jcHNyQyA9IChncHJzW3JuXSA+Pj4gMCkgPj0gaW1tZWRpYXRlOwoJCWNwdS5jcHNyViA9IChncHJzW3JuXSA+PiAzMSkgJiYgKChncHJzW3JuXSBeIGFsdU91dCkgPj4gMzEpOwoJfTsKfQoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RDTVAyID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIGQgPSBncHJzW3JkXTsKCQl2YXIgbSA9IGdwcnNbcm1dOwoJCXZhciBhbHVPdXQgPSBkIC0gbTsKCQl2YXIgYW4gPSBhbHVPdXQgPj4gMzE7CgkJdmFyIGRuID0gZCA+PiAzMTsKCQljcHUuY3Bzck4gPSBhbjsKCQljcHUuY3BzclogPSAhKGFsdU91dCAmIDB4RkZGRkZGRkYpOwoJCWNwdS5jcHNyQyA9IChkID4+PiAwKSA+PSAobSA+Pj4gMCk7CgkJY3B1LmNwc3JWID0gZG4gIT0gKG0gPj4gMzEpICYmIGRuICE9IGFuOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0Q01QMyA9IGZ1bmN0aW9uKHJkLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBhbHVPdXQgPSBncHJzW3JkXSAtIGdwcnNbcm1dOwoJCWNwdS5jcHNyTiA9IGFsdU91dCA+PiAzMTsKCQljcHUuY3BzclogPSAhKGFsdU91dCAmIDB4RkZGRkZGRkYpOwoJCWNwdS5jcHNyQyA9IChncHJzW3JkXSA+Pj4gMCkgPj0gKGdwcnNbcm1dID4+PiAwKTsKCQljcHUuY3BzclYgPSAoKGdwcnNbcmRdIF4gZ3Byc1tybV0pID4+IDMxKSAmJiAoKGdwcnNbcmRdIF4gYWx1T3V0KSA+PiAzMSk7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RFT1IgPSBmdW5jdGlvbihyZCwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW3JkXSA9IGdwcnNbcmRdIF4gZ3Byc1tybV07CgkJY3B1LmNwc3JOID0gZ3Byc1tyZF0gPj4gMzE7CgkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TERNSUEgPSBmdW5jdGlvbihybiwgcnMpIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQl2YXIgYWRkcmVzcyA9IGdwcnNbcm5dOwoJCXZhciB0b3RhbCA9IDA7CgkJdmFyIG0sIGk7CgkJZm9yIChtID0gMHgwMSwgaSA9IDA7IGkgPCA4OyBtIDw8PSAxLCArK2kpIHsKCQkJaWYgKHJzICYgbSkgewoJCQkJZ3Byc1tpXSA9IGNwdS5tbXUubG9hZDMyKGFkZHJlc3MpOwoJCQkJYWRkcmVzcyArPSA0OwoJCQkJKyt0b3RhbDsKCQkJfQoJCX0KCQljcHUubW11LndhaXRNdWx0aTMyKGFkZHJlc3MsIHRvdGFsKTsKCQlpZiAoISgoMSA8PCBybikgJiBycykpIHsKCQkJZ3Byc1tybl0gPSBhZGRyZXNzOwoJCX0KCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdExEUjEgPSBmdW5jdGlvbihyZCwgcm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBuID0gZ3Byc1tybl0gKyBpbW1lZGlhdGU7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWQzMihuKTsKCQljcHUubW11LndhaXQzMihuKTsKCQkrK2NwdS5jeWNsZXM7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RMRFIyID0gZnVuY3Rpb24ocmQsIHJuLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcmRdID0gY3B1Lm1tdS5sb2FkMzIoZ3Byc1tybl0gKyBncHJzW3JtXSk7CgkJY3B1Lm1tdS53YWl0MzIoZ3Byc1tybl0gKyBncHJzW3JtXSk7CgkJKytjcHUuY3ljbGVzOwoJfQp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RMRFIzID0gZnVuY3Rpb24ocmQsIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcmRdID0gY3B1Lm1tdS5sb2FkMzIoKGdwcnNbY3B1LlBDXSAmIDB4RkZGRkZGRkMpICsgaW1tZWRpYXRlKTsKCQljcHUubW11LndhaXQzMihncHJzW2NwdS5QQ10pOwoJCSsrY3B1LmN5Y2xlczsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdExEUjQgPSBmdW5jdGlvbihyZCwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWQzMihncHJzW2NwdS5TUF0gKyBpbW1lZGlhdGUpOwoJCWNwdS5tbXUud2FpdDMyKGdwcnNbY3B1LlNQXSArIGltbWVkaWF0ZSk7CgkJKytjcHUuY3ljbGVzOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TERSQjEgPSBmdW5jdGlvbihyZCwgcm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQl2YXIgbiA9IGdwcnNbcm5dICsgaW1tZWRpYXRlOwoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWRVOChuKTsKCQljcHUubW11LndhaXQobik7CgkJKytjcHUuY3ljbGVzOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TERSQjIgPSBmdW5jdGlvbihyZCwgcm4sIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWRVOChncHJzW3JuXSArIGdwcnNbcm1dKTsKCQljcHUubW11LndhaXQoZ3Byc1tybl0gKyBncHJzW3JtXSk7CgkJKytjcHUuY3ljbGVzOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TERSSDEgPSBmdW5jdGlvbihyZCwgcm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQl2YXIgbiA9IGdwcnNbcm5dICsgaW1tZWRpYXRlOwoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSBjcHUubW11LmxvYWRVMTYobik7CgkJY3B1Lm1tdS53YWl0KG4pOwoJCSsrY3B1LmN5Y2xlczsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdExEUkgyID0gZnVuY3Rpb24ocmQsIHJuLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcmRdID0gY3B1Lm1tdS5sb2FkVTE2KGdwcnNbcm5dICsgZ3Byc1tybV0pOwoJCWNwdS5tbXUud2FpdChncHJzW3JuXSArIGdwcnNbcm1dKTsKCQkrK2NwdS5jeWNsZXM7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RMRFJTQiA9IGZ1bmN0aW9uKHJkLCBybiwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW3JkXSA9IGNwdS5tbXUubG9hZDgoZ3Byc1tybl0gKyBncHJzW3JtXSk7CgkJY3B1Lm1tdS53YWl0KGdwcnNbcm5dICsgZ3Byc1tybV0pOwoJCSsrY3B1LmN5Y2xlczsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdExEUlNIID0gZnVuY3Rpb24ocmQsIHJuLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcmRdID0gY3B1Lm1tdS5sb2FkMTYoZ3Byc1tybl0gKyBncHJzW3JtXSk7CgkJY3B1Lm1tdS53YWl0KGdwcnNbcm5dICsgZ3Byc1tybV0pOwoJCSsrY3B1LmN5Y2xlczsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdExTTDEgPSBmdW5jdGlvbihyZCwgcm0sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWlmIChpbW1lZGlhdGUgPT0gMCkgewoJCQlncHJzW3JkXSA9IGdwcnNbcm1dOwoJCX0gZWxzZSB7CgkJCWNwdS5jcHNyQyA9IGdwcnNbcm1dICYgKDEgPDwgKDMyIC0gaW1tZWRpYXRlKSk7CgkJCWdwcnNbcmRdID0gZ3Byc1tybV0gPDwgaW1tZWRpYXRlOwoJCX0KCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RMU0wyID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIHJzID0gZ3Byc1tybV0gJiAweEZGOwoJCWlmIChycykgewoJCQlpZiAocnMgPCAzMikgewoJCQkJY3B1LmNwc3JDID0gZ3Byc1tyZF0gJiAoMSA8PCAoMzIgLSBycykpOwoJCQkJZ3Byc1tyZF0gPDw9IHJzOwoJCQl9IGVsc2UgewoJCQkJaWYgKHJzID4gMzIpIHsKCQkJCQljcHUuY3BzckMgPSAwOwoJCQkJfSBlbHNlIHsKCQkJCQljcHUuY3BzckMgPSBncHJzW3JkXSAmIDB4MDAwMDAwMDE7CgkJCQl9CgkJCQlncHJzW3JkXSA9IDA7CgkJCX0KCQl9CgkJY3B1LmNwc3JOID0gZ3Byc1tyZF0gPj4gMzE7CgkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TFNSMSA9IGZ1bmN0aW9uKHJkLCBybSwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJaWYgKGltbWVkaWF0ZSA9PSAwKSB7CgkJCWNwdS5jcHNyQyA9IGdwcnNbcm1dID4+IDMxOwoJCQlncHJzW3JkXSA9IDA7CgkJfSBlbHNlIHsKCQkJY3B1LmNwc3JDID0gZ3Byc1tybV0gJiAoMSA8PCAoaW1tZWRpYXRlIC0gMSkpOwoJCQlncHJzW3JkXSA9IGdwcnNbcm1dID4+PiBpbW1lZGlhdGU7CgkJfQoJCWNwdS5jcHNyTiA9IDA7CgkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJfTsKfQoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RMU1IyID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIHJzID0gZ3Byc1tybV0gJiAweEZGOwoJCWlmIChycykgewoJCQlpZiAocnMgPCAzMikgewoJCQkJY3B1LmNwc3JDID0gZ3Byc1tyZF0gJiAoMSA8PCAocnMgLSAxKSk7CgkJCQlncHJzW3JkXSA+Pj49IHJzOwoJCQl9IGVsc2UgewoJCQkJaWYgKHJzID4gMzIpIHsKCQkJCQljcHUuY3BzckMgPSAwOwoJCQkJfSBlbHNlIHsKCQkJCQljcHUuY3BzckMgPSBncHJzW3JkXSA+PiAzMTsKCQkJCX0KCQkJCWdwcnNbcmRdID0gMDsKCQkJfQoJCX0KCQljcHUuY3Bzck4gPSBncHJzW3JkXSA+PiAzMTsKCQljcHUuY3BzclogPSAhKGdwcnNbcmRdICYgMHhGRkZGRkZGRik7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RNT1YxID0gZnVuY3Rpb24ocm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcm5dID0gaW1tZWRpYXRlOwoJCWNwdS5jcHNyTiA9IGltbWVkaWF0ZSA+PiAzMTsKCQljcHUuY3BzclogPSAhKGltbWVkaWF0ZSAmIDB4RkZGRkZGRkYpOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TU9WMiA9IGZ1bmN0aW9uKHJkLCBybiwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQl2YXIgZCA9IGdwcnNbcm5dOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gMDsKCQljcHUuY3BzclYgPSAwOwoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdE1PVjMgPSBmdW5jdGlvbihyZCwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQlncHJzW3JkXSA9IGdwcnNbcm1dOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0TVVMID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJY3B1Lm1tdS53YWl0TXVsKGdwcnNbcm1dKTsKCQlpZiAoKGdwcnNbcm1dICYgMHhGRkZGMDAwMCkgJiYgKGdwcnNbcmRdICYgMHhGRkZGMDAwMCkpIHsKCQkJLy8gT3VyIGRhdGEgdHlwZSBpcyBhIGRvdWJsZS0td2UnbGwgbG9zZSBiaXRzIGlmIHdlIGRvIGl0IGFsbCBhdCBvbmNlIQoJCQl2YXIgaGkgPSAoKGdwcnNbcmRdICYgMHhGRkZGMDAwMCkgKiBncHJzW3JtXSkgJiAweEZGRkZGRkZGOwoJCQl2YXIgbG8gPSAoKGdwcnNbcmRdICYgMHgwMDAwRkZGRikgKiBncHJzW3JtXSkgJiAweEZGRkZGRkZGOwoJCQlncHJzW3JkXSA9IChoaSArIGxvKSAmIDB4RkZGRkZGRkY7CgkJfSBlbHNlIHsKCQkJZ3Byc1tyZF0gKj0gZ3Byc1tybV07CgkJfQoJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoZ3Byc1tyZF0gJiAweEZGRkZGRkZGKTsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdE1WTiA9IGZ1bmN0aW9uKHJkLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCWdwcnNbcmRdID0gfmdwcnNbcm1dOwoJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoZ3Byc1tyZF0gJiAweEZGRkZGRkZGKTsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdE5FRyA9IGZ1bmN0aW9uKHJkLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBkID0gLWdwcnNbcm1dOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gMCA+PSAoZCA+Pj4gMCk7CgkJY3B1LmNwc3JWID0gKGdwcnNbcm1dID4+IDMxKSAmJiAoZCA+PiAzMSk7CgkJZ3Byc1tyZF0gPSBkOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0T1JSID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJZ3Byc1tyZF0gPSBncHJzW3JkXSB8IGdwcnNbcm1dOwoJCWNwdS5jcHNyTiA9IGdwcnNbcmRdID4+IDMxOwoJCWNwdS5jcHNyWiA9ICEoZ3Byc1tyZF0gJiAweEZGRkZGRkZGKTsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdFBPUCA9IGZ1bmN0aW9uKHJzLCByKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJKytjcHUuY3ljbGVzOwoJCXZhciBhZGRyZXNzID0gZ3Byc1tjcHUuU1BdOwoJCXZhciB0b3RhbCA9IDA7CgkJdmFyIG0sIGk7CgkJZm9yIChtID0gMHgwMSwgaSA9IDA7IGkgPCA4OyBtIDw8PSAxLCArK2kpIHsKCQkJaWYgKHJzICYgbSkgewoJCQkJY3B1Lm1tdS53YWl0U2VxMzIoYWRkcmVzcyk7CgkJCQlncHJzW2ldID0gY3B1Lm1tdS5sb2FkMzIoYWRkcmVzcyk7CgkJCQlhZGRyZXNzICs9IDQ7CgkJCQkrK3RvdGFsOwoJCQl9CgkJfQoJCWlmIChyKSB7CgkJCWdwcnNbY3B1LlBDXSA9IGNwdS5tbXUubG9hZDMyKGFkZHJlc3MpICYgMHhGRkZGRkZGRTsKCQkJYWRkcmVzcyArPSA0OwoJCQkrK3RvdGFsOwoJCX0KCQljcHUubW11LndhaXRNdWx0aTMyKGFkZHJlc3MsIHRvdGFsKTsKCQlncHJzW2NwdS5TUF0gPSBhZGRyZXNzOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0UFVTSCA9IGZ1bmN0aW9uKHJzLCByKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCXZhciBhZGRyZXNzID0gZ3Byc1tjcHUuU1BdIC0gNDsKCQl2YXIgdG90YWwgPSAwOwoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJaWYgKHIpIHsKCQkJY3B1Lm1tdS5zdG9yZTMyKGFkZHJlc3MsIGdwcnNbY3B1LkxSXSk7CgkJCWFkZHJlc3MgLT0gNDsKCQkJKyt0b3RhbDsKCQl9CgkJdmFyIG0sIGk7CgkJZm9yIChtID0gMHg4MCwgaSA9IDc7IG07IG0gPj49IDEsIC0taSkgewoJCQlpZiAocnMgJiBtKSB7CgkJCQljcHUubW11LnN0b3JlMzIoYWRkcmVzcywgZ3Byc1tpXSk7CgkJCQlhZGRyZXNzIC09IDQ7CgkJCQkrK3RvdGFsOwoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJZm9yIChtID4+PSAxLCAtLWk7IG07IG0gPj49IDEsIC0taSkgewoJCQlpZiAocnMgJiBtKSB7CgkJCQljcHUubW11LnN0b3JlMzIoYWRkcmVzcywgZ3Byc1tpXSk7CgkJCQlhZGRyZXNzIC09IDQ7CgkJCQkrK3RvdGFsOwoJCQl9CgkJfQoJCWNwdS5tbXUud2FpdE11bHRpMzIoYWRkcmVzcywgdG90YWwpOwoJCWdwcnNbY3B1LlNQXSA9IGFkZHJlc3MgKyA0OwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0Uk9SID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIHJzID0gZ3Byc1tybV0gJiAweEZGOwoJCWlmIChycykgewoJCQl2YXIgcjQgPSBycyAmIDB4MUY7CgkJCWlmIChyNCA+IDApIHsKCQkJCWNwdS5jcHNyQyA9IGdwcnNbcmRdICYgKDEgPDwgKHI0IC0gMSkpOwoJCQkJZ3Byc1tyZF0gPSAoZ3Byc1tyZF0gPj4+IHI0KSB8IChncHJzW3JkXSA8PCAoMzIgLSByNCkpOwoJCQl9IGVsc2UgewoJCQkJY3B1LmNwc3JDID0gZ3Byc1tyZF0gPj4gMzE7CgkJCX0KCQl9CgkJY3B1LmNwc3JOID0gZ3Byc1tyZF0gPj4gMzE7CgkJY3B1LmNwc3JaID0gIShncHJzW3JkXSAmIDB4RkZGRkZGRkYpOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0U0JDID0gZnVuY3Rpb24ocmQsIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIG0gPSAoZ3Byc1tybV0gPj4+IDApICsgIWNwdS5jcHNyQzsKCQl2YXIgZCA9IChncHJzW3JkXSA+Pj4gMCkgLSBtOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gKGdwcnNbcmRdID4+PiAwKSA+PSAoZCA+Pj4gMCk7CgkJY3B1LmNwc3JWID0gKChncHJzW3JkXSBeIG0pID4+IDMxKSAmJiAoKGdwcnNbcmRdIF4gZCkgPj4gMzEpOwoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdFNUTUlBID0gZnVuY3Rpb24ocm4sIHJzKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdChncHJzW2NwdS5QQ10pOwoJCXZhciBhZGRyZXNzID0gZ3Byc1tybl07CgkJdmFyIHRvdGFsID0gMDsKCQl2YXIgbSwgaTsKCQlmb3IgKG0gPSAweDAxLCBpID0gMDsgaSA8IDg7IG0gPDw9IDEsICsraSkgewoJCQlpZiAocnMgJiBtKSB7CgkJCQljcHUubW11LnN0b3JlMzIoYWRkcmVzcywgZ3Byc1tpXSk7CgkJCQlhZGRyZXNzICs9IDQ7CgkJCQkrK3RvdGFsOwoJCQkJYnJlYWs7CgkJCX0KCQl9CgkJZm9yIChtIDw8PSAxLCArK2k7IGkgPCA4OyBtIDw8PSAxLCArK2kpIHsKCQkJaWYgKHJzICYgbSkgewoJCQkJY3B1Lm1tdS5zdG9yZTMyKGFkZHJlc3MsIGdwcnNbaV0pOwoJCQkJYWRkcmVzcyArPSA0OwoJCQkJKyt0b3RhbDsKCQkJfQoJCX0KCQljcHUubW11LndhaXRNdWx0aTMyKGFkZHJlc3MsIHRvdGFsKTsKCQlncHJzW3JuXSA9IGFkZHJlc3M7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RTVFIxID0gZnVuY3Rpb24ocmQsIHJuLCBpbW1lZGlhdGUpIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJdmFyIG4gPSBncHJzW3JuXSArIGltbWVkaWF0ZTsKCQljcHUubW11LnN0b3JlMzIobiwgZ3Byc1tyZF0pOwoJCWNwdS5tbXUud2FpdChncHJzW2NwdS5QQ10pOwoJCWNwdS5tbXUud2FpdDMyKG4pOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0U1RSMiA9IGZ1bmN0aW9uKHJkLCBybiwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS5zdG9yZTMyKGdwcnNbcm5dICsgZ3Byc1tybV0sIGdwcnNbcmRdKTsKCQljcHUubW11LndhaXQoZ3Byc1tjcHUuUENdKTsKCQljcHUubW11LndhaXQzMihncHJzW3JuXSArIGdwcnNbcm1dKTsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdFNUUjMgPSBmdW5jdGlvbihyZCwgaW1tZWRpYXRlKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUuc3RvcmUzMihncHJzW2NwdS5TUF0gKyBpbW1lZGlhdGUsIGdwcnNbcmRdKTsKCQljcHUubW11LndhaXQoZ3Byc1tjcHUuUENdKTsKCQljcHUubW11LndhaXQzMihncHJzW2NwdS5TUF0gKyBpbW1lZGlhdGUpOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0U1RSQjEgPSBmdW5jdGlvbihyZCwgcm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQl2YXIgbiA9IGdwcnNbcm5dICsgaW1tZWRpYXRlOwoJCWNwdS5tbXUuc3RvcmU4KG4sIGdwcnNbcmRdKTsKCQljcHUubW11LndhaXQoZ3Byc1tjcHUuUENdKTsKCQljcHUubW11LndhaXQobik7Cgl9Owp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RTVFJCMiA9IGZ1bmN0aW9uKHJkLCBybiwgcm0pIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS5zdG9yZTgoZ3Byc1tybl0gKyBncHJzW3JtXSwgZ3Byc1tyZF0pOwoJCWNwdS5tbXUud2FpdChncHJzW2NwdS5QQ10pOwoJCWNwdS5tbXUud2FpdChncHJzW3JuXSArIGdwcnNbcm1dKTsKCX0KfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0U1RSSDEgPSBmdW5jdGlvbihyZCwgcm4sIGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQl2YXIgbiA9IGdwcnNbcm5dICsgaW1tZWRpYXRlOwoJCWNwdS5tbXUuc3RvcmUxNihuLCBncHJzW3JkXSk7CgkJY3B1Lm1tdS53YWl0KGdwcnNbY3B1LlBDXSk7CgkJY3B1Lm1tdS53YWl0KG4pOwoJfTsKfTsKCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0U1RSSDIgPSBmdW5jdGlvbihyZCwgcm4sIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUuc3RvcmUxNihncHJzW3JuXSArIGdwcnNbcm1dLCBncHJzW3JkXSk7CgkJY3B1Lm1tdS53YWl0KGdwcnNbY3B1LlBDXSk7CgkJY3B1Lm1tdS53YWl0KGdwcnNbcm5dICsgZ3Byc1tybV0pOwoJfQp9OwoKQVJNQ29yZVRodW1iLnByb3RvdHlwZS5jb25zdHJ1Y3RTVUIxID0gZnVuY3Rpb24ocmQsIHJuLCBpbW1lZGlhdGUpIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQl2YXIgZCA9IGdwcnNbcm5dIC0gaW1tZWRpYXRlOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gKGdwcnNbcm5dID4+PiAwKSA+PSBpbW1lZGlhdGU7CgkJY3B1LmNwc3JWID0gKGdwcnNbcm5dID4+IDMxKSAmJiAoKGdwcnNbcm5dIF4gZCkgPj4gMzEpOwoJCWdwcnNbcmRdID0gZDsKCX07Cn0KCkFSTUNvcmVUaHVtYi5wcm90b3R5cGUuY29uc3RydWN0U1VCMiA9IGZ1bmN0aW9uKHJuLCBpbW1lZGlhdGUpIHsKCXZhciBjcHUgPSB0aGlzLmNwdTsKCXZhciBncHJzID0gY3B1LmdwcnM7CglyZXR1cm4gZnVuY3Rpb24oKSB7CgkJY3B1Lm1tdS53YWl0UHJlZmV0Y2goZ3Byc1tjcHUuUENdKTsKCQl2YXIgZCA9IGdwcnNbcm5dIC0gaW1tZWRpYXRlOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gKGdwcnNbcm5dID4+PiAwKSA+PSBpbW1lZGlhdGU7CgkJY3B1LmNwc3JWID0gKGdwcnNbcm5dID4+IDMxKSAmJiAoKGdwcnNbcm5dIF4gZCkgPj4gMzEpOwoJCWdwcnNbcm5dID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdFNVQjMgPSBmdW5jdGlvbihyZCwgcm4sIHJtKSB7Cgl2YXIgY3B1ID0gdGhpcy5jcHU7Cgl2YXIgZ3BycyA9IGNwdS5ncHJzOwoJcmV0dXJuIGZ1bmN0aW9uKCkgewoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7CgkJdmFyIGQgPSBncHJzW3JuXSAtIGdwcnNbcm1dOwoJCWNwdS5jcHNyTiA9IGQgPj4gMzE7CgkJY3B1LmNwc3JaID0gIShkICYgMHhGRkZGRkZGRik7CgkJY3B1LmNwc3JDID0gKGdwcnNbcm5dID4+PiAwKSA+PSAoZ3Byc1tybV0gPj4+IDApOwoJCWNwdS5jcHNyViA9IChncHJzW3JuXSA+PiAzMSkgIT0gKGdwcnNbcm1dID4+IDMxKSAmJgoJCQkJCShncHJzW3JuXSA+PiAzMSkgIT0gKGQgPj4gMzEpOwoJCWdwcnNbcmRdID0gZDsKCX07Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdFNXSSA9IGZ1bmN0aW9uKGltbWVkaWF0ZSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUuaXJxLnN3aShpbW1lZGlhdGUpOwoJCWNwdS5tbXUud2FpdFByZWZldGNoKGdwcnNbY3B1LlBDXSk7Cgl9Cn07CgpBUk1Db3JlVGh1bWIucHJvdG90eXBlLmNvbnN0cnVjdFRTVCA9IGZ1bmN0aW9uKHJkLCBybSkgewoJdmFyIGNwdSA9IHRoaXMuY3B1OwoJdmFyIGdwcnMgPSBjcHUuZ3ByczsKCXJldHVybiBmdW5jdGlvbigpIHsKCQljcHUubW11LndhaXRQcmVmZXRjaChncHJzW2NwdS5QQ10pOwoJCXZhciBhbHVPdXQgPSBncHJzW3JkXSAmIGdwcnNbcm1dOwoJCWNwdS5jcHNyTiA9IGFsdU91dCA+PiAzMTsKCQljcHUuY3BzclogPSAhKGFsdU91dCAmIDB4RkZGRkZGRkYpOwoJfTsKfTsK";

const GBA_js_util_js = "T2JqZWN0LnByb3RvdHlwZS5pbmhlcml0ID0gZnVuY3Rpb24oKSB7Cglmb3IgKHZhciB2IGluIHRoaXMpIHsKCQl0aGlzW3ZdID0gdGhpc1t2XTsKCX0KfTsKCmZ1bmN0aW9uIGhleChudW1iZXIsIGxlYWRpbmcsIHVzZVByZWZpeCkgewoJaWYgKHR5cGVvZih1c2VQcmVmaXgpID09PSAndW5kZWZpbmVkJykgewoJCXVzZVByZWZpeCA9IHRydWU7Cgl9CglpZiAodHlwZW9mKGxlYWRpbmcpID09PSAndW5kZWZpbmVkJykgewoJCWxlYWRpbmcgPSA4OwoJfQoJdmFyIHN0cmluZyA9IChudW1iZXIgPj4+IDApLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpOwoJbGVhZGluZyAtPSBzdHJpbmcubGVuZ3RoOwoJaWYgKGxlYWRpbmcgPCAwKQoJCXJldHVybiBzdHJpbmc7CglyZXR1cm4gKHVzZVByZWZpeCA/ICcweCcgOiAnJykgKyBuZXcgQXJyYXkobGVhZGluZyArIDEpLmpvaW4oJzAnKSArIHN0cmluZzsKfQoKU2VyaWFsaXplciA9IHsKCVRBR19JTlQ6IDEsCglUQUdfU1RSSU5HOiAyLAoJVEFHX1NUUlVDVDogMywKCVRBR19CTE9COiA0LAoJVEFHX0JPT0xFQU46IDUsCglUWVBFOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJywKCglwb2ludGVyOiBmdW5jdGlvbigpIHsKCQl0aGlzLmluZGV4ID0gMDsKCQl0aGlzLnRvcCA9IDA7CgkJdGhpcy5zdGFjayA9IFtdOwoJfSwKCglwYWNrOiBmdW5jdGlvbih2YWx1ZSkgewoJCXZhciBvYmplY3QgPSBuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKDQpKTsKCQlvYmplY3Quc2V0VWludDMyKDAsIHZhbHVlLCB0cnVlKTsKCQlyZXR1cm4gb2JqZWN0LmJ1ZmZlcjsKCX0sCgoJcGFjazg6IGZ1bmN0aW9uKHZhbHVlKSB7CgkJdmFyIG9iamVjdCA9IG5ldyBEYXRhVmlldyhuZXcgQXJyYXlCdWZmZXIoMSkpOwoJCW9iamVjdC5zZXRVaW50OCgwLCB2YWx1ZSwgdHJ1ZSk7CgkJcmV0dXJuIG9iamVjdC5idWZmZXI7Cgl9LAoKCXByZWZpeDogZnVuY3Rpb24odmFsdWUpIHsKCQlyZXR1cm4gbmV3IEJsb2IoW1NlcmlhbGl6ZXIucGFjayh2YWx1ZS5zaXplIHx8IHZhbHVlLmxlbmd0aCB8fCB2YWx1ZS5ieXRlTGVuZ3RoKSwgdmFsdWVdLCB7IHR5cGU6IFNlcmlhbGl6ZXIuVFlQRSB9KTsKCX0sCgoJc2VyaWFsaXplOiBmdW5jdGlvbihzdHJlYW0pIHsKCQl2YXIgcGFydHMgPSBbXTsKCQl2YXIgc2l6ZSA9IDQ7CgkJZm9yIChpIGluIHN0cmVhbSkgewoJCQlpZiAoc3RyZWFtLmhhc093blByb3BlcnR5KGkpKSB7CgkJCQl2YXIgdGFnOwoJCQkJdmFyIGhlYWQgPSBTZXJpYWxpemVyLnByZWZpeChpKTsKCQkJCXZhciBib2R5OwoJCQkJc3dpdGNoICh0eXBlb2Yoc3RyZWFtW2ldKSkgewoJCQkJY2FzZSAnbnVtYmVyJzoKCQkJCQl0YWcgPSBTZXJpYWxpemVyLlRBR19JTlQ7CgkJCQkJYm9keSA9IFNlcmlhbGl6ZXIucGFjayhzdHJlYW1baV0pOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAnc3RyaW5nJzoKCQkJCQl0YWcgPSBTZXJpYWxpemVyLlRBR19TVFJJTkc7CgkJCQkJYm9keSA9IFNlcmlhbGl6ZXIucHJlZml4KHN0cmVhbVtpXSk7CgkJCQkJYnJlYWs7CgkJCQljYXNlICdvYmplY3QnOgoJCQkJCWlmIChzdHJlYW1baV0udHlwZSA9PSBTZXJpYWxpemVyLlRZUEUpIHsKCQkJCQkJdGFnID0gU2VyaWFsaXplci5UQUdfQkxPQjsKCQkJCQkJYm9keSA9IHN0cmVhbVtpXTsKCQkJCQl9IGVsc2UgewoJCQkJCQl0YWcgPSBTZXJpYWxpemVyLlRBR19TVFJVQ1Q7CgkJCQkJCWJvZHkgPSBTZXJpYWxpemVyLnNlcmlhbGl6ZShzdHJlYW1baV0pOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgJ2Jvb2xlYW4nOgoJCQkJCXRhZyA9IFNlcmlhbGl6ZXIuVEFHX0JPT0xFQU47CgkJCQkJYm9keSA9IFNlcmlhbGl6ZXIucGFjazgoc3RyZWFtW2ldKTsKCQkJCQlicmVhazsKCQkJCWRlZmF1bHQ6CgkJCQkJY29uc29sZS5sb2coc3RyZWFtW2ldKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCXNpemUgKz0gMSArIGhlYWQuc2l6ZSArIChib2R5LnNpemUgfHwgYm9keS5ieXRlTGVuZ3RoIHx8IGJvZHkubGVuZ3RoKTsKCQkJCXBhcnRzLnB1c2goU2VyaWFsaXplci5wYWNrOCh0YWcpKTsKCQkJCXBhcnRzLnB1c2goaGVhZCk7CgkJCQlwYXJ0cy5wdXNoKGJvZHkpOwoJCQl9CgkJfQoJCXBhcnRzLnVuc2hpZnQoU2VyaWFsaXplci5wYWNrKHNpemUpKTsKCQlyZXR1cm4gbmV3IEJsb2IocGFydHMpOwoJfSwKCglkZXNlcmlhbGl6ZTogZnVuY3Rpb24oYmxvYiwgY2FsbGJhY2spIHsKCQl2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCQlyZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZGF0YSkgewoJCQljYWxsYmFjayhTZXJpYWxpemVyLmRlc2VyZWFsaXplU3RyZWFtKG5ldyBEYXRhVmlldyhkYXRhLnRhcmdldC5yZXN1bHQpLCBuZXcgU2VyaWFsaXplci5wb2ludGVyKSk7CgkJfQoJCXJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKTsKCX0sCgoJZGVzZXJlYWxpemVTdHJlYW06IGZ1bmN0aW9uKHZpZXcsIHBvaW50ZXIpIHsKCQlwb2ludGVyLnB1c2goKTsKCQl2YXIgb2JqZWN0ID0ge307CgkJdmFyIHJlbWFpbmluZyA9IHZpZXcuZ2V0VWludDMyKHBvaW50ZXIuYWR2YW5jZSg0KSwgdHJ1ZSk7CgkJd2hpbGUgKHBvaW50ZXIubWFyaygpIDwgcmVtYWluaW5nKSB7CgkJCXZhciB0YWcgPSB2aWV3LmdldFVpbnQ4KHBvaW50ZXIuYWR2YW5jZSgxKSk7CgkJCXZhciBoZWFkID0gcG9pbnRlci5yZWFkU3RyaW5nKHZpZXcpOwoJCQl2YXIgYm9keTsKCQkJc3dpdGNoICh0YWcpIHsKCQkJY2FzZSBTZXJpYWxpemVyLlRBR19JTlQ6CgkJCQlib2R5ID0gdmlldy5nZXRVaW50MzIocG9pbnRlci5hZHZhbmNlKDQpLCB0cnVlKTsKCQkJCWJyZWFrOwoJCQljYXNlIFNlcmlhbGl6ZXIuVEFHX1NUUklORzoKCQkJCWJvZHkgPSBwb2ludGVyLnJlYWRTdHJpbmcodmlldyk7CgkJCQlicmVhazsKCQkJY2FzZSBTZXJpYWxpemVyLlRBR19TVFJVQ1Q6CgkJCQlib2R5ID0gU2VyaWFsaXplci5kZXNlcmVhbGl6ZVN0cmVhbSh2aWV3LCBwb2ludGVyKTsKCQkJCWJyZWFrOwoJCQljYXNlIFNlcmlhbGl6ZXIuVEFHX0JMT0I6CgkJCQl2YXIgc2l6ZSA9IHZpZXcuZ2V0VWludDMyKHBvaW50ZXIuYWR2YW5jZSg0KSwgdHJ1ZSk7CgkJCQlib2R5ID0gdmlldy5idWZmZXIuc2xpY2UocG9pbnRlci5hZHZhbmNlKHNpemUpLCBwb2ludGVyLmFkdmFuY2UoMCkpOwoJCQkJYnJlYWs7CgkJCWNhc2UgU2VyaWFsaXplci5UQUdfQk9PTEVBTjoKCQkJCWJvZHkgPSAhIXZpZXcuZ2V0VWludDgocG9pbnRlci5hZHZhbmNlKDEpKTsKCQkJCWJyZWFrOwoJCQl9CgkJCW9iamVjdFtoZWFkXSA9IGJvZHk7CgkJfQoJCWlmIChwb2ludGVyLm1hcmsoKSA+IHJlbWFpbmluZykgewoJCQl0aHJvdyAiU2l6ZSBvZiBzZXJpYWxpemVkIGRhdGEgZXhjZWVkZWQiOwoJCX0KCQlwb2ludGVyLnBvcCgpOwoJCXJldHVybiBvYmplY3Q7Cgl9LAoKCXNlcmlhbGl6ZVBORzogZnVuY3Rpb24oYmxvYiwgYmFzZSwgY2FsbGJhY2spIHsKCQl2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CgkJdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKCQl2YXIgcGl4ZWxzID0gYmFzZS5nZXRDb250ZXh0KCcyZCcpLmdldEltYWdlRGF0YSgwLCAwLCBiYXNlLndpZHRoLCBiYXNlLmhlaWdodCk7CgkJdmFyIHRyYW5zcGFyZW50ID0gMDsKCQlmb3IgKHZhciB5ID0gMDsgeSA8IGJhc2UuaGVpZ2h0OyArK3kpIHsKCQkJZm9yICh2YXIgeCA9IDA7IHggPCBiYXNlLndpZHRoOyArK3gpIHsKCQkJCWlmICghcGl4ZWxzLmRhdGFbKHggKyB5ICogYmFzZS53aWR0aCkgKiA0ICsgM10pIHsKCQkJCQkrK3RyYW5zcGFyZW50OwoJCQkJfQoJCQl9CgkJfQoJCXZhciBieXRlc0luQ2FudmFzID0gdHJhbnNwYXJlbnQgKiAzICsgKGJhc2Uud2lkdGggKiBiYXNlLmhlaWdodCAtIHRyYW5zcGFyZW50KTsKCQlmb3IgKHZhciBtdWx0aXBsaWVyID0gMTsgKGJ5dGVzSW5DYW52YXMgKiBtdWx0aXBsaWVyICogbXVsdGlwbGllcikgPCBibG9iLnNpemU7ICsrbXVsdGlwbGllcik7CgkJdmFyIGVkZ2VzID0gYnl0ZXNJbkNhbnZhcyAqIG11bHRpcGxpZXIgKiBtdWx0aXBsaWVyIC0gYmxvYi5zaXplOwoJCXZhciBwYWRkaW5nID0gTWF0aC5jZWlsKGVkZ2VzIC8gKGJhc2Uud2lkdGggKiBtdWx0aXBsaWVyKSk7CgkJY2FudmFzLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBiYXNlLndpZHRoICogbXVsdGlwbGllcik7CgkJY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgYmFzZS5oZWlnaHQgKiBtdWx0aXBsaWVyICsgcGFkZGluZyk7CgoJCXZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoJCXJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihkYXRhKSB7CgkJCXZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS50YXJnZXQucmVzdWx0KTsKCQkJdmFyIHBvaW50ZXIgPSAwOwoJCQl2YXIgcGl4ZWxQb2ludGVyID0gMDsKCQkJdmFyIG5ld1BpeGVscyA9IGNvbnRleHQuY3JlYXRlSW1hZ2VEYXRhKGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCArIHBhZGRpbmcpOwoJCQlmb3IgKHZhciB5ID0gMDsgeSA8IGNhbnZhcy5oZWlnaHQ7ICsreSkgewoJCQkJZm9yICh2YXIgeCA9IDA7IHggPCBjYW52YXMud2lkdGg7ICsreCkgewoJCQkJCXZhciBvbGRZID0gKHkgLyBtdWx0aXBsaWVyKSB8IDA7CgkJCQkJdmFyIG9sZFggPSAoeCAvIG11bHRpcGxpZXIpIHwgMDsKCQkJCQlpZiAob2xkWSA+IGJhc2UuaGVpZ2h0IHx8ICFwaXhlbHMuZGF0YVsob2xkWCArIG9sZFkgKiBiYXNlLndpZHRoKSAqIDQgKyAzXSkgewoJCQkJCQluZXdQaXhlbHMuZGF0YVtwaXhlbFBvaW50ZXIrK10gPSB2aWV3W3BvaW50ZXIrK107CgkJCQkJCW5ld1BpeGVscy5kYXRhW3BpeGVsUG9pbnRlcisrXSA9IHZpZXdbcG9pbnRlcisrXTsKCQkJCQkJbmV3UGl4ZWxzLmRhdGFbcGl4ZWxQb2ludGVyKytdID0gdmlld1twb2ludGVyKytdOwoJCQkJCQluZXdQaXhlbHMuZGF0YVtwaXhlbFBvaW50ZXIrK10gPSAwOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXZhciBieXRlID0gdmlld1twb2ludGVyKytdOwoJCQkJCQluZXdQaXhlbHMuZGF0YVtwaXhlbFBvaW50ZXIrK10gPSBwaXhlbHMuZGF0YVsob2xkWCArIG9sZFkgKiBiYXNlLndpZHRoKSAqIDQgKyAwXSB8IChieXRlICYgNyk7CgkJCQkJCW5ld1BpeGVscy5kYXRhW3BpeGVsUG9pbnRlcisrXSA9IHBpeGVscy5kYXRhWyhvbGRYICsgb2xkWSAqIGJhc2Uud2lkdGgpICogNCArIDFdIHwgKChieXRlID4+IDMpICYgNyk7CgkJCQkJCW5ld1BpeGVscy5kYXRhW3BpeGVsUG9pbnRlcisrXSA9IHBpeGVscy5kYXRhWyhvbGRYICsgb2xkWSAqIGJhc2Uud2lkdGgpICogNCArIDJdIHwgKChieXRlID4+IDYpICYgNyk7CgkJCQkJCW5ld1BpeGVscy5kYXRhW3BpeGVsUG9pbnRlcisrXSA9IHBpeGVscy5kYXRhWyhvbGRYICsgb2xkWSAqIGJhc2Uud2lkdGgpICogNCArIDNdOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQljb250ZXh0LnB1dEltYWdlRGF0YShuZXdQaXhlbHMsIDAsIDApOwoJCQljYWxsYmFjayhjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSk7CgkJfQoJCXJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKTsKCQlyZXR1cm4gY2FudmFzOwoJfSwKCglkZXNlcmlhbGl6ZVBORzogZnVuY3Rpb24oYmxvYiwgY2FsbGJhY2spIHsKCQl2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCQlyZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZGF0YSkgewoJCQl2YXIgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsKCQkJaW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBkYXRhLnRhcmdldC5yZXN1bHQpOwoJCQl2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CgkJCWNhbnZhcy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIGltYWdlLmhlaWdodCk7CgkJCWNhbnZhcy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgaW1hZ2Uud2lkdGgpOwoJCQl2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwoJCQljb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CgkJCXZhciBwaXhlbHMgPSBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpOwoJCQl2YXIgZGF0YSA9IFtdOwoJCQlmb3IgKHZhciB5ID0gMDsgeSA8IGNhbnZhcy5oZWlnaHQ7ICsreSkgewoJCQkJZm9yICh2YXIgeCA9IDA7IHggPCBjYW52YXMud2lkdGg7ICsreCkgewoJCQkJCWlmICghcGl4ZWxzLmRhdGFbKHggKyB5ICogY2FudmFzLndpZHRoKSAqIDQgKyAzXSkgewoJCQkJCQlkYXRhLnB1c2gocGl4ZWxzLmRhdGFbKHggKyB5ICogY2FudmFzLndpZHRoKSAqIDQgKyAwXSk7CgkJCQkJCWRhdGEucHVzaChwaXhlbHMuZGF0YVsoeCArIHkgKiBjYW52YXMud2lkdGgpICogNCArIDFdKTsKCQkJCQkJZGF0YS5wdXNoKHBpeGVscy5kYXRhWyh4ICsgeSAqIGNhbnZhcy53aWR0aCkgKiA0ICsgMl0pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXZhciBieXRlID0gMDsKCQkJCQkJYnl0ZSB8PSBwaXhlbHMuZGF0YVsoeCArIHkgKiBjYW52YXMud2lkdGgpICogNCArIDBdICYgNzsKCQkJCQkJYnl0ZSB8PSAocGl4ZWxzLmRhdGFbKHggKyB5ICogY2FudmFzLndpZHRoKSAqIDQgKyAxXSAmIDcpIDw8IDM7CgkJCQkJCWJ5dGUgfD0gKHBpeGVscy5kYXRhWyh4ICsgeSAqIGNhbnZhcy53aWR0aCkgKiA0ICsgMl0gJiA3KSA8PCA2OwoJCQkJCQlkYXRhLnB1c2goYnl0ZSk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCW5ld0Jsb2IgPSBuZXcgQmxvYihkYXRhLm1hcChmdW5jdGlvbiAoYnl0ZSkgewoJCQkJdmFyIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoMSk7CgkJCQlhcnJheVswXSA9IGJ5dGU7CgkJCQlyZXR1cm4gYXJyYXk7CgkJCX0pLCB7IHR5cGU6IFNlcmlhbGl6ZXIuVFlQRX0pOwoJCQlTZXJpYWxpemVyLmRlc2VyaWFsaXplKG5ld0Jsb2IsIGNhbGxiYWNrKTsKCQl9CgkJcmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYik7Cgl9Cn07CgpTZXJpYWxpemVyLnBvaW50ZXIucHJvdG90eXBlLmFkdmFuY2UgPSBmdW5jdGlvbihhbW91bnQpIHsKCXZhciBpbmRleCA9IHRoaXMuaW5kZXg7Cgl0aGlzLmluZGV4ICs9IGFtb3VudDsKCXJldHVybiBpbmRleDsKfTsKClNlcmlhbGl6ZXIucG9pbnRlci5wcm90b3R5cGUubWFyayA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuIHRoaXMuaW5kZXggLSB0aGlzLnRvcDsKfTsKClNlcmlhbGl6ZXIucG9pbnRlci5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uKCkgewoJdGhpcy5zdGFjay5wdXNoKHRoaXMudG9wKTsKCXRoaXMudG9wID0gdGhpcy5pbmRleDsKfTsKClNlcmlhbGl6ZXIucG9pbnRlci5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24oKSB7Cgl0aGlzLnRvcCA9IHRoaXMuc3RhY2sucG9wKCk7Cn07CgpTZXJpYWxpemVyLnBvaW50ZXIucHJvdG90eXBlLnJlYWRTdHJpbmcgPSBmdW5jdGlvbih2aWV3KSB7Cgl2YXIgbGVuZ3RoID0gdmlldy5nZXRVaW50MzIodGhpcy5hZHZhbmNlKDQpLCB0cnVlKTsKCXZhciBieXRlcyA9IFtdOwoJZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7ICsraSkgewoJCWJ5dGVzLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSh2aWV3LmdldFVpbnQ4KHRoaXMuYWR2YW5jZSgxKSkpKTsKCX0KCXJldHVybiBieXRlcy5qb2luKCcnKTsKfTsK";

const GBA_js_video_js = "ZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VWaWRlbygpIHsKCXRoaXMucmVuZGVyUGF0aCA9IG5ldyBHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIoKTsKCgl0aGlzLkNZQ0xFU19QRVJfUElYRUwgPSA0OwoKCXRoaXMuSE9SSVpPTlRBTF9QSVhFTFMgPSAyNDA7Cgl0aGlzLkhCTEFOS19QSVhFTFMgPSA2ODsKCXRoaXMuSERSQVdfTEVOR1RIID0gMTAwNjsKCXRoaXMuSEJMQU5LX0xFTkdUSCA9IDIyNjsKCXRoaXMuSE9SSVpPTlRBTF9MRU5HVEggPSAxMjMyOwoKCXRoaXMuVkVSVElDQUxfUElYRUxTID0gMTYwOwoJdGhpcy5WQkxBTktfUElYRUxTID0gNjg7Cgl0aGlzLlZFUlRJQ0FMX1RPVEFMX1BJWEVMUyA9IDIyODsKCgl0aGlzLlRPVEFMX0xFTkdUSCA9IDI4MDg5NjsKCgl0aGlzLmRyYXdDYWxsYmFjayA9IGZ1bmN0aW9uKCkge307Cgl0aGlzLnZibGFua0NhbGxiYWNrID0gZnVuY3Rpb24oKSB7fTsKfTsKCkdhbWVCb3lBZHZhbmNlVmlkZW8ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7Cgl0aGlzLnJlbmRlclBhdGguY2xlYXIodGhpcy5jcHUubW11KTsKCgkvLyBESVNQU1RBVAoJdGhpcy5ESVNQU1RBVF9NQVNLID0gMHhGRjM4OwoJdGhpcy5pbkhibGFuayA9IGZhbHNlOwoJdGhpcy5pblZibGFuayA9IGZhbHNlOwoJdGhpcy52Y291bnRlciA9IDA7Cgl0aGlzLnZibGFua0lSUSA9IDA7Cgl0aGlzLmhibGFua0lSUSA9IDA7Cgl0aGlzLnZjb3VudGVySVJRID0gMDsKCXRoaXMudmNvdW50U2V0dGluZyA9IDA7CgoJLy8gVkNPVU5UCgl0aGlzLnZjb3VudCA9IC0xOwoKCXRoaXMubGFzdEhibGFuayA9IDA7Cgl0aGlzLm5leHRIYmxhbmsgPSB0aGlzLkhEUkFXX0xFTkdUSDsKCXRoaXMubmV4dEV2ZW50ID0gdGhpcy5uZXh0SGJsYW5rOwoKCXRoaXMubmV4dEhibGFua0lSUSA9IDA7Cgl0aGlzLm5leHRWYmxhbmtJUlEgPSAwOwoJdGhpcy5uZXh0VmNvdW50ZXJJUlEgPSAwOwp9OwoKR2FtZUJveUFkdmFuY2VWaWRlby5wcm90b3R5cGUuZnJlZXplID0gZnVuY3Rpb24oKSB7CglyZXR1cm4gewoJCSdpbkhibGFuayc6IHRoaXMuaW5IYmxhbmssCgkJJ2luVmJsYW5rJzogdGhpcy5pblZibGFuaywKCQkndmNvdW50ZXInOiB0aGlzLnZjb3VudGVyLAoJCSd2YmxhbmtJUlEnOiB0aGlzLnZibGFua0lSUSwKCQknaGJsYW5rSVJRJzogdGhpcy5oYmxhbmtJUlEsCgkJJ3Zjb3VudGVySVJRJzogdGhpcy52Y291bnRlcklSUSwKCQkndmNvdW50U2V0dGluZyc6IHRoaXMudmNvdW50U2V0dGluZywKCQkndmNvdW50JzogdGhpcy52Y291bnQsCgkJJ2xhc3RIYmxhbmsnOiB0aGlzLmxhc3RIYmxhbmssCgkJJ25leHRIYmxhbmsnOiB0aGlzLm5leHRIYmxhbmssCgkJJ25leHRFdmVudCc6IHRoaXMubmV4dEV2ZW50LAoJCSduZXh0SGJsYW5rSVJRJzogdGhpcy5uZXh0SGJsYW5rSVJRLAoJCSduZXh0VmJsYW5rSVJRJzogdGhpcy5uZXh0VmJsYW5rSVJRLAoJCSduZXh0VmNvdW50ZXJJUlEnOiB0aGlzLm5leHRWY291bnRlcklSUSwKCQkncmVuZGVyUGF0aCc6IHRoaXMucmVuZGVyUGF0aC5mcmVlemUodGhpcy5jb3JlLmVuY29kZUJhc2U2NCkKCX07Cn07CgpHYW1lQm95QWR2YW5jZVZpZGVvLnByb3RvdHlwZS5kZWZyb3N0ID0gZnVuY3Rpb24oZnJvc3QpIHsKCXRoaXMuaW5IYmxhbmsgPSBmcm9zdC5pbkhibGFuazsKCXRoaXMuaW5WYmxhbmsgPSBmcm9zdC5pblZibGFuazsKCXRoaXMudmNvdW50ZXIgPSBmcm9zdC52Y291bnRlcjsKCXRoaXMudmJsYW5rSVJRID0gZnJvc3QudmJsYW5rSVJROwoJdGhpcy5oYmxhbmtJUlEgPSBmcm9zdC5oYmxhbmtJUlE7Cgl0aGlzLnZjb3VudGVySVJRID0gZnJvc3QudmNvdW50ZXJJUlE7Cgl0aGlzLnZjb3VudFNldHRpbmcgPSBmcm9zdC52Y291bnRTZXR0aW5nOwoJdGhpcy52Y291bnQgPSBmcm9zdC52Y291bnQ7Cgl0aGlzLmxhc3RIYmxhbmsgPSBmcm9zdC5sYXN0SGJsYW5rOwoJdGhpcy5uZXh0SGJsYW5rID0gZnJvc3QubmV4dEhibGFuazsKCXRoaXMubmV4dEV2ZW50ID0gZnJvc3QubmV4dEV2ZW50OwoJdGhpcy5uZXh0SGJsYW5rSVJRID0gZnJvc3QubmV4dEhibGFua0lSUTsKCXRoaXMubmV4dFZibGFua0lSUSA9IGZyb3N0Lm5leHRWYmxhbmtJUlE7Cgl0aGlzLm5leHRWY291bnRlcklSUSA9IGZyb3N0Lm5leHRWY291bnRlcklSUTsKCXRoaXMucmVuZGVyUGF0aC5kZWZyb3N0KGZyb3N0LnJlbmRlclBhdGgsIHRoaXMuY29yZS5kZWNvZGVCYXNlNjQpOwp9OwoKR2FtZUJveUFkdmFuY2VWaWRlby5wcm90b3R5cGUuc2V0QmFja2luZyA9IGZ1bmN0aW9uKGJhY2tpbmcpIHsKCXZhciBwaXhlbERhdGEgPSBiYWNraW5nLmNyZWF0ZUltYWdlRGF0YSh0aGlzLkhPUklaT05UQUxfUElYRUxTLCB0aGlzLlZFUlRJQ0FMX1BJWEVMUyk7Cgl0aGlzLmNvbnRleHQgPSBiYWNraW5nOwoKCS8vIENsZWFyIGJhY2tpbmcgZmlyc3QKCWZvciAodmFyIG9mZnNldCA9IDA7IG9mZnNldCA8IHRoaXMuSE9SSVpPTlRBTF9QSVhFTFMgKiB0aGlzLlZFUlRJQ0FMX1BJWEVMUyAqIDQ7KSB7CgkJcGl4ZWxEYXRhLmRhdGFbb2Zmc2V0KytdID0gMHhGRjsKCQlwaXhlbERhdGEuZGF0YVtvZmZzZXQrK10gPSAweEZGOwoJCXBpeGVsRGF0YS5kYXRhW29mZnNldCsrXSA9IDB4RkY7CgkJcGl4ZWxEYXRhLmRhdGFbb2Zmc2V0KytdID0gMHhGRjsKCX0KCgl0aGlzLnJlbmRlclBhdGguc2V0QmFja2luZyhwaXhlbERhdGEpOwp9CgpHYW1lQm95QWR2YW5jZVZpZGVvLnByb3RvdHlwZS51cGRhdGVUaW1lcnMgPSBmdW5jdGlvbihjcHUpIHsKCXZhciBjeWNsZXMgPSBjcHUuY3ljbGVzOwoKCWlmICh0aGlzLm5leHRFdmVudCA8PSBjeWNsZXMpIHsKCQlpZiAodGhpcy5pbkhibGFuaykgewoJCQkvLyBFbmQgSGJsYW5rCgkJCXRoaXMuaW5IYmxhbmsgPSBmYWxzZTsKCQkJdGhpcy5uZXh0RXZlbnQgPSB0aGlzLm5leHRIYmxhbms7CgoJCQkrK3RoaXMudmNvdW50OwoKCQkJc3dpdGNoICh0aGlzLnZjb3VudCkgewoJCQljYXNlIHRoaXMuVkVSVElDQUxfUElYRUxTOgoJCQkJdGhpcy5pblZibGFuayA9IHRydWU7CgkJCQl0aGlzLnJlbmRlclBhdGguZmluaXNoRHJhdyh0aGlzKTsKCQkJCXRoaXMubmV4dFZibGFua0lSUSA9IHRoaXMubmV4dEV2ZW50ICsgdGhpcy5UT1RBTF9MRU5HVEg7CgkJCQl0aGlzLmNwdS5tbXUucnVuVmJsYW5rRG1hcygpOwoJCQkJaWYgKHRoaXMudmJsYW5rSVJRKSB7CgkJCQkJdGhpcy5jcHUuaXJxLnJhaXNlSVJRKHRoaXMuY3B1LmlycS5JUlFfVkJMQU5LKTsKCQkJCX0KCQkJCXRoaXMudmJsYW5rQ2FsbGJhY2soKTsKCQkJCWJyZWFrOwoJCQljYXNlIHRoaXMuVkVSVElDQUxfVE9UQUxfUElYRUxTIC0gMToKCQkJCXRoaXMuaW5WYmxhbmsgPSBmYWxzZTsKCQkJCWJyZWFrOwoJCQljYXNlIHRoaXMuVkVSVElDQUxfVE9UQUxfUElYRUxTOgoJCQkJdGhpcy52Y291bnQgPSAwOwoJCQkJdGhpcy5yZW5kZXJQYXRoLnN0YXJ0RHJhdygpOwoJCQkJYnJlYWs7CgkJCX0KCgkJCXRoaXMudmNvdW50ZXIgPSB0aGlzLnZjb3VudCA9PSB0aGlzLnZjb3VudFNldHRpbmc7CgkJCWlmICh0aGlzLnZjb3VudGVyICYmIHRoaXMudmNvdW50ZXJJUlEpIHsKCQkJCXRoaXMuY3B1LmlycS5yYWlzZUlSUSh0aGlzLmNwdS5pcnEuSVJRX1ZDT1VOVEVSKTsKCQkJCXRoaXMubmV4dFZjb3VudGVySVJRICs9IHRoaXMuVE9UQUxfTEVOR1RIOwoJCQl9CgoJCQlpZiAodGhpcy52Y291bnQgPCB0aGlzLlZFUlRJQ0FMX1BJWEVMUykgewoJCQkJdGhpcy5yZW5kZXJQYXRoLmRyYXdTY2FubGluZSh0aGlzLnZjb3VudCk7CgkJCX0KCQl9IGVsc2UgewoJCQkvLyBCZWdpbiBIYmxhbmsKCQkJdGhpcy5pbkhibGFuayA9IHRydWU7CgkJCXRoaXMubGFzdEhibGFuayA9IHRoaXMubmV4dEhibGFuazsKCQkJdGhpcy5uZXh0RXZlbnQgPSB0aGlzLmxhc3RIYmxhbmsgKyB0aGlzLkhCTEFOS19MRU5HVEg7CgkJCXRoaXMubmV4dEhibGFuayA9IHRoaXMubmV4dEV2ZW50ICsgdGhpcy5IRFJBV19MRU5HVEg7CgkJCXRoaXMubmV4dEhibGFua0lSUSA9IHRoaXMubmV4dEhibGFuazsKCgkJCWlmICh0aGlzLnZjb3VudCA8IHRoaXMuVkVSVElDQUxfUElYRUxTKSB7CgkJCQl0aGlzLmNwdS5tbXUucnVuSGJsYW5rRG1hcygpOwoJCQl9CgkJCWlmICh0aGlzLmhibGFua0lSUSkgewoJCQkJdGhpcy5jcHUuaXJxLnJhaXNlSVJRKHRoaXMuY3B1LmlycS5JUlFfSEJMQU5LKTsKCQkJfQoJCX0KCX0KfTsKCkdhbWVCb3lBZHZhbmNlVmlkZW8ucHJvdG90eXBlLndyaXRlRGlzcGxheVN0YXQgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy52YmxhbmtJUlEgPSB2YWx1ZSAmIDB4MDAwODsKCXRoaXMuaGJsYW5rSVJRID0gdmFsdWUgJiAweDAwMTA7Cgl0aGlzLnZjb3VudGVySVJRID0gdmFsdWUgJiAweDAwMjA7Cgl0aGlzLnZjb3VudFNldHRpbmcgPSAodmFsdWUgJiAweEZGMDApID4+IDg7CgoJaWYgKHRoaXMudmNvdW50ZXJJUlEpIHsKCQkvLyBGSVhNRTogdGhpcyBjYW4gYmUgdG9vIGxhdGUgaWYgd2UncmUgaW4gdGhlIG1pZGRsZSBvZiBhbiBIYmxhbmsKCQl0aGlzLm5leHRWY291bnRlcklSUSA9IHRoaXMubmV4dEhibGFuayArIHRoaXMuSEJMQU5LX0xFTkdUSCArICh0aGlzLnZjb3VudFNldHRpbmcgLSB0aGlzLnZjb3VudCkgKiB0aGlzLkhPUklaT05UQUxfTEVOR1RIOwoJCWlmICh0aGlzLm5leHRWY291bnRlcklSUSA8IHRoaXMubmV4dEV2ZW50KSB7CgkJCXRoaXMubmV4dFZjb3VudGVySVJRICs9IHRoaXMuVE9UQUxfTEVOR1RIOwoJCX0KCX0KfTsKCkdhbWVCb3lBZHZhbmNlVmlkZW8ucHJvdG90eXBlLnJlYWREaXNwbGF5U3RhdCA9IGZ1bmN0aW9uKCkgewoJcmV0dXJuICh0aGlzLmluVmJsYW5rKSB8ICh0aGlzLmluSGJsYW5rIDw8IDEpIHwgKHRoaXMudmNvdW50ZXIgPDwgMik7Cn07CgpHYW1lQm95QWR2YW5jZVZpZGVvLnByb3RvdHlwZS5maW5pc2hEcmF3ID0gZnVuY3Rpb24ocGl4ZWxEYXRhKSB7Cgl0aGlzLmNvbnRleHQucHV0SW1hZ2VEYXRhKHBpeGVsRGF0YSwgMCwgMCk7Cgl0aGlzLmRyYXdDYWxsYmFjaygpOwp9Owo=";

const GBA_js_video_proxy_js = "ZnVuY3Rpb24gTWVtb3J5UHJveHkob3duZXIsIHNpemUsIGJsb2NrU2l6ZSkgewoJdGhpcy5vd25lciA9IG93bmVyOwoJdGhpcy5ibG9ja3MgPSBbXTsKCXRoaXMuYmxvY2tTaXplID0gYmxvY2tTaXplOwoJdGhpcy5tYXNrID0gKDEgPDwgYmxvY2tTaXplKSAtIDE7Cgl0aGlzLnNpemUgPSBzaXplOwoJaWYgKGJsb2NrU2l6ZSkgewoJCWZvciAodmFyIGkgPSAwOyBpIDwgKHNpemUgPj4gYmxvY2tTaXplKTsgKytpKSB7CgkJCXRoaXMuYmxvY2tzLnB1c2gobmV3IE1lbW9yeVZpZXcobmV3IEFycmF5QnVmZmVyKDEgPDwgYmxvY2tTaXplKSkpOwoJCX0KCX0gZWxzZSB7CgkJdGhpcy5ibG9ja1NpemUgPSAzMTsKCQl0aGlzLm1hc2sgPSAtMTsKCQl0aGlzLmJsb2Nrc1swXSA9IG5ldyBNZW1vcnlWaWV3KG5ldyBBcnJheUJ1ZmZlcihzaXplKSk7Cgl9Cn07CgpNZW1vcnlQcm94eS5wcm90b3R5cGUuY29tYmluZSA9IGZ1bmN0aW9uKCkgewoJaWYgKHRoaXMuYmxvY2tzLmxlbmd0aCA+IDEpIHsKCQl2YXIgY29tYmluZWQgPSBuZXcgVWludDhBcnJheSh0aGlzLnNpemUpOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ibG9ja3MubGVuZ3RoOyArK2kpIHsKCQkJY29tYmluZWQuc2V0KG5ldyBVaW50OEFycmF5KHRoaXMuYmxvY2tzW2ldLmJ1ZmZlciksIGkgPDwgdGhpcy5ibG9ja1NpemUpOwoJCX0KCQlyZXR1cm4gY29tYmluZWQuYnVmZmVyOwoJfSBlbHNlIHsKCQlyZXR1cm4gdGhpcy5ibG9ja3NbMF0uYnVmZmVyOwoJfQp9OwoKTWVtb3J5UHJveHkucHJvdG90eXBlLnJlcGxhY2UgPSBmdW5jdGlvbihidWZmZXIpIHsKCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ibG9ja3MubGVuZ3RoOyArK2kpIHsKCQl0aGlzLmJsb2Nrc1tpXSA9IG5ldyBNZW1vcnlWaWV3KGJ1ZmZlci5zbGljZShpIDw8IHRoaXMuYmxvY2tTaXplLCAoaSA8PCB0aGlzLmJsb2NrU2l6ZSkgKyB0aGlzLmJsb2Nrc1tpXS5idWZmZXIuYnl0ZUxlbmd0aCkpOwoJfQp9OwoKTWVtb3J5UHJveHkucHJvdG90eXBlLmxvYWQ4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5ibG9ja3Nbb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplXS5sb2FkOChvZmZzZXQgJiB0aGlzLm1hc2spOwp9OwoKTWVtb3J5UHJveHkucHJvdG90eXBlLmxvYWQxNiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMuYmxvY2tzW29mZnNldCA+PiB0aGlzLmJsb2NrU2l6ZV0ubG9hZDE2KG9mZnNldCAmIHRoaXMubWFzayk7Cn07CgpNZW1vcnlQcm94eS5wcm90b3R5cGUubG9hZFU4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5ibG9ja3Nbb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplXS5sb2FkVTgob2Zmc2V0ICYgdGhpcy5tYXNrKTsKfTsKCk1lbW9yeVByb3h5LnByb3RvdHlwZS5sb2FkVTE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5ibG9ja3Nbb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplXS5sb2FkVTE2KG9mZnNldCAmIHRoaXMubWFzayk7Cn07CgpNZW1vcnlQcm94eS5wcm90b3R5cGUubG9hZDMyID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5ibG9ja3Nbb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplXS5sb2FkMzIob2Zmc2V0ICYgdGhpcy5tYXNrKTsKfTsKCk1lbW9yeVByb3h5LnByb3RvdHlwZS5zdG9yZTggPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7CglpZiAob2Zmc2V0ID49IHRoaXMuc2l6ZSkgewoJCXJldHVybjsKCX0KCXRoaXMub3duZXIubWVtb3J5RGlydGllZCh0aGlzLCBvZmZzZXQgPj4gdGhpcy5ibG9ja1NpemUpOwoJdGhpcy5ibG9ja3Nbb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplXS5zdG9yZTgob2Zmc2V0ICYgdGhpcy5tYXNrLCB2YWx1ZSk7Cgl0aGlzLmJsb2Nrc1tvZmZzZXQgPj4gdGhpcy5ibG9ja1NpemVdLnN0b3JlOCgob2Zmc2V0ICYgdGhpcy5tYXNrKSBeIDEsIHZhbHVlKTsKfTsKCk1lbW9yeVByb3h5LnByb3RvdHlwZS5zdG9yZTE2ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJaWYgKG9mZnNldCA+PSB0aGlzLnNpemUpIHsKCQlyZXR1cm47Cgl9Cgl0aGlzLm93bmVyLm1lbW9yeURpcnRpZWQodGhpcywgb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplKTsKCXJldHVybiB0aGlzLmJsb2Nrc1tvZmZzZXQgPj4gdGhpcy5ibG9ja1NpemVdLnN0b3JlMTYob2Zmc2V0ICYgdGhpcy5tYXNrLCB2YWx1ZSk7Cn07CgpNZW1vcnlQcm94eS5wcm90b3R5cGUuc3RvcmUzMiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCWlmIChvZmZzZXQgPj0gdGhpcy5zaXplKSB7CgkJcmV0dXJuOwoJfQoJdGhpcy5vd25lci5tZW1vcnlEaXJ0aWVkKHRoaXMsIG9mZnNldCA+PiB0aGlzLmJsb2NrU2l6ZSk7CglyZXR1cm4gdGhpcy5ibG9ja3Nbb2Zmc2V0ID4+IHRoaXMuYmxvY2tTaXplXS5zdG9yZTMyKG9mZnNldCAmIHRoaXMubWFzaywgdmFsdWUpOwp9OwoKTWVtb3J5UHJveHkucHJvdG90eXBlLmludmFsaWRhdGVQYWdlID0gZnVuY3Rpb24oYWRkcmVzcykge307CgpmdW5jdGlvbiBHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5KCkgewoJdGhpcy53b3JrZXIgPSBuZXcgV29ya2VyKCdqcy92aWRlby93b3JrZXIuanMnKTsKCgl0aGlzLmN1cnJlbnRGcmFtZSA9IDA7Cgl0aGlzLmRlbGF5ID0gMDsKCXRoaXMuc2tpcEZyYW1lID0gZmFsc2U7CgoJdGhpcy5kaXJ0eSA9IG51bGw7Cgl2YXIgc2VsZiA9IHRoaXM7Cgl2YXIgaGFuZGxlcnMgPSB7CgkJZmluaXNoOiBmdW5jdGlvbihkYXRhKSB7CgkJCXNlbGYuYmFja2luZyA9IGRhdGEuYmFja2luZzsKCQkJc2VsZi5jYWxsZXIuZmluaXNoRHJhdyhzZWxmLmJhY2tpbmcpOwoJCQktLXNlbGYuZGVsYXk7CgkJfQoJfTsKCXRoaXMud29ya2VyLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHsKCQloYW5kbGVyc1ttZXNzYWdlLmRhdGFbJ3R5cGUnXV0obWVzc2FnZS5kYXRhKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLm1lbW9yeURpcnRpZWQgPSBmdW5jdGlvbihtZW0sIGJsb2NrKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkubWVtb3J5ID0gdGhpcy5kaXJ0eS5tZW1vcnkgfHwge307CglpZiAobWVtID09PSB0aGlzLnBhbGV0dGUpIHsKCQl0aGlzLmRpcnR5Lm1lbW9yeS5wYWxldHRlID0gbWVtLmJsb2Nrc1swXS5idWZmZXI7Cgl9CglpZiAobWVtID09PSB0aGlzLm9hbSkgewoJCXRoaXMuZGlydHkubWVtb3J5Lm9hbSA9IG1lbS5ibG9ja3NbMF0uYnVmZmVyOwoJfQoJaWYgKG1lbSA9PT0gdGhpcy52cmFtKSB7CgkJdGhpcy5kaXJ0eS5tZW1vcnkudnJhbSA9IHRoaXMuZGlydHkubWVtb3J5LnZyYW0gfHwgW107CgkJdGhpcy5kaXJ0eS5tZW1vcnkudnJhbVtibG9ja10gPSBtZW0uYmxvY2tzW2Jsb2NrXS5idWZmZXI7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKG1tdSkgewoJdGhpcy5wYWxldHRlID0gbmV3IE1lbW9yeVByb3h5KHRoaXMsIG1tdS5TSVpFX1BBTEVUVEVfUkFNLCAwKTsKCXRoaXMudnJhbSA9IG5ldyBNZW1vcnlQcm94eSh0aGlzLCBtbXUuU0laRV9WUkFNLCAxMyk7Cgl0aGlzLm9hbSA9IG5ldyBNZW1vcnlQcm94eSh0aGlzLCBtbXUuU0laRV9PQU0sIDApOwoKCXRoaXMuZGlydHkgPSBudWxsOwoJdGhpcy5zY2FubGluZVF1ZXVlID0gW107CgoJdGhpcy53b3JrZXIucG9zdE1lc3NhZ2UoeyB0eXBlOiAnY2xlYXInLCBTSVpFX1ZSQU06IG1tdS5TSVpFX1ZSQU0sIFNJWkVfT0FNOiBtbXUuU0laRV9PQU0gfSk7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS5mcmVlemUgPSBmdW5jdGlvbihlbmNvZGVCYXNlNjQpIHsKCXJldHVybiB7CgkJJ3BhbGV0dGUnOiBTZXJpYWxpemVyLnByZWZpeCh0aGlzLnBhbGV0dGUuY29tYmluZSgpKSwKCQkndnJhbSc6IFNlcmlhbGl6ZXIucHJlZml4KHRoaXMudnJhbS5jb21iaW5lKCkpLAoJCSdvYW0nOiBTZXJpYWxpemVyLnByZWZpeCh0aGlzLm9hbS5jb21iaW5lKCkpCgl9Owp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUuZGVmcm9zdCA9IGZ1bmN0aW9uKGZyb3N0LCBkZWNvZGVCYXNlNjQpIHsKCXRoaXMucGFsZXR0ZS5yZXBsYWNlKGZyb3N0LnBhbGV0dGUpOwoJdGhpcy5tZW1vcnlEaXJ0aWVkKHRoaXMucGFsZXR0ZSwgMCk7Cgl0aGlzLnZyYW0ucmVwbGFjZShmcm9zdC52cmFtKTsKCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52cmFtLmJsb2Nrcy5sZW5ndGg7ICsraSkgewoJCXRoaXMubWVtb3J5RGlydGllZCh0aGlzLnZyYW0sIGkpOwoJfQoJdGhpcy5vYW0ucmVwbGFjZShmcm9zdC5vYW0pOwoJdGhpcy5tZW1vcnlEaXJ0aWVkKHRoaXMub2FtLCAwKTsKfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLndyaXRlRGlzcGxheUNvbnRyb2wgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LkRJU1BDTlQgPSB2YWx1ZTsKfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZENvbnRyb2wgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuZGlydHkgPSB0aGlzLmRpcnR5IHx8IHt9OwoJdGhpcy5kaXJ0eS5CR0NOVCA9IHRoaXMuZGlydHkuQkdDTlQgfHwgW107Cgl0aGlzLmRpcnR5LkJHQ05UW2JnXSA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUud3JpdGVCYWNrZ3JvdW5kSE9mZnNldCA9IGZ1bmN0aW9uKGJnLCB2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LkJHSE9GUyA9IHRoaXMuZGlydHkuQkdIT0ZTIHx8IFtdOwoJdGhpcy5kaXJ0eS5CR0hPRlNbYmddID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZUJhY2tncm91bmRWT2Zmc2V0ID0gZnVuY3Rpb24oYmcsIHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuQkdWT0ZTID0gdGhpcy5kaXJ0eS5CR1ZPRlMgfHwgW107Cgl0aGlzLmRpcnR5LkJHVk9GU1tiZ10gPSB2YWx1ZTsKfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZFJlZlggPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuZGlydHkgPSB0aGlzLmRpcnR5IHx8IHt9OwoJdGhpcy5kaXJ0eS5CR1ggPSB0aGlzLmRpcnR5LkJHWCB8fCBbXTsKCXRoaXMuZGlydHkuQkdYW2JnXSA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUud3JpdGVCYWNrZ3JvdW5kUmVmWSA9IGZ1bmN0aW9uKGJnLCB2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LkJHWSA9IHRoaXMuZGlydHkuQkdZIHx8IFtdOwoJdGhpcy5kaXJ0eS5CR1lbYmddID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZUJhY2tncm91bmRQYXJhbUEgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuZGlydHkgPSB0aGlzLmRpcnR5IHx8IHt9OwoJdGhpcy5kaXJ0eS5CR1BBID0gdGhpcy5kaXJ0eS5CR1BBIHx8IFtdOwoJdGhpcy5kaXJ0eS5CR1BBW2JnXSA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUud3JpdGVCYWNrZ3JvdW5kUGFyYW1CID0gZnVuY3Rpb24oYmcsIHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuQkdQQiA9IHRoaXMuZGlydHkuQkdQQiB8fCBbXTsKCXRoaXMuZGlydHkuQkdQQltiZ10gPSB2YWx1ZTsKfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZFBhcmFtQyA9IGZ1bmN0aW9uKGJnLCB2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LkJHUEMgPSB0aGlzLmRpcnR5LkJHUEMgfHwgW107Cgl0aGlzLmRpcnR5LkJHUENbYmddID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZUJhY2tncm91bmRQYXJhbUQgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuZGlydHkgPSB0aGlzLmRpcnR5IHx8IHt9OwoJdGhpcy5kaXJ0eS5CR1BEID0gdGhpcy5kaXJ0eS5CR1BEIHx8IFtdOwoJdGhpcy5kaXJ0eS5CR1BEW2JnXSA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUud3JpdGVXaW4wSCA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuV0lOMEggPSB2YWx1ZTsKfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLndyaXRlV2luMUggPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LldJTjFIID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZVdpbjBWID0gZnVuY3Rpb24odmFsdWUpIHsKCXRoaXMuZGlydHkgPSB0aGlzLmRpcnR5IHx8IHt9OwoJdGhpcy5kaXJ0eS5XSU4wViA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUud3JpdGVXaW4xViA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuV0lOMVYgPSB2YWx1ZTsKfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLndyaXRlV2luSW4gPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LldJTklOID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZVdpbk91dCA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuV0lOT1VUID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZUJsZW5kQ29udHJvbCA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuQkxEQ05UID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZUJsZW5kQWxwaGEgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5LkJMREFMUEhBID0gdmFsdWU7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS53cml0ZUJsZW5kWSA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCXRoaXMuZGlydHkuQkxEWSA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUud3JpdGVNb3NhaWMgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5kaXJ0eSA9IHRoaXMuZGlydHkgfHwge307Cgl0aGlzLmRpcnR5Lk1PU0FJQyA9IHZhbHVlOwp9OwoKR2FtZUJveUFkdmFuY2VSZW5kZXJQcm94eS5wcm90b3R5cGUuY2xlYXJTdWJzZXRzID0gZnVuY3Rpb24obW11LCByZWdpb25zKSB7Cgl0aGlzLmRpcnR5ID0gdGhpcy5kaXJ0eSB8fCB7fTsKCWlmIChyZWdpb25zICYgMHgwNCkgewoJCXRoaXMucGFsZXR0ZSA9IG5ldyBNZW1vcnlQcm94eSh0aGlzLCBtbXUuU0laRV9QQUxFVFRFX1JBTSwgMCk7CgkJbW11Lm1tYXAobW11LlJFR0lPTl9QQUxFVFRFX1JBTSwgdGhpcy5wYWxldHRlKTsKCQl0aGlzLm1lbW9yeURpcnRpZWQodGhpcy5wYWxldHRlLCAwKTsKCX0KCWlmIChyZWdpb25zICYgMHgwOCkgewoJCXRoaXMudnJhbSA9IG5ldyBNZW1vcnlQcm94eSh0aGlzLCBtbXUuU0laRV9WUkFNLCAxMyk7CgkJbW11Lm1tYXAobW11LlJFR0lPTl9WUkFNLCB0aGlzLnZyYW0pOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy52cmFtLmJsb2Nrcy5sZW5ndGg7ICsraSkgewoJCQl0aGlzLm1lbW9yeURpcnRpZWQodGhpcy52cmFtLCBpKTsKCQl9Cgl9CglpZiAocmVnaW9ucyAmIDB4MTApIHsKCQl0aGlzLm9hbSA9IG5ldyBNZW1vcnlQcm94eSh0aGlzLCBtbXUuU0laRV9PQU0sIDApOwoJCW1tdS5tbWFwKG1tdS5SRUdJT05fT0FNLCB0aGlzLm9hbSk7CgkJdGhpcy5tZW1vcnlEaXJ0aWVkKHRoaXMub2FtLCAwKTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlUmVuZGVyUHJveHkucHJvdG90eXBlLnNldEJhY2tpbmcgPSBmdW5jdGlvbihiYWNraW5nKSB7Cgl0aGlzLmJhY2tpbmcgPSBiYWNraW5nOwoJdGhpcy53b3JrZXIucG9zdE1lc3NhZ2UoeyB0eXBlOiAnc3RhcnQnLCBiYWNraW5nOiB0aGlzLmJhY2tpbmcgfSk7Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS5kcmF3U2NhbmxpbmUgPSBmdW5jdGlvbih5KSB7CglpZiAoIXRoaXMuc2tpcEZyYW1lKSB7CgkJaWYgKHRoaXMuZGlydHkpIHsKCQkJaWYgKHRoaXMuZGlydHkubWVtb3J5KSB7CgkJCQlpZiAodGhpcy5kaXJ0eS5tZW1vcnkucGFsZXR0ZSkgewoJCQkJCXRoaXMuZGlydHkubWVtb3J5LnBhbGV0dGUgPSB0aGlzLmRpcnR5Lm1lbW9yeS5wYWxldHRlLnNsaWNlKDApOwoJCQkJfQoJCQkJaWYgKHRoaXMuZGlydHkubWVtb3J5Lm9hbSkgewoJCQkJCXRoaXMuZGlydHkubWVtb3J5Lm9hbSA9IHRoaXMuZGlydHkubWVtb3J5Lm9hbS5zbGljZSgwKTsKCQkJCX0KCQkJCWlmICh0aGlzLmRpcnR5Lm1lbW9yeS52cmFtKSB7CgkJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgKytpKSB7CgkJCQkJCWlmICh0aGlzLmRpcnR5Lm1lbW9yeS52cmFtW2ldKSB7CgkJCQkJCQl0aGlzLmRpcnR5Lm1lbW9yeS52cmFtW2ldID0gdGhpcy5kaXJ0eS5tZW1vcnkudnJhbVtpXS5zbGljZSgwKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCQl0aGlzLnNjYW5saW5lUXVldWUucHVzaCh7IHk6IHksIGRpcnR5OiB0aGlzLmRpcnR5IH0pOwoJCQl0aGlzLmRpcnR5ID0gbnVsbDsKCQl9Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS5zdGFydERyYXcgPSBmdW5jdGlvbigpIHsKCSsrdGhpcy5jdXJyZW50RnJhbWU7CglpZiAodGhpcy5kZWxheSA8PSAwKSB7CgkJdGhpcy5za2lwRnJhbWUgPSBmYWxzZTsKCX0KCWlmICghdGhpcy5za2lwRnJhbWUpIHsKCQkrK3RoaXMuZGVsYXk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVJlbmRlclByb3h5LnByb3RvdHlwZS5maW5pc2hEcmF3ID0gZnVuY3Rpb24oY2FsbGVyKSB7Cgl0aGlzLmNhbGxlciA9IGNhbGxlcjsKCWlmICghdGhpcy5za2lwRnJhbWUpIHsKCQl0aGlzLndvcmtlci5wb3N0TWVzc2FnZSh7IHR5cGU6ICdmaW5pc2gnLCBzY2FubGluZXM6IHRoaXMuc2NhbmxpbmVRdWV1ZSwgZnJhbWU6IHRoaXMuY3VycmVudEZyYW1lIH0pOwoJCXRoaXMuc2NhbmxpbmVRdWV1ZSA9IFtdOwoJCWlmICh0aGlzLmRlbGF5ID4gMikgewoJCQl0aGlzLnNraXBGcmFtZSA9IHRydWU7CgkJfQoJfQp9Owo=";

const GBA_js_video_software_js = "ZnVuY3Rpb24gTWVtb3J5QWxpZ25lZDE2KHNpemUpIHsKCXRoaXMuYnVmZmVyID0gbmV3IFVpbnQxNkFycmF5KHNpemUgPj4gMSk7Cn07CgpNZW1vcnlBbGlnbmVkMTYucHJvdG90eXBlLmxvYWQ4ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gKHRoaXMubG9hZFU4KG9mZnNldCkgPDwgMjQpID4+IDI0Owp9OwoKTWVtb3J5QWxpZ25lZDE2LnByb3RvdHlwZS5sb2FkMTYgPSBmdW5jdGlvbihvZmZzZXQpIHsKCXJldHVybiAodGhpcy5sb2FkVTE2KG9mZnNldCkgPDwgMTYpID4+IDE2Owp9OwoKTWVtb3J5QWxpZ25lZDE2LnByb3RvdHlwZS5sb2FkVTggPSBmdW5jdGlvbihvZmZzZXQpIHsKCXZhciBpbmRleCA9IG9mZnNldCA+PiAxOwoJaWYgKG9mZnNldCAmIDEpIHsKCQlyZXR1cm4gKHRoaXMuYnVmZmVyW2luZGV4XSAmIDB4RkYwMCkgPj4+IDg7Cgl9IGVsc2UgewoJCXJldHVybiB0aGlzLmJ1ZmZlcltpbmRleF0gJiAweDAwRkY7Cgl9Cn07CgpNZW1vcnlBbGlnbmVkMTYucHJvdG90eXBlLmxvYWRVMTYgPSBmdW5jdGlvbihvZmZzZXQpIHsKCXJldHVybiB0aGlzLmJ1ZmZlcltvZmZzZXQgPj4gMV07Cn07CgpNZW1vcnlBbGlnbmVkMTYucHJvdG90eXBlLmxvYWQzMiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMuYnVmZmVyWyhvZmZzZXQgPj4gMSkgJiB+MV0gfCAodGhpcy5idWZmZXJbKG9mZnNldCA+PiAxKSB8IDFdIDw8IDE2KTsKfTsKCk1lbW9yeUFsaWduZWQxNi5wcm90b3R5cGUuc3RvcmU4ID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdmFyIGluZGV4ID0gb2Zmc2V0ID4+IDE7Cgl0aGlzLnN0b3JlMTYob2Zmc2V0LCAodmFsdWUgPDwgOCkgfCB2YWx1ZSk7Cn07CgpNZW1vcnlBbGlnbmVkMTYucHJvdG90eXBlLnN0b3JlMTYgPSBmdW5jdGlvbihvZmZzZXQsIHZhbHVlKSB7Cgl0aGlzLmJ1ZmZlcltvZmZzZXQgPj4gMV0gPSB2YWx1ZTsKfTsKCk1lbW9yeUFsaWduZWQxNi5wcm90b3R5cGUuc3RvcmUzMiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXZhciBpbmRleCA9IG9mZnNldCA+PiAxOwoJdGhpcy5zdG9yZTE2KG9mZnNldCwgdGhpcy5idWZmZXJbaW5kZXhdID0gdmFsdWUgJiAweEZGRkYpOwoJdGhpcy5zdG9yZTE2KG9mZnNldCArIDIsIHRoaXMuYnVmZmVyW2luZGV4ICsgMV0gPSB2YWx1ZSA+Pj4gMTYpOwp9OwoKTWVtb3J5QWxpZ25lZDE2LnByb3RvdHlwZS5pbnNlcnQgPSBmdW5jdGlvbihzdGFydCwgZGF0YSkgewoJdGhpcy5idWZmZXIuc2V0KGRhdGEsIHN0YXJ0KTsKfTsKCk1lbW9yeUFsaWduZWQxNi5wcm90b3R5cGUuaW52YWxpZGF0ZVBhZ2UgPSBmdW5jdGlvbihhZGRyZXNzKSB7fTsKCmZ1bmN0aW9uIEdhbWVCb3lBZHZhbmNlVlJBTShzaXplKSB7CglNZW1vcnlBbGlnbmVkMTYuY2FsbCh0aGlzLCBzaXplKTsKCXRoaXMudnJhbSA9IHRoaXMuYnVmZmVyOwp9OwoKR2FtZUJveUFkdmFuY2VWUkFNLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTWVtb3J5QWxpZ25lZDE2LnByb3RvdHlwZSk7CgpmdW5jdGlvbiBHYW1lQm95QWR2YW5jZU9BTShzaXplKSB7CglNZW1vcnlBbGlnbmVkMTYuY2FsbCh0aGlzLCBzaXplKTsKCXRoaXMub2FtID0gdGhpcy5idWZmZXI7Cgl0aGlzLm9ianMgPSBuZXcgQXJyYXkoMTI4KTsKCWZvciAodmFyIGkgPSAwOyBpIDwgMTI4OyArK2kpIHsKCQl0aGlzLm9ianNbaV0gPSBuZXcgR2FtZUJveUFkdmFuY2VPQkoodGhpcywgaSk7Cgl9Cgl0aGlzLnNjYWxlcm90ID0gbmV3IEFycmF5KDMyKTsKCWZvciAodmFyIGkgPSAwOyBpIDwgMzI7ICsraSkgewoJCXRoaXMuc2NhbGVyb3RbaV0gPSB7CgkJCWE6IDEsCgkJCWI6IDAsCgkJCWM6IDAsCgkJCWQ6IDEKCQl9OwoJfQp9OwoKR2FtZUJveUFkdmFuY2VPQU0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNZW1vcnlBbGlnbmVkMTYucHJvdG90eXBlKTsKCkdhbWVCb3lBZHZhbmNlT0FNLnByb3RvdHlwZS5vdmVyd3JpdGUgPSBmdW5jdGlvbihtZW1vcnkpIHsKCWZvciAodmFyIGkgPSAwOyBpIDwgKHRoaXMuYnVmZmVyLmJ5dGVMZW5ndGggPj4gMSk7ICsraSkgewoJCXRoaXMuc3RvcmUxNihpIDw8IDEsIG1lbW9yeVtpXSk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZU9BTS5wcm90b3R5cGUuc3RvcmUxNiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXZhciBpbmRleCA9IChvZmZzZXQgJiAweDNGOCkgPj4gMzsKCXZhciBvYmogPSB0aGlzLm9ianNbaW5kZXhdOwoJdmFyIHNjYWxlcm90ID0gdGhpcy5zY2FsZXJvdFtpbmRleCA+PiAyXTsKCXZhciBsYXllciA9IG9iai5wcmlvcml0eTsKCXZhciBkaXNhYmxlID0gb2JqLmRpc2FibGU7Cgl2YXIgeSA9IG9iai55OwoJc3dpdGNoIChvZmZzZXQgJiAweDAwMDAwMDA2KSB7CgljYXNlIDA6CgkJLy8gQXR0cmlidXRlIDAKCQlvYmoueSA9IHZhbHVlICYgMHgwMEZGOwoJCXZhciB3YXNTY2FsZXJvdCA9IG9iai5zY2FsZXJvdDsKCQlvYmouc2NhbGVyb3QgPSB2YWx1ZSAmIDB4MDEwMDsKCQlpZiAob2JqLnNjYWxlcm90KSB7CgkJCW9iai5zY2FsZXJvdE9hbSA9IHRoaXMuc2NhbGVyb3Rbb2JqLnNjYWxlcm90UGFyYW1dOwoJCQlvYmouZG91Ymxlc2l6ZSA9ICEhKHZhbHVlICYgMHgwMjAwKTsKCQkJb2JqLmRpc2FibGUgPSAwOwoJCQlvYmouaGZsaXAgPSAwOwoJCQlvYmoudmZsaXAgPSAwOwoJCX0gZWxzZSB7CgkJCW9iai5kb3VibGVzaXplID0gZmFsc2U7CgkJCW9iai5kaXNhYmxlID0gdmFsdWUgJiAweDAyMDA7CgkJCWlmICh3YXNTY2FsZXJvdCkgewoJCQkJb2JqLmhmbGlwID0gb2JqLnNjYWxlcm90UGFyYW0gJiAweDAwMDg7CgkJCQlvYmoudmZsaXAgPSBvYmouc2NhbGVyb3RQYXJhbSAmIDB4MDAxMDsKCQkJfQoJCX0KCQlvYmoubW9kZSA9ICh2YWx1ZSAmIDB4MEMwMCkgPj4gNjsgLy8gVGhpcyBsaW5lcyB1cCB3aXRoIHRoZSBzdGVuY2lsIGZvcm1hdAoJCW9iai5tb3NhaWMgPSB2YWx1ZSAmIDB4MTAwMDsKCQlvYmoubXVsdGlwYWxldHRlID0gdmFsdWUgJiAweDIwMDA7CgkJb2JqLnNoYXBlID0gKHZhbHVlICYgMHhDMDAwKSA+PiAxNDsKCgkJb2JqLnJlY2FsY1NpemUoKTsKCQlicmVhazsKCWNhc2UgMjoKCQkvLyBBdHRyaWJ1dGUgMQoJCW9iai54ID0gdmFsdWUgJiAweDAxRkY7CgkJaWYgKG9iai5zY2FsZXJvdCkgewoJCQlvYmouc2NhbGVyb3RQYXJhbSA9ICh2YWx1ZSAmIDB4M0UwMCkgPj4gOTsKCQkJb2JqLnNjYWxlcm90T2FtID0gdGhpcy5zY2FsZXJvdFtvYmouc2NhbGVyb3RQYXJhbV07CgkJCW9iai5oZmxpcCA9IDA7CgkJCW9iai52ZmxpcCA9IDA7CgkJCW9iai5kcmF3U2NhbmxpbmUgPSBvYmouZHJhd1NjYW5saW5lQWZmaW5lOwoJCX0gZWxzZSB7CgkJCW9iai5oZmxpcCA9IHZhbHVlICYgMHgxMDAwOwoJCQlvYmoudmZsaXAgPSB2YWx1ZSAmIDB4MjAwMDsKCQkJb2JqLmRyYXdTY2FubGluZSA9IG9iai5kcmF3U2NhbmxpbmVOb3JtYWw7CgkJfQoJCW9iai5zaXplID0gKHZhbHVlICYgMHhDMDAwKSA+PiAxNDsKCgkJb2JqLnJlY2FsY1NpemUoKTsKCQlicmVhazsKCWNhc2UgNDoKCQkvLyBBdHRyaWJ1dGUgMgoJCW9iai50aWxlQmFzZSA9IHZhbHVlICYgMHgwM0ZGOwoJCW9iai5wcmlvcml0eSA9ICh2YWx1ZSAmIDB4MEMwMCkgPj4gMTA7CgkJb2JqLnBhbGV0dGUgPSAodmFsdWUgJiAweEYwMDApID4+IDg7IC8vIFRoaXMgaXMgc2hpZnRlZCB1cCA0IHRvIG1ha2UgcHVzaFBpeGVsIGZhc3RlcgoJCWJyZWFrOwoJY2FzZSA2OgoJCS8vIFNjYWxpbmcvcm90YXRpb24gcGFyYW1ldGVyCgkJc3dpdGNoIChpbmRleCAmIDB4MykgewoJCWNhc2UgMDoKCQkJc2NhbGVyb3QuYSA9ICh2YWx1ZSA8PCAxNikgLyAweDEwMDAwMDA7CgkJCWJyZWFrOwoJCWNhc2UgMToKCQkJc2NhbGVyb3QuYiA9ICh2YWx1ZSA8PCAxNikgLyAweDEwMDAwMDA7CgkJCWJyZWFrOwoJCWNhc2UgMjoKCQkJc2NhbGVyb3QuYyA9ICh2YWx1ZSA8PCAxNikgLyAweDEwMDAwMDA7CgkJCWJyZWFrOwoJCWNhc2UgMzoKCQkJc2NhbGVyb3QuZCA9ICh2YWx1ZSA8PCAxNikgLyAweDEwMDAwMDA7CgkJCWJyZWFrOwoJCX0KCQlicmVhazsKCX0KCglNZW1vcnlBbGlnbmVkMTYucHJvdG90eXBlLnN0b3JlMTYuY2FsbCh0aGlzLCBvZmZzZXQsIHZhbHVlKTsKfTsKCmZ1bmN0aW9uIEdhbWVCb3lBZHZhbmNlUGFsZXR0ZSgpIHsKCXRoaXMuY29sb3JzID0gWyBuZXcgQXJyYXkoMHgxMDApLCBuZXcgQXJyYXkoMHgxMDApIF07Cgl0aGlzLmFkanVzdGVkQ29sb3JzID0gWyBuZXcgQXJyYXkoMHgxMDApLCBuZXcgQXJyYXkoMHgxMDApIF07Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzID0gWwoJCXRoaXMuY29sb3JzWzBdLCAvLyBCRzAKCQl0aGlzLmNvbG9yc1swXSwgLy8gQkcxCgkJdGhpcy5jb2xvcnNbMF0sIC8vIEJHMgoJCXRoaXMuY29sb3JzWzBdLCAvLyBCRzMKCQl0aGlzLmNvbG9yc1sxXSwgLy8gT0JKCgkJdGhpcy5jb2xvcnNbMF0gLy8gQmFja2Ryb3AKCV07Cgl0aGlzLmJsZW5kWSA9IDE7Cn07CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLm92ZXJ3cml0ZSA9IGZ1bmN0aW9uKG1lbW9yeSkgewoJZm9yICh2YXIgaSA9IDA7IGkgPCA1MTI7ICsraSkgewoJCXRoaXMuc3RvcmUxNihpIDw8IDEsIG1lbW9yeVtpXSk7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLmxvYWRVOCA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuICh0aGlzLmxvYWRVMTYob2Zmc2V0KSA+PiAoOCAqIChvZmZzZXQgJiAxKSkpICYgMHhGRjsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUubG9hZFUxNiA9IGZ1bmN0aW9uKG9mZnNldCkgewoJcmV0dXJuIHRoaXMuY29sb3JzWyhvZmZzZXQgJiAweDIwMCkgPj4gOV1bKG9mZnNldCAmIDB4MUZGKSA+PiAxXTsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUubG9hZDE2ID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gKHRoaXMubG9hZFUxNihvZmZzZXQpIDw8IDE2KSA+PiAxNjsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUubG9hZDMyID0gZnVuY3Rpb24ob2Zmc2V0KSB7CglyZXR1cm4gdGhpcy5sb2FkVTE2KG9mZnNldCkgfCAodGhpcy5sb2FkVTE2KG9mZnNldCArIDIpIDw8IDE2KTsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUuc3RvcmUxNiA9IGZ1bmN0aW9uKG9mZnNldCwgdmFsdWUpIHsKCXZhciB0eXBlID0gKG9mZnNldCAmIDB4MjAwKSA+PiA5OwoJdmFyIGluZGV4ID0gKG9mZnNldCAmIDB4MUZGKSA+PiAxOwoJdGhpcy5jb2xvcnNbdHlwZV1baW5kZXhdID0gdmFsdWU7Cgl0aGlzLmFkanVzdGVkQ29sb3JzW3R5cGVdW2luZGV4XSA9IHRoaXMuYWRqdXN0Q29sb3IodmFsdWUpOwp9OwoKR2FtZUJveUFkdmFuY2VQYWxldHRlLnByb3RvdHlwZS5zdG9yZTMyID0gZnVuY3Rpb24ob2Zmc2V0LCB2YWx1ZSkgewoJdGhpcy5zdG9yZTE2KG9mZnNldCwgdmFsdWUgJiAweEZGRkYpOwoJdGhpcy5zdG9yZTE2KG9mZnNldCArIDIsIHZhbHVlID4+IDE2KTsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUuaW52YWxpZGF0ZVBhZ2UgPSBmdW5jdGlvbihhZGRyZXNzKSB7fTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUuY29udmVydDE2VG8zMiA9IGZ1bmN0aW9uKHZhbHVlLCBpbnB1dCkgewoJdmFyIHIgPSAodmFsdWUgJiAweDAwMUYpIDw8IDM7Cgl2YXIgZyA9ICh2YWx1ZSAmIDB4MDNFMCkgPj4gMjsKCXZhciBiID0gKHZhbHVlICYgMHg3QzAwKSA+PiA3OwoKCWlucHV0WzBdID0gcjsKCWlucHV0WzFdID0gZzsKCWlucHV0WzJdID0gYjsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUubWl4ID0gZnVuY3Rpb24oYVdlaWdodCwgYUNvbG9yLCBiV2VpZ2h0LCBiQ29sb3IpIHsKCXZhciBhciA9IChhQ29sb3IgJiAweDAwMUYpOwoJdmFyIGFnID0gKGFDb2xvciAmIDB4MDNFMCkgPj4gNTsKCXZhciBhYiA9IChhQ29sb3IgJiAweDdDMDApID4+IDEwOwoKCXZhciBiciA9IChiQ29sb3IgJiAweDAwMUYpOwoJdmFyIGJnID0gKGJDb2xvciAmIDB4MDNFMCkgPj4gNTsKCXZhciBiYiA9IChiQ29sb3IgJiAweDdDMDApID4+IDEwOwoKCXZhciByID0gTWF0aC5taW4oYVdlaWdodCAqIGFyICsgYldlaWdodCAqIGJyLCAweDFGKTsKCXZhciBnID0gTWF0aC5taW4oYVdlaWdodCAqIGFnICsgYldlaWdodCAqIGJnLCAweDFGKTsKCXZhciBiID0gTWF0aC5taW4oYVdlaWdodCAqIGFiICsgYldlaWdodCAqIGJiLCAweDFGKTsKCglyZXR1cm4gciB8IChnIDw8IDUpIHwgKGIgPDwgMTApOwp9OwoKR2FtZUJveUFkdmFuY2VQYWxldHRlLnByb3RvdHlwZS5tYWtlRGFya1BhbGV0dGVzID0gZnVuY3Rpb24obGF5ZXJzKSB7CglpZiAodGhpcy5hZGp1c3RDb2xvciAhPSB0aGlzLmFkanVzdENvbG9yRGFyaykgewoJCXRoaXMuYWRqdXN0Q29sb3IgPSB0aGlzLmFkanVzdENvbG9yRGFyazsKCQl0aGlzLnJlc2V0UGFsZXR0ZXMoKTsKCX0KCXRoaXMucmVzZXRQYWxldHRlTGF5ZXJzKGxheWVycyk7Cn07CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLm1ha2VCcmlnaHRQYWxldHRlcyA9IGZ1bmN0aW9uKGxheWVycykgewoJaWYgKHRoaXMuYWRqdXN0Q29sb3IgIT0gdGhpcy5hZGp1c3RDb2xvckJyaWdodCkgewoJCXRoaXMuYWRqdXN0Q29sb3IgPSB0aGlzLmFkanVzdENvbG9yQnJpZ2h0OwoJCXRoaXMucmVzZXRQYWxldHRlcygpOwoJfQoJdGhpcy5yZXNldFBhbGV0dGVMYXllcnMobGF5ZXJzKTsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUubWFrZU5vcm1hbFBhbGV0dGVzID0gZnVuY3Rpb24oKSB7Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzWzBdID0gdGhpcy5jb2xvcnNbMF07Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzWzFdID0gdGhpcy5jb2xvcnNbMF07Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzWzJdID0gdGhpcy5jb2xvcnNbMF07Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzWzNdID0gdGhpcy5jb2xvcnNbMF07Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzWzRdID0gdGhpcy5jb2xvcnNbMV07Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzWzVdID0gdGhpcy5jb2xvcnNbMF07Cn07CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLm1ha2VTcGVjaWFsUGFsZXR0ZSA9IGZ1bmN0aW9uKGxheWVyKSB7Cgl0aGlzLnBhc3N0aHJvdWdoQ29sb3JzW2xheWVyXSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbbGF5ZXIgPT0gNCA/IDEgOiAwXTsKfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUubWFrZU5vcm1hbFBhbGV0dGUgPSBmdW5jdGlvbihsYXllcikgewoJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1tsYXllcl0gPSB0aGlzLmNvbG9yc1tsYXllciA9PSA0ID8gMSA6IDBdOwp9OwoKR2FtZUJveUFkdmFuY2VQYWxldHRlLnByb3RvdHlwZS5yZXNldFBhbGV0dGVMYXllcnMgPSBmdW5jdGlvbihsYXllcnMpIHsKCWlmIChsYXllcnMgJiAweDAxKSB7CgkJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1swXSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMF07Cgl9IGVsc2UgewoJCXRoaXMucGFzc3Rocm91Z2hDb2xvcnNbMF0gPSB0aGlzLmNvbG9yc1swXTsKCX0KCWlmIChsYXllcnMgJiAweDAyKSB7CgkJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1sxXSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMF07Cgl9IGVsc2UgewoJCXRoaXMucGFzc3Rocm91Z2hDb2xvcnNbMV0gPSB0aGlzLmNvbG9yc1swXTsKCX0KCWlmIChsYXllcnMgJiAweDA0KSB7CgkJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1syXSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMF07Cgl9IGVsc2UgewoJCXRoaXMucGFzc3Rocm91Z2hDb2xvcnNbMl0gPSB0aGlzLmNvbG9yc1swXTsKCX0KCWlmIChsYXllcnMgJiAweDA4KSB7CgkJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1szXSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMF07Cgl9IGVsc2UgewoJCXRoaXMucGFzc3Rocm91Z2hDb2xvcnNbM10gPSB0aGlzLmNvbG9yc1swXTsKCX0KCWlmIChsYXllcnMgJiAweDEwKSB7CgkJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1s0XSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMV07Cgl9IGVsc2UgewoJCXRoaXMucGFzc3Rocm91Z2hDb2xvcnNbNF0gPSB0aGlzLmNvbG9yc1sxXTsKCX0KCWlmIChsYXllcnMgJiAweDIwKSB7CgkJdGhpcy5wYXNzdGhyb3VnaENvbG9yc1s1XSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMF07Cgl9IGVsc2UgewoJCXRoaXMucGFzc3Rocm91Z2hDb2xvcnNbNV0gPSB0aGlzLmNvbG9yc1swXTsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUucmVzZXRQYWxldHRlcyA9IGZ1bmN0aW9uKCkgewoJdmFyIGk7Cgl2YXIgb3V0UGFsZXR0ZSA9IHRoaXMuYWRqdXN0ZWRDb2xvcnNbMF07Cgl2YXIgaW5QYWxldHRlID0gdGhpcy5jb2xvcnNbMF07Cglmb3IgKGkgPSAwOyBpIDwgMjU2OyArK2kpIHsKCQlvdXRQYWxldHRlW2ldID0gdGhpcy5hZGp1c3RDb2xvcihpblBhbGV0dGVbaV0pOwoJfQoKCW91dFBhbGV0dGUgPSB0aGlzLmFkanVzdGVkQ29sb3JzWzFdOwoJaW5QYWxldHRlID0gdGhpcy5jb2xvcnNbMV07Cglmb3IgKGkgPSAwOyBpIDwgMjU2OyArK2kpIHsKCQlvdXRQYWxldHRlW2ldID0gdGhpcy5hZGp1c3RDb2xvcihpblBhbGV0dGVbaV0pOwoJfQp9CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLmFjY2Vzc0NvbG9yID0gZnVuY3Rpb24obGF5ZXIsIGluZGV4KSB7CglyZXR1cm4gdGhpcy5wYXNzdGhyb3VnaENvbG9yc1tsYXllcl1baW5kZXhdOwp9OwoKR2FtZUJveUFkdmFuY2VQYWxldHRlLnByb3RvdHlwZS5hZGp1c3RDb2xvckRhcmsgPSBmdW5jdGlvbihjb2xvcikgewoJdmFyIHIgPSAoY29sb3IgJiAweDAwMUYpOwoJdmFyIGcgPSAoY29sb3IgJiAweDAzRTApID4+IDU7Cgl2YXIgYiA9IChjb2xvciAmIDB4N0MwMCkgPj4gMTA7CgoJciA9IHIgLSAociAqIHRoaXMuYmxlbmRZKTsKCWcgPSBnIC0gKGcgKiB0aGlzLmJsZW5kWSk7CgliID0gYiAtIChiICogdGhpcy5ibGVuZFkpOwoKCXJldHVybiByIHwgKGcgPDwgNSkgfCAoYiA8PCAxMCk7Cn07CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLmFkanVzdENvbG9yQnJpZ2h0ID0gZnVuY3Rpb24oY29sb3IpIHsKCXZhciByID0gKGNvbG9yICYgMHgwMDFGKTsKCXZhciBnID0gKGNvbG9yICYgMHgwM0UwKSA+PiA1OwoJdmFyIGIgPSAoY29sb3IgJiAweDdDMDApID4+IDEwOwoKCXIgPSByICsgKCgzMSAtIHIpICogdGhpcy5ibGVuZFkpOwoJZyA9IGcgKyAoKDMxIC0gZykgKiB0aGlzLmJsZW5kWSk7CgliID0gYiArICgoMzEgLSBiKSAqIHRoaXMuYmxlbmRZKTsKCglyZXR1cm4gciB8IChnIDw8IDUpIHwgKGIgPDwgMTApOwp9OwoKR2FtZUJveUFkdmFuY2VQYWxldHRlLnByb3RvdHlwZS5hZGp1c3RDb2xvciA9IEdhbWVCb3lBZHZhbmNlUGFsZXR0ZS5wcm90b3R5cGUuYWRqdXN0Q29sb3JCcmlnaHQ7CgpHYW1lQm95QWR2YW5jZVBhbGV0dGUucHJvdG90eXBlLnNldEJsZW5kWSA9IGZ1bmN0aW9uKHkpIHsKCWlmICh0aGlzLmJsZW5kWSAhPSB5KSB7CgkJdGhpcy5ibGVuZFkgPSB5OwoJCXRoaXMucmVzZXRQYWxldHRlcygpOwoJfQp9OwoKZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VPQkoob2FtLCBpbmRleCkgewoJdGhpcy5USUxFX09GRlNFVCA9IDB4MTAwMDA7Cgl0aGlzLm9hbSA9IG9hbTsKCgl0aGlzLmluZGV4ID0gaW5kZXg7Cgl0aGlzLnggPSAwOwoJdGhpcy55ID0gMDsKCXRoaXMuc2NhbGVyb3QgPSAwOwoJdGhpcy5kb3VibGVzaXplID0gZmFsc2U7Cgl0aGlzLmRpc2FibGUgPSAxOwoJdGhpcy5tb2RlID0gMDsKCXRoaXMubW9zYWljID0gZmFsc2U7Cgl0aGlzLm11bHRpcGFsZXR0ZSA9IGZhbHNlOwoJdGhpcy5zaGFwZSA9IDA7Cgl0aGlzLnNjYWxlcm90UGFyYW0gPSAwOwoJdGhpcy5oZmxpcCA9IDA7Cgl0aGlzLnZmbGlwID0gMDsKCXRoaXMudGlsZUJhc2UgPSAwOwoJdGhpcy5wcmlvcml0eSA9IDA7Cgl0aGlzLnBhbGV0dGUgPSAwOwoJdGhpcy5kcmF3U2NhbmxpbmUgPSB0aGlzLmRyYXdTY2FubGluZU5vcm1hbDsKCXRoaXMucHVzaFBpeGVsID0gR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnB1c2hQaXhlbDsKCXRoaXMuY2FjaGVkV2lkdGggPSA4OwoJdGhpcy5jYWNoZWRIZWlnaHQgPSA4Owp9OwoKR2FtZUJveUFkdmFuY2VPQkoucHJvdG90eXBlLmRyYXdTY2FubGluZU5vcm1hbCA9IGZ1bmN0aW9uKGJhY2tpbmcsIHksIHlPZmYsIHN0YXJ0LCBlbmQpIHsKCXZhciB2aWRlbyA9IHRoaXMub2FtLnZpZGVvOwoJdmFyIHg7Cgl2YXIgdW5kZXJmbG93OwoJdmFyIG9mZnNldDsKCXZhciBtYXNrID0gdGhpcy5tb2RlIHwgdmlkZW8udGFyZ2V0Mlt2aWRlby5MQVlFUl9PQkpdIHwgKHRoaXMucHJpb3JpdHkgPDwgMSk7CglpZiAodGhpcy5tb2RlID09IDB4MTApIHsKCQltYXNrIHw9IHZpZGVvLlRBUkdFVDFfTUFTSzsKCX0KCWlmICh2aWRlby5ibGVuZE1vZGUgPT0gMSAmJiB2aWRlby5hbHBoYUVuYWJsZWQpIHsKCQltYXNrIHw9IHZpZGVvLnRhcmdldDFbdmlkZW8uTEFZRVJfT0JKXTsKCX0KCgl2YXIgdG90YWxXaWR0aCA9IHRoaXMuY2FjaGVkV2lkdGg7CglpZiAodGhpcy54IDwgdmlkZW8uSE9SSVpPTlRBTF9QSVhFTFMpIHsKCQlpZiAodGhpcy54IDwgc3RhcnQpIHsKCQkJdW5kZXJmbG93ID0gc3RhcnQgLSB0aGlzLng7CgkJCW9mZnNldCA9IHN0YXJ0OwoJCX0gZWxzZSB7CgkJCXVuZGVyZmxvdyA9IDA7CgkJCW9mZnNldCA9IHRoaXMueDsKCQl9CgkJaWYgKGVuZCA8IHRoaXMuY2FjaGVkV2lkdGggKyB0aGlzLngpIHsKCQkJdG90YWxXaWR0aCA9IGVuZCAtIHRoaXMueDsKCQl9Cgl9IGVsc2UgewoJCXVuZGVyZmxvdyA9IHN0YXJ0ICsgNTEyIC0gdGhpcy54OwoJCW9mZnNldCA9IHN0YXJ0OwoJCWlmIChlbmQgPCB0aGlzLmNhY2hlZFdpZHRoIC0gdW5kZXJmbG93KSB7CgkJCXRvdGFsV2lkdGggPSBlbmQ7CgkJfQoJfQoJCgl2YXIgbG9jYWxYOwoJdmFyIGxvY2FsWTsKCWlmICghdGhpcy52ZmxpcCkgewoJCWxvY2FsWSA9IHkgLSB5T2ZmOwoJfSBlbHNlIHsKCQlsb2NhbFkgPSB0aGlzLmNhY2hlZEhlaWdodCAtIHkgKyB5T2ZmIC0gMTsKCX0KCXZhciBsb2NhbFlMbyA9IGxvY2FsWSAmIDB4NzsKCXZhciBtb3NhaWNYOwoJdmFyIHRpbGVPZmZzZXQ7CgoJdmFyIHBhbGV0dGVTaGlmdCA9IHRoaXMubXVsdGlwYWxldHRlID8gMSA6IDA7CgoJaWYgKHZpZGVvLm9iakNoYXJhY3Rlck1hcHBpbmcpIHsKCQl0aWxlT2Zmc2V0ID0gKChsb2NhbFkgJiAweDAxRjgpICogdGhpcy5jYWNoZWRXaWR0aCkgPj4gNjsKCX0gZWxzZSB7CgkJdGlsZU9mZnNldCA9IChsb2NhbFkgJiAweDAxRjgpIDw8ICgyIC0gcGFsZXR0ZVNoaWZ0KTsKCX0KCglpZiAodGhpcy5tb3NhaWMpIHsKCQltb3NhaWNYID0gdmlkZW8ub2JqTW9zYWljWCAtIDEgLSAodmlkZW8ub2JqTW9zYWljWCArIG9mZnNldCAtIDEpICUgdmlkZW8ub2JqTW9zYWljWDsKCQlvZmZzZXQgKz0gbW9zYWljWDsKCQl1bmRlcmZsb3cgKz0gbW9zYWljWDsKCX0KCWlmICghdGhpcy5oZmxpcCkgewoJCWxvY2FsWCA9IHVuZGVyZmxvdzsKCX0gZWxzZSB7CgkJbG9jYWxYID0gdGhpcy5jYWNoZWRXaWR0aCAtIHVuZGVyZmxvdyAtIDE7Cgl9CgoJdmFyIHRpbGVSb3cgPSB2aWRlby5hY2Nlc3NUaWxlKHRoaXMuVElMRV9PRkZTRVQgKyAoeCAmIDB4NCkgKiBwYWxldHRlU2hpZnQsIHRoaXMudGlsZUJhc2UgKyAodGlsZU9mZnNldCA8PCBwYWxldHRlU2hpZnQpICsgKChsb2NhbFggJiAweDAxRjgpID4+ICgzIC0gcGFsZXR0ZVNoaWZ0KSksIGxvY2FsWUxvIDw8IHBhbGV0dGVTaGlmdCk7Cglmb3IgKHggPSB1bmRlcmZsb3c7IHggPCB0b3RhbFdpZHRoOyArK3gpIHsKCQltb3NhaWNYID0gdGhpcy5tb3NhaWMgPyBvZmZzZXQgJSB2aWRlby5vYmpNb3NhaWNYIDogMDsKCQlpZiAoIXRoaXMuaGZsaXApIHsKCQkJbG9jYWxYID0geCAtIG1vc2FpY1g7CgkJfSBlbHNlIHsKCQkJbG9jYWxYID0gdGhpcy5jYWNoZWRXaWR0aCAtICh4IC0gbW9zYWljWCkgLSAxOwoJCX0KCQlpZiAoIXBhbGV0dGVTaGlmdCkgewoJCQlpZiAoISh4ICYgMHg3KSB8fCAodGhpcy5tb3NhaWMgJiYgIW1vc2FpY1gpKSB7CgkJCQl0aWxlUm93ID0gdmlkZW8uYWNjZXNzVGlsZSh0aGlzLlRJTEVfT0ZGU0VULCB0aGlzLnRpbGVCYXNlICsgdGlsZU9mZnNldCArIChsb2NhbFggPj4gMyksIGxvY2FsWUxvKTsKCQkJfQoJCX0gZWxzZSB7CgkJCWlmICghKHggJiAweDMpIHx8ICh0aGlzLm1vc2FpYyAmJiAhbW9zYWljWCkpIHsKCQkJCXRpbGVSb3cgPSB2aWRlby5hY2Nlc3NUaWxlKHRoaXMuVElMRV9PRkZTRVQgKyAobG9jYWxYICYgMHg0KSwgdGhpcy50aWxlQmFzZSArICh0aWxlT2Zmc2V0IDw8IDEpICsgKChsb2NhbFggJiAweDAxRjgpID4+IDIpLCBsb2NhbFlMbyA8PCAxKTsKCQkJfQoJCX0KCQl0aGlzLnB1c2hQaXhlbCh2aWRlby5MQVlFUl9PQkosIHRoaXMsIHZpZGVvLCB0aWxlUm93LCBsb2NhbFggJiAweDcsIG9mZnNldCwgYmFja2luZywgbWFzaywgZmFsc2UpOwoJCW9mZnNldCsrOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VPQkoucHJvdG90eXBlLmRyYXdTY2FubGluZUFmZmluZSA9IGZ1bmN0aW9uKGJhY2tpbmcsIHksIHlPZmYsIHN0YXJ0LCBlbmQpIHsKCXZhciB2aWRlbyA9IHRoaXMub2FtLnZpZGVvOwoJdmFyIHg7Cgl2YXIgdW5kZXJmbG93OwoJdmFyIG9mZnNldDsKCXZhciBtYXNrID0gdGhpcy5tb2RlIHwgdmlkZW8udGFyZ2V0Mlt2aWRlby5MQVlFUl9PQkpdIHwgKHRoaXMucHJpb3JpdHkgPDwgMSk7CglpZiAodGhpcy5tb2RlID09IDB4MTApIHsKCQltYXNrIHw9IHZpZGVvLlRBUkdFVDFfTUFTSzsKCX0KCWlmICh2aWRlby5ibGVuZE1vZGUgPT0gMSAmJiB2aWRlby5hbHBoYUVuYWJsZWQpIHsKCQltYXNrIHw9IHZpZGVvLnRhcmdldDFbdmlkZW8uTEFZRVJfT0JKXTsKCX0KCgl2YXIgbG9jYWxYOwoJdmFyIGxvY2FsWTsKCXZhciB5RGlmZiA9IHkgLSB5T2ZmOwoJdmFyIHRpbGVPZmZzZXQ7CgoJdmFyIHBhbGV0dGVTaGlmdCA9IHRoaXMubXVsdGlwYWxldHRlID8gMSA6IDA7Cgl2YXIgdG90YWxXaWR0aCA9IHRoaXMuY2FjaGVkV2lkdGggPDwgdGhpcy5kb3VibGVzaXplOwoJdmFyIHRvdGFsSGVpZ2h0ID0gdGhpcy5jYWNoZWRIZWlnaHQgPDwgdGhpcy5kb3VibGVzaXplOwoJdmFyIGRyYXdXaWR0aCA9IHRvdGFsV2lkdGg7CglpZiAoZHJhd1dpZHRoID4gdmlkZW8uSE9SSVpPTlRBTF9QSVhFTFMpIHsKCQl0b3RhbFdpZHRoID0gdmlkZW8uSE9SSVpPTlRBTF9QSVhFTFM7Cgl9CgoJaWYgKHRoaXMueCA8IHZpZGVvLkhPUklaT05UQUxfUElYRUxTKSB7CgkJaWYgKHRoaXMueCA8IHN0YXJ0KSB7CgkJCXVuZGVyZmxvdyA9IHN0YXJ0IC0gdGhpcy54OwoJCQlvZmZzZXQgPSBzdGFydDsKCQl9IGVsc2UgewoJCQl1bmRlcmZsb3cgPSAwOwoJCQlvZmZzZXQgPSB0aGlzLng7CgkJfQoJCWlmIChlbmQgPCBkcmF3V2lkdGggKyB0aGlzLngpIHsKCQkJZHJhd1dpZHRoID0gZW5kIC0gdGhpcy54OwoJCX0KCX0gZWxzZSB7CgkJdW5kZXJmbG93ID0gc3RhcnQgKyA1MTIgLSB0aGlzLng7CgkJb2Zmc2V0ID0gc3RhcnQ7CgkJaWYgKGVuZCA8IGRyYXdXaWR0aCAtIHVuZGVyZmxvdykgewoJCQlkcmF3V2lkdGggPSBlbmQ7CgkJfQoJfQoKCWZvciAoeCA9IHVuZGVyZmxvdzsgeCA8IGRyYXdXaWR0aDsgKyt4KSB7CgkJbG9jYWxYID0gdGhpcy5zY2FsZXJvdE9hbS5hICogKHggLSAodG90YWxXaWR0aCA+PiAxKSkgKyB0aGlzLnNjYWxlcm90T2FtLmIgKiAoeURpZmYgLSAodG90YWxIZWlnaHQgPj4gMSkpICsgKHRoaXMuY2FjaGVkV2lkdGggPj4gMSk7CgkJbG9jYWxZID0gdGhpcy5zY2FsZXJvdE9hbS5jICogKHggLSAodG90YWxXaWR0aCA+PiAxKSkgKyB0aGlzLnNjYWxlcm90T2FtLmQgKiAoeURpZmYgLSAodG90YWxIZWlnaHQgPj4gMSkpICsgKHRoaXMuY2FjaGVkSGVpZ2h0ID4+IDEpOwoJCWlmICh0aGlzLm1vc2FpYykgewoJCQlsb2NhbFggLT0gKHggJSB2aWRlby5vYmpNb3NhaWNYKSAqIHRoaXMuc2NhbGVyb3RPYW0uYSArICh5ICUgdmlkZW8ub2JqTW9zYWljWSkgKiB0aGlzLnNjYWxlcm90T2FtLmI7CgkJCWxvY2FsWSAtPSAoeCAlIHZpZGVvLm9iak1vc2FpY1gpICogdGhpcy5zY2FsZXJvdE9hbS5jICsgKHkgJSB2aWRlby5vYmpNb3NhaWNZKSAqIHRoaXMuc2NhbGVyb3RPYW0uZDsKCQl9CgoJCWlmIChsb2NhbFggPCAwIHx8IGxvY2FsWCA+PSB0aGlzLmNhY2hlZFdpZHRoIHx8IGxvY2FsWSA8IDAgfHwgbG9jYWxZID49IHRoaXMuY2FjaGVkSGVpZ2h0KSB7CgkJCW9mZnNldCsrOwoJCQljb250aW51ZTsKCQl9CgoJCWlmICh2aWRlby5vYmpDaGFyYWN0ZXJNYXBwaW5nKSB7CgkJCXRpbGVPZmZzZXQgPSAoKGxvY2FsWSAmIDB4MDFGOCkgKiB0aGlzLmNhY2hlZFdpZHRoKSA+PiA2OwoJCX0gZWxzZSB7CgkJCXRpbGVPZmZzZXQgPSAobG9jYWxZICYgMHgwMUY4KSA8PCAoMiAtIHBhbGV0dGVTaGlmdCk7CgkJfQoJCXRpbGVSb3cgPSB2aWRlby5hY2Nlc3NUaWxlKHRoaXMuVElMRV9PRkZTRVQgKyAobG9jYWxYICYgMHg0KSAqIHBhbGV0dGVTaGlmdCwgdGhpcy50aWxlQmFzZSArICh0aWxlT2Zmc2V0IDw8IHBhbGV0dGVTaGlmdCkgKyAoKGxvY2FsWCAmIDB4MDFGOCkgPj4gKDMgLSBwYWxldHRlU2hpZnQpKSwgKGxvY2FsWSAmIDB4NykgPDwgcGFsZXR0ZVNoaWZ0KTsKCQl0aGlzLnB1c2hQaXhlbCh2aWRlby5MQVlFUl9PQkosIHRoaXMsIHZpZGVvLCB0aWxlUm93LCBsb2NhbFggJiAweDcsIG9mZnNldCwgYmFja2luZywgbWFzaywgZmFsc2UpOwoJCW9mZnNldCsrOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VPQkoucHJvdG90eXBlLnJlY2FsY1NpemUgPSBmdW5jdGlvbigpIHsKCXN3aXRjaCAodGhpcy5zaGFwZSkgewoJY2FzZSAwOgoJCS8vIFNxdWFyZQoJCXRoaXMuY2FjaGVkSGVpZ2h0ID0gdGhpcy5jYWNoZWRXaWR0aCA9IDggPDwgdGhpcy5zaXplOwoJCWJyZWFrOwoJY2FzZSAxOgoJCS8vIEhvcml6b250YWwKCQlzd2l0Y2ggKHRoaXMuc2l6ZSkgewoJCWNhc2UgMDoKCQkJdGhpcy5jYWNoZWRIZWlnaHQgPSA4OwoJCQl0aGlzLmNhY2hlZFdpZHRoID0gMTY7CgkJCWJyZWFrOwoJCWNhc2UgMToKCQkJdGhpcy5jYWNoZWRIZWlnaHQgPSA4OwoJCQl0aGlzLmNhY2hlZFdpZHRoID0gMzI7CgkJCWJyZWFrOwoJCWNhc2UgMjoKCQkJdGhpcy5jYWNoZWRIZWlnaHQgPSAxNjsKCQkJdGhpcy5jYWNoZWRXaWR0aCA9IDMyOwoJCQlicmVhazsKCQljYXNlIDM6CgkJCXRoaXMuY2FjaGVkSGVpZ2h0ID0gMzI7CgkJCXRoaXMuY2FjaGVkV2lkdGggPSA2NDsKCQkJYnJlYWs7CgkJfQoJCWJyZWFrOwoJY2FzZSAyOgoJCS8vIFZlcnRpY2FsCgkJc3dpdGNoICh0aGlzLnNpemUpIHsKCQljYXNlIDA6CgkJCXRoaXMuY2FjaGVkSGVpZ2h0ID0gMTY7CgkJCXRoaXMuY2FjaGVkV2lkdGggPSA4OwoJCQlicmVhazsKCQljYXNlIDE6CgkJCXRoaXMuY2FjaGVkSGVpZ2h0ID0gMzI7CgkJCXRoaXMuY2FjaGVkV2lkdGggPSA4OwoJCQlicmVhazsKCQljYXNlIDI6CgkJCXRoaXMuY2FjaGVkSGVpZ2h0ID0gMzI7CgkJCXRoaXMuY2FjaGVkV2lkdGggPSAxNjsKCQkJYnJlYWs7CgkJY2FzZSAzOgoJCQl0aGlzLmNhY2hlZEhlaWdodCA9IDY0OwoJCQl0aGlzLmNhY2hlZFdpZHRoID0gMzI7CgkJCWJyZWFrOwoJCX0KCQlicmVhazsKCWRlZmF1bHQ6CgkJLy8gQmFkIQoJfQp9OwoKZnVuY3Rpb24gR2FtZUJveUFkdmFuY2VPQkpMYXllcih2aWRlbywgaW5kZXgpIHsKCXRoaXMudmlkZW8gPSB2aWRlbzsKCXRoaXMuYmcgPSBmYWxzZTsKCXRoaXMuaW5kZXggPSB2aWRlby5MQVlFUl9PQko7Cgl0aGlzLnByaW9yaXR5ID0gaW5kZXg7Cgl0aGlzLmVuYWJsZWQgPSBmYWxzZTsKCXRoaXMub2Jqd2luID0gMDsKfTsKCkdhbWVCb3lBZHZhbmNlT0JKTGF5ZXIucHJvdG90eXBlLmRyYXdTY2FubGluZSA9IGZ1bmN0aW9uKGJhY2tpbmcsIGxheWVyLCBzdGFydCwgZW5kKSB7Cgl2YXIgeSA9IHRoaXMudmlkZW8udmNvdW50OwoJdmFyIHdyYXBwZWRZOwoJdmFyIG1vc2FpY1k7Cgl2YXIgb2JqOwoJaWYgKHN0YXJ0ID49IGVuZCkgewoJCXJldHVybjsKCX0KCXZhciBvYmpzID0gdGhpcy52aWRlby5vYW0ub2JqczsKCWZvciAodmFyIGkgPSAwOyBpIDwgb2Jqcy5sZW5ndGg7ICsraSkgewoJCW9iaiA9IG9ianNbaV07CgkJaWYgKG9iai5kaXNhYmxlKSB7CgkJCWNvbnRpbnVlOwoJCX0KCQlpZiAoKG9iai5tb2RlICYgdGhpcy52aWRlby5PQkpXSU5fTUFTSykgIT0gdGhpcy5vYmp3aW4pIHsKCQkJY29udGludWU7CgkJfQoJCWlmICghKG9iai5tb2RlICYgdGhpcy52aWRlby5PQkpXSU5fTUFTSykgJiYgdGhpcy5wcmlvcml0eSAhPSBvYmoucHJpb3JpdHkpIHsKCQkJY29udGludWU7CgkJfQoJCWlmIChvYmoueSA8IHRoaXMudmlkZW8uVkVSVElDQUxfUElYRUxTKSB7CgkJCXdyYXBwZWRZID0gb2JqLnk7CgkJfSBlbHNlIHsKCQkJd3JhcHBlZFkgPSBvYmoueSAtIDI1NjsKCQl9CgkJdmFyIHRvdGFsSGVpZ2h0OwoJCWlmICghb2JqLnNjYWxlcm90KSB7CgkJCXRvdGFsSGVpZ2h0ID0gb2JqLmNhY2hlZEhlaWdodDsKCQl9IGVsc2UgewoJCQl0b3RhbEhlaWdodCA9IG9iai5jYWNoZWRIZWlnaHQgPDwgb2JqLmRvdWJsZXNpemU7CgkJfQoJCWlmICghb2JqLm1vc2FpYykgewoJCQltb3NhaWNZID0geTsKCQl9IGVsc2UgewoJCQltb3NhaWNZID0geSAtIHkgJSB0aGlzLnZpZGVvLm9iak1vc2FpY1k7CgkJfQoJCWlmICh3cmFwcGVkWSA8PSB5ICYmICh3cmFwcGVkWSArIHRvdGFsSGVpZ2h0KSA+IHkpIHsKCQkJb2JqLmRyYXdTY2FubGluZShiYWNraW5nLCBtb3NhaWNZLCB3cmFwcGVkWSwgc3RhcnQsIGVuZCk7CgkJfQoJfQp9OwoKR2FtZUJveUFkdmFuY2VPQkpMYXllci5wcm90b3R5cGUub2JqQ29tcGFyYXRvciA9IGZ1bmN0aW9uKGEsIGIpIHsKCXJldHVybiBhLmluZGV4IC0gYi5pbmRleDsKfTsKCmZ1bmN0aW9uIEdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlcigpIHsKCXRoaXMuTEFZRVJfQkcwID0gMDsKCXRoaXMuTEFZRVJfQkcxID0gMTsKCXRoaXMuTEFZRVJfQkcyID0gMjsKCXRoaXMuTEFZRVJfQkczID0gMzsKCXRoaXMuTEFZRVJfT0JKID0gNDsKCXRoaXMuTEFZRVJfQkFDS0RST1AgPSA1OwoKCXRoaXMuSE9SSVpPTlRBTF9QSVhFTFMgPSAyNDA7Cgl0aGlzLlZFUlRJQ0FMX1BJWEVMUyA9IDE2MDsKCgl0aGlzLkxBWUVSX01BU0sgPSAweDA2OwoJdGhpcy5CQUNLR1JPVU5EX01BU0sgPSAweDAxOwoJdGhpcy5UQVJHRVQyX01BU0sgPSAweDA4OwoJdGhpcy5UQVJHRVQxX01BU0sgPSAweDEwOwoJdGhpcy5PQkpXSU5fTUFTSyA9IDB4MjA7Cgl0aGlzLldSSVRURU5fTUFTSyA9IDB4ODA7CgoJdGhpcy5QUklPUklUWV9NQVNLID0gdGhpcy5MQVlFUl9NQVNLIHwgdGhpcy5CQUNLR1JPVU5EX01BU0s7CgoJdGhpcy5kcmF3QmFja2Ryb3AgPSBuZXcgKGZ1bmN0aW9uKHZpZGVvKSB7CgkJdGhpcy5iZyA9IHRydWU7CgkJdGhpcy5wcmlvcml0eSA9IC0xOwoJCXRoaXMuaW5kZXggPSB2aWRlby5MQVlFUl9CQUNLRFJPUDsKCQl0aGlzLmVuYWJsZWQgPSB0cnVlOwoKCQl0aGlzLmRyYXdTY2FubGluZSA9IGZ1bmN0aW9uKGJhY2tpbmcsIGxheWVyLCBzdGFydCwgZW5kKSB7CgkJCS8vIFRPRE86IGludGVyYWN0aW9ucyB3aXRoIGJsZW5kIG1vZGVzIGFuZCBPQkpXSU4KCQkJZm9yICh2YXIgeCA9IHN0YXJ0OyB4IDwgZW5kOyArK3gpIHsKCQkJCWlmICghKGJhY2tpbmcuc3RlbmNpbFt4XSAmIHZpZGVvLldSSVRURU5fTUFTSykpIHsKCQkJCQliYWNraW5nLmNvbG9yW3hdID0gdmlkZW8ucGFsZXR0ZS5hY2Nlc3NDb2xvcih0aGlzLmluZGV4LCAwKTsKCQkJCQliYWNraW5nLnN0ZW5jaWxbeF0gPSB2aWRlby5XUklUVEVOX01BU0s7CgkJCQl9IGVsc2UgaWYgKGJhY2tpbmcuc3RlbmNpbFt4XSAmIHZpZGVvLlRBUkdFVDFfTUFTSykgewoJCQkJCWJhY2tpbmcuY29sb3JbeF0gPSB2aWRlby5wYWxldHRlLm1peCh2aWRlby5ibGVuZEIsIHZpZGVvLnBhbGV0dGUuYWNjZXNzQ29sb3IodGhpcy5pbmRleCwgMCksIHZpZGVvLmJsZW5kQSwgYmFja2luZy5jb2xvclt4XSk7CgkJCQkJYmFja2luZy5zdGVuY2lsW3hdID0gdmlkZW8uV1JJVFRFTl9NQVNLOwoJCQkJfQoJCQl9CgkJfQoJfSkodGhpcyk7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24obW11KSB7Cgl0aGlzLnBhbGV0dGUgPSBuZXcgR2FtZUJveUFkdmFuY2VQYWxldHRlKCk7Cgl0aGlzLnZyYW0gPSBuZXcgR2FtZUJveUFkdmFuY2VWUkFNKG1tdS5TSVpFX1ZSQU0pOwoJdGhpcy5vYW0gPSBuZXcgR2FtZUJveUFkdmFuY2VPQU0obW11LlNJWkVfT0FNKTsKCXRoaXMub2FtLnZpZGVvID0gdGhpczsKCXRoaXMub2JqTGF5ZXJzID0gWwoJCW5ldyBHYW1lQm95QWR2YW5jZU9CSkxheWVyKHRoaXMsIDApLAoJCW5ldyBHYW1lQm95QWR2YW5jZU9CSkxheWVyKHRoaXMsIDEpLAoJCW5ldyBHYW1lQm95QWR2YW5jZU9CSkxheWVyKHRoaXMsIDIpLAoJCW5ldyBHYW1lQm95QWR2YW5jZU9CSkxheWVyKHRoaXMsIDMpCgldOwoJdGhpcy5vYmp3aW5MYXllciA9IG5ldyBHYW1lQm95QWR2YW5jZU9CSkxheWVyKHRoaXMsIDQpOwoJdGhpcy5vYmp3aW5MYXllci5vYmp3aW4gPSB0aGlzLk9CSldJTl9NQVNLOwoKCS8vIERJU1BDTlQKCXRoaXMuYmFja2dyb3VuZE1vZGUgPSAwOwoJdGhpcy5kaXNwbGF5RnJhbWVTZWxlY3QgPSAwOwoJdGhpcy5oYmxhbmtJbnRlcnZhbEZyZWUgPSAwOwoJdGhpcy5vYmpDaGFyYWN0ZXJNYXBwaW5nID0gMDsKCXRoaXMuZm9yY2VkQmxhbmsgPSAxOwoJdGhpcy53aW4wID0gMDsKCXRoaXMud2luMSA9IDA7Cgl0aGlzLm9iandpbiA9IDA7CgoJLy8gVkNPVU5UCgl0aGlzLnZjb3VudCA9IC0xOwoKCS8vIFdJTjBICgl0aGlzLndpbjBMZWZ0ID0gMDsKCXRoaXMud2luMFJpZ2h0ID0gMjQwOwoKCS8vIFdJTjFICgl0aGlzLndpbjFMZWZ0ID0gMDsKCXRoaXMud2luMVJpZ2h0ID0gMjQwOwoKCS8vIFdJTjBWCgl0aGlzLndpbjBUb3AgPSAwOwoJdGhpcy53aW4wQm90dG9tID0gMTYwOwoKCS8vIFdJTjFWCgl0aGlzLndpbjFUb3AgPSAwOwoJdGhpcy53aW4xQm90dG9tID0gMTYwOwoKCS8vIFdJTklOL1dJTk9VVAoJdGhpcy53aW5kb3dzID0gbmV3IEFycmF5KCk7Cglmb3IgKHZhciBpID0gMDsgaSA8IDQ7ICsraSkgewoJCXRoaXMud2luZG93cy5wdXNoKHsKCQkJZW5hYmxlZDogWyBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIHRydWUgXSwKCQkJc3BlY2lhbDogMAoJCX0pOwoJfTsKCgkvLyBCTERDTlQKCXRoaXMudGFyZ2V0MSA9IG5ldyBBcnJheSg1KTsKCXRoaXMudGFyZ2V0MiA9IG5ldyBBcnJheSg1KTsKCXRoaXMuYmxlbmRNb2RlID0gMDsKCgkvLyBCTERBTFBIQQoJdGhpcy5ibGVuZEEgPSAwOwoJdGhpcy5ibGVuZEIgPSAwOwoKCS8vIEJMRFkKCXRoaXMuYmxlbmRZID0gMDsKCgkvLyBNT1NBSUMKCXRoaXMuYmdNb3NhaWNYID0gMTsKCXRoaXMuYmdNb3NhaWNZID0gMTsKCXRoaXMub2JqTW9zYWljWCA9IDE7Cgl0aGlzLm9iak1vc2FpY1kgPSAxOwoKCXRoaXMubGFzdEhibGFuayA9IDA7Cgl0aGlzLm5leHRIYmxhbmsgPSB0aGlzLkhEUkFXX0xFTkdUSDsKCXRoaXMubmV4dEV2ZW50ID0gdGhpcy5uZXh0SGJsYW5rOwoKCXRoaXMubmV4dEhibGFua0lSUSA9IDA7Cgl0aGlzLm5leHRWYmxhbmtJUlEgPSAwOwoJdGhpcy5uZXh0VmNvdW50ZXJJUlEgPSAwOwoKCXRoaXMuYmcgPSBuZXcgQXJyYXkoKTsKCWZvciAodmFyIGkgPSAwOyBpIDwgNDsgKytpKSB7CgkJdGhpcy5iZy5wdXNoKHsKCQkJYmc6IHRydWUsCgkJCWluZGV4OiBpLAoJCQllbmFibGVkOiBmYWxzZSwKCQkJdmlkZW86IHRoaXMsCgkJCXZyYW06IHRoaXMudnJhbSwKCQkJcHJpb3JpdHk6IDAsCgkJCWNoYXJCYXNlOiAwLAoJCQltb3NhaWM6IGZhbHNlLAoJCQltdWx0aXBhbGV0dGU6IGZhbHNlLAoJCQlzY3JlZW5CYXNlOiAwLAoJCQlvdmVyZmxvdzogMCwKCQkJc2l6ZTogMCwKCQkJeDogMCwKCQkJeTogMCwKCQkJcmVmeDogMCwKCQkJcmVmeTogMCwKCQkJZHg6IDEsCgkJCWRteDogMCwKCQkJZHk6IDAsCgkJCWRteTogMSwKCQkJc3g6IDAsCgkJCXN5OiAwLAoJCQlwdXNoUGl4ZWw6IEdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wdXNoUGl4ZWwsCgkJCWRyYXdTY2FubGluZTogdGhpcy5kcmF3U2NhbmxpbmVCR01vZGUwCgkJfSk7Cgl9CgoJdGhpcy5iZ01vZGVzID0gWwoJCXRoaXMuZHJhd1NjYW5saW5lQkdNb2RlMCwKCQl0aGlzLmRyYXdTY2FubGluZUJHTW9kZTIsIC8vIE1vZGVzIDEgYW5kIDIgYXJlIGlkZW50aWNhbCBmb3IgbGF5ZXJzIDIgYW5kIDMKCQl0aGlzLmRyYXdTY2FubGluZUJHTW9kZTIsCgkJdGhpcy5kcmF3U2NhbmxpbmVCR01vZGUzLAoJCXRoaXMuZHJhd1NjYW5saW5lQkdNb2RlNCwKCQl0aGlzLmRyYXdTY2FubGluZUJHTW9kZTUKCV07CgoJdGhpcy5kcmF3TGF5ZXJzID0gWwoJCXRoaXMuYmdbMF0sCgkJdGhpcy5iZ1sxXSwKCQl0aGlzLmJnWzJdLAoJCXRoaXMuYmdbM10sCgkJdGhpcy5vYmpMYXllcnNbMF0sCgkJdGhpcy5vYmpMYXllcnNbMV0sCgkJdGhpcy5vYmpMYXllcnNbMl0sCgkJdGhpcy5vYmpMYXllcnNbM10sCgkJdGhpcy5vYmp3aW5MYXllciwKCQl0aGlzLmRyYXdCYWNrZHJvcAoJXTsKCgl0aGlzLG9iandpbkFjdGl2ZSA9IGZhbHNlOwoJdGhpcy5hbHBoYUVuYWJsZWQgPSBmYWxzZTsKCgl0aGlzLnNjYW5saW5lID0gewoJCWNvbG9yOiBuZXcgVWludDE2QXJyYXkodGhpcy5IT1JJWk9OVEFMX1BJWEVMUyksCgkJLy8gU3RlbmNpbCBmb3JtYXQ6CgkJLy8gQml0cyAwLTE6IExheWVyCgkJLy8gQml0IDI6IElzIGJhY2tncm91bmQKCQkvLyBCaXQgMzogSXMgVGFyZ2V0IDIKCQkvLyBCaXQgNDogSXMgVGFyZ2V0IDEKCQkvLyBCaXQgNTogSXMgT0JKIFdpbmRvdwoJCS8vIEJpdCA2OiBSZXNlcnZlZAoJCS8vIEJpdCA3OiBIYXMgYmVlbiB3cml0dGVuCgkJc3RlbmNpbDogbmV3IFVpbnQ4QXJyYXkodGhpcy5IT1JJWk9OVEFMX1BJWEVMUykKCX07Cgl0aGlzLnNoYXJlZENvbG9yID0gWyAwLCAwLCAwIF07Cgl0aGlzLnNoYXJlZE1hcCA9IHsKCQl0aWxlOiAwLAoJCWhmbGlwOiBmYWxzZSwKCQl2ZmxpcDogZmFsc2UsCgkJcGFsZXR0ZTogMAoJfTsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuY2xlYXJTdWJzZXRzID0gZnVuY3Rpb24obW11LCByZWdpb25zKSB7CglpZiAocmVnaW9ucyAmIDB4MDQpIHsKCQl0aGlzLnBhbGV0dGUub3ZlcndyaXRlKG5ldyBVaW50MTZBcnJheShtbXUuU0laRV9QQUxFVFRFID4+IDEpKTsKCX0KCglpZiAocmVnaW9ucyAmIDB4MDgpIHsKCQl0aGlzLnZyYW0uaW5zZXJ0KDAsIG5ldyBVaW50MTZBcnJheShtbXUuU0laRV9WUkFNID4+IDEpKTsKCX0KCglpZiAocmVnaW9ucyAmIDB4MTApIHsKCQl0aGlzLm9hbS5vdmVyd3JpdGUobmV3IFVpbnQxNkFycmF5KG1tdS5TSVpFX09BTSA+PiAxKSk7CgkJdGhpcy5vYW0udmlkZW8gPSB0aGlzOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5mcmVlemUgPSBmdW5jdGlvbigpIHsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuZGVmcm9zdCA9IGZ1bmN0aW9uKGZyb3N0KSB7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLnNldEJhY2tpbmcgPSBmdW5jdGlvbihiYWNraW5nKSB7Cgl0aGlzLnBpeGVsRGF0YSA9IGJhY2tpbmc7CgoJLy8gQ2xlYXIgYmFja2luZyBmaXJzdAoJZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgdGhpcy5IT1JJWk9OVEFMX1BJWEVMUyAqIHRoaXMuVkVSVElDQUxfUElYRUxTICogNDspIHsKCQl0aGlzLnBpeGVsRGF0YS5kYXRhW29mZnNldCsrXSA9IDB4RkY7CgkJdGhpcy5waXhlbERhdGEuZGF0YVtvZmZzZXQrK10gPSAweEZGOwoJCXRoaXMucGl4ZWxEYXRhLmRhdGFbb2Zmc2V0KytdID0gMHhGRjsKCQl0aGlzLnBpeGVsRGF0YS5kYXRhW29mZnNldCsrXSA9IDB4RkY7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlRGlzcGxheUNvbnRyb2wgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy5iYWNrZ3JvdW5kTW9kZSA9IHZhbHVlICYgMHgwMDA3OwoJdGhpcy5kaXNwbGF5RnJhbWVTZWxlY3QgPSB2YWx1ZSAmIDB4MDAxMDsKCXRoaXMuaGJsYW5rSW50ZXJ2YWxGcmVlID0gdmFsdWUgJiAweDAwMjA7Cgl0aGlzLm9iakNoYXJhY3Rlck1hcHBpbmcgPSB2YWx1ZSAmIDB4MDA0MDsKCXRoaXMuZm9yY2VkQmxhbmsgPSB2YWx1ZSAmIDB4MDA4MDsKCXRoaXMuYmdbMF0uZW5hYmxlZCA9IHZhbHVlICYgMHgwMTAwOwoJdGhpcy5iZ1sxXS5lbmFibGVkID0gdmFsdWUgJiAweDAyMDA7Cgl0aGlzLmJnWzJdLmVuYWJsZWQgPSB2YWx1ZSAmIDB4MDQwMDsKCXRoaXMuYmdbM10uZW5hYmxlZCA9IHZhbHVlICYgMHgwODAwOwoJdGhpcy5vYmpMYXllcnNbMF0uZW5hYmxlZCA9IHZhbHVlICYgMHgxMDAwOwoJdGhpcy5vYmpMYXllcnNbMV0uZW5hYmxlZCA9IHZhbHVlICYgMHgxMDAwOwoJdGhpcy5vYmpMYXllcnNbMl0uZW5hYmxlZCA9IHZhbHVlICYgMHgxMDAwOwoJdGhpcy5vYmpMYXllcnNbM10uZW5hYmxlZCA9IHZhbHVlICYgMHgxMDAwOwoJdGhpcy53aW4wID0gdmFsdWUgJiAweDIwMDA7Cgl0aGlzLndpbjEgPSB2YWx1ZSAmIDB4NDAwMDsKCXRoaXMub2Jqd2luID0gdmFsdWUgJiAweDgwMDA7Cgl0aGlzLm9iandpbkxheWVyLmVuYWJsZWQgPSB2YWx1ZSAmIDB4MTAwMCAmJiB2YWx1ZSAmIDB4ODAwMDsKCgkvLyBUb3RhbCBoYWNrIHNvIHdlIGNhbiBzdG9yZSBib3RoIHRoaW5ncyB0aGF0IHdvdWxkIHNldCBpdCB0byAyNTYtY29sb3IgbW9kZSBpbiB0aGUgc2FtZSB2YXJpYWJsZQoJdGhpcy5iZ1syXS5tdWx0aXBhbGV0dGUgJj0gfjB4MDAwMTsKCXRoaXMuYmdbM10ubXVsdGlwYWxldHRlICY9IH4weDAwMDE7CglpZiAodGhpcy5iYWNrZ3JvdW5kTW9kZSA+IDApIHsKCQl0aGlzLmJnWzJdLm11bHRpcGFsZXR0ZSB8PSAweDAwMDE7Cgl9CglpZiAodGhpcy5iYWNrZ3JvdW5kTW9kZSA9PSAyKSB7CgkJdGhpcy5iZ1szXS5tdWx0aXBhbGV0dGUgfD0gMHgwMDAxOwoJfQoJCgl0aGlzLnJlc2V0TGF5ZXJzKCk7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZENvbnRyb2wgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXZhciBiZ0RhdGEgPSB0aGlzLmJnW2JnXTsKCWJnRGF0YS5wcmlvcml0eSA9IHZhbHVlICYgMHgwMDAzOwoJYmdEYXRhLmNoYXJCYXNlID0gKHZhbHVlICYgMHgwMDBDKSA8PCAxMjsKCWJnRGF0YS5tb3NhaWMgPSB2YWx1ZSAmIDB4MDA0MDsKCWJnRGF0YS5tdWx0aXBhbGV0dGUgJj0gfjB4MDA4MDsKCWlmIChiZyA8IDIgfHwgdGhpcy5iYWNrZ3JvdW5kTW9kZSA9PSAwKSB7CgkJYmdEYXRhLm11bHRpcGFsZXR0ZSB8PSB2YWx1ZSAmIDB4MDA4MDsKCX0KCWJnRGF0YS5zY3JlZW5CYXNlID0gKHZhbHVlICYgMHgxRjAwKSA8PCAzOwoJYmdEYXRhLm92ZXJmbG93ID0gdmFsdWUgJiAweDIwMDA7CgliZ0RhdGEuc2l6ZSA9ICh2YWx1ZSAmIDB4QzAwMCkgPj4gMTQ7CgoJdGhpcy5kcmF3TGF5ZXJzLnNvcnQodGhpcy5sYXllckNvbXBhcmF0b3IpOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZUJhY2tncm91bmRIT2Zmc2V0ID0gZnVuY3Rpb24oYmcsIHZhbHVlKSB7Cgl0aGlzLmJnW2JnXS54ID0gdmFsdWUgJiAweDFGRjsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUud3JpdGVCYWNrZ3JvdW5kVk9mZnNldCA9IGZ1bmN0aW9uKGJnLCB2YWx1ZSkgewoJdGhpcy5iZ1tiZ10ueSA9IHZhbHVlICYgMHgxRkY7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZFJlZlggPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuYmdbYmddLnJlZnggPSAodmFsdWUgPDwgNCkgLyAweDEwMDA7Cgl0aGlzLmJnW2JnXS5zeCA9IHRoaXMuYmdbYmddLnJlZng7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZFJlZlkgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuYmdbYmddLnJlZnkgPSAodmFsdWUgPDwgNCkgLyAweDEwMDA7Cgl0aGlzLmJnW2JnXS5zeSA9IHRoaXMuYmdbYmddLnJlZnk7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZFBhcmFtQSA9IGZ1bmN0aW9uKGJnLCB2YWx1ZSkgewoJdGhpcy5iZ1tiZ10uZHggPSAodmFsdWUgPDwgMTYpIC8gMHgxMDAwMDAwOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZUJhY2tncm91bmRQYXJhbUIgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuYmdbYmddLmRteCA9ICh2YWx1ZSA8PCAxNikgLyAweDEwMDAwMDA7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlQmFja2dyb3VuZFBhcmFtQyA9IGZ1bmN0aW9uKGJnLCB2YWx1ZSkgewoJdGhpcy5iZ1tiZ10uZHkgPSAodmFsdWUgPDwgMTYpIC8gMHgxMDAwMDAwOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZUJhY2tncm91bmRQYXJhbUQgPSBmdW5jdGlvbihiZywgdmFsdWUpIHsKCXRoaXMuYmdbYmddLmRteSA9ICh2YWx1ZSA8PCAxNikgLyAweDEwMDAwMDA7Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlV2luMEggPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy53aW4wTGVmdCA9ICh2YWx1ZSAmIDB4RkYwMCkgPj4gODsKCXRoaXMud2luMFJpZ2h0ID0gTWF0aC5taW4odGhpcy5IT1JJWk9OVEFMX1BJWEVMUywgdmFsdWUgJiAweDAwRkYpOwoJaWYgKHRoaXMud2luMExlZnQgPiB0aGlzLndpbjBSaWdodCkgewoJCXRoaXMud2luMFJpZ2h0ID0gdGhpcy5IT1JJWk9OVEFMX1BJWEVMUzsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUud3JpdGVXaW4xSCA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLndpbjFMZWZ0ID0gKHZhbHVlICYgMHhGRjAwKSA+PiA4OwoJdGhpcy53aW4xUmlnaHQgPSBNYXRoLm1pbih0aGlzLkhPUklaT05UQUxfUElYRUxTLCB2YWx1ZSAmIDB4MDBGRik7CglpZiAodGhpcy53aW4xTGVmdCA+IHRoaXMud2luMVJpZ2h0KSB7CgkJdGhpcy53aW4xUmlnaHQgPSB0aGlzLkhPUklaT05UQUxfUElYRUxTOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZVdpbjBWID0gZnVuY3Rpb24odmFsdWUpIHsKCXRoaXMud2luMFRvcCA9ICh2YWx1ZSAmIDB4RkYwMCkgPj4gODsKCXRoaXMud2luMEJvdHRvbSA9IE1hdGgubWluKHRoaXMuVkVSVElDQUxfUElYRUxTLCB2YWx1ZSAmIDB4MDBGRik7CglpZiAodGhpcy53aW4wVG9wID4gdGhpcy53aW4wQm90dG9tKSB7CgkJdGhpcy53aW4wQm90dG9tID0gdGhpcy5WRVJUSUNBTF9QSVhFTFM7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlV2luMVYgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy53aW4xVG9wID0gKHZhbHVlICYgMHhGRjAwKSA+PiA4OwoJdGhpcy53aW4xQm90dG9tID0gTWF0aC5taW4odGhpcy5WRVJUSUNBTF9QSVhFTFMsIHZhbHVlICYgMHgwMEZGKTsKCWlmICh0aGlzLndpbjFUb3AgPiB0aGlzLndpbjFCb3R0b20pIHsKCQl0aGlzLndpbjFCb3R0b20gPSB0aGlzLlZFUlRJQ0FMX1BJWEVMUzsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUud3JpdGVXaW5kb3cgPSBmdW5jdGlvbihpbmRleCwgdmFsdWUpIHsKCXZhciB3aW5kb3cgPSB0aGlzLndpbmRvd3NbaW5kZXhdOwoJd2luZG93LmVuYWJsZWRbMF0gPSB2YWx1ZSAmIDB4MDE7Cgl3aW5kb3cuZW5hYmxlZFsxXSA9IHZhbHVlICYgMHgwMjsKCXdpbmRvdy5lbmFibGVkWzJdID0gdmFsdWUgJiAweDA0OwoJd2luZG93LmVuYWJsZWRbM10gPSB2YWx1ZSAmIDB4MDg7Cgl3aW5kb3cuZW5hYmxlZFs0XSA9IHZhbHVlICYgMHgxMDsKCXdpbmRvdy5zcGVjaWFsID0gdmFsdWUgJiAweDIwOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZVdpbkluID0gZnVuY3Rpb24odmFsdWUpIHsKCXRoaXMud3JpdGVXaW5kb3coMCwgdmFsdWUpOwoJdGhpcy53cml0ZVdpbmRvdygxLCB2YWx1ZSA+PiA4KTsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUud3JpdGVXaW5PdXQgPSBmdW5jdGlvbih2YWx1ZSkgewoJdGhpcy53cml0ZVdpbmRvdygyLCB2YWx1ZSk7Cgl0aGlzLndyaXRlV2luZG93KDMsIHZhbHVlID4+IDgpOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZUJsZW5kQ29udHJvbCA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLnRhcmdldDFbMF0gPSAhISh2YWx1ZSAmIDB4MDAwMSkgKiB0aGlzLlRBUkdFVDFfTUFTSzsKCXRoaXMudGFyZ2V0MVsxXSA9ICEhKHZhbHVlICYgMHgwMDAyKSAqIHRoaXMuVEFSR0VUMV9NQVNLOwoJdGhpcy50YXJnZXQxWzJdID0gISEodmFsdWUgJiAweDAwMDQpICogdGhpcy5UQVJHRVQxX01BU0s7Cgl0aGlzLnRhcmdldDFbM10gPSAhISh2YWx1ZSAmIDB4MDAwOCkgKiB0aGlzLlRBUkdFVDFfTUFTSzsKCXRoaXMudGFyZ2V0MVs0XSA9ICEhKHZhbHVlICYgMHgwMDEwKSAqIHRoaXMuVEFSR0VUMV9NQVNLOwoJdGhpcy50YXJnZXQxWzVdID0gISEodmFsdWUgJiAweDAwMjApICogdGhpcy5UQVJHRVQxX01BU0s7Cgl0aGlzLnRhcmdldDJbMF0gPSAhISh2YWx1ZSAmIDB4MDEwMCkgKiB0aGlzLlRBUkdFVDJfTUFTSzsKCXRoaXMudGFyZ2V0MlsxXSA9ICEhKHZhbHVlICYgMHgwMjAwKSAqIHRoaXMuVEFSR0VUMl9NQVNLOwoJdGhpcy50YXJnZXQyWzJdID0gISEodmFsdWUgJiAweDA0MDApICogdGhpcy5UQVJHRVQyX01BU0s7Cgl0aGlzLnRhcmdldDJbM10gPSAhISh2YWx1ZSAmIDB4MDgwMCkgKiB0aGlzLlRBUkdFVDJfTUFTSzsKCXRoaXMudGFyZ2V0Mls0XSA9ICEhKHZhbHVlICYgMHgxMDAwKSAqIHRoaXMuVEFSR0VUMl9NQVNLOwoJdGhpcy50YXJnZXQyWzVdID0gISEodmFsdWUgJiAweDIwMDApICogdGhpcy5UQVJHRVQyX01BU0s7Cgl0aGlzLmJsZW5kTW9kZSA9ICh2YWx1ZSAmIDB4MDBDMCkgPj4gNjsKCglzd2l0Y2ggKHRoaXMuYmxlbmRNb2RlKSB7CgljYXNlIDE6CgkJLy8gQWxwaGEKCQkvLyBGYWxsIHRocm91Z2gKCWNhc2UgMDoKCQkvLyBOb3JtYWwKCQl0aGlzLnBhbGV0dGUubWFrZU5vcm1hbFBhbGV0dGVzKCk7CgkJYnJlYWs7CgljYXNlIDI6CgkJLy8gQnJpZ2h0ZXIKCQl0aGlzLnBhbGV0dGUubWFrZUJyaWdodFBhbGV0dGVzKHZhbHVlICYgMHgzRik7CgkJYnJlYWs7CgljYXNlIDM6CgkJLy8gRGFya2VyCgkJdGhpcy5wYWxldHRlLm1ha2VEYXJrUGFsZXR0ZXModmFsdWUgJiAweDNGKTsKCQlicmVhazsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuc2V0QmxlbmRFbmFibGVkID0gZnVuY3Rpb24obGF5ZXIsIGVuYWJsZWQsIG92ZXJyaWRlKSB7Cgl0aGlzLmFscGhhRW5hYmxlZCA9IGVuYWJsZWQgJiYgb3ZlcnJpZGUgPT0gMTsKCWlmIChlbmFibGVkKSB7CgkJc3dpdGNoIChvdmVycmlkZSkgewoJCWNhc2UgMToKCQkJLy8gQWxwaGEKCQkJLy8gRmFsbCB0aHJvdWdoCgkJY2FzZSAwOgoJCQkvLyBOb3JtYWwKCQkJdGhpcy5wYWxldHRlLm1ha2VOb3JtYWxQYWxldHRlKGxheWVyKTsKCQkJYnJlYWs7CgkJY2FzZSAyOgoJCQkvLyBCcmlnaHRlcgoJCWNhc2UgMzoKCQkJLy8gRGFya2VyCgkJCXRoaXMucGFsZXR0ZS5tYWtlU3BlY2lhbFBhbGV0dGUobGF5ZXIpOwoJCQlicmVhazsKCQl9Cgl9IGVsc2UgewoJCXRoaXMucGFsZXR0ZS5tYWtlTm9ybWFsUGFsZXR0ZShsYXllcik7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLndyaXRlQmxlbmRBbHBoYSA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmJsZW5kQSA9ICh2YWx1ZSAmIDB4MDAxRikgLyAxNjsKCWlmICh0aGlzLmJsZW5kQSA+IDEpIHsKCQl0aGlzLmJsZW5kQSA9IDE7Cgl9Cgl0aGlzLmJsZW5kQiA9ICgodmFsdWUgJiAweDFGMDApID4+IDgpIC8gMTY7CglpZiAodGhpcy5ibGVuZEIgPiAxKSB7CgkJdGhpcy5ibGVuZEIgPSAxOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZUJsZW5kWSA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmJsZW5kWSA9IHZhbHVlOwoJdGhpcy5wYWxldHRlLnNldEJsZW5kWSh2YWx1ZSA+PSAxNiA/IDEgOiAodmFsdWUgLyAxNikpOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS53cml0ZU1vc2FpYyA9IGZ1bmN0aW9uKHZhbHVlKSB7Cgl0aGlzLmJnTW9zYWljWCA9ICh2YWx1ZSAmIDB4RikgKyAxOwoJdGhpcy5iZ01vc2FpY1kgPSAoKHZhbHVlID4+IDQpICYgMHhGKSArIDE7Cgl0aGlzLm9iak1vc2FpY1ggPSAoKHZhbHVlID4+IDgpICYgMHhGKSArIDE7Cgl0aGlzLm9iak1vc2FpY1kgPSAoKHZhbHVlID4+IDEyKSAmIDB4RikgKyAxOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5yZXNldExheWVycyA9IGZ1bmN0aW9uKCkgewoJaWYgKHRoaXMuYmFja2dyb3VuZE1vZGUgPiAxKSB7CgkJdGhpcy5iZ1swXS5lbmFibGVkID0gZmFsc2U7CgkJdGhpcy5iZ1sxXS5lbmFibGVkID0gZmFsc2U7Cgl9CglpZiAodGhpcy5iZ1syXS5lbmFibGVkKSB7CgkJdGhpcy5iZ1syXS5kcmF3U2NhbmxpbmUgPSB0aGlzLmJnTW9kZXNbdGhpcy5iYWNrZ3JvdW5kTW9kZV07Cgl9CglpZiAoKHRoaXMuYmFja2dyb3VuZE1vZGUgPT0gMCB8fCB0aGlzLmJhY2tncm91bmRNb2RlID09IDIpKSB7CgkJaWYgKHRoaXMuYmdbM10uZW5hYmxlZCkgewoJCQl0aGlzLmJnWzNdLmRyYXdTY2FubGluZSA9IHRoaXMuYmdNb2Rlc1t0aGlzLmJhY2tncm91bmRNb2RlXTsKCQl9Cgl9IGVsc2UgewoJCXRoaXMuYmdbM10uZW5hYmxlZCA9IGZhbHNlOwoJfQoJdGhpcy5kcmF3TGF5ZXJzLnNvcnQodGhpcy5sYXllckNvbXBhcmF0b3IpOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5sYXllckNvbXBhcmF0b3IgPSBmdW5jdGlvbihhLCBiKSB7Cgl2YXIgZGlmZiA9IGIucHJpb3JpdHkgLSBhLnByaW9yaXR5OwoJaWYgKCFkaWZmKSB7CgkJaWYgKGEuYmcgJiYgIWIuYmcpIHsKCQkJcmV0dXJuIC0xOwoJCX0gZWxzZSBpZiAoIWEuYmcgJiYgYi5iZykgewoJCQlyZXR1cm4gMTsKCQl9CgoJCXJldHVybiBiLmluZGV4IC0gYS5pbmRleDsKCX0KCXJldHVybiBkaWZmOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5hY2Nlc3NNYXBNb2RlMCA9IGZ1bmN0aW9uKGJhc2UsIHNpemUsIHgsIHlCYXNlLCBvdXQpIHsKCXZhciBvZmZzZXQgPSBiYXNlICsgKCh4ID4+IDIpICYgMHgzRSkgKyB5QmFzZTsKCglpZiAoc2l6ZSAmIDEpIHsKCQlvZmZzZXQgKz0gKHggJiAweDEwMCkgPDwgMzsKCX0KCgl2YXIgbWVtID0gdGhpcy52cmFtLmxvYWRVMTYob2Zmc2V0KTsKCW91dC50aWxlID0gbWVtICYgMHgwM0ZGOwoJb3V0LmhmbGlwID0gbWVtICYgMHgwNDAwOwoJb3V0LnZmbGlwID0gbWVtICYgMHgwODAwOwoJb3V0LnBhbGV0dGUgPSAobWVtICYgMHhGMDAwKSA+PiA4IC8vIFRoaXMgaXMgc2hpZnRlZCB1cCA0IHRvIG1ha2UgcHVzaFBpeGVsIGZhc3Rlcgp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5hY2Nlc3NNYXBNb2RlMSA9IGZ1bmN0aW9uKGJhc2UsIHNpemUsIHgsIHlCYXNlLCBvdXQpIHsKCXZhciBvZmZzZXQgPSBiYXNlICsgKHggPj4gMykgKyB5QmFzZTsKCglvdXQudGlsZSA9IHRoaXMudnJhbS5sb2FkVTgob2Zmc2V0KTsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuYWNjZXNzVGlsZSA9IGZ1bmN0aW9uKGJhc2UsIHRpbGUsIHkpIHsKCXZhciBvZmZzZXQgPSBiYXNlICsgKHRpbGUgPDwgNSk7CglvZmZzZXQgfD0geSA8PCAyOwoKCXJldHVybiB0aGlzLnZyYW0ubG9hZDMyKG9mZnNldCk7Cn0KCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wdXNoUGl4ZWwgPSBmdW5jdGlvbihsYXllciwgbWFwLCB2aWRlbywgcm93LCB4LCBvZmZzZXQsIGJhY2tpbmcsIG1hc2ssIHJhdykgewoJdmFyIGluZGV4OwoJaWYgKCFyYXcpIHsKCQlpZiAodGhpcy5tdWx0aXBhbGV0dGUpIHsKCQkJaW5kZXggPSAocm93ID4+ICh4IDw8IDMpKSAmIDB4RkY7CgkJfSBlbHNlIHsKCQkJaW5kZXggPSAocm93ID4+ICh4IDw8IDIpKSAmIDB4RjsKCQl9CgkJLy8gSW5kZXggMCBpcyB0cmFuc3BhcmVudAoJCWlmICghaW5kZXgpIHsKCQkJcmV0dXJuOwoJCX0gZWxzZSBpZiAoIXRoaXMubXVsdGlwYWxldHRlKSB7CgkJCWluZGV4IHw9IG1hcC5wYWxldHRlOwoJCX0KCX0KCgl2YXIgc3RlbmNpbCA9IHZpZGVvLldSSVRURU5fTUFTSzsKCXZhciBvbGRTdGVuY2lsID0gYmFja2luZy5zdGVuY2lsW29mZnNldF07Cgl2YXIgYmxlbmQgPSB2aWRlby5ibGVuZE1vZGU7CglpZiAodmlkZW8ub2Jqd2luQWN0aXZlKSB7CgkJaWYgKG9sZFN0ZW5jaWwgJiB2aWRlby5PQkpXSU5fTUFTSykgewoJCQlpZiAodmlkZW8ud2luZG93c1szXS5lbmFibGVkW2xheWVyXSkgewoJCQkJdmlkZW8uc2V0QmxlbmRFbmFibGVkKGxheWVyLCB2aWRlby53aW5kb3dzWzNdLnNwZWNpYWwgJiYgdmlkZW8udGFyZ2V0MVtsYXllcl0sIGJsZW5kKTsKCQkJCWlmICh2aWRlby53aW5kb3dzWzNdLnNwZWNpYWwgJiYgdmlkZW8uYWxwaGFFbmFibGVkKSB7CgkJCQkJbWFzayB8PSB2aWRlby50YXJnZXQxW2xheWVyXTsKCQkJCX0KCQkJCXN0ZW5jaWwgfD0gdmlkZW8uT0JKV0lOX01BU0s7CgkJCX0gZWxzZSB7CgkJCQlyZXR1cm47CgkJCX0KCQl9IGVsc2UgaWYgKHZpZGVvLndpbmRvd3NbMl0uZW5hYmxlZFtsYXllcl0pIHsKCQkJdmlkZW8uc2V0QmxlbmRFbmFibGVkKGxheWVyLCB2aWRlby53aW5kb3dzWzJdLnNwZWNpYWwgJiYgdmlkZW8udGFyZ2V0MVtsYXllcl0sIGJsZW5kKTsKCQkJaWYgKHZpZGVvLndpbmRvd3NbMl0uc3BlY2lhbCAmJiB2aWRlby5hbHBoYUVuYWJsZWQpIHsKCQkJCW1hc2sgfD0gdmlkZW8udGFyZ2V0MVtsYXllcl07CgkJCX0KCQl9IGVsc2UgewoJCQlyZXR1cm47CgkJfQoJfQoKCWlmICgobWFzayAmIHZpZGVvLlRBUkdFVDFfTUFTSykgJiYgKG9sZFN0ZW5jaWwgJiB2aWRlby5UQVJHRVQyX01BU0spKSB7CgkJdmlkZW8uc2V0QmxlbmRFbmFibGVkKGxheWVyLCB0cnVlLCAxKTsKCX0KCgl2YXIgcGl4ZWwgPSByYXcgPyByb3cgOiB2aWRlby5wYWxldHRlLmFjY2Vzc0NvbG9yKGxheWVyLCBpbmRleCk7CgoJaWYgKG1hc2sgJiB2aWRlby5UQVJHRVQxX01BU0spIHsKCQl2aWRlby5zZXRCbGVuZEVuYWJsZWQobGF5ZXIsICEhYmxlbmQsIGJsZW5kKTsKCX0KCXZhciBoaWdoUHJpb3JpdHkgPSAobWFzayAmIHZpZGVvLlBSSU9SSVRZX01BU0spIDwgKG9sZFN0ZW5jaWwgJiB2aWRlby5QUklPUklUWV9NQVNLKTsKCS8vIEJhY2tncm91bmRzIGNhbiBkcmF3IG92ZXIgZWFjaCBvdGhlciwgdG9vLgoJaWYgKChtYXNrICYgdmlkZW8uUFJJT1JJVFlfTUFTSykgPT0gKG9sZFN0ZW5jaWwgJiB2aWRlby5QUklPUklUWV9NQVNLKSkgewoJCWhpZ2hQcmlvcml0eSA9IG1hc2sgJiB2aWRlby5CQUNLR1JPVU5EX01BU0s7Cgl9CgoJaWYgKCEob2xkU3RlbmNpbCAmIHZpZGVvLldSSVRURU5fTUFTSykpIHsKCQkvLyBOb3RoaW5nIGhlcmUgeWV0LCBqdXN0IGNvbnRpbnVlCgkJc3RlbmNpbCB8PSBtYXNrOwoJfSBlbHNlIGlmIChoaWdoUHJpb3JpdHkpIHsKCQkvLyBXZSBhcmUgaGlnaGVyIHByaW9yaXR5CgkJaWYgKG1hc2sgJiB2aWRlby5UQVJHRVQxX01BU0sgJiYgb2xkU3RlbmNpbCAmIHZpZGVvLlRBUkdFVDJfTUFTSykgewoJCQlwaXhlbCA9IHZpZGVvLnBhbGV0dGUubWl4KHZpZGVvLmJsZW5kQSwgcGl4ZWwsIHZpZGVvLmJsZW5kQiwgYmFja2luZy5jb2xvcltvZmZzZXRdKTsKCQl9CgkJLy8gV2UganVzdCBkcmV3IG92ZXIgc29tZXRoaW5nLCBzbyBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIHVzIHRvIGJlIGEgVEFSR0VUMSBhbnltb3JlLi4uCgkJc3RlbmNpbCB8PSBtYXNrICYgfnZpZGVvLlRBUkdFVDFfTUFTSzsKCX0gZWxzZSBpZiAoKG1hc2sgJiB2aWRlby5QUklPUklUWV9NQVNLKSA+IChvbGRTdGVuY2lsICYgdmlkZW8uUFJJT1JJVFlfTUFTSykpIHsKCQkvLyBXZSdyZSBiZWxvdyBhbm90aGVyIGxheWVyLCBidXQgbWlnaHQgYmUgdGhlIGJsZW5kIHRhcmdldCBmb3IgaXQKCQlzdGVuY2lsID0gb2xkU3RlbmNpbCAmIH4odmlkZW8uVEFSR0VUMV9NQVNLIHwgdmlkZW8uVEFSR0VUMl9NQVNLKTsKCQlpZiAobWFzayAmIHZpZGVvLlRBUkdFVDJfTUFTSyAmJiBvbGRTdGVuY2lsICYgdmlkZW8uVEFSR0VUMV9NQVNLKSB7CgkJCXBpeGVsID0gdmlkZW8ucGFsZXR0ZS5taXgodmlkZW8uYmxlbmRCLCBwaXhlbCwgdmlkZW8uYmxlbmRBLCBiYWNraW5nLmNvbG9yW29mZnNldF0pOwoJCX0gZWxzZSB7CgkJCXJldHVybjsKCQl9Cgl9IGVsc2UgewoJCXJldHVybjsKCX0KCglpZiAobWFzayAmIHZpZGVvLk9CSldJTl9NQVNLKSB7CgkJLy8gV2UgQVJFIHRoZSBvYmplY3Qgd2luZG93LCBkb24ndCBkcmF3IHBpeGVscyEKCQliYWNraW5nLnN0ZW5jaWxbb2Zmc2V0XSB8PSB2aWRlby5PQkpXSU5fTUFTSzsKCQlyZXR1cm47Cgl9CgliYWNraW5nLmNvbG9yW29mZnNldF0gPSBwaXhlbDsKCWJhY2tpbmcuc3RlbmNpbFtvZmZzZXRdID0gc3RlbmNpbDsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuaWRlbnRpdHkgPSBmdW5jdGlvbih4KSB7CglyZXR1cm4geDsKfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuZHJhd1NjYW5saW5lQmxhbmsgPSBmdW5jdGlvbihiYWNraW5nKSB7Cglmb3IgKHZhciB4ID0gMDsgeCA8IHRoaXMuSE9SSVpPTlRBTF9QSVhFTFM7ICsreCkgewoJCWJhY2tpbmcuY29sb3JbeF0gPSAweEZGRkY7CgkJYmFja2luZy5zdGVuY2lsW3hdID0gMDsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUucHJlcGFyZVNjYW5saW5lID0gZnVuY3Rpb24oYmFja2luZykgewoJZm9yICh2YXIgeCA9IDA7IHggPCB0aGlzLkhPUklaT05UQUxfUElYRUxTOyArK3gpIHsKCQliYWNraW5nLnN0ZW5jaWxbeF0gPSB0aGlzLnRhcmdldDJbdGhpcy5MQVlFUl9CQUNLRFJPUF07Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLmRyYXdTY2FubGluZUJHTW9kZTAgPSBmdW5jdGlvbihiYWNraW5nLCBiZywgc3RhcnQsIGVuZCkgewoJdmFyIHZpZGVvID0gdGhpcy52aWRlbzsKCXZhciB4OwoJdmFyIHkgPSB2aWRlby52Y291bnQ7Cgl2YXIgb2Zmc2V0ID0gc3RhcnQ7Cgl2YXIgeE9mZiA9IGJnLng7Cgl2YXIgeU9mZiA9IGJnLnk7Cgl2YXIgbG9jYWxYOwoJdmFyIGxvY2FsWExvOwoJdmFyIGxvY2FsWSA9IHkgKyB5T2ZmOwoJaWYgKHRoaXMubW9zYWljKSB7CgkJbG9jYWxZIC09IHkgJSB2aWRlby5iZ01vc2FpY1k7Cgl9Cgl2YXIgbG9jYWxZTG8gPSBsb2NhbFkgJiAweDc7Cgl2YXIgbW9zYWljWDsKCXZhciBzY3JlZW5CYXNlID0gYmcuc2NyZWVuQmFzZTsKCXZhciBjaGFyQmFzZSA9IGJnLmNoYXJCYXNlOwoJdmFyIHNpemUgPSBiZy5zaXplOwoJdmFyIGluZGV4ID0gYmcuaW5kZXg7Cgl2YXIgbWFwID0gdmlkZW8uc2hhcmVkTWFwOwoJdmFyIHBhbGV0dGVTaGlmdCA9IGJnLm11bHRpcGFsZXR0ZSA/IDEgOiAwOwoJdmFyIG1hc2sgPSB2aWRlby50YXJnZXQyW2luZGV4XSB8IChiZy5wcmlvcml0eSA8PCAxKSB8IHZpZGVvLkJBQ0tHUk9VTkRfTUFTSzsKCWlmICh2aWRlby5ibGVuZE1vZGUgPT0gMSAmJiB2aWRlby5hbHBoYUVuYWJsZWQpIHsKCQltYXNrIHw9IHZpZGVvLnRhcmdldDFbaW5kZXhdOwoJfQoKCXZhciB5QmFzZSA9IChsb2NhbFkgPDwgMykgJiAweDdDMDsKCWlmIChzaXplID09IDIpIHsKCQl5QmFzZSArPSAobG9jYWxZIDw8IDMpICYgMHg4MDA7Cgl9IGVsc2UgaWYgKHNpemUgPT0gMykgewoJCXlCYXNlICs9IChsb2NhbFkgPDwgNCkgJiAweDEwMDA7Cgl9CgoJdmFyIHhNYXNrOwoJaWYgKHNpemUgJiAxKSB7CgkJeE1hc2sgPSAweDFGRjsKCX0gZWxzZSB7CgkJeE1hc2sgPSAweEZGOwoJfQoKCXZpZGVvLmFjY2Vzc01hcE1vZGUwKHNjcmVlbkJhc2UsIHNpemUsIChzdGFydCArIHhPZmYpICYgeE1hc2ssIHlCYXNlLCBtYXApOwoJdmFyIHRpbGVSb3cgPSB2aWRlby5hY2Nlc3NUaWxlKGNoYXJCYXNlLCBtYXAudGlsZSA8PCBwYWxldHRlU2hpZnQsICghbWFwLnZmbGlwID8gbG9jYWxZTG8gOiA3IC0gbG9jYWxZTG8pIDw8IHBhbGV0dGVTaGlmdCk7Cglmb3IgKHggPSBzdGFydDsgeCA8IGVuZDsgKyt4KSB7CgkJbG9jYWxYID0gKHggKyB4T2ZmKSAmIHhNYXNrOwoJCW1vc2FpY1ggPSB0aGlzLm1vc2FpYyA/IG9mZnNldCAlIHZpZGVvLmJnTW9zYWljWCA6IDA7CgkJbG9jYWxYIC09IG1vc2FpY1g7CgkJbG9jYWxYTG8gPSBsb2NhbFggJiAweDc7CgkJaWYgKCFwYWxldHRlU2hpZnQpIHsKCQkJaWYgKCFsb2NhbFhMbyB8fCAodGhpcy5tb3NhaWMgJiYgIW1vc2FpY1gpKSB7CgkJCQl2aWRlby5hY2Nlc3NNYXBNb2RlMChzY3JlZW5CYXNlLCBzaXplLCBsb2NhbFgsIHlCYXNlLCBtYXApOwoJCQkJdGlsZVJvdyA9IHZpZGVvLmFjY2Vzc1RpbGUoY2hhckJhc2UsIG1hcC50aWxlLCAhbWFwLnZmbGlwID8gbG9jYWxZTG8gOiA3IC0gbG9jYWxZTG8pOwoJCQkJaWYgKCF0aWxlUm93ICYmICFsb2NhbFhMbykgewoJCQkJCXggKz0gNzsKCQkJCQlvZmZzZXQgKz0gODsKCQkJCQljb250aW51ZTsKCQkJCX0KCQkJfQoJCX0gZWxzZSB7CgkJCWlmICghbG9jYWxYTG8gfHwgKHRoaXMubW9zYWljICYmICFtb3NhaWNYKSkgewoJCQkJdmlkZW8uYWNjZXNzTWFwTW9kZTAoc2NyZWVuQmFzZSwgc2l6ZSwgbG9jYWxYLCB5QmFzZSwgbWFwKTsKCQkJfQoJCQlpZiAoIShsb2NhbFhMbyAmIDB4MykgfHwgKHRoaXMubW9zYWljICYmICFtb3NhaWNYKSkgewoJCQkJdGlsZVJvdyA9IHZpZGVvLmFjY2Vzc1RpbGUoY2hhckJhc2UgKyAoISEobG9jYWxYICYgMHg0KSA9PSAhbWFwLmhmbGlwID8gNCA6IDApLCBtYXAudGlsZSA8PCAxLCAoIW1hcC52ZmxpcCA/IGxvY2FsWUxvIDogNyAtIGxvY2FsWUxvKSA8PCAxKTsKCQkJCWlmICghdGlsZVJvdyAmJiAhKGxvY2FsWExvICYgMHgzKSkgewoJCQkJCXggKz0gMzsKCQkJCQlvZmZzZXQgKz0gNDsKCQkJCQljb250aW51ZTsKCQkJCX0KCQkJfQoJCX0KCQlpZiAobWFwLmhmbGlwKSB7CgkJCWxvY2FsWExvID0gNyAtIGxvY2FsWExvOwoJCX0KCQliZy5wdXNoUGl4ZWwoaW5kZXgsIG1hcCwgdmlkZW8sIHRpbGVSb3csIGxvY2FsWExvLCBvZmZzZXQsIGJhY2tpbmcsIG1hc2ssIGZhbHNlKTsKCQlvZmZzZXQrKzsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuZHJhd1NjYW5saW5lQkdNb2RlMiA9IGZ1bmN0aW9uKGJhY2tpbmcsIGJnLCBzdGFydCwgZW5kKSB7Cgl2YXIgdmlkZW8gPSB0aGlzLnZpZGVvOwoJdmFyIHg7Cgl2YXIgeSA9IHZpZGVvLnZjb3VudDsKCXZhciBvZmZzZXQgPSBzdGFydDsKCXZhciBsb2NhbFg7Cgl2YXIgbG9jYWxZOwoJdmFyIHNjcmVlbkJhc2UgPSBiZy5zY3JlZW5CYXNlOwoJdmFyIGNoYXJCYXNlID0gYmcuY2hhckJhc2U7Cgl2YXIgc2l6ZSA9IGJnLnNpemU7Cgl2YXIgc2l6ZUFkanVzdGVkID0gMTI4IDw8IHNpemU7Cgl2YXIgaW5kZXggPSBiZy5pbmRleDsKCXZhciBtYXAgPSB2aWRlby5zaGFyZWRNYXA7Cgl2YXIgY29sb3I7Cgl2YXIgbWFzayA9IHZpZGVvLnRhcmdldDJbaW5kZXhdIHwgKGJnLnByaW9yaXR5IDw8IDEpIHwgdmlkZW8uQkFDS0dST1VORF9NQVNLOwoJaWYgKHZpZGVvLmJsZW5kTW9kZSA9PSAxICYmIHZpZGVvLmFscGhhRW5hYmxlZCkgewoJCW1hc2sgfD0gdmlkZW8udGFyZ2V0MVtpbmRleF07Cgl9CgoJdmFyIHlCYXNlOwoKCWZvciAoeCA9IHN0YXJ0OyB4IDwgZW5kOyArK3gpIHsKCQlsb2NhbFggPSBiZy5keCAqIHggKyBiZy5zeDsKCQlsb2NhbFkgPSBiZy5keSAqIHggKyBiZy5zeTsKCQlpZiAodGhpcy5tb3NhaWMpIHsKCQkJbG9jYWxYIC09ICh4ICUgdmlkZW8uYmdNb3NhaWNYKSAqIGJnLmR4ICsgKHkgJSB2aWRlby5iZ01vc2FpY1kpICogYmcuZG14OwoJCQlsb2NhbFkgLT0gKHggJSB2aWRlby5iZ01vc2FpY1gpICogYmcuZHkgKyAoeSAlIHZpZGVvLmJnTW9zYWljWSkgKiBiZy5kbXk7CgkJfQoJCWlmIChiZy5vdmVyZmxvdykgewoJCQlsb2NhbFggJj0gc2l6ZUFkanVzdGVkIC0gMTsKCQkJaWYgKGxvY2FsWCA8IDApIHsKCQkJCWxvY2FsWCArPSBzaXplQWRqdXN0ZWQ7CgkJCX0KCQkJbG9jYWxZICY9IHNpemVBZGp1c3RlZCAtIDE7CgkJCWlmIChsb2NhbFkgPCAwKSB7CgkJCQlsb2NhbFkgKz0gc2l6ZUFkanVzdGVkOwoJCQl9CgkJfSBlbHNlIGlmIChsb2NhbFggPCAwIHx8IGxvY2FsWSA8IDAgfHwgbG9jYWxYID49IHNpemVBZGp1c3RlZCB8fCBsb2NhbFkgPj0gc2l6ZUFkanVzdGVkKSB7CgkJCW9mZnNldCsrOwoJCQljb250aW51ZTsKCQl9CgkJeUJhc2UgPSAoKGxvY2FsWSA8PCAxKSAmIDB4N0YwKSA8PCBzaXplOwoJCXZpZGVvLmFjY2Vzc01hcE1vZGUxKHNjcmVlbkJhc2UsIHNpemUsIGxvY2FsWCwgeUJhc2UsIG1hcCk7CgkJY29sb3IgPSB0aGlzLnZyYW0ubG9hZFU4KGNoYXJCYXNlICsgKG1hcC50aWxlIDw8IDYpICsgKChsb2NhbFkgJiAweDcpIDw8IDMpICsgKGxvY2FsWCAmIDB4NykpOwoJCWJnLnB1c2hQaXhlbChpbmRleCwgbWFwLCB2aWRlbywgY29sb3IsIDAsIG9mZnNldCwgYmFja2luZywgbWFzaywgZmFsc2UpOwoJCW9mZnNldCsrOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5kcmF3U2NhbmxpbmVCR01vZGUzID0gZnVuY3Rpb24oYmFja2luZywgYmcsIHN0YXJ0LCBlbmQpIHsKCXZhciB2aWRlbyA9IHRoaXMudmlkZW87Cgl2YXIgeDsKCXZhciB5ID0gdmlkZW8udmNvdW50OwoJdmFyIG9mZnNldCA9IHN0YXJ0OwoJdmFyIGxvY2FsWDsKCXZhciBsb2NhbFk7Cgl2YXIgaW5kZXggPSBiZy5pbmRleDsKCXZhciBtYXAgPSB2aWRlby5zaGFyZWRNYXA7Cgl2YXIgY29sb3I7Cgl2YXIgbWFzayA9IHZpZGVvLnRhcmdldDJbaW5kZXhdIHwgKGJnLnByaW9yaXR5IDw8IDEpIHwgdmlkZW8uQkFDS0dST1VORF9NQVNLOwoJaWYgKHZpZGVvLmJsZW5kTW9kZSA9PSAxICYmIHZpZGVvLmFscGhhRW5hYmxlZCkgewoJCW1hc2sgfD0gdmlkZW8udGFyZ2V0MVtpbmRleF07Cgl9CgoJdmFyIHlCYXNlOwoKCWZvciAoeCA9IHN0YXJ0OyB4IDwgZW5kOyArK3gpIHsKCQlsb2NhbFggPSBiZy5keCAqIHggKyBiZy5zeDsKCQlsb2NhbFkgPSBiZy5keSAqIHggKyBiZy5zeTsKCQlpZiAodGhpcy5tb3NhaWMpIHsKCQkJbG9jYWxYIC09ICh4ICUgdmlkZW8uYmdNb3NhaWNYKSAqIGJnLmR4ICsgKHkgJSB2aWRlby5iZ01vc2FpY1kpICogYmcuZG14OwoJCQlsb2NhbFkgLT0gKHggJSB2aWRlby5iZ01vc2FpY1gpICogYmcuZHkgKyAoeSAlIHZpZGVvLmJnTW9zYWljWSkgKiBiZy5kbXk7CgkJfQoJCWlmIChsb2NhbFggPCAwIHx8IGxvY2FsWSA8IDAgfHwgbG9jYWxYID49IHZpZGVvLkhPUklaT05UQUxfUElYRUxTIHx8IGxvY2FsWSA+PSB2aWRlby5WRVJUSUNBTF9QSVhFTFMpIHsKCQkJb2Zmc2V0Kys7CgkJCWNvbnRpbnVlOwoJCX0KCQljb2xvciA9IHRoaXMudnJhbS5sb2FkVTE2KCgobG9jYWxZICogdmlkZW8uSE9SSVpPTlRBTF9QSVhFTFMpICsgbG9jYWxYKSA8PCAxKTsKCQliZy5wdXNoUGl4ZWwoaW5kZXgsIG1hcCwgdmlkZW8sIGNvbG9yLCAwLCBvZmZzZXQsIGJhY2tpbmcsIG1hc2ssIHRydWUpOwoJCW9mZnNldCsrOwoJfQp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5kcmF3U2NhbmxpbmVCR01vZGU0ID0gZnVuY3Rpb24oYmFja2luZywgYmcsIHN0YXJ0LCBlbmQpIHsKCXZhciB2aWRlbyA9IHRoaXMudmlkZW87Cgl2YXIgeDsKCXZhciB5ID0gdmlkZW8udmNvdW50OwoJdmFyIG9mZnNldCA9IHN0YXJ0OwoJdmFyIGxvY2FsWDsKCXZhciBsb2NhbFk7Cgl2YXIgY2hhckJhc2UgPSAwOwoJaWYgKHZpZGVvLmRpc3BsYXlGcmFtZVNlbGVjdCkgewoJCWNoYXJCYXNlICs9IDB4QTAwMDsKCX0KCXZhciBzaXplID0gYmcuc2l6ZTsKCXZhciBpbmRleCA9IGJnLmluZGV4OwoJdmFyIG1hcCA9IHZpZGVvLnNoYXJlZE1hcDsKCXZhciBjb2xvcjsKCXZhciBtYXNrID0gdmlkZW8udGFyZ2V0MltpbmRleF0gfCAoYmcucHJpb3JpdHkgPDwgMSkgfCB2aWRlby5CQUNLR1JPVU5EX01BU0s7CglpZiAodmlkZW8uYmxlbmRNb2RlID09IDEgJiYgdmlkZW8uYWxwaGFFbmFibGVkKSB7CgkJbWFzayB8PSB2aWRlby50YXJnZXQxW2luZGV4XTsKCX0KCgl2YXIgeUJhc2U7CgoJZm9yICh4ID0gc3RhcnQ7IHggPCBlbmQ7ICsreCkgewoJCWxvY2FsWCA9IGJnLmR4ICogeCArIGJnLnN4OwoJCWxvY2FsWSA9IDAgfCBiZy5keSAqIHggKyBiZy5zeTsKCQlpZiAodGhpcy5tb3NhaWMpIHsKCQkJbG9jYWxYIC09ICh4ICUgdmlkZW8uYmdNb3NhaWNYKSAqIGJnLmR4ICsgKHkgJSB2aWRlby5iZ01vc2FpY1kpICogYmcuZG14OwoJCQlsb2NhbFkgLT0gKHggJSB2aWRlby5iZ01vc2FpY1gpICogYmcuZHkgKyAoeSAlIHZpZGVvLmJnTW9zYWljWSkgKiBiZy5kbXk7CgkJfQoJCXlCYXNlID0gKGxvY2FsWSA8PCAyKSAmIDB4N0UwOwoJCWlmIChsb2NhbFggPCAwIHx8IGxvY2FsWSA8IDAgfHwgbG9jYWxYID49IHZpZGVvLkhPUklaT05UQUxfUElYRUxTIHx8IGxvY2FsWSA+PSB2aWRlby5WRVJUSUNBTF9QSVhFTFMpIHsKCQkJb2Zmc2V0Kys7CgkJCWNvbnRpbnVlOwoJCX0KCQljb2xvciA9IHRoaXMudnJhbS5sb2FkVTgoY2hhckJhc2UgKyAobG9jYWxZICogdmlkZW8uSE9SSVpPTlRBTF9QSVhFTFMpICsgbG9jYWxYKTsKCQliZy5wdXNoUGl4ZWwoaW5kZXgsIG1hcCwgdmlkZW8sIGNvbG9yLCAwLCBvZmZzZXQsIGJhY2tpbmcsIG1hc2ssIGZhbHNlKTsKCQlvZmZzZXQrKzsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuZHJhd1NjYW5saW5lQkdNb2RlNSA9IGZ1bmN0aW9uKGJhY2tpbmcsIGJnLCBzdGFydCwgZW5kKSB7Cgl2YXIgdmlkZW8gPSB0aGlzLnZpZGVvOwoJdmFyIHg7Cgl2YXIgeSA9IHZpZGVvLnZjb3VudDsKCXZhciBvZmZzZXQgPSBzdGFydDsKCXZhciBsb2NhbFg7Cgl2YXIgbG9jYWxZOwoJdmFyIGNoYXJCYXNlID0gMDsKCWlmICh2aWRlby5kaXNwbGF5RnJhbWVTZWxlY3QpIHsKCQljaGFyQmFzZSArPSAweEEwMDA7Cgl9Cgl2YXIgaW5kZXggPSBiZy5pbmRleDsKCXZhciBtYXAgPSB2aWRlby5zaGFyZWRNYXA7Cgl2YXIgY29sb3I7Cgl2YXIgbWFzayA9IHZpZGVvLnRhcmdldDJbaW5kZXhdIHwgKGJnLnByaW9yaXR5IDw8IDEpIHwgdmlkZW8uQkFDS0dST1VORF9NQVNLOwoJaWYgKHZpZGVvLmJsZW5kTW9kZSA9PSAxICYmIHZpZGVvLmFscGhhRW5hYmxlZCkgewoJCW1hc2sgfD0gdmlkZW8udGFyZ2V0MVtpbmRleF07Cgl9CgoJdmFyIHlCYXNlOwoKCWZvciAoeCA9IHN0YXJ0OyB4IDwgZW5kOyArK3gpIHsKCQlsb2NhbFggPSBiZy5keCAqIHggKyBiZy5zeDsKCQlsb2NhbFkgPSBiZy5keSAqIHggKyBiZy5zeTsKCQlpZiAodGhpcy5tb3NhaWMpIHsKCQkJbG9jYWxYIC09ICh4ICUgdmlkZW8uYmdNb3NhaWNYKSAqIGJnLmR4ICsgKHkgJSB2aWRlby5iZ01vc2FpY1kpICogYmcuZG14OwoJCQlsb2NhbFkgLT0gKHggJSB2aWRlby5iZ01vc2FpY1gpICogYmcuZHkgKyAoeSAlIHZpZGVvLmJnTW9zYWljWSkgKiBiZy5kbXk7CgkJfQoJCWlmIChsb2NhbFggPCAwIHx8IGxvY2FsWSA8IDAgfHwgbG9jYWxYID49IDE2MCB8fCBsb2NhbFkgPj0gMTI4KSB7CgkJCW9mZnNldCsrOwoJCQljb250aW51ZTsKCQl9CgkJY29sb3IgPSB0aGlzLnZyYW0ubG9hZFUxNihjaGFyQmFzZSArICgobG9jYWxZICogMTYwKSArIGxvY2FsWCkgPDwgMSk7CgkJYmcucHVzaFBpeGVsKGluZGV4LCBtYXAsIHZpZGVvLCBjb2xvciwgMCwgb2Zmc2V0LCBiYWNraW5nLCBtYXNrLCB0cnVlKTsKCQlvZmZzZXQrKzsKCX0KfTsKCkdhbWVCb3lBZHZhbmNlU29mdHdhcmVSZW5kZXJlci5wcm90b3R5cGUuZHJhd1NjYW5saW5lID0gZnVuY3Rpb24oeSkgewoJdmFyIGJhY2tpbmcgPSB0aGlzLnNjYW5saW5lOwoJaWYgKHRoaXMuZm9yY2VkQmxhbmspIHsKCQl0aGlzLmRyYXdTY2FubGluZUJsYW5rKGJhY2tpbmcpOwoJCXJldHVybjsKCX0KCXRoaXMucHJlcGFyZVNjYW5saW5lKGJhY2tpbmcpOwoJdmFyIGxheWVyOwoJdmFyIGZpcnN0U3RhcnQ7Cgl2YXIgZmlyc3RFbmQ7Cgl2YXIgbGFzdFN0YXJ0OwoJdmFyIGxhc3RFbmQ7Cgl0aGlzLnZjb3VudCA9IHk7CgkvLyBEcmF3IGxvd2VyIHByaW9yaXR5IGZpcnN0IGFuZCB0aGVuIGRyYXcgb3ZlciB0aGVtCglmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZHJhd0xheWVycy5sZW5ndGg7ICsraSkgewoJCWxheWVyID0gdGhpcy5kcmF3TGF5ZXJzW2ldOwoJCWlmICghbGF5ZXIuZW5hYmxlZCkgewoJCQljb250aW51ZTsKCQl9CgkJdGhpcy5vYmp3aW5BY3RpdmUgPSBmYWxzZTsKCQlpZiAoISh0aGlzLndpbjAgfHwgdGhpcy53aW4xIHx8IHRoaXMub2Jqd2luKSkgewoJCQl0aGlzLnNldEJsZW5kRW5hYmxlZChsYXllci5pbmRleCwgdGhpcy50YXJnZXQxW2xheWVyLmluZGV4XSwgdGhpcy5ibGVuZE1vZGUpOwoJCQlsYXllci5kcmF3U2NhbmxpbmUoYmFja2luZywgbGF5ZXIsIDAsIHRoaXMuSE9SSVpPTlRBTF9QSVhFTFMpOwoJCX0gZWxzZSB7CgkJCWZpcnN0U3RhcnQgPSAwOwoJCQlmaXJzdEVuZCA9IHRoaXMuSE9SSVpPTlRBTF9QSVhFTFM7CgkJCWxhc3RTdGFydCA9IDA7CgkJCWxhc3RFbmQgPSB0aGlzLkhPUklaT05UQUxfUElYRUxTOwoJCQlpZiAodGhpcy53aW4wICYmIHkgPj0gdGhpcy53aW4wVG9wICYmIHkgPCB0aGlzLndpbjBCb3R0b20pIHsKCQkJCWlmICh0aGlzLndpbmRvd3NbMF0uZW5hYmxlZFtsYXllci5pbmRleF0pIHsKCQkJCQl0aGlzLnNldEJsZW5kRW5hYmxlZChsYXllci5pbmRleCwgdGhpcy53aW5kb3dzWzBdLnNwZWNpYWwgJiYgdGhpcy50YXJnZXQxW2xheWVyLmluZGV4XSwgdGhpcy5ibGVuZE1vZGUpOwoJCQkJCWxheWVyLmRyYXdTY2FubGluZShiYWNraW5nLCBsYXllciwgdGhpcy53aW4wTGVmdCwgdGhpcy53aW4wUmlnaHQpOwoJCQkJfQoJCQkJZmlyc3RTdGFydCA9IE1hdGgubWF4KGZpcnN0U3RhcnQsIHRoaXMud2luMExlZnQpOwoJCQkJZmlyc3RFbmQgPSBNYXRoLm1pbihmaXJzdEVuZCwgdGhpcy53aW4wTGVmdCk7CgkJCQlsYXN0U3RhcnQgPSBNYXRoLm1heChsYXN0U3RhcnQsIHRoaXMud2luMFJpZ2h0KTsKCQkJCWxhc3RFbmQgPSBNYXRoLm1pbihsYXN0RW5kLCB0aGlzLndpbjBSaWdodCk7CgkJCX0KCQkJaWYgKHRoaXMud2luMSAmJiB5ID49IHRoaXMud2luMVRvcCAmJiB5IDwgdGhpcy53aW4xQm90dG9tKSB7CgkJCQlpZiAodGhpcy53aW5kb3dzWzFdLmVuYWJsZWRbbGF5ZXIuaW5kZXhdKSB7CgkJCQkJdGhpcy5zZXRCbGVuZEVuYWJsZWQobGF5ZXIuaW5kZXgsIHRoaXMud2luZG93c1sxXS5zcGVjaWFsICYmIHRoaXMudGFyZ2V0MVtsYXllci5pbmRleF0sIHRoaXMuYmxlbmRNb2RlKTsKCQkJCQlpZiAoIXRoaXMud2luZG93c1swXS5lbmFibGVkW2xheWVyLmluZGV4XSAmJiAodGhpcy53aW4xTGVmdCA8IGZpcnN0U3RhcnQgfHwgdGhpcy53aW4xUmlnaHQgPCBsYXN0U3RhcnQpKSB7CgkJCQkJCS8vIFdlJ3ZlIGJlZW4gY3V0IGluIHR3byBieSB3aW5kb3cgMCEKCQkJCQkJbGF5ZXIuZHJhd1NjYW5saW5lKGJhY2tpbmcsIGxheWVyLCB0aGlzLndpbjFMZWZ0LCBmaXJzdFN0YXJ0KTsKCQkJCQkJbGF5ZXIuZHJhd1NjYW5saW5lKGJhY2tpbmcsIGxheWVyLCBsYXN0RW5kLCB0aGlzLndpbjFSaWdodCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJbGF5ZXIuZHJhd1NjYW5saW5lKGJhY2tpbmcsIGxheWVyLCB0aGlzLndpbjFMZWZ0LCB0aGlzLndpbjFSaWdodCk7CgkJCQkJfQoJCQkJfQoJCQkJZmlyc3RTdGFydCA9IE1hdGgubWF4KGZpcnN0U3RhcnQsIHRoaXMud2luMUxlZnQpOwoJCQkJZmlyc3RFbmQgPSBNYXRoLm1pbihmaXJzdEVuZCwgdGhpcy53aW4xTGVmdCk7CgkJCQlsYXN0U3RhcnQgPSBNYXRoLm1heChsYXN0U3RhcnQsIHRoaXMud2luMVJpZ2h0KTsKCQkJCWxhc3RFbmQgPSBNYXRoLm1pbihsYXN0RW5kLCB0aGlzLndpbjFSaWdodCk7CgkJCX0KCQkJLy8gRG8gbGFzdCB0d28KCQkJaWYgKHRoaXMud2luZG93c1syXS5lbmFibGVkW2xheWVyLmluZGV4XSB8fCAodGhpcy5vYmp3aW4gJiYgdGhpcy53aW5kb3dzWzNdLmVuYWJsZWRbbGF5ZXIuaW5kZXhdKSkgewoJCQkJLy8gV0lOT1VUL09CSldJTgoJCQkJdGhpcy5vYmp3aW5BY3RpdmUgPSB0aGlzLm9iandpbjsKCQkJCXRoaXMuc2V0QmxlbmRFbmFibGVkKGxheWVyLmluZGV4LCB0aGlzLndpbmRvd3NbMl0uc3BlY2lhbCAmJiB0aGlzLnRhcmdldDFbbGF5ZXIuaW5kZXhdLCB0aGlzLmJsZW5kTW9kZSk7IC8vIFdpbmRvdyAzIGhhbmRsZWQgaW4gcHVzaFBpeGVsCgkJCQlpZiAoZmlyc3RFbmQgPiBsYXN0U3RhcnQpIHsKCQkJCQlsYXllci5kcmF3U2NhbmxpbmUoYmFja2luZywgbGF5ZXIsIDAsIHRoaXMuSE9SSVpPTlRBTF9QSVhFTFMpOwoJCQkJfSBlbHNlIHsKCQkJCQlpZiAoZmlyc3RFbmQpIHsKCQkJCQkJbGF5ZXIuZHJhd1NjYW5saW5lKGJhY2tpbmcsIGxheWVyLCAwLCBmaXJzdEVuZCk7CgkJCQkJfQoJCQkJCWlmIChsYXN0U3RhcnQgPCB0aGlzLkhPUklaT05UQUxfUElYRUxTKSB7CgkJCQkJCWxheWVyLmRyYXdTY2FubGluZShiYWNraW5nLCBsYXllciwgbGFzdFN0YXJ0LCB0aGlzLkhPUklaT05UQUxfUElYRUxTKTsKCQkJCQl9CgkJCQkJaWYgKGxhc3RFbmQgPCBmaXJzdFN0YXJ0KSB7CgkJCQkJCWxheWVyLmRyYXdTY2FubGluZShiYWNraW5nLCBsYXllciwgbGFzdEVuZCwgZmlyc3RTdGFydCk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQl0aGlzLnNldEJsZW5kRW5hYmxlZCh0aGlzLkxBWUVSX0JBQ0tEUk9QLCB0aGlzLnRhcmdldDFbdGhpcy5MQVlFUl9CQUNLRFJPUF0gJiYgdGhpcy53aW5kb3dzWzJdLnNwZWNpYWwsIHRoaXMuYmxlbmRNb2RlKTsKCQl9CgkJaWYgKGxheWVyLmJnKSB7CgkJCWxheWVyLnN4ICs9IGxheWVyLmRteDsKCQkJbGF5ZXIuc3kgKz0gbGF5ZXIuZG15OwoJCX0KCX0KCgl0aGlzLmZpbmlzaFNjYW5saW5lKGJhY2tpbmcpOwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5maW5pc2hTY2FubGluZSA9IGZ1bmN0aW9uKGJhY2tpbmcpIHsKCXZhciBjb2xvcjsKCXZhciBiZCA9IHRoaXMucGFsZXR0ZS5hY2Nlc3NDb2xvcih0aGlzLkxBWUVSX0JBQ0tEUk9QLCAwKTsKCXZhciB4eCA9IHRoaXMudmNvdW50ICogdGhpcy5IT1JJWk9OVEFMX1BJWEVMUyAqIDQ7Cgl2YXIgaXNUYXJnZXQyID0gdGhpcy50YXJnZXQyW3RoaXMuTEFZRVJfQkFDS0RST1BdOwoJZm9yICh2YXIgeCA9IDA7IHggPCB0aGlzLkhPUklaT05UQUxfUElYRUxTOyArK3gpIHsKCQlpZiAoYmFja2luZy5zdGVuY2lsW3hdICYgdGhpcy5XUklUVEVOX01BU0spIHsKCQkJY29sb3IgPSBiYWNraW5nLmNvbG9yW3hdOwoJCQlpZiAoaXNUYXJnZXQyICYmIGJhY2tpbmcuc3RlbmNpbFt4XSAmIHRoaXMuVEFSR0VUMV9NQVNLKSB7CgkJCQljb2xvciA9IHRoaXMucGFsZXR0ZS5taXgodGhpcy5ibGVuZEEsIGNvbG9yLCB0aGlzLmJsZW5kQiwgYmQpOwoJCQl9CgkJCXRoaXMucGFsZXR0ZS5jb252ZXJ0MTZUbzMyKGNvbG9yLCB0aGlzLnNoYXJlZENvbG9yKTsKCQl9IGVsc2UgewoJCQl0aGlzLnBhbGV0dGUuY29udmVydDE2VG8zMihiZCwgdGhpcy5zaGFyZWRDb2xvcik7CgkJfQoJCXRoaXMucGl4ZWxEYXRhLmRhdGFbeHgrK10gPSB0aGlzLnNoYXJlZENvbG9yWzBdOwoJCXRoaXMucGl4ZWxEYXRhLmRhdGFbeHgrK10gPSB0aGlzLnNoYXJlZENvbG9yWzFdOwoJCXRoaXMucGl4ZWxEYXRhLmRhdGFbeHgrK10gPSB0aGlzLnNoYXJlZENvbG9yWzJdOwoJCXh4Kys7Cgl9Cn07CgpHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIucHJvdG90eXBlLnN0YXJ0RHJhdyA9IGZ1bmN0aW9uKCkgewoJLy8gTm90aGluZyB0byBkbwp9OwoKR2FtZUJveUFkdmFuY2VTb2Z0d2FyZVJlbmRlcmVyLnByb3RvdHlwZS5maW5pc2hEcmF3ID0gZnVuY3Rpb24oY2FsbGVyKSB7Cgl0aGlzLmJnWzJdLnN4ID0gdGhpcy5iZ1syXS5yZWZ4OwoJdGhpcy5iZ1syXS5zeSA9IHRoaXMuYmdbMl0ucmVmeTsKCXRoaXMuYmdbM10uc3ggPSB0aGlzLmJnWzNdLnJlZng7Cgl0aGlzLmJnWzNdLnN5ID0gdGhpcy5iZ1szXS5yZWZ5OwoJY2FsbGVyLmZpbmlzaERyYXcodGhpcy5waXhlbERhdGEpOwp9Owo=";

const GBA_js_video_worker_js = "aW1wb3J0U2NyaXB0cygnc29mdHdhcmUuanMnKTsKCnZhciB2aWRlbyA9IG5ldyBHYW1lQm95QWR2YW5jZVNvZnR3YXJlUmVuZGVyZXIoKTsKdmFyIHByb3h5QmFja2luZyA9IG51bGw7CnZhciBjdXJyZW50RnJhbWUgPSAwOwoKc2VsZi5maW5pc2hEcmF3ID0gZnVuY3Rpb24ocGl4ZWxEYXRhKSB7CglzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ2ZpbmlzaCcsIGJhY2tpbmc6IHBpeGVsRGF0YSwgZnJhbWU6IGN1cnJlbnRGcmFtZSB9KTsKfQoKZnVuY3Rpb24gcmVjZWl2ZURpcnR5KGRpcnR5KSB7Cglmb3IgKHZhciB0eXBlIGluIGRpcnR5KSB7CgkJc3dpdGNoICh0eXBlKSB7CgkJY2FzZSAnRElTUENOVCc6CgkJCXZpZGVvLndyaXRlRGlzcGxheUNvbnRyb2woZGlydHlbdHlwZV0pOwoJCQlicmVhazsKCQljYXNlICdCR0NOVCc6CgkJCWZvciAodmFyIGkgaW4gZGlydHlbdHlwZV0pIHsKCQkJCWlmICh0eXBlb2YoZGlydHlbdHlwZV1baV0pID09PSAnbnVtYmVyJykgewoJCQkJCXZpZGVvLndyaXRlQmFja2dyb3VuZENvbnRyb2woaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHSE9GUyc6CgkJCWZvciAodmFyIGkgaW4gZGlydHlbdHlwZV0pIHsKCQkJCWlmICh0eXBlb2YoZGlydHlbdHlwZV1baV0pID09PSAnbnVtYmVyJykgewoJCQkJCXZpZGVvLndyaXRlQmFja2dyb3VuZEhPZmZzZXQoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHVk9GUyc6CgkJCWZvciAodmFyIGkgaW4gZGlydHlbdHlwZV0pIHsKCQkJCWlmICh0eXBlb2YoZGlydHlbdHlwZV1baV0pID09PSAnbnVtYmVyJykgewoJCQkJCXZpZGVvLndyaXRlQmFja2dyb3VuZFZPZmZzZXQoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHWCc6CgkJCWZvciAodmFyIGkgaW4gZGlydHlbdHlwZV0pIHsKCQkJCWlmICh0eXBlb2YoZGlydHlbdHlwZV1baV0pID09PSAnbnVtYmVyJykgewoJCQkJCXZpZGVvLndyaXRlQmFja2dyb3VuZFJlZlgoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHWSc6CgkJCWZvciAodmFyIGkgaW4gZGlydHlbdHlwZV0pIHsKCQkJCWlmICh0eXBlb2YoZGlydHlbdHlwZV1baV0pID09PSAnbnVtYmVyJykgewoJCQkJCXZpZGVvLndyaXRlQmFja2dyb3VuZFJlZlkoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHUEEnOgoJCQlmb3IgKHZhciBpIGluIGRpcnR5W3R5cGVdKSB7CgkJCQlpZiAodHlwZW9mKGRpcnR5W3R5cGVdW2ldKSA9PT0gJ251bWJlcicpIHsKCQkJCQl2aWRlby53cml0ZUJhY2tncm91bmRQYXJhbUEoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHUEInOgoJCQlmb3IgKHZhciBpIGluIGRpcnR5W3R5cGVdKSB7CgkJCQlpZiAodHlwZW9mKGRpcnR5W3R5cGVdW2ldKSA9PT0gJ251bWJlcicpIHsKCQkJCQl2aWRlby53cml0ZUJhY2tncm91bmRQYXJhbUIoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHUEMnOgoJCQlmb3IgKHZhciBpIGluIGRpcnR5W3R5cGVdKSB7CgkJCQlpZiAodHlwZW9mKGRpcnR5W3R5cGVdW2ldKSA9PT0gJ251bWJlcicpIHsKCQkJCQl2aWRlby53cml0ZUJhY2tncm91bmRQYXJhbUMoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ0JHUEQnOgoJCQlmb3IgKHZhciBpIGluIGRpcnR5W3R5cGVdKSB7CgkJCQlpZiAodHlwZW9mKGRpcnR5W3R5cGVdW2ldKSA9PT0gJ251bWJlcicpIHsKCQkJCQl2aWRlby53cml0ZUJhY2tncm91bmRQYXJhbUQoaSwgZGlydHlbdHlwZV1baV0pOwoJCQkJfQoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ1dJTjBIJzoKCQkJdmlkZW8ud3JpdGVXaW4wSChkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ1dJTjFIJzoKCQkJdmlkZW8ud3JpdGVXaW4xSChkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ1dJTjBWJzoKCQkJdmlkZW8ud3JpdGVXaW4wVihkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ1dJTjFWJzoKCQkJdmlkZW8ud3JpdGVXaW4xVihkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ1dJTklOJzoKCQkJdmlkZW8ud3JpdGVXaW5JbihkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ1dJTk9VVCc6CgkJCXZpZGVvLndyaXRlV2luT3V0KGRpcnR5W3R5cGVdKTsKCQkJYnJlYWs7CgkJY2FzZSAnQkxEQ05UJzoKCQkJdmlkZW8ud3JpdGVCbGVuZENvbnRyb2woZGlydHlbdHlwZV0pOwoJCQlicmVhazsKCQljYXNlICdCTERBTFBIQSc6CgkJCXZpZGVvLndyaXRlQmxlbmRBbHBoYShkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ0JMRFknOgoJCQl2aWRlby53cml0ZUJsZW5kWShkaXJ0eVt0eXBlXSk7CgkJCWJyZWFrOwoJCWNhc2UgJ01PU0FJQyc6CgkJCXZpZGVvLndyaXRlTW9zYWljKGRpcnR5W3R5cGVdKTsKCQkJYnJlYWs7CgkJY2FzZSAnbWVtb3J5JzoKCQkJcmVjZWl2ZU1lbW9yeShkaXJ0eS5tZW1vcnkpOwoJCQlicmVhazsKCQl9Cgl9Cn0KCmZ1bmN0aW9uIHJlY2VpdmVNZW1vcnkobWVtb3J5KSB7CglpZiAobWVtb3J5LnBhbGV0dGUpIHsKCQl2aWRlby5wYWxldHRlLm92ZXJ3cml0ZShuZXcgVWludDE2QXJyYXkobWVtb3J5LnBhbGV0dGUpKTsKCX0KCWlmIChtZW1vcnkub2FtKSB7CgkJdmlkZW8ub2FtLm92ZXJ3cml0ZShuZXcgVWludDE2QXJyYXkobWVtb3J5Lm9hbSkpOwoJfQoJaWYgKG1lbW9yeS52cmFtKSB7CgkJZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgKytpKSB7CgkJCWlmIChtZW1vcnkudnJhbVtpXSkgewoJCQkJdmlkZW8udnJhbS5pbnNlcnQoaSA8PCAxMiwgbmV3IFVpbnQxNkFycmF5KG1lbW9yeS52cmFtW2ldKSk7CgkJCX0KCQl9Cgl9Cn0KCnZhciBoYW5kbGVycyA9IHsKCWNsZWFyOiBmdW5jdGlvbihkYXRhKSB7CgkJdmlkZW8uY2xlYXIoZGF0YSk7Cgl9LAoKCXNjYW5saW5lOiBmdW5jdGlvbihkYXRhKSB7CgkJcmVjZWl2ZURpcnR5KGRhdGEuZGlydHkpOwoJCXZpZGVvLmRyYXdTY2FubGluZShkYXRhLnksIHByb3h5QmFja2luZyk7Cgl9LAoKCXN0YXJ0OiBmdW5jdGlvbihkYXRhKSB7CgkJcHJveHlCYWNraW5nID0gZGF0YS5iYWNraW5nOwoJCXZpZGVvLnNldEJhY2tpbmcoZGF0YS5iYWNraW5nKTsKCX0sCgoJZmluaXNoOiBmdW5jdGlvbihkYXRhKSB7CgkJY3VycmVudEZyYW1lID0gZGF0YS5mcmFtZTsKCQl2YXIgc2NhbmxpbmUgPSAwOwoJCWZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5zY2FubGluZXMubGVuZ3RoOyArK2kpIHsKCQkJZm9yICh2YXIgeSA9IHNjYW5saW5lOyB5IDwgZGF0YS5zY2FubGluZXNbaV0ueTsgKyt5KSB7CgkJCQl2aWRlby5kcmF3U2NhbmxpbmUoeSwgcHJveHlCYWNraW5nKTsKCQkJfQoJCQlzY2FubGluZSA9IGRhdGEuc2NhbmxpbmVzW2ldLnkgKyAxOwoJCQlyZWNlaXZlRGlydHkoZGF0YS5zY2FubGluZXNbaV0uZGlydHkpOwoJCQl2aWRlby5kcmF3U2NhbmxpbmUoZGF0YS5zY2FubGluZXNbaV0ueSwgcHJveHlCYWNraW5nKTsKCQl9CgkJZm9yICh2YXIgeSA9IHNjYW5saW5lOyB5IDwgMTYwOyArK3kpIHsKCQkJdmlkZW8uZHJhd1NjYW5saW5lKHksIHByb3h5QmFja2luZyk7CgkJfQoJCXZpZGVvLmZpbmlzaERyYXcoc2VsZik7Cgl9LAp9OwoKc2VsZi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihtZXNzYWdlKSB7CgloYW5kbGVyc1ttZXNzYWdlLmRhdGFbJ3R5cGUnXV0obWVzc2FnZS5kYXRhKTsKfTsK";

const GBA_res_crash_png = "iVBORw0KGgoAAAANSUhEUgAAAYAAAAEACAMAAACNqVFVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACdQTFRFY0u/bm5vShKmXDS2kYLMiIiTblfEubnAKys26CwsWFhbGxsjAAAAiP3GPgAAAA10Uk5T////////////////AD3oIoYAAAciSURBVHja7J0Lc6s4DEazaZv2kv7/37vr9dXoYRkIIY1JzzfThodlbJ1BBhOR0zd6qk64AAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAHo6gOt1RAfMt+rxbQbAqwO4Gi2X2uK65XoBAIDnAZj+0/Va/891dPpf+wIozl+qFQAA+KmBzocZGxqKm9qwUf/kv9aRA1Arewyp19dgy/VatSUoAgAA8wBqmKndtkHJd1PLSKmelXWSLxPr1a2xXN4quxUAANgLgK7FE9+e/hocqsvUOlpZJ9mQ0g6hdsmXy1u15hIXAAC4B4C97JQgEsNAtM6s7J6ylIc2D82Wy1sFAAA8GkC8YfJ7egB6N2LtEeJF5VJLfP0AAMBjAZTTX90ja3MDYWvVGz7bej2SeCOWtcq2CAAAuH9CTv/rmp0mmyZZt0uttbWyn9He12vLxnK9VmlJAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAAj9L5TgEAAMcC8OF0Pr/fqfPZ1wgAAIwM4OPj869qAHl/Pzm9rZC3KAiKpN7REAAAAN79MnjWABJdf12hiEFCkYAYCwEAAGAB6KAbQ8/1RimCumQHZQAAYNRB+Hy+XE6Jrhsk7v/zR2FcLqPdmgEAAD4E9QFMN0gBFKdrPQUAIQgAxwTwzw2yAKwAAIBxAfTdvx+A8RAAAAAtgHZaLQL4+qp/2RoAAHB8AGXieA7ANH19TVO+1gNQoQIAAGMDqG6qADQMtSGoOD1f8wCklre3Mtn98fH2BgAAjA2gPjisDyd7AErAsSHIrlkA6vZab6kRAAA4PoC1N2LqdkIQAI4CQL5EUj4rgPqA5VYABYG6/XSqD+W5DAXAmADsVJwA8A8ktwAQt487GQEAAGQAvNt6AL7+ag7A6NNxAABACyD/UkrrfHkE30IAAABeG0B1vk5FZJNxAADAcQG0DyTbyTivdjLOArBT2wAAwPgALpf6aObz894bMXkQWQQAABxpEK4Q7gVQXU8IAsDxB+FtKRqEIAAcB4BNJWoH4W0A2hA01kNJAAAgR9AOwvuEIB7KA2BkAAVBfN1GSbLe4v6a7G2H31J3OQYAADAigPqyJoGQvXCjaNnt7csOpL7qfJL0ADAqAJE8lM9fwDSvLClj5Bf4AQAASyDyV5HNywadsV9dCQAA3BaQ1ukor20FAABuB/EKLywGAAAQAACAAAAAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAAKBnALheb6umfDF8jd2t9d5Wyz61P1axjQAYCUBNcdgGoPx42iMB2Ha1tWxrNQAAEAHUnwHcAuD7e5oeCaDUDgAAPBqA/JclKS7ByQYprUoS5Fo7H9hsSW2K2thy8dMe3Zftbc9aYY8lPZ3rV9yzxqotmfUQAOMD0IBUAoCEprLk95W9dhD2+9RWg5wPc2pjy2UA6nHa0tl23wpvoWWkVM8q98G8VVaybTMAxgRQTezJE0+//HRS5/cDRHRsb1lcai9upeFZ8Mq3z4U07U0c2qOV37/OKi/ZthkAIwKoAcaHBXuKxRMqB2D3xZN6HYBYY34jNg/AtyLuaY+6n1UeZAFwBACx+/3utbcX3lV9258CkPXM15S5ci8rABwfQDmN4g2OfOq+1l1+X3tzpAO97hMbeylXS+klpr0ha9sbt/tW2PrjbaN1WWx7NqgvW2Ul2x4CYDwAOqjWJRla5KdCdItdkvLy5/epbVybpnbNNk9tfIvint722EJ7IZGXb9tue7feqlfStwgA4wF45iSthqYj1r/7Q3kA/DIA+el5nPoBAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAcGwAR0j9uacHy/17nAcAAID+0drUu60tyezsz7/t74G1FgAAQP9oNhFifwA+zQgAAJirrP3yqT1I+3VV+eyXzVOg2oSm3pHbxNA8pTRPbI1BLjuKt7+1hwB4LQAx/TNL1mmbN182r1O+ji5l7XovTdUnz2p4iXvaYCMtnk9iVVf7oDjXQwC8FgB7ynnn+GRSGw58al4/Bbvf9N5l6FxdMYz0AmC/vjzJVOGu6yEAfgOAPDnPnrTPAZCl1a4F0Esy9a8iWO7h2i8CA+D1ALRbfh7A3BHm6+snmVoEyz18YggCwEMBSLqlXO75ZFJ7eebLxokvm7bp64xpovE1GLG8rPvLw3gjth5A3ya+yGauhwB4JQDz6Z/+0ze0l5SqW/Tmx6Z5xuNZm7YNbZpqTKv1CaexZ8vpqG3i6lIPdx2EAfBkALdOxK5JBx03cXSvHgLgtwJYlw46buLoXj0EwG8FgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAG078CDAC2aBhgKkAO3AAAAABJRU5ErkJggg==";

const GBA_res_main_css = "Ym9keSB7Cgl0ZXh0LWFsaWduOiBjZW50ZXI7CgltYXJnaW46IDAgMCAxNXB4OwoJY29sb3I6IHdoaXRlOwoJZm9udC1mYW1pbHk6ICdDYWxpYnJpJywgJ1ZlcmRhbmEnLCBzYW5zLXNlcmlmOwoJZm9udC1zaXplOiAxNXB4OwoJdGV4dC1zaGFkb3c6IDAgMnB4IHJnYmEoMCwgMCwgMCwgMC42KTsKCWJhY2tncm91bmQ6bm9uZSB0cmFuc3BhcmVudDsKfQoKYnV0dG9uIHsKCWZvbnQtZmFtaWx5OiAnQ2FsaWJyaScsICdWZXJkYW5hJywgc2Fucy1zZXJpZjsKfQoKI3NjcmVlbiB7CgliYWNrZ3JvdW5kOmJsYWNrOwoJcGFkZGluZzogMDsKICAgIG1hcmdpbjogYXV0bzsKICAgIGRpc3BsYXk6IGJsb2NrOyAgICAKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHRvcDogMDsKICAgIGJvdHRvbTogMDsKICAgIGxlZnQ6IDA7CiAgICByaWdodDogMDsgCn0KCiNzY3JlZW5bd2lkdGg9IjI0MCJdIHsKCW1hcmdpbi10b3A6IDQyLjVweDsKCW1hcmdpbi1ib3R0b206IC0zNjNweDsgLyogVGFrZSB1cCBubyBoZWlnaHQgKi8KCWltYWdlLXJlbmRlcmluZzogLXdlYmtpdC1vcHRpbWl6ZS1jb250cmFzdDsKCWltYWdlLXJlbmRlcmluZzogLW1vei1jcmlzcC1lZGdlczsKCWltYWdlLXJlbmRlcmluZzogLW8tY3Jpc3AtZWRnZXM7Cgl6b29tOiAyOwoJLW8tdHJhbnNmb3JtOiBzY2FsZSgyKTsKfQoKI2NvbnRyb2xzOjpiZWZvcmUgewoJY29udGVudDogIiI7CglkaXNwbGF5OiBibG9jazsKCWhlaWdodDogMzBweDsKCXdpZHRoOiA2NDdweDsKCWJvcmRlci1yYWRpdXM6IDVweCAvIDE1cHg7Cglib3JkZXI6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuNCk7Cglib3JkZXItd2lkdGg6IDAgMXB4OwoJbWFyZ2luOiAwIC01cHggMjBweDsKCWJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgIzg3NjlBMCwgIzk1NzhCOSAxNSUsICM2QTQ4ODMgNTAlLCAjNDMzMDYxKTsKCWJhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgIzg3NjlBMCwgIzk1NzhCOSAxNSUsICM2QTQ4ODMgNTAlLCAjNDMzMDYxKTsKCWJveC1zaGFkb3c6IDAgNXB4IDRweCAtM3B4IHJnYmEoMCwgMCwgMCwgMC42KTsKCXBvc2l0aW9uOiBhYnNvbHV0ZTsKfQoKI2NvbnRyb2xzIHsKCWJvcmRlci1yYWRpdXM6IDIwcHg7Cglib3JkZXI6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuNCk7Cglib3JkZXItdG9wOiBub25lOwoJYm94LXNoYWRvdzogMCA0cHggNHB4IC0ycHggcmdiYSgwLCAwLCAwLCAwLjkpLCAwIC00MHB4IDJweCAtMXB4ICM0MzMwNjEgaW5zZXQ7Cgl3aWR0aDogNjQwcHg7CgltYXJnaW46IGF1dG87CgloZWlnaHQ6IDIwMHB4OwoJb3ZlcmZsb3c6IGhpZGRlbjsKCWJhY2tncm91bmQtY29sb3I6ICM3NjU0OTA7Cn0KCiNjb250cm9scyA+IGRpdiB7CgltYXJnaW4tdG9wOiAzMHB4OwoJLW1vei10cmFuc2Zvcm0tb3JpZ2luOiA1MCUgMDsKCS1tb3otdHJhbnNmb3JtOiByb3RhdGVYKDBkZWcpOwoJLW1vei10cmFuc2l0aW9uOiAtbW96LXRyYW5zZm9ybSBsaW5lYXIgMC41czsKCS13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbi15OiAycHg7Cgktd2Via2l0LXRyYW5zZm9ybTogcm90YXRlWCgwZGVnKTsKCS13ZWJraXQtdHJhbnNpdGlvbjogLXdlYmtpdC10cmFuc2Zvcm0gbGluZWFyIDAuNXM7Cn0KCiNjcmFzaCB7CgltYXJnaW4tdG9wOiAxMDBweDsKCW1hcmdpbi1ib3R0b206IDE5OXB4Owp9CgpidXR0b24gewoJYmFja2dyb3VuZC1jb2xvcjogIzZBNDg4MzsKCWZvbnQtd2VpZ2h0OiBib2xkOwoJZm9udC1zaXplOiAxOHB4OwoJY29sb3I6IHdoaXRlOwoJdGV4dC1zaGFkb3c6IDAgM3B4ICM0MzMwNjE7CglwYWRkaW5nOiAycHggMTBweCA1cHg7Cglib3JkZXItcmFkaXVzOiAwIDAgMTBweCAxMHB4OwoJYm9yZGVyOiAwIHNvbGlkIHJnYmEoMCwgMCwgMCwgMC40KTsKCWJvcmRlci13aWR0aDogM3B4IDFweCAwcHg7CglkaXNwbGF5OiBpbmxpbmU7Cglib3gtc2hhZG93OiAwIDJweCA2cHggLTFweCByZ2JhKDAsIDAsIDAsIDAuMikgaW5zZXQ7CgltYXJnaW46IDAgMCAyMHB4Owp9CgpsYWJlbCwgI3NvdW5kLCAjY29udHJvbHMgPiBkaXYgPiBwIHsKCWRpc3BsYXk6IGJsb2NrOwoJbWFyZ2luOiA1cHggMzBweDsKCWhlaWdodDogMThweDsKfQoKbGFiZWwsICNzb3VuZCB7CglmbG9hdDogbGVmdDsKCWNsZWFyOiBsZWZ0Owp9Cgojc291bmQgKyBwIHsKCW1hcmdpbi10b3A6IC0yM3B4ICFpbXBvcnRhbnQ7Cn0KCiNjb250cm9scyA+IGRpdiA+IHAgewoJZmxvYXQ6IHJpZ2h0OwoJY2xlYXI6IHJpZ2h0Owp9CgppbnB1dFt0eXBlPWNoZWNrYm94XSB7CgltYXJnaW46IC0zcHggNXB4IDAgMDsKfQoKaW5wdXRbdHlwZT1jaGVja2JveF06OmFmdGVyIHsKCWRpc3BsYXk6IGlubGluZS1ibG9jazsKCWNvbnRlbnQ6ICIiOwoJYmFja2dyb3VuZC1jb2xvcjogIzc2NTQ5MDsKCWJvcmRlcjogMCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMyk7Cglib3JkZXItd2lkdGg6IDFweCAxcHggMnB4OwoJd2lkdGg6IDEycHg7CgloZWlnaHQ6IDEycHg7Cglib3JkZXItcmFkaXVzOiAzcHg7Cglwb3NpdGlvbjogcmVsYXRpdmU7Cgl0b3A6IC0zcHg7Cgl2aXNpYmlsaXR5OiB2aXNpYmxlOwp9CgppbnB1dFt0eXBlPWNoZWNrYm94XTpjaGVja2VkOjphZnRlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiAjNkE0ODgzOwoJYm9yZGVyLXdpZHRoOiAycHggMXB4IDFweDsKCWJveC1zaGFkb3c6IDAgMnB4IDZweCAtMXB4IHJnYmEoMCwgMCwgMCwgMC4yKSBpbnNldDsKfQoKcDpmaXJzdC1jaGlsZCB7CgltYXJnaW4tdG9wOiAwOwp9CgphOmxpbmssIGE6dmlzaXRlZCB7Cgljb2xvcjogI2ZjYjNmMDsKfQoKLmhpZGRlbiB7CgktbW96LXRyYW5zZm9ybTogcm90YXRlWCg5MGRlZykgIWltcG9ydGFudDsKCS13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGVYKDkwZGVnKSAhaW1wb3J0YW50Owp9CgouZGVhZCB7CglkaXNwbGF5OiBub25lOwp9CgppbnB1dFt0eXBlPWZpbGVdIHsKCW9wYWNpdHk6IDAgIWltcG9ydGFudDsKCXdpZHRoOiAwOwoJaGVpZ2h0OiAwOwoJbWFyZ2luOiAwOwoJcGFkZGluZzogMDsKCWJvcmRlcjogbm9uZTsKfQoKaW5wdXRbdHlwZT1yYW5nZV0gewoJd2lkdGg6IDEwMHB4OwoJaGVpZ2h0OiAxNHB4OwoJbWFyZ2luOiAycHg7Cn0KCmZvb3RlciB7Cglmb250LXNpemU6IDEycHg7CglwYWRkaW5nLXRvcDogOHB4Owp9CgpwIHsKCW1hcmdpbjogMDsKfQoKbGFiZWwgcCwgI3NvdW5kIHAgewoJZGlzcGxheTogaW5saW5lOwp9Cgp1bCNsaW5rcyB7CglkaXNwbGF5OiBibG9jazsKCXRleHQtYWxpZ246IGNlbnRlcjsKCXBhZGRpbmc6IDA7Cn0KCnVsI2xpbmtzIGxpIHsKCWRpc3BsYXk6IGlubGluZTsKCWxpc3Qtc3R5bGUtdHlwZTogbm9uZTsKfQoKdWwjbGlua3MgbGk6bm90KDpmaXJzdC1jaGlsZCk6OmJlZm9yZSB7Cgljb250ZW50OiAi4oCiIjsKCW1hcmdpbjogMCAwLjVlbTsKfQo=";

const GBA_res_xhr_js = "ZnVuY3Rpb24gbG9hZFJvbSh1cmwsIGNhbGxiYWNrKSB7Cgl2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7Cgl4aHIub3BlbignR0VUJywgdXJsKTsKCXhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInOwoKCXhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHsgY2FsbGJhY2soeGhyLnJlc3BvbnNlKSB9OwoJeGhyLnNlbmQoKTsKfQo=";

const GBA_COPYING = "Q29weXJpZ2h0IChjKSAyMDEyLCBKZWZmcmV5IFBmYXUKQWxsIHJpZ2h0cyByZXNlcnZlZC4KClJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAptb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDoKCiogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzCiAgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuCgoqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwKICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uCiAgYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uCgpUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTICJBUyBJUyIKQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRQpJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRQpBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgT1IgQ09OVFJJQlVUT1JTIEJFCkxJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IKQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0YKU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTCklOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOCkNPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpCkFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFClBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLgo=";

const GBA_index_html = "PGh0bWw+CjxoZWFkPgo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCI+Cjx0aXRsZT5HQkEuanM8L3RpdGxlPgo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9InJlc291cmNlcy9tYWluLmNzcyI+CjxzY3JpcHQgc3JjPSJqcy91dGlsLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImpzL2NvcmUuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0ianMvYXJtLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImpzL3RodW1iLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImpzL21tdS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy9pby5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy9hdWRpby5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy92aWRlby5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy92aWRlby9wcm94eS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy92aWRlby9zb2Z0d2FyZS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy9pcnEuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0ianMva2V5cGFkLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImpzL3Npby5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy9zYXZlZGF0YS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJqcy9ncGlvLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImpzL2diYS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJyZXNvdXJjZXMveGhyLmpzIj48L3NjcmlwdD4KCjxzY3JpcHQ+CnZhciBnYmE7CnZhciBydW5Db21tYW5kcyA9IFtdOwp2YXIgZGVidWcgPSBudWxsOwoKdHJ5IHsKCWdiYSA9IG5ldyBHYW1lQm95QWR2YW5jZSgpOwoJZ2JhLmtleXBhZC5lYXRJbnB1dCA9IHRydWU7CglnYmEuc2V0TG9nZ2VyKGZ1bmN0aW9uKGxldmVsLCBlcnJvcikgewoJCWNvbnNvbGUubG9nKGVycm9yKTsKCQlnYmEucGF1c2UoKTsKCQl2YXIgc2NyZWVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjcmVlbicpOwoJCWlmIChzY3JlZW4uZ2V0QXR0cmlidXRlKCdjbGFzcycpID09ICdkZWFkJykgewoJCQljb25zb2xlLmxvZygnV2UgYXBwZWFyIHRvIGhhdmUgY3Jhc2hlZCBtdWx0aXBsZSB0aW1lcyB3aXRob3V0IHJlc2V0aW5nLicpOwoJCQlyZXR1cm47CgkJfQoJCXZhciBjcmFzaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOwoJCWNyYXNoLnNldEF0dHJpYnV0ZSgnaWQnLCAnY3Jhc2gnKTsKCQljcmFzaC5zZXRBdHRyaWJ1dGUoJ3NyYycsICdyZXNvdXJjZXMvY3Jhc2gucG5nJyk7CgkJc2NyZWVuLnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGNyYXNoLCBzY3JlZW4pOwoJCXNjcmVlbi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2RlYWQnKTsKCX0pOwp9IGNhdGNoIChleGNlcHRpb24pIHsKCWdiYSA9IG51bGw7Cn0KCndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKCWlmIChnYmEgJiYgRmlsZVJlYWRlcikgewoJCXZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NyZWVuJyk7CgkJZ2JhLnNldENhbnZhcyhjYW52YXMpOwoKCQlnYmEubG9nTGV2ZWwgPSBnYmEuTE9HX0VSUk9SOwoKCQlnYmEuc2V0QmlvcyhCSU9TX2J5dGVzKTsKCQkvL2xvYWRSb20oJ3Jlc291cmNlcy9iaW9zLmJpbicsIGZ1bmN0aW9uKGJpb3MpIHsKCQkJLy9nYmEuc2V0QmlvcyhiaW9zKTsKCQkvL30pOwoKCQlpZiAoIWdiYS5hdWRpby5jb250ZXh0KSB7CgkJCS8vIFJlbW92ZSB0aGUgc291bmQgYm94IGlmIHNvdW5kIGlzbid0IGF2YWlsYWJsZQoJCQl2YXIgc291bmRib3ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291bmQnKTsKCQkJc291bmRib3gucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChzb3VuZGJveCk7CgkJfQoKCQlpZiAod2luZG93Lm5hdmlnYXRvci5hcHBOYW1lID09ICdNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXInKSB7CgkJCS8vIFJlbW92ZSB0aGUgcGl4ZWxhdGVkIG9wdGlvbiBpZiBpdCBkb2Vzbid0IHdvcmsKCQkJdmFyIHBpeGVsYXRlZEJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaXhlbGF0ZWQnKTsKCQkJcGl4ZWxhdGVkQm94LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQocGl4ZWxhdGVkQm94KTsKCQl9Cgl9IGVsc2UgewoJCXZhciBkZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRyb2xzJyk7CgkJZGVhZC5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGRlYWQpOwoJfQoJCglydW4oIiIpOwp9CgpmdW5jdGlvbiBmYWRlT3V0KGlkLCBuZXh0SWQsIGtpbGwpIHsKCXZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwoJdmFyIGUyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmV4dElkKTsKCWlmICghZSkgewoJCXJldHVybjsKCX0KCXZhciByZW1vdmVTZWxmID0gZnVuY3Rpb24oKSB7CgkJaWYgKGtpbGwpIHsKCQkJZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGUpOwoJCX0gZWxzZSB7CgkJCWUuc2V0QXR0cmlidXRlKCdjbGFzcycsICdkZWFkJyk7CgkJCWUucmVtb3ZlRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIHJlbW92ZVNlbGYpOwoJCQllLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29UcmFuc2l0aW9uRW5kJywgcmVtb3ZlU2VsZik7CgkJCWUucmVtb3ZlRXZlbnRMaXN0ZW5lcigndHJhbnNpdGlvbmVuZCcsIHJlbW92ZVNlbGYpOwoJCX0KCQlpZiAoZTIpIHsKCQkJZTIuc2V0QXR0cmlidXRlKCdjbGFzcycsICdoaWRkZW4nKTsKCQkJc2V0VGltZW91dChmdW5jdGlvbigpIHsKCQkJCWUyLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTsKCQkJfSwgMCk7CgkJfQoJfQoKCWUuYWRkRXZlbnRMaXN0ZW5lcignd2Via2l0VHJhbnNpdGlvbkVuZCcsIHJlbW92ZVNlbGYsIGZhbHNlKTsKCWUuYWRkRXZlbnRMaXN0ZW5lcignb1RyYW5zaXRpb25FbmQnLCByZW1vdmVTZWxmLCBmYWxzZSk7CgllLmFkZEV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCByZW1vdmVTZWxmLCBmYWxzZSk7CgllLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnaGlkZGVuJyk7Cn0KCmZ1bmN0aW9uIHJ1bihmaWxlKSB7CgkvL3ZhciBkZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRlcicpOwoJLy9kZWFkLnZhbHVlID0gJyc7CgkvL3ZhciBsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdCcpOwoJLy9sb2FkLnRleHRDb250ZW50ID0gJ0xvYWRpbmcuLi4nOwoJLy9sb2FkLnJlbW92ZUF0dHJpYnV0ZSgnb25jbGljaycpOwoJLy92YXIgcGF1c2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF1c2UnKTsKCS8vcGF1c2UudGV4dENvbnRlbnQgPSAiUEFVU0UiOwoJdmFyIHJlc3VsdCA9IFJPTV9ieXRlczsKCWNvbnNvbGUubG9nKHJlc3VsdCk7CglnYmEuc2V0Um9tKHJlc3VsdCk7Cglmb3IgKHZhciBpID0gMDsgaSA8IHJ1bkNvbW1hbmRzLmxlbmd0aDsgKytpKSB7CgkJCQlydW5Db21tYW5kc1tpXSgpOwoJCQl9CgkJCXJ1bkNvbW1hbmRzID0gW107CgkJCWZhZGVPdXQoJ3ByZWxvYWQnLCAnaW5nYW1lJyk7CgkJCWZhZGVPdXQoJ2luc3RydWN0aW9ucycsIG51bGwsIHRydWUpOwoJCQlnYmEucnVuU3RhYmxlKCk7CgkKCS8qZ2JhLmxvYWRSb21Gcm9tRmlsZShmaWxlLCBmdW5jdGlvbihyZXN1bHQpIHsKCQlpZiAocmVzdWx0KSB7CgkJCWZvciAodmFyIGkgPSAwOyBpIDwgcnVuQ29tbWFuZHMubGVuZ3RoOyArK2kpIHsKCQkJCXJ1bkNvbW1hbmRzW2ldKCk7CgkJCX0KCQkJcnVuQ29tbWFuZHMgPSBbXTsKCQkJZmFkZU91dCgncHJlbG9hZCcsICdpbmdhbWUnKTsKCQkJZmFkZU91dCgnaW5zdHJ1Y3Rpb25zJywgbnVsbCwgdHJ1ZSk7CgkJCWdiYS5ydW5TdGFibGUoKTsKCQl9IGVsc2UgewoJCQlsb2FkLnRleHRDb250ZW50ID0gJ0ZBSUxFRCc7CgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCQlsb2FkLnRleHRDb250ZW50ID0gJ1NFTEVDVCc7CgkJCQlsb2FkLm9uY2xpY2sgPSBmdW5jdGlvbigpIHsKCQkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGVyJykuY2xpY2soKTsKCQkJCX0KCQkJfSwgMzAwMCk7CgkJfQoJfSk7Ki8KfQoKZnVuY3Rpb24gcmVzZXQoKSB7CglnYmEucGF1c2UoKTsKCWdiYS5yZXNldCgpOwoJdmFyIGxvYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0Jyk7Cglsb2FkLnRleHRDb250ZW50ID0gJ1NFTEVDVCc7Cgl2YXIgY3Jhc2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Jhc2gnKTsKCWlmIChjcmFzaCkgewoJCXZhciBjb250ZXh0ID0gZ2JhLnRhcmdldENhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwoJCWNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIDQ4MCwgMzIwKTsKCQlnYmEudmlkZW8uZHJhd0NhbGxiYWNrKCk7CgkJY3Jhc2gucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChjcmFzaCk7CgkJdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW4nKTsKCQljYW52YXMucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpOwoJfSBlbHNlIHsKCQlsY2RGYWRlKGdiYS5jb250ZXh0LCBnYmEudGFyZ2V0Q2FudmFzLmdldENvbnRleHQoJzJkJyksIGdiYS52aWRlby5kcmF3Q2FsbGJhY2spOwoJfQoJbG9hZC5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRlcicpLmNsaWNrKCk7Cgl9CglmYWRlT3V0KCdpbmdhbWUnLCAncHJlbG9hZCcpOwp9CgpmdW5jdGlvbiB1cGxvYWRTYXZlZGF0YVBlbmRpbmcoZmlsZSkgewoJcnVuQ29tbWFuZHMucHVzaChmdW5jdGlvbigpIHsgZ2JhLmxvYWRTYXZlZGF0YUZyb21GaWxlKGZpbGUpIH0pOwp9CgpmdW5jdGlvbiB0b2dnbGVQYXVzZSgpIHsKCXZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhdXNlJyk7CglpZiAoZ2JhLnBhdXNlZCkgewoJCWlmIChkZWJ1ZyAmJiBkZWJ1Zy5nYmFDb24pIHsKCQkJZGVidWcuZ2JhQ29uLnJ1bigpOwoJCX0gZWxzZSB7CgkJCWdiYS5ydW5TdGFibGUoKTsKCQl9CgkJZS50ZXh0Q29udGVudCA9ICJQQVVTRSI7Cgl9IGVsc2UgewoJCWlmIChkZWJ1ZyAmJiBkZWJ1Zy5nYmFDb24pIHsKCQkJZGVidWcuZ2JhQ29uLnBhdXNlKCk7CgkJfSBlbHNlIHsKCQkJZ2JhLnBhdXNlKCk7CgkJfQoJCWUudGV4dENvbnRlbnQgPSAiVU5QQVVTRSI7Cgl9Cn0KCmZ1bmN0aW9uIHNjcmVlbnNob3QoKSB7Cgl2YXIgY2FudmFzID0gZ2JhLmluZGlyZWN0Q2FudmFzOwoJd2luZG93Lm9wZW4oY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyksICdzY3JlZW5zaG90Jyk7Cn0KCmZ1bmN0aW9uIGxjZEZhZGUoY29udGV4dCwgdGFyZ2V0LCBjYWxsYmFjaykgewoJdmFyIGkgPSAwOwoJdmFyIGRyYXdJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgewoJCWkrKzsKCQl2YXIgcGl4ZWxEYXRhID0gY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgMjQwLCAxNjApOwoJCWZvciAodmFyIHkgPSAwOyB5IDwgMTYwOyArK3kpIHsKCQkJZm9yICh2YXIgeCA9IDA7IHggPCAyNDA7ICsreCkgewoJCQkJdmFyIHhEaWZmID0gTWF0aC5hYnMoeCAtIDEyMCk7CgkJCQl2YXIgeURpZmYgPSBNYXRoLmFicyh5IC0gODApICogMC44OwoJCQkJdmFyIHhGYWN0b3IgPSAoMTIwIC0gaSAtIHhEaWZmKSAvIDEyMDsKCQkJCXZhciB5RmFjdG9yID0gKDgwIC0gaSAtICgoeSAmIDEpICogMTApIC0geURpZmYgKyBNYXRoLnBvdyh4RGlmZiwgMSAvIDIpKSAvIDgwOwoJCQkJcGl4ZWxEYXRhLmRhdGFbKHggKyB5ICogMjQwKSAqIDQgKyAzXSAqPSBNYXRoLnBvdyh4RmFjdG9yLCAxIC8gMykgKiBNYXRoLnBvdyh5RmFjdG9yLCAxIC8gMik7CgkJCX0KCQl9CgkJY29udGV4dC5wdXRJbWFnZURhdGEocGl4ZWxEYXRhLCAwLCAwKTsKCQl0YXJnZXQuY2xlYXJSZWN0KDAsIDAsIDQ4MCwgMzIwKTsKCQlpZiAoaSA+IDQwKSB7CgkJCWNsZWFySW50ZXJ2YWwoZHJhd0ludGVydmFsKTsKCQl9IGVsc2UgewoJCQljYWxsYmFjaygpOwoJCX0KCX0sIDUwKTsKfQoKZnVuY3Rpb24gc2V0Vm9sdW1lKHZhbHVlKSB7CglnYmEuYXVkaW8ubWFzdGVyVm9sdW1lID0gTWF0aC5wb3coMiwgdmFsdWUpIC0gMTsKfQoKZnVuY3Rpb24gc2V0UGl4ZWxhdGVkKHBpeGVsYXRlZCkgewoJdmFyIHNjcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW4nKTsKCXZhciBjb250ZXh0ID0gc2NyZWVuLmdldENvbnRleHQoJzJkJyk7CglpZiAoY29udGV4dC53ZWJraXRJbWFnZVNtb290aGluZ0VuYWJsZWQpIHsKCQljb250ZXh0LndlYmtpdEltYWdlU21vb3RoaW5nRW5hYmxlZCA9ICFwaXhlbGF0ZWQ7Cgl9IGVsc2UgaWYgKGNvbnRleHQubW96SW1hZ2VTbW9vdGhpbmdFbmFibGVkKSB7CgkJY29udGV4dC5tb3pJbWFnZVNtb290aGluZ0VuYWJsZWQgPSAhcGl4ZWxhdGVkOwoJfSBlbHNlIGlmICh3aW5kb3cubmF2aWdhdG9yLmFwcE5hbWUgIT0gJ01pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlcicpIHsKCQkJaWYgKHBpeGVsYXRlZCkgewoJCQkJc2NyZWVuLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQwJyk7CgkJCQlzY3JlZW4uc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMTYwJyk7CgkJCX0gZWxzZSB7CgkJCQlzY3JlZW4uc2V0QXR0cmlidXRlKCd3aWR0aCcsICc0ODAnKTsKCQkJCXNjcmVlbi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICczMjAnKTsKCQkJfQoJCQlpZiAod2luZG93Lm5hdmlnYXRvci5hcHBOYW1lID09ICdPcGVyYScpIHsKCQkJLy8gVWdseSBoYWNrISBFdyEKCQkJaWYgKHBpeGVsYXRlZCkgewoJCQkJc2NyZWVuLnN0eWxlLm1hcmdpblRvcCA9ICcwJzsKCQkJCXNjcmVlbi5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnLTMyNXB4JzsKCQkJfSBlbHNlIHsKCQkJCWRlbGV0ZSBzY3JlZW4uc3R5bGU7CgkJCX0KCQl9Cgl9Cn0KCmZ1bmN0aW9uIGVuYWJsZURlYnVnKCkgewoJd2luZG93Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHsKCQlpZiAobWVzc2FnZS5vcmlnaW4gIT0gZG9jdW1lbnQuZG9tYWluICYmIChtZXNzYWdlLm9yaWdpbiAhPSAnZmlsZTovLycgfHwgZG9jdW1lbnQuZG9tYWluKSkgewoJCQljb25zb2xlLmxvZygnRmFpbGVkIFhTUycpOwoJCQlyZXR1cm47CgkJfQoJCXN3aXRjaCAobWVzc2FnZS5kYXRhKSB7CgkJY2FzZSAnY29ubmVjdCc6CgkJCWlmIChtZXNzYWdlLnNvdXJjZSA9PSBkZWJ1ZykgewoJCQkJZGVidWcucG9zdE1lc3NhZ2UoJ2Nvbm5lY3QnLCBkb2N1bWVudC5kb21haW4gfHwgJyonKTsKCQkJfQoJCQlicmVhazsKCQljYXNlICdjb25uZWN0ZWQnOgoJCQlicmVhazsKCQljYXNlICdkaXNjb25uZWN0JzoKCQkJaWYgKG1lc3NhZ2Uuc291cmNlID09IGRlYnVnKSB7CgkJCQlkZWJ1ZyA9IG51bGw7CgkJCX0KCQl9Cgl9Cgl3aW5kb3cub251bmxvYWQgPSBmdW5jdGlvbigpIHsKCQlpZiAoZGVidWcgJiYgZGVidWcucG9zdE1lc3NhZ2UpIHsKCQkJZGVidWcucG9zdE1lc3NhZ2UoJ2Rpc2Nvbm5lY3QnLCBkb2N1bWVudC5kb21haW4gfHwgJyonKTsKCQl9Cgl9CglpZiAoIWRlYnVnIHx8ICFkZWJ1Zy5wb3N0TWVzc2FnZSkgewoJCWRlYnVnID0gd2luZG93Lm9wZW4oJ2RlYnVnZ2VyLmh0bWwnLCAnZGVidWcnKTsKCX0gZWxzZSB7CgkJZGVidWcucG9zdE1lc3NhZ2UoJ2Nvbm5lY3QnLCBkb2N1bWVudC5kb21haW4gfHwgJyonKTsKCX0KfQoKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignd2Via2l0ZnVsbHNjcmVlbmNoYW5nZScsIGZ1bmN0aW9uKCkgewoJdmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW4nKTsKCWlmIChkb2N1bWVudC53ZWJraXRJc0Z1bGxTY3JlZW4pIHsKCQljYW52YXMuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCk7CgkJY2FudmFzLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAvIDIgKiAzKTsKCQljYW52YXMuc2V0QXR0cmlidXRlKCdzdHlsZScsICdtYXJnaW46IDAnKTsKCX0gZWxzZSB7CgkJY2FudmFzLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgMzIwKTsKCQljYW52YXMuc2V0QXR0cmlidXRlKCd3aWR0aCcsIDQ4MCk7CgkJY2FudmFzLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKCX0KfSwgZmFsc2UpOwoKPC9zY3JpcHQ+CjwvaGVhZD4KPGJvZHk+CjxjYW52YXMgaWQ9InNjcmVlbiIgd2lkdGg9IjQ4MCIgaGVpZ2h0PSIzMjAiPjwvY2FudmFzPgo8IS0tc2VjdGlvbiBpZD0iY29udHJvbHMiPgoJPGRpdiBpZD0icHJlbG9hZCI+CgkJPGJ1dHRvbiBjbGFzcz0iYmlnYnV0dG9uIiBpZD0ic2VsZWN0IiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGVyJykuY2xpY2soKSI+U0VMRUNUPC9idXR0b24+CgkJPGlucHV0IGlkPSJsb2FkZXIiIHR5cGU9ImZpbGUiIGFjY2VwdD0iLmdiYSIgb25jaGFuZ2U9InJ1bih0aGlzLmZpbGVzWzBdKTsiPgoJCTxidXR0b24gb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVsb2FkZXInKS5jbGljaygpIj5VcGxvYWQgU2F2ZWdhbWU8L2J1dHRvbj4KCQk8aW5wdXQgaWQ9InNhdmVsb2FkZXIiIHR5cGU9ImZpbGUiIG9uY2hhbmdlPSJ1cGxvYWRTYXZlZGF0YVBlbmRpbmcodGhpcy5maWxlc1swXSk7Ij4KCTwvZGl2PgoJPGRpdiBpZD0iaW5nYW1lIiBjbGFzcz0iaGlkZGVuIj4JCQoJCTxidXR0b24gY2xhc3M9ImJpZ2J1dHRvbiIgb25jbGljaz0icmVzZXQoKSI+UkVTRVQ8L2J1dHRvbj4KCQk8YnV0dG9uIG9uY2xpY2s9ImdiYS5kb3dubG9hZFNhdmVkYXRhKCkiPkRvd25sb2FkIFNhdmVnYW1lPC9idXR0b24+CgkJPGJ1dHRvbiBvbmNsaWNrPSJzY3JlZW5zaG90KCkiPlNjcmVlbnNob3Q8L2J1dHRvbj4KCQk8bGFiZWwgaWQ9InBpeGVsYXRlZCI+CgkJCTxpbnB1dCB0eXBlPSJjaGVja2JveCIgb25jaGFuZ2U9InNldFBpeGVsYXRlZCh0aGlzLmNoZWNrZWQpIj4KCQkJPHA+UGl4ZWxhdGVkPC9wPgoJCTwvbGFiZWw+CgkJPGRpdiBpZD0ic291bmQiPgoJCQk8aW5wdXQgdHlwZT0iY2hlY2tib3giIGNoZWNrZWQgb25jaGFuZ2U9ImdiYS5hdWRpby5tYXN0ZXJFbmFibGUgPSB0aGlzLmNoZWNrZWQiPgoJCQk8cD5Tb3VuZDwvcD4KCQkJPGlucHV0IHR5cGU9InJhbmdlIiBtaW49IjAiIG1heD0iMSIgdmFsdWU9IjEiIHN0ZXA9ImFueSIgb25jaGFuZ2U9InNldFZvbHVtZSh0aGlzLnZhbHVlKSIgb25pbnB1dD0ic2V0Vm9sdW1lKHRoaXMudmFsdWUpIj4KCQk8L2Rpdj4KCQk8cCBpZD0ib3BlbkRlYnVnIiBvbmNsaWNrPSJlbmFibGVEZWJ1ZygpIj5EZWJ1Z2dlcjwvcD4KCTwvZGl2Pgo8L3NlY3Rpb24+Cjx1bCBpZD0ibGlua3MiPgoJPGxpPjxhIGhyZWY9Imh0dHA6Ly9naXRodWIuY29tL2VuZHJpZnQvZ2JhanMvIj5Gb3JrIG1lIG9uIEdpdEh1YiE8L2E+PC9saT4KCTxsaT48YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vZW5kcmlmdC9nYmFqcy93aWtpL0NvbXBhdGliaWxpdHktTGlzdCI+Q29tcGF0aWJpbGl0eSBsaXN0PC9hPjwvbGk+CjwvdWw+Cjxmb290ZXI+wqkgMjAxMiDigJMgMjAxMyA8YSBocmVmPSJodHRwOi8vZW5kcmlmdC5jb20vIj5KZWZmcmV5IFBmYXU8L2E+PC9mb290ZXItLT4KPC9ib2R5PgoKPHNjcmlwdD4KCVJPTV9iNjQgPSAiQChyb21fYjY0KSI7CglST01fYnl0ZXMgPSBVaW50OEFycmF5LmZyb20oYXRvYihST01fYjY0KSwgYyA9PiBjLmNoYXJDb2RlQXQoMCkpLmJ1ZmZlcjsKCQoJQklPU19iNjQgPSAiQmdBQTZ2Ny8vK29GQUFEcS92Ly82djcvLytvQUFLRGhEQUFBNnY3Ly8rb0M4NkRqQUFCZDR3SFRvQU1nMEUwQ0FFQXQ2UUlBWHVVRUFGRGpDUUFBQ3dVQVVPTUhBQUFMQUVDOTZBN3dzT0VQVUMzcEFRT2c0d0RnaitJRThCRGxEMUM5NkFUd1h1SVFRQzNwQk5CTjRyQVF6ZUVCUTZEakFreUU0ckFBMU9HeUFNM2hzQkRkNFFFQWdPR3dBTVRoQVVPZzR4OEFvT01BOENuaEFBQ2c0d0VEeE9YVEFLRGpBUEFwNGJnQVZPR3dFTjNoQUJBUjRBQVFJUkM0RUVRUjgvLy9DZ0ZEb09NQ1RJVGlzZ0RkNGJBQXhPRUUwSTNpRUlDOTZBPT0iOwoJCglCSU9TX2J5dGVzID0gVWludDhBcnJheS5mcm9tKGF0b2IoQklPU19iNjQpLCBjID0+IGMuY2hhckNvZGVBdCgwKSkuYnVmZmVyOwo8L3NjcmlwdD4KCjwvaHRtbD4K";

function create_zip_GBA(filename, content) {
	var zip = new JSZip();
	zip.file("resources/crash.png",atob(GBA_res_crash_png));
	zip.file("resources/main.css",atob(GBA_res_main_css));
	zip.file("resources/xhr.js",atob(GBA_res_xhr_js));
	zip.file("js/video/proxy.js",atob(GBA_js_video_proxy_js));
	zip.file("js/video/software.js",atob(GBA_js_video_software_js));
	zip.file("js/video/worker.js",atob(GBA_js_video_worker_js));
	zip.file("js/arm.js",atob(GBA_js_arm_js));
	zip.file("js/audio.js",atob(GBA_js_audio_js));
	zip.file("js/core.js",atob(GBA_js_core_js));
	zip.file("js/gba.js",atob(GBA_js_gba_js));
	zip.file("js/gpio.js",atob(GBA_js_gpio_js));
	zip.file("js/io.js",atob(GBA_js_io_js));
	zip.file("js/irq.js",atob(GBA_js_irq_js));
	zip.file("js/keypad.js",atob(GBA_js_keypad_js));
	zip.file("js/mmu.js",atob(GBA_js_mmu_js));
	zip.file("js/savedata.js",atob(GBA_js_savedata_js));
	zip.file("js/sio.js",atob(GBA_js_sio_js));
	zip.file("js/thumb.js",atob(GBA_js_thumb_js));
	zip.file("js/util.js",atob(GBA_js_util_js));
	zip.file("js/video.js",atob(GBA_js_video_js));
	zip.file("COPYING",atob(GBA_COPYING));
	
	var index_html = atob(GBA_index_html);
	index_html = index_html.replace("@(rom_b64)", btoa(content));
	//console.log(mobile_js);
	zip.file("index.html",index_html);
    
    zip.generateAsync({
        type: "base64"
    }).then(function(content) {
		var link = document.createElement('a');
		if (typeof link.download === 'string') {
			document.body.appendChild(link); // Firefox requires the link to be in the body
			link.download = filename+".zip";
			link.href = "data:application/zip;base64," + content;
			link.click();
			document.body.removeChild(link); // remove the link when done
		} else {
			location.replace("data:application/zip;base64," + content);
		}        
    });     
}